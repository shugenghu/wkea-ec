{"version":3,"sources":["webpack:///./src/modules/search/actions/get-auto-suggest-suggestions.ts?53f2","webpack:///./src/modules/search/components/search.keywordsuggest.tsx?a25a","webpack:///./src/modules/search/components/search.productsuggest.tsx?c402","webpack:///./src/modules/search/components/search.categorysuggest.tsx?fc93","webpack:///./src/modules/search/components/search.form.tsx?0c2c","webpack:///./src/modules/search/components/search.label.tsx?27cf","webpack:///./src/modules/search/components/index.ts?db85","webpack:///./src/modules/search/search.tsx?8a4b"],"names":[],"mappings":"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","file":"1.61d51c981f6403262e8d.hot-update.js","sourcesContent":["import { generateImageUrl } from '@msdyn365-commerce-modules/retail-actions';\nimport { Autosuggestions } from '@msdyn365-commerce/commerce-entities';\nimport {\n    CacheType, createObservableDataAction, IAction, IActionContext, IActionInput,\n    ICreateActionContext\n} from '@msdyn365-commerce/core';\nimport { SearchSuggestion, SearchSuggestionCriteria } from '@msdyn365-commerce/retail-proxy';\nimport {\n    getSearchSuggestionsAsync\n} from '@msdyn365-commerce/retail-proxy/dist/DataActions/StoreOperationsDataActions.g';\n\n// @ts-ignore\nexport const enum SuggestionType {\n    Category = 'ScopedCategory',\n    Keyword = 'Keyword',\n    Product = 'Product',\n    None = 'None'\n}\n\n/**\n * Input class for auto suggest search input\n */\nexport class AutoSuggestInput implements IActionInput {\n    public searchQuery?: string;\n    public topResultsCount?: number;\n    public suggestionType?: string;\n    public hitPrefix?: string;\n    public hitSuffix?: string;\n\n    constructor(searchText?: string, top?: number, suggestionType?: string, hitPrefix?: string, hitSuffix?: string) {\n        this.searchQuery = searchText;\n        this.topResultsCount = top;\n        this.suggestionType = suggestionType;\n        this.hitPrefix = hitPrefix;\n        this.hitSuffix = hitSuffix;\n    }\n\n    public getCacheKey = () => `AutoSuggestSearchSuggestions`;\n    public getCacheObjectType = () => 'AutoSuggestSearchSuggestions';\n    public dataCacheType = (): CacheType => 'none';\n}\n\nconst createInput = (inputData: ICreateActionContext) => {\n    return new AutoSuggestInput();\n};\n\n/**\n * Calls the Retail API and returns a auto-suggest suggestions\n */\nexport async function getSearchSuggestionsAction(input: AutoSuggestInput, ctx: IActionContext): Promise<Autosuggestions | null> {\n    // If no input is provided fail out\n    if (!input || !input.searchQuery) {\n        throw new Error('[getSearchSuggestionsAction]No valid Input was provided, failing');\n    }\n\n    const autosuggest: Autosuggestions = {};\n\n    const autoSuggestPromises = [\n        _getAutoSuggest(input, autosuggest, ctx),\n    ];\n    return Promise.all(autoSuggestPromises).then(() => {\n        return autosuggest;\n    });\n}\n\nasync function _getAutoSuggest(\n    input: AutoSuggestInput,\n    autosuggest: Autosuggestions,\n    ctx: IActionContext\n): Promise<void> {\n    const searchCriteria: SearchSuggestionCriteria = {\n        ProductSearchCriteria: {\n            SearchCondition: input.searchQuery && input.searchQuery.length > 0 ? input.searchQuery : '',\n            Context: {\n                ChannelId: +ctx.requestContext.apiSettings.channelId,\n                CatalogId: +ctx.requestContext.apiSettings.catalogId\n            }\n        },\n        HitPrefix: input.hitPrefix,\n        HitSuffix: input.hitSuffix,\n        SuggestionType: input.suggestionType\n    };\n\n    const searchSuggestions = await getSearchSuggestionsAsync(\n        { callerContext: ctx, queryResultSettings: { Paging: { Top: input.topResultsCount } } },\n        searchCriteria\n    );\n\n    if (searchSuggestions && searchSuggestions.length > 0) {\n        // Generate image url\n        searchSuggestions.map(\n            (item: SearchSuggestion) =>\n                (item.ImageUrl = item.ImageUrl ? generateImageUrl(item.ImageUrl, ctx.requestContext.apiSettings) : '')\n        );\n\n        autosuggest.AllSearchResults = searchSuggestions;\n    } else {\n        ctx.telemetry.error(`[getSearchSuggestionsAction] unable to get availabilites for search with suggestion type ${searchCriteria.SuggestionType}`);\n    }\n}\n\nexport default createObservableDataAction({\n    id: '@msdyn365-commerce-modules/search/get-auto-suggest-suggestions',\n    action: <IAction<Autosuggestions>>getSearchSuggestionsAction,\n    input: createInput\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as React from 'react';\n\nimport { getPayloadObject, getTelemetryAttributes, IPayLoad, ITelemetryContent } from '@msdyn365-commerce-modules/utilities';\nimport { getRichTextHtml } from '@msdyn365-commerce/core';\nimport { SearchSuggestion } from '@msdyn365-commerce/retail-proxy';\n\nimport { ISearchData } from '../search.data';\nimport { ISearchProps } from '../search.props.autogenerated';\n\nexport interface ISearchKeywordSuggestProps {\n    searchKeywordSuggestClass: string;\n    searchPageURL: string;\n    searchQsp: string | undefined;\n    hitPrefix: string;\n    hitSuffix: string;\n    autoSuggestProps: ISearchProps<ISearchData>;\n    searchText: string;\n    suggestions: SearchSuggestion[] | undefined;\n    telemetryContent?: ITelemetryContent;\n}\n\nexport interface ISearchKeywordViewProps {\n    text: React.ReactNode[];\n}\n\nlet payLoad: IPayLoad;\n\n/**\n *\n * KeywordSuggestionsComponent\n */\nexport const KeywordSuggestionsComponent = (props: ISearchKeywordSuggestProps): ISearchKeywordViewProps | undefined => {\n    const {\n        suggestions,\n        hitPrefix,\n        hitSuffix\n    } = props;\n\n    if (!suggestions) {\n        return undefined;\n    }\n\n    payLoad = getPayloadObject('click', props.telemetryContent!, '');\n\n    const reactNodes: React.ReactNode[] = [];\n\n    suggestions.map(item => {\n        reactNodes.push(_assembleNode(item, hitPrefix, hitSuffix, props));\n    });\n\n    return { text: reactNodes };\n};\n\nconst _assembleNode = (item: SearchSuggestion, hitPrefix: string, hitSuffix: string, props: ISearchKeywordSuggestProps) => {\n    const ariaLabel = item.Value &&\n    (item.Value).replace(new RegExp(`[${hitPrefix}]`, 'gi'), '').replace(new RegExp(`[${hitSuffix}]`, 'gi'), '');\n    payLoad.contentAction.etext = ariaLabel;\n    const attribute = getTelemetryAttributes(props.telemetryContent!, payLoad);\n    return (\n        <li className='msc-autoSuggest__keywordResults-item' key={item.Id}>\n            <a\n                aria-label={ariaLabel}\n                href={_generateLink(item, hitPrefix, hitSuffix, props)}\n                {...attribute}\n            >\n                {_generateLink(item, hitPrefix, hitSuffix, props) &&\n                    _getHighlightedText(item.Value ? item.Value : '', hitPrefix, hitSuffix)}\n            </a>\n        </li>\n    );\n};\n\nconst _generateLink = (suggestion: SearchSuggestion, hitPrefix: string, hitSuffix: string, props: ISearchKeywordSuggestProps): string => {\n    const { searchPageURL, searchQsp } = props;\n\n    const formattedLink = (suggestion.Value as string)\n        .replace(new RegExp(`[${hitPrefix}]`, 'gi'), '')\n        .replace(new RegExp(`[${hitSuffix}]`, 'gi'), '');\n    const route = searchPageURL || '';\n    return formattedLink && formattedLink.length > 0\n        ? `${route}${route.indexOf('?') === -1 ? '?' : '&'}${searchQsp}=${formattedLink}`\n        : route;\n};\n\nconst _getHighlightedText = (suggestion: string, hitPrefix: string, hitSuffix: string): JSX.Element => {\n    const formattedText = suggestion\n        .replace(new RegExp(`[${hitPrefix}]`, 'gi'), '<strong>')\n        .replace(new RegExp(`[${hitSuffix}]`, 'gi'), '</strong>');\n\n    // tslint:disable:react-no-dangerous-html\n    return <span dangerouslySetInnerHTML={getRichTextHtml(formattedText)} />;\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as React from 'react';\n\nimport { PriceComponent } from '@msdyn365-commerce/components';\nimport { getRichTextHtml, IActionContext, IImageSettings, Image, ITelemetry } from '@msdyn365-commerce/core';\nimport { SearchSuggestion } from '@msdyn365-commerce/retail-proxy';\n\nimport { getProductPageUrlSync } from '@msdyn365-commerce-modules/retail-actions';\nimport { getPayloadObject, getTelemetryAttributes, INodeProps, IPayLoad, ITelemetryContent, NodeTag } from '@msdyn365-commerce-modules/utilities';\nimport { ISearchData } from '../search.data';\nimport { ISearchProps } from '../search.props.autogenerated';\n\nexport interface ISearchProductSuggestProps {\n    searchProductSuggestClass: string;\n    searchPageURL: string;\n    searchQsp: string | undefined;\n    hitPrefix: string;\n    hitSuffix: string;\n    autoSuggestProps: ISearchProps<ISearchData>;\n    searchText: string;\n    suggestions: SearchSuggestion[] | undefined;\n    telemetry: ITelemetry;\n    moduleType: string;\n    moduleId: string;\n    telemetryContent?: ITelemetryContent;\n}\n\nexport interface ISearchProductViewProps {\n    title: React.ReactNode;\n    items: ISearchProductItemViewProps[];\n}\n\nexport interface ISearchProductItemViewProps {\n    text: React.ReactNode;\n    thumbnail: React.ReactNode;\n    price: React.ReactNode;\n    LiProduct: INodeProps;\n    AProduct: INodeProps;\n    id: string | undefined;\n}\n\nlet payLoad: IPayLoad;\nlet telemetryContent: ITelemetryContent | undefined;\n\n/**\n *\n * ProductSuggestionsComponent\n */\nexport const ProductSuggestionsComponent = (props: ISearchProductSuggestProps): ISearchProductViewProps | undefined => {\n    const {\n        suggestions,\n        hitSuffix,\n        hitPrefix,\n        autoSuggestProps: {\n            context: { actionContext },\n            resources: { productSuggestionHeading }\n        },\n        moduleType,\n        moduleId\n    } = props;\n    const reactNodes: ISearchProductItemViewProps[] = [];\n    telemetryContent = props.telemetryContent;\n    payLoad = getPayloadObject('click', props.telemetryContent!, '');\n\n    if (!suggestions) {\n        return undefined;\n    }\n\n    suggestions.map(item => {\n        reactNodes.push(_assembleNode(item, hitPrefix, hitSuffix, actionContext, props, moduleType, moduleId));\n    });\n\n    const titleNode = _renderTitle(productSuggestionHeading);\n\n    return { title: titleNode, items: reactNodes };\n};\n\nconst _renderTitle = (productSuggestionHeading: string) => {\n    const productAutoSuggestionHeading = productSuggestionHeading ? productSuggestionHeading : 'Go to products';\n\n    return <li className='msc-autoSuggest__productResults-title'>{productAutoSuggestionHeading}</li>;\n};\n\nconst _assembleNode = (\n    item: SearchSuggestion,\n    hitPrefix: string,\n    hitSuffix: string,\n    actionContext: IActionContext,\n    props: ISearchProductSuggestProps,\n    moduleType: string,\n    moduleId: string\n): ISearchProductItemViewProps => {\n    const altText =\n        item.Value &&\n        (item.Value).replace(new RegExp(`[${hitPrefix}]`, 'gi'), '').replace(new RegExp(`[${hitSuffix}]`, 'gi'), '');\n\n    return {\n        text: _getHighlightedText(item.Value ? item.Value : '', hitPrefix, hitSuffix),\n        thumbnail: _renderThumbnail(item, altText ? altText : '', props),\n        price:\n            item.Id &&\n            item.Value3 &&\n            item.Value3.Value &&\n            item.Value3.Value.DecimalValue &&\n            _renderPrice(item.Value3.Value.DecimalValue, item.Value3.Value.DecimalValue, moduleId, moduleType, props),\n        LiProduct: _getLiWrapper(),\n        AProduct: _getAWrapper(item, hitPrefix, hitSuffix, actionContext),\n        id: item.Id\n    };\n};\n\nconst _getLiWrapper = () => {\n    return {\n        className: 'msc-autoSuggest__productResults-item',\n        tag: 'li' as NodeTag\n    };\n};\n\nconst _getAWrapper = (item: SearchSuggestion, hitPrefix: string, hitSuffix: string, actionContext: IActionContext) => {\n    const ariaLabel = item.Value &&\n        (item.Value).replace(new RegExp(`[${hitPrefix}]`, 'gi'), '').replace(new RegExp(`[${hitSuffix}]`, 'gi'), '');\n\n    payLoad.contentAction.recid = item.Id;\n    const attribute = getTelemetryAttributes(telemetryContent!, payLoad);\n\n    return {\n        className: 'msc-autoSuggest__productResults-item',\n        tag: 'a' as NodeTag,\n        'aria-label': ariaLabel,\n        href: _generateLink(item, hitPrefix, hitSuffix, actionContext),\n        ...attribute\n    };\n};\n\nconst _generateLink = (suggestion: SearchSuggestion, hitPrefix: string, hitSuffix: string, actionContext: IActionContext) => {\n    const formattedLink = (suggestion.Value as string).replace(new RegExp(`[${hitPrefix}]`, 'gi'), '').replace(new RegExp(`[${hitSuffix}]`, 'gi'), '');\n    return suggestion.Value && suggestion.Id ?\n        getProductPageUrlSync(formattedLink,suggestion.Id as unknown as number, actionContext, undefined) : '';\n};\n\nconst _getHighlightedText = (suggestion: string, hitPrefix: string, hitSuffix: string): JSX.Element => {\n    const formattedText = suggestion\n        .replace(new RegExp(`[${hitPrefix}]`, 'gi'), '<strong>')\n        .replace(new RegExp(`[${hitSuffix}]`, 'gi'), '</strong>');\n\n    // tslint:disable:react-no-dangerous-html\n    return <span className='msc-price msc-autoSuggest__productResults-item-text'  dangerouslySetInnerHTML={getRichTextHtml(formattedText)} />;\n};\n\nconst _renderPrice = (adjustedPrice: number, basePrice: number, moduleId: string, moduleType: string, props: ISearchProductSuggestProps): JSX.Element | null => {\n    const {\n        autoSuggestProps: { context }\n    } = props;\n\n    return (\n        <PriceComponent\n            id={moduleId}\n            typeName={moduleType}\n            context={context}\n            data={{\n                price: {\n                    CustomerContextualPrice: adjustedPrice,\n                    BasePrice: basePrice\n                }\n            }}\n            className='msc-autoSuggest__productResults-item-price'\n        />\n    );\n};\n\nconst _renderThumbnail = (suggestion: SearchSuggestion, altText: string, props: ISearchProductSuggestProps): JSX.Element | null => {\n    const {\n        autoSuggestProps: {\n            context: {\n                request: { gridSettings }\n            },\n            config: { imageSettings }\n        }\n    } = props;\n\n    if (!suggestion || !suggestion.ImageUrl) {\n        props.telemetry.error('Search suggestion content is empty, module wont render.');\n        return null;\n    }\n\n    const defaultImageSettings: IImageSettings = {\n        viewports: {\n            xs: { q: `w=40&h=40&m=6`, w: 0, h: 0 },\n            lg: { q: `w=40&h=40&m=6`, w: 0, h: 0 },\n            xl: { q: `w=40&h=40&m=6`, w: 0, h: 0 }\n        },\n        lazyload: true\n    };\n\n    return (\n        <Image\n            altText={altText}\n            className='msc-autoSuggest__productResults-item-img'\n            src={suggestion.ImageUrl}\n            gridSettings={gridSettings!}\n            imageSettings={imageSettings ? imageSettings : defaultImageSettings}\n            loadFailureBehavior='hide'\n        />\n    );\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as React from 'react';\n\nimport { getRichTextHtml } from '@msdyn365-commerce/core';\nimport { ProductRefiner, ProductRefinerValue, SearchSuggestion } from '@msdyn365-commerce/retail-proxy';\n\nimport { format, getPayloadObject, getTelemetryAttributes, IPayLoad, ITelemetryContent } from '@msdyn365-commerce-modules/utilities';\nimport { ISearchData } from '../search.data';\nimport { ISearchProps } from '../search.props.autogenerated';\n\nexport interface ISearchCategorySuggestProps {\n    searchCategorySuggestClass: string;\n    searchPageURL: string;\n    searchQsp: string | undefined;\n    hitPrefix: string;\n    hitSuffix: string;\n    autoSuggestProps: ISearchProps<ISearchData>;\n    searchText: string;\n    searchRefiners: ProductRefiner[] | undefined;\n    suggestions: SearchSuggestion[] | undefined;\n    telemetryContent?: ITelemetryContent;\n}\n\nexport interface ISearchCategoryViewProps {\n    title: React.ReactNode;\n    text: React.ReactNode[];\n}\n\nlet payLoad: IPayLoad;\n\n/**\n *\n * CategorySuggestionsComponent\n */\nexport const CategorySuggestionsComponent = (props: ISearchCategorySuggestProps): ISearchCategoryViewProps | undefined => {\n    const {\n        suggestions,\n        searchText,\n        autoSuggestProps: {\n            resources: { categorySuggestionHeading }\n        }\n    } = props;\n\n    if (!suggestions) {\n        return undefined;\n    }\n\n    const reactNodes: React.ReactNode[] = [];\n    payLoad = getPayloadObject('click', props.telemetryContent!, '');\n\n    suggestions.map(item => {\n        reactNodes.push(_assembleNode(item, props));\n    });\n\n    const titleNode = _renderTitle(categorySuggestionHeading, searchText);\n\n    return { title: titleNode, text: reactNodes };\n};\n\nconst _renderTitle = (categorySuggestionHeading: string, searchText: string) => {\n    const categoryAutoSuggestionHeading = categorySuggestionHeading\n        ? format(categorySuggestionHeading, searchText)\n        : `Search \"${searchText}\" in categories`;\n\n    return <li className='msc-autoSuggest__categoryResults-title'>{categoryAutoSuggestionHeading}</li>;\n};\n\nconst _assembleNode = (item: SearchSuggestion, props: ISearchCategorySuggestProps) => {\n    const { searchText, hitPrefix, hitSuffix } = props;\n\n    const splitValue = item.Value && item.Value.split('|').pop();\n    const ariaLabel = splitValue\n        ? splitValue.replace(new RegExp(`[${hitPrefix}]`, 'gi'), '').replace(new RegExp(`[${hitSuffix}]`, 'gi'), '')\n        : item.Value && item.Value.replace(new RegExp(`[${hitPrefix}]`, 'gi'), '').replace(new RegExp(`[${hitSuffix}]`, 'gi'), '');\n    payLoad.contentAction.etext = item.Value;\n    const attribute = getTelemetryAttributes(props.telemetryContent!, payLoad);\n    return (\n        <li className='msc-autoSuggest__categoryResults-item' key={item.Id}>\n            <a aria-label={ariaLabel} href={_generateLink(item, searchText, props)} {...attribute}>\n                {_generateLink(item, searchText, props) && _getHighlightedText(item.Value ? item.Value : '', hitPrefix, hitSuffix)}\n            </a>\n        </li>\n    );\n};\n\nconst _generateLink = (suggestion: SearchSuggestion, searchText: string, props: ISearchCategorySuggestProps): string => {\n    return suggestion && suggestion.Id ? _getCategoryLink(suggestion.Id, searchText, props) : '';\n};\n\nconst _getCategoryLink = (id: string, searchText: string, props: ISearchCategorySuggestProps): string => {\n    const { searchPageURL, searchQsp, searchRefiners } = props;\n\n    const route = searchPageURL || '';\n    const urlPath = `${route}${route.indexOf('?') === -1 ? '?' : '&'}${searchQsp}=${searchText}`;\n    const categoryRefiners =\n        searchRefiners &&\n        searchRefiners.find(refiners => {\n            return refiners.KeyName === 'Category';\n        });\n    const refiner =\n        categoryRefiners &&\n        categoryRefiners.Values &&\n        categoryRefiners.Values.find(item => {\n            return item.RefinerRecordId === parseInt(id, 10);\n        });\n\n    const encodedRefiner = refiner && encodeURIComponent(JSON.stringify(compressRefiners([refiner])));\n\n    return encodedRefiner ? `${urlPath}&refiners=${encodedRefiner}` : urlPath;\n};\n\nconst _getHighlightedText = (suggestion: string, hitPrefix: string, hitSuffix: string): JSX.Element => {\n    let formattedText = suggestion\n        .replace(new RegExp(`[${hitPrefix}]`, 'gi'), '<strong>')\n        .replace(new RegExp(`[${hitSuffix}]`, 'gi'), '</strong>');\n    formattedText = formattedText.split('|').pop() || '';\n\n    // tslint:disable:react-no-dangerous-html\n    return <span dangerouslySetInnerHTML={getRichTextHtml(formattedText)} />;\n};\n\n// TODO: This code is currently duplicated in categoryautosuggest need to either remove one of these files\n// or move this code to a common place\nconst compressedRefinerKeys = ['DataTypeValue', 'LeftValueBoundString', 'RefinerRecordId', 'RefinerSourceValue', 'RightValueBoundString', 'UnitText'];\n\n/**\n * Compressed a list of refiners for use in URLs\n * @param refiners The uncompressed refiners\n */\nconst compressRefiners = (refiners: ProductRefinerValue[]) => {\n    const compressedRefiners: (string | number)[][] = [];\n\n    refiners.forEach((refiner) => {\n        const compressedRefiner: (string | number)[] = [];\n        compressedRefinerKeys.forEach((refinerKey) => {\n            // @ts-ignore: This line is intentionally not typesafe\n            compressedRefiner.push(refiner[refinerKey]);\n        });\n        compressedRefiners.push(compressedRefiner);\n    });\n\n    return compressedRefiners;\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Button } from '@msdyn365-commerce-modules/utilities';\nimport * as React from 'react';\n\nexport interface ISearchFormProps {\n    hideSearchLabel: boolean | undefined;\n    isSearchFormExpanded: boolean | undefined;\n    disableSubmitSearch: boolean | undefined;\n    searchTextInput: React.RefObject<HTMLInputElement>;\n    maxChars: number;\n    searchQsp: string;\n    searchPlaceholder: string;\n    query: string;\n    ariaLabelCancel: string;\n    ariaLabelSearch: string;\n    ariaLabelSubmit: string;\n    handleCancelSearchChange(): void;\n    handleInputChange(query: string): void;\n}\n\nexport interface ISearchFormViewProps {\n    input: React.ReactNode;\n    submitBtn: React.ReactNode;\n    cancelBtn: React.ReactNode;\n\n}\n\nexport const FormComponent = (props: ISearchFormProps): ISearchFormViewProps => {\n    const {\n        searchQsp,\n        searchPlaceholder,\n        hideSearchLabel,\n        isSearchFormExpanded,\n        searchTextInput,\n        handleInputChange,\n        maxChars,\n        disableSubmitSearch,\n        handleCancelSearchChange,\n        query,\n        ariaLabelCancel,\n        ariaLabelSearch,\n        ariaLabelSubmit\n    } = props;\n\n    const onInputChange = (e: React.ChangeEvent<HTMLInputElement>): void => {\n        handleInputChange(e.target.value || '');\n    };\n\n    const inputNode = !hideSearchLabel ? (\n        <input\n            className='ms-search__form-control'\n            type='text'\n            aria-label={isSearchFormExpanded ? 'Search expanded' : 'Search collapsed'}\n            name={searchQsp}\n            placeholder={searchPlaceholder}\n            ref={searchTextInput}\n            onChange={onInputChange}\n            maxLength={maxChars}\n            value={query}\n        />\n    ) : (\n        <input\n            className='ms-search__form-control'\n            type='text'\n            aria-label={ariaLabelSearch}\n            name={searchQsp}\n            placeholder={searchPlaceholder}\n            ref={searchTextInput}\n            onChange={onInputChange}\n            value={query}\n        />\n    );\n\n    const submitBtnNode = !disableSubmitSearch && (\n        <Button className='ms-search__form-submitSearch' aria-label={ariaLabelSubmit} />\n    );\n\n    const cancelBtNoden = (\n    <Button\n        className={!disableSubmitSearch ? 'ms-search__form-cancelSearch' : 'ms-search__form-cancelSearchNoSumbit'}\n        aria-label={ariaLabelCancel}\n        onClick={handleCancelSearchChange}\n        type='button'\n    />\n    );\n\n    return {input: inputNode, cancelBtn: cancelBtNoden, submitBtn: submitBtnNode};\n};","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Button, getPayloadObject, getTelemetryAttributes, ITelemetryContent } from '@msdyn365-commerce-modules/utilities';\nimport * as React from 'react';\n\nexport interface ISearchLabelProps {\n    isSearchFormExpanded: boolean;\n    searchLabelClass: string;\n    searchLabelArialLabel: string;\n    searchtext: string;\n    searchCollapsedLabel: React.RefObject<HTMLButtonElement>;\n    hideSearchLabel?: boolean;\n    telemetryContent: ITelemetryContent;\n    handleCancelSearchChange(): void;\n}\n\nexport const LabelComponent = (props: ISearchLabelProps) => {\n    const { searchLabelClass, searchLabelArialLabel, isSearchFormExpanded, searchtext, searchCollapsedLabel, hideSearchLabel, handleCancelSearchChange, telemetryContent} = props;\n    const payLoad = getPayloadObject('click', telemetryContent, searchtext, '');\n    const attributes = getTelemetryAttributes(telemetryContent, payLoad);\n\n    return (\n        <div className={searchLabelClass}>\n\n            <Button\n                className='ms-search__icon'\n                aria-expanded={isSearchFormExpanded}\n                aria-label={searchLabelArialLabel}\n                onClick={handleCancelSearchChange}\n                innerRef={searchCollapsedLabel}\n                {...attributes}\n            >\n                {!hideSearchLabel && <span className='ms-search__icon-text' aria-hidden={true}>{searchtext}</span>}\n            </Button>\n        </div>\n    );\n};\n","export * from './search.keywordsuggest';\nexport * from './search.productsuggest';\nexport * from './search.categorysuggest';\nexport * from './search.form';\nexport * from './search.label';","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createSearchStateInput } from '@msdyn365-commerce-modules/search-utilities';\nimport { getTelemetryObject, IModuleProps, INodeProps, ITelemetryContent, KeyCodes } from '@msdyn365-commerce-modules/utilities';\nimport { Autosuggestions } from '@msdyn365-commerce/commerce-entities';\nimport { getUrlSync } from '@msdyn365-commerce/core';\nimport { ProductRefiner } from '@msdyn365-commerce/retail-proxy';\nimport { getProductSearchRefinersAsync } from '@msdyn365-commerce/retail-proxy/dist/DataActions/ProductsDataActions.g';\nimport classnames from 'classnames';\nimport { debounce } from 'lodash';\nimport * as React from 'react';\n\nimport getSearchSuggestionsAction, { AutoSuggestInput, SuggestionType } from './actions/get-auto-suggest-suggestions';\nimport {\n    CategorySuggestionsComponent,\n    FormComponent,\n    ISearchCategoryViewProps,\n    ISearchKeywordViewProps,\n    ISearchProductViewProps,\n    KeywordSuggestionsComponent,\n    LabelComponent,\n    ProductSuggestionsComponent\n} from './components';\nimport { ISearchData } from './search.data';\nimport { ISearchProps, ISuggestionTypeCriterionData } from './search.props.autogenerated';\n\nexport interface ISearchState {\n    isSearchFormExpanded: boolean;\n    searchText: string;\n    searchKeywordSuggestClass: string;\n    searchProductSuggestClass: string;\n    searchCategorySuggestClass: string;\n    suggestions: Autosuggestions | undefined;\n    searchRefiners?: ProductRefiner[] | undefined;\n    autoSuggestAriaLabel: string;\n    isInitialState: boolean;\n}\n\nexport interface ISearchViewProps extends ISearchProps<ISearchData> {\n    Search: IModuleProps;\n    AutoSuggestAriaLabel: INodeProps;\n    AutoSuggestAriaLabelText: string;\n    searchText: string;\n    AutoSuggest: INodeProps;\n    KeywordSuggest: INodeProps;\n    ProductSuggest: INodeProps;\n    CategorySuggest: INodeProps;\n    SearchForm: INodeProps;\n    FormWrapper: INodeProps;\n    UlKeyword: INodeProps;\n    UlProduct: INodeProps;\n    UlCategory: INodeProps;\n    label: React.ReactNode;\n    form: React.ReactNode;\n    autosuggestKeyword?: ISearchKeywordViewProps;\n    autosuggestProduct?: ISearchProductViewProps;\n    autosuggestCategory?: ISearchCategoryViewProps;\n    callbacks: {\n        handleCancelSearchChange(): void;\n    };\n    isSearchFormExpanded: boolean;\n}\n\n/**\n *\n * Search module\n * @extends {React.Component<ISearchProps<ISearchData>, ISearchState>}\n */\nclass Search extends React.Component<ISearchProps<ISearchData>, ISearchState> {\n    private searchTextInput: React.RefObject<HTMLInputElement>;\n    private searchCollapsedLabel: React.RefObject<HTMLButtonElement>;\n    private formReference: React.RefObject<HTMLButtonElement>;\n    private maxChars: number;\n    private inputSuggestionType?: ISuggestionTypeCriterionData[];\n    private topResultsCount?: number;\n    private hitPrefix: string = '{';\n    private hitSuffix: string = '}';\n    private waitTime: number = 500;\n    private autoSuggestResultScreenReaderDiv: React.RefObject<HTMLDivElement>;\n    private autoSuggestResultDiv: React.RefObject<HTMLDivElement>;\n    private searchFormClass: string;\n    private searchLabelClass: string;\n    private telemetryContent: ITelemetryContent;\n    // @ts-ignore\n    private cancellabelDebounce: debounce;\n\n    constructor(props: ISearchProps<ISearchData>) {\n        super(props);\n        this.searchTextInput = React.createRef();\n        this.searchCollapsedLabel = React.createRef();\n        this.autoSuggestResultScreenReaderDiv = React.createRef();\n        this.autoSuggestResultDiv = React.createRef();\n        this.formReference = React.createRef();\n        this.state = {\n            isSearchFormExpanded: false,\n            searchText: '',\n            searchKeywordSuggestClass: 'ms-search__autoSuggest__keyword',\n            searchProductSuggestClass: 'ms-search__autoSuggest__product',\n            searchCategorySuggestClass: 'ms-search__autoSuggest__category',\n            suggestions: undefined,\n            searchRefiners: undefined,\n            autoSuggestAriaLabel: '',\n            isInitialState: true\n        };\n        this.maxChars =\n            (this.props.context &&\n                this.props.context.app &&\n                this.props.context.app.config &&\n                this.props.context.app.config.searchInputMaxLength) ||\n            50;\n        this.inputSuggestionType = this.props.config && this.props.config.suggestionTypeCriterion;\n        this.topResultsCount = this.props.config && this.props.config.topResultsCount ? this.props.config.topResultsCount : 5;\n        this.searchFormClass = 'ms-search__form';\n        this.searchLabelClass = 'ms-search__label';\n        this.telemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!, this.props.friendlyName, this.props.telemetry);\n    }\n\n    public async componentDidMount(): Promise<void> {\n        document.body && document.body.addEventListener('mousedown', this._focusOutTarget);\n        window && window.addEventListener('keyup', this._keyup);\n    }\n\n    public componentWillUnmount(): void {\n        document.body && document.body.removeEventListener('mousedown', this._focusOutTarget, false);\n        window && window.removeEventListener('keyup', this._keyup, false);\n    }\n\n    public componentDidUpdate(): void {\n        const {\n            config: { hideSearchLabel }\n        } = this.props;\n        const { isSearchFormExpanded, isInitialState } = this.state;\n\n        if (!this.props.context.request.params.isEditor) {\n            if (!hideSearchLabel && isSearchFormExpanded) {\n                this.searchTextInput && this.searchTextInput.current && this.searchTextInput.current.focus();\n            } else if (!isInitialState) {\n                this.searchCollapsedLabel && this.searchCollapsedLabel.current && this.searchCollapsedLabel.current.focus();\n            }\n        }\n    }\n\n    // tslint:disable-next-line: cyclomatic-complexity max-func-body-length\n    public render(): JSX.Element {\n        const {\n            context,\n            resources: { searchtext, searchLabelArialLabel, cancelBtnAriaLabel, searchBtnAriaLabel, submitBtnAriaLabel},\n            config: { hideSearchLabel, disableSubmitSearch, searchplaceholderText, className = '' }\n        } = this.props;\n\n        const {\n            isSearchFormExpanded,\n            searchText,\n            searchKeywordSuggestClass,\n            searchProductSuggestClass,\n            searchCategorySuggestClass,\n            suggestions,\n            searchRefiners\n        } = this.state;\n\n        const searchQsp = (context && context.app && context.app.config && context.app.config.searchQueryStringParameter) || 'q';\n        const searchPageURL = getUrlSync('search', context && context.actionContext) || '';\n        const searchURL = this._appendQueryParams(searchPageURL, searchText, searchQsp);\n        const searchPlaceholder = searchplaceholderText && searchplaceholderText.length > 0 ? searchplaceholderText : 'Search in Fabrikam';\n\n        const keywordSuggestions =\n            suggestions &&\n            suggestions.AllSearchResults &&\n            suggestions.AllSearchResults.filter(\n                i => i.SuggestionType === SuggestionType.Keyword || i.SuggestionType === SuggestionType.None\n            );\n        const productSuggestions =\n            suggestions &&\n            suggestions.AllSearchResults &&\n            suggestions.AllSearchResults.filter(i => i.SuggestionType === SuggestionType.Product);\n        const categorySuggestions =\n            suggestions &&\n            suggestions.AllSearchResults &&\n            suggestions.AllSearchResults.filter(i => i.SuggestionType === SuggestionType.Category);\n\n        const viewProps: ISearchViewProps = {\n            ...(this.props as ISearchProps<ISearchData>),\n\n            Search: {\n                moduleProps: this.props,\n                className: `${classnames('ms-search', className)} ${disableSubmitSearch ? 'no-submit' : 'with-submit'}`,\n            },\n            AutoSuggestAriaLabel: {\n                tag: 'div',\n                className: 'msc-autoSuggest__screen-reader',\n                'aria-live': 'assertive',\n                ref: this.autoSuggestResultScreenReaderDiv\n            },\n            AutoSuggestAriaLabelText: this.state.autoSuggestAriaLabel,\n            searchText: this.state.searchText,\n            AutoSuggest: {\n                ref: this.autoSuggestResultDiv,\n                className: 'ms-search__autoSuggest'\n            },\n            KeywordSuggest: {\n                className: searchKeywordSuggestClass\n            },\n            ProductSuggest: {\n                className: searchProductSuggestClass\n            },\n            CategorySuggest: {\n                className: searchCategorySuggestClass\n            },\n            SearchForm: {\n                className: `${this.searchFormClass} ${isSearchFormExpanded ? 'bx-show' : 'bx-hide'}`\n            },\n            FormWrapper: {\n                tag: 'form',\n                ref: this.formReference,\n                className: 'ms-search__searchForm',\n                'aria-label': 'Search',\n                name: 'searchForm',\n                role: 'Search',\n                action: searchURL,\n                autoComplete: 'off',\n                onSubmit: this._handleSubmit\n            },\n            UlKeyword: {\n                tag: 'ul',\n                className: classnames('msc-autoSuggest__keywordResults-items', className)\n            },\n            UlProduct: {\n                tag: 'ul',\n                className: classnames('msc-autoSuggest__productResults-items', className)\n            },\n            UlCategory: {\n                tag: 'ul',\n                className: classnames('msc-autoSuggest__categoryResults-items', className)\n            },\n            label:LabelComponent({\n                isSearchFormExpanded: isSearchFormExpanded,\n                searchLabelClass: `${this.searchLabelClass} ${isSearchFormExpanded ? 'bx-hide' : 'bx-show'}`,\n                searchtext: searchtext,\n                searchLabelArialLabel: searchLabelArialLabel,\n                searchCollapsedLabel: this.searchCollapsedLabel,\n                hideSearchLabel: hideSearchLabel,\n                handleCancelSearchChange: this._handleCancelSearchChange,\n                telemetryContent: this.telemetryContent\n            }),\n            form: FormComponent({\n                ariaLabelCancel: cancelBtnAriaLabel,\n                ariaLabelSearch: searchBtnAriaLabel,\n                ariaLabelSubmit: submitBtnAriaLabel,\n                hideSearchLabel: hideSearchLabel,\n                searchTextInput: this.searchTextInput,\n                isSearchFormExpanded: isSearchFormExpanded,\n                disableSubmitSearch: disableSubmitSearch,\n                handleInputChange: this._handleInputChange,\n                handleCancelSearchChange: this._handleCancelSearchChange,\n                maxChars: this.maxChars,\n                searchQsp: searchQsp,\n                searchPlaceholder: searchPlaceholder,\n                query: searchText\n            }),\n            autosuggestKeyword:\n                searchText && searchText.length > 0 && keywordSuggestions && keywordSuggestions.length > 0\n                    ? KeywordSuggestionsComponent({\n                          searchKeywordSuggestClass: searchKeywordSuggestClass,\n                          searchPageURL: searchPageURL,\n                          searchQsp: searchQsp,\n                          hitPrefix: this.hitPrefix,\n                          hitSuffix: this.hitSuffix,\n                          autoSuggestProps: this.props,\n                          searchText: searchText,\n                          suggestions: keywordSuggestions,\n                          telemetryContent: this.telemetryContent\n                      })\n                    : undefined,\n            autosuggestProduct:\n                searchText && searchText.length > 0 && productSuggestions && productSuggestions.length > 0\n                    ? ProductSuggestionsComponent({\n                          searchProductSuggestClass: searchProductSuggestClass,\n                          searchPageURL: searchPageURL,\n                          searchQsp: searchQsp,\n                          hitPrefix: this.hitPrefix,\n                          hitSuffix: this.hitSuffix,\n                          autoSuggestProps: this.props,\n                          searchText: searchText,\n                          suggestions: productSuggestions,\n                          telemetry: this.props.telemetry,\n                          moduleType: this.props.typeName,\n                          moduleId: this.props.id,\n                          telemetryContent: this.telemetryContent\n                      })\n                    : undefined,\n            autosuggestCategory:\n                searchText && searchText.length > 0 && categorySuggestions && categorySuggestions.length > 0\n                    ? CategorySuggestionsComponent({\n                          searchCategorySuggestClass: searchCategorySuggestClass,\n                          searchPageURL: searchPageURL,\n                          searchQsp: searchQsp,\n                          hitPrefix: this.hitPrefix,\n                          hitSuffix: this.hitSuffix,\n                          autoSuggestProps: this.props,\n                          searchText: searchText,\n                          suggestions: categorySuggestions,\n                          searchRefiners: searchRefiners,\n                          telemetryContent: this.telemetryContent\n                      })\n                    : undefined,\n            callbacks: {\n                handleCancelSearchChange: this._handleCancelSearchChange\n            },\n            isSearchFormExpanded: this.state.isSearchFormExpanded\n        };\n\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n\n    // tslint:disable-next-line:no-any\n    private _focusOutTarget = (e: any): void => {\n        const { suggestions } = this.state;\n\n        if (\n            suggestions &&\n            suggestions.AllSearchResults &&\n            e.target.closest('.ms-search') === null\n        ) {\n            this._clearAutoSuggestState();\n        }\n    };\n\n    private _keyup = (e: KeyboardEvent): void => {\n        const { suggestions } = this.state;\n\n        if (suggestions && suggestions.AllSearchResults && e.keyCode === KeyCodes.Escape) {\n            this._clearAutoSuggestState();\n        } else if(this.state.isSearchFormExpanded && e.keyCode === KeyCodes.Escape) {\n            if(this.state.isSearchFormExpanded) {\n                this.setState({ isSearchFormExpanded: false });\n            }\n        }\n\n        if (!((this.formReference.current && this.formReference.current.contains(e.target as unknown as Node)) ||\n        (this.autoSuggestResultDiv.current && this.autoSuggestResultDiv.current.contains(e.target as unknown as Node)))) {\n            if (suggestions && suggestions.AllSearchResults) {\n                this._clearAutoSuggestState();\n            }\n\n            if(this.state.isSearchFormExpanded) {\n                this.setState({ isSearchFormExpanded: false });\n            }\n        }\n    };\n\n    private _clearAutoSuggestState = (): void => {\n        const {\n            context: { actionContext },\n            data: { searchState }\n        } = this.props;\n\n        if (this.searchTextInput.current && this.searchTextInput.current.value.length > 0) {\n            searchState.searchText = '';\n            searchState.defaultBasicSearchUrl = '';\n            searchState.searchQueryStringParameter = '';\n            actionContext ? actionContext.update(createSearchStateInput(searchState), searchState) : null;\n            this.searchTextInput.current.value = '';\n        }\n\n        this.setState({ searchText: '', suggestions: undefined, searchRefiners: undefined });\n    };\n\n    private _handleInputChange = (query: string): void => {\n        if (!query || query.length < this.maxChars) {\n            this.setState({ searchText: query });\n        }\n\n        if (this.cancellabelDebounce) {\n            this.cancellabelDebounce.cancel();\n        }\n\n        const {\n            telemetry,\n            context,\n            data: { searchState }\n        } = this.props;\n\n        if (context) {\n            if (query && query.length > 0) {\n                if (query.length > this.maxChars) {\n                    return;\n                }\n\n                this.cancellabelDebounce = debounce(() => {\n                    getSearchSuggestionsAction(\n                        new AutoSuggestInput(\n                            query,\n                            this.topResultsCount,\n                            this._getSuggestionType(this.inputSuggestionType),\n                            this.hitPrefix,\n                            this.hitSuffix\n                        ),\n                        context.actionContext\n                    )\n                        .then(results => {\n                            this._getSearchRefiners(query)\n                                .then(refiners => {\n                                    this.setState({ suggestions: results, searchRefiners: refiners,\n                                        autoSuggestAriaLabel: this._setAutoSuggestResultCount(results) });\n                                })\n                                .catch(error => {\n                                    this.setState({ suggestions: results, searchRefiners: undefined,\n                                        autoSuggestAriaLabel: this._setAutoSuggestResultCount(results) });\n                                    telemetry.exception(error);\n                                    telemetry.debug('Unable to get refiners results');\n                                });\n                        })\n                        .catch(error => {\n                            this.setState({ suggestions: undefined, searchRefiners: undefined,\n                                autoSuggestAriaLabel: this._setAutoSuggestResultCount() });\n                            telemetry.exception(error);\n                            telemetry.debug('Unable to get auto suggest results');\n                        });\n                },                                  this.waitTime);\n\n                setTimeout(() => {\n                    this.cancellabelDebounce();\n                },         0);\n\n                searchState.searchText = query;\n            } else {\n                this.setState({ suggestions: undefined, searchRefiners: undefined });\n                searchState.searchText = '';\n            }\n            context.actionContext.update(createSearchStateInput(searchState), searchState);\n        }\n    };\n\n    private _getSuggestionType = (suggestionTypes?: ISuggestionTypeCriterionData[]): string => {\n        if (suggestionTypes && suggestionTypes.length > 0) {\n            const distinctSuggestionTypes: string[] = [];\n            suggestionTypes && suggestionTypes.forEach((suggestionTypeItem, index) => {\n                suggestionTypeItem.SuggestionType && distinctSuggestionTypes.push(suggestionTypeItem.SuggestionType.charAt(0).toUpperCase() + suggestionTypeItem.SuggestionType.slice(1));\n            });\n            return distinctSuggestionTypes.join(',');\n        }\n        return 'Keyword, Product, ScopedCategory';\n    };\n\n    private async _getSearchRefiners(searchText: string): Promise<ProductRefiner[]> {\n        const { actionContext: ctx } = this.props.context;\n        return getProductSearchRefinersAsync(\n            { callerContext: ctx },\n            {\n                SearchCondition: searchText,\n                Context: {\n                    ChannelId: +ctx.requestContext.apiSettings.channelId,\n                    CatalogId: +ctx.requestContext.apiSettings.catalogId\n                }\n            }\n        );\n    }\n\n    private _handleSubmit = (\n        e: React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement> | React.FormEvent<HTMLFormElement>\n    ): void => {\n        const {\n            config: { disableSubmitSearch },\n            context: {\n                actionContext,\n                app: {\n                    config: { searchQueryStringParameter }\n                }\n            }\n        } = this.props;\n\n        const query = this.searchTextInput.current && this.searchTextInput.current.value;\n        e.preventDefault();\n\n        if (!query || (query && query.length === 0) || disableSubmitSearch) {\n            this.searchTextInput && this.searchTextInput.current && this.searchTextInput.current.focus();\n        } else {\n            const searchQsp = searchQueryStringParameter || 'q';\n            const searchURL = this._appendQueryParams(getUrlSync('search', actionContext) || '', query, searchQsp);\n            document.location.href = searchURL;\n        }\n    };\n\n    private _handleCancelSearchChange = (): void => {\n        const { isSearchFormExpanded, suggestions } = this.state;\n\n        if (!isSearchFormExpanded) {\n            this.setState({\n                isSearchFormExpanded: true,\n                searchText: '',\n                isInitialState: false\n            });\n        } else {\n            if (suggestions && suggestions.AllSearchResults) {\n                this._clearAutoSuggestState();\n            }\n\n            this.setState({ isSearchFormExpanded: false });\n        }\n    };\n\n    private _appendQueryParams = (route: string, query: string, qsp: string): string => {\n        if (route && route.length > 0) {\n            return query && query.length > 0 ? `${route}${route.indexOf('?') === -1 ? '?' : '&'}${qsp}=${query}` : route;\n        }\n        return '';\n    };\n\n    private _setAutoSuggestResultCount = (result?: Autosuggestions) => {\n        if (this.autoSuggestResultScreenReaderDiv.current !== null) {\n            const ariaLiveRegion = this.autoSuggestResultScreenReaderDiv.current;\n            const suggestResultString = this.props.resources.autoSuggestFoundMessage;\n            const emptyResultString = this.props.resources.noAutoSuggestionMessage;\n            ariaLiveRegion.innerText = result && (result.AllSearchResults && result.AllSearchResults.length > 0) ? suggestResultString : emptyResultString;\n            ariaLiveRegion.setAttribute('aria-live','assertive');\n            return ariaLiveRegion.innerText;\n        } else {\n            return '';\n        }\n    };\n}\n\nexport default Search;\n"],"sourceRoot":""}