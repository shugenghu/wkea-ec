/*!
 * Copyright (c) Microsoft Corporation.
 * All rights reserved. See LICENSE in the project root for license information.
 */
import 'jest';
import { Telemetry } from '@msdyn365-commerce/telemetry-internal';
import { createDataAction } from '../create-data-action';
const mockActionInput = {
    getCacheObjectType: () => {
        return '';
    },
    getCacheKey: () => {
        return '';
    },
    shouldCacheOutput: () => {
        return true;
    }
};
const mockActionFunc = (input, ctx) => {
    return Promise.resolve('foo');
};
const createMockActionContext = () => {
    const ctx = {
        telemetry: new Telemetry(),
        chainAction: (action, input) => {
            return action(input, ctx);
        },
        update: (input, data) => undefined,
        get: (s, k) => undefined,
        getAll: s => null,
        trace: (message) => undefined,
        requestContext: {},
        runAllActionsInQueue: jest.fn()
    };
    return ctx;
};
describe('Create Data Action Unit Tests', () => {
    it('Crrectly creates and runs standard actions', async () => {
        const mockActionContext = createMockActionContext();
        const dataAction = createDataAction({ action: mockActionFunc });
        const result = await mockActionContext.chainAction(dataAction, mockActionInput);
        expect(result).toBe('foo');
    });
    it('Correctly creates and runs direct actions', async () => {
        const mockActionContext = createMockActionContext();
        const dataAction = createDataAction({ action: mockActionFunc });
        const result = await dataAction(mockActionInput, mockActionContext);
        expect(result).toBe('foo');
    });
});
//# sourceMappingURL=create-data-action.test.js.map