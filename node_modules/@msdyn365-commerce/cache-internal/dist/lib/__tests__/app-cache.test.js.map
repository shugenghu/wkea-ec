{"version":3,"file":"app-cache.test.js","sourceRoot":"","sources":["../../../src/__tests__/app-cache.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*!\n * Copyright (c) Microsoft Corporation.\n * All rights reserved. See LICENSE in the project root for license information.\n */\n\nimport 'jest';\nimport { observable } from 'mobx';\nimport { AppCache } from '../app-cache';\nimport { ICacheKey } from '../ICache';\n\nimport { AsyncResult } from '@msdyn365-commerce/retail-proxy';\n\ndescribe('Validate app cache put', () => {\n    // cache settings are normalized to uppercase. Please check platformutils: getCacheSettings() for implementation\n    const cache = new AppCache({\n        ttlInSeconds: { SHOES: -1 },\n        ttrInSeconds: { FASHION: -1, CATEGORY: 2 },\n        checkPeriodInSeconds: 600,\n        defaultTTRInSeconds: 10\n    });\n\n    it('Should insert values in app cache', () => {\n        cache.put(\n            { key: '1234567', typeName: 'electronics' },\n            {\n                item: {\n                    camera: {\n                        features: ['Flash', 'Video'],\n                        primary: '5.0 megapixels'\n                    }\n                },\n                shouldRefresh: true\n            }\n        );\n\n        const cacheKey: ICacheKey = { key: '1234567', typeName: 'electronics' };\n        expect(cache.get(cacheKey)).toMatchObject({\n            item: {\n                camera: {\n                    features: ['Flash', 'Video'],\n                    primary: '5.0 megapixels'\n                }\n            },\n            shouldRefresh: true\n        });\n    });\n\n    it('validate put/get/del of string typeName', () => {\n        const cacheKey = { key: '99999', typeName: 'string' };\n        cache.put(cacheKey, { item: 'string' });\n        expect(cache.getValue(cacheKey)).toEqual('string');\n        expect(cache.del(cacheKey)).toBeTruthy();\n    });\n\n    it('validate put/get/del of number typeName', () => {\n        const cacheKey = { key: '99999', typeName: 'number' };\n        cache.put(cacheKey, { item: 0 });\n        expect(cache.getValue(cacheKey)).toEqual(0);\n        expect(cache.del(cacheKey)).toBeTruthy();\n    });\n\n    it('validate put/get/del of boolean typeName', () => {\n        const cacheKey = { key: '99999', typeName: 'boolean' };\n        cache.put(cacheKey, { item: false });\n        expect(cache.getValue(cacheKey)).toEqual(false);\n        expect(cache.del(cacheKey)).toBeTruthy();\n    });\n\n    it('validate put/get/del of null', () => {\n        const cacheKey = { key: '99999', typeName: 'null' };\n        cache.put(cacheKey, { item: null });\n        expect(cache.getValue(cacheKey)).toBeNull();\n        expect(cache.del(cacheKey)).toBeTruthy();\n    });\n\n    it('validate put/get/del of undefined', () => {\n        const cacheKey = { key: '99999', typeName: 'undefined' };\n        cache.put(cacheKey, { item: undefined });\n        expect(cache.getValue(cacheKey)).toBeUndefined();\n        expect(cache.del(cacheKey)).toBeTruthy();\n    });\n\n    it('Should return stale data when ttr expires', () => {\n        const cacheKey: ICacheKey = { key: '1234567', typeName: 'fashion' };\n        cache.put(cacheKey, {\n            item: {\n                camera: {\n                    features: ['Summer wear'],\n                    primary: 'old navy'\n                }\n            }\n        });\n\n        const cachedItem = cache.get(cacheKey);\n        expect(cachedItem && cachedItem.shouldRefresh).toEqual(true);\n    });\n\n    it('Should return undefined when ttl expires', () => {\n        cache.put({ key: '1234567', typeName: 'shoes' }, { item: 'athletic' });\n\n        const cacheKey: ICacheKey = { key: '1234567', typeName: 'shoes' };\n        expect(cache.get(cacheKey)).toBeUndefined();\n    });\n\n    it('Should return all keys in the cache', () => {\n        cache.put(\n            { key: '1234568', typeName: 'electronics' },\n            {\n                item: {\n                    camera: {\n                        features: ['Flash', 'Video'],\n                        primary: '8.0 megapixels'\n                    }\n                }\n            }\n        );\n\n        expect(cache.keys()).toEqual(['ELECTRONICS-1234567', 'FASHION-1234567', 'ELECTRONICS-1234568']);\n    });\n\n    it('Should delete value from app cache', () => {\n        const cacheKey = { key: '987654321', typeName: 'electronics' };\n\n        cache.put(\n            { key: '987654321', typeName: 'electronics' },\n            {\n                item: {\n                    camera: {\n                        features: ['Flash', 'Video'],\n                        primary: '9.0 megapixels'\n                    }\n                }\n            }\n        );\n\n        expect(cache.del(cacheKey)).toBeTruthy();\n        expect(cache.get(cacheKey)).toBeUndefined();\n    });\n\n    it('Should flush all values from app cache', () => {\n        cache.flushAll();\n\n        expect(cache.get({ key: '1234567', typeName: 'electronics' })).toBeUndefined();\n        expect(cache.get({ key: '1234568', typeName: 'electronics' })).toBeUndefined();\n    });\n\n    it('should fallback to default ttr if ttr is not specified', () => {\n        const cacheKey = { key: '99999', typeName: 'boolean' };\n        const expectedExpirtyTime = new Date();\n        expectedExpirtyTime.setSeconds(expectedExpirtyTime.getSeconds() + 10);\n        cache.put(cacheKey, { item: false });\n        const cachedItem = cache.get(cacheKey);\n        // @ts-ignore\n        expect(expectedExpirtyTime.toUTCString()).toEqual(new Date(<number>cachedItem.expireAtInTimeMilliseconds).toUTCString());\n    });\n\n    it('Insert an mobx observable item and retrive the same', () => {\n        const cacheKey = { key: '987654321', typeName: 'mobx-object' };\n        const cacheItem = observable([\n            {\n                RecordId: '12345'\n            }\n        ]);\n\n        cache.put(cacheKey, { item: cacheItem });\n        const cachedItem = cache.get(cacheKey);\n        expect(cachedItem).not.toBeUndefined();\n        expect(cachedItem && cachedItem.item).toEqual([{ RecordId: '12345' }]);\n    });\n\n    it('Inserts an AsyncResult and retireves the same', async () => {\n        const cacheKey = { key: '1', typeName: 'observable-promise' };\n        const cacheItem = new AsyncResult(resolve => {\n            resolve('foo');\n        });\n\n        cache.put(cacheKey, { item: cacheItem });\n\n        // tslint:disable-next-line\n        await cacheItem;\n        const cachedItem = cache.getValue(cacheKey);\n\n        expect(cacheItem instanceof AsyncResult).toBe(true);\n        expect(cachedItem instanceof AsyncResult).toBe(true);\n        expect(cacheItem).toBe(cachedItem);\n    });\n\n    it('Can handle observable AsyncResults', async () => {\n        const cacheKey = { key: '1', typeName: 'observable-promise' };\n        const cacheItem = observable(\n            new AsyncResult(resolve => {\n                resolve('foo');\n            })\n        );\n\n        cache.put(cacheKey, { item: cacheItem });\n\n        // tslint:disable-next-line\n        await cacheItem;\n        const cachedItem = cache.getValue(cacheKey);\n\n        expect(cacheItem instanceof AsyncResult).toBe(true);\n        expect(cachedItem instanceof AsyncResult).toBe(true);\n    });\n\n    // tslint:disable-next-line:mocha-avoid-only\n    it('Should return the cache value in case if the item is in refreshing state', async done => {\n        jest.setTimeout(20000);\n        const cacheKey = { key: '12345', typeName: 'Category' };\n        cache.put(cacheKey, { item: 'Shirts' });\n        expect(cache.get(cacheKey)!.shouldRefresh).toBeUndefined();\n\n        setTimeout(() => {\n            // shouldRefresh to be true if the ttr expired\n            expect(cache.get(cacheKey)!.shouldRefresh).toBeTruthy();\n\n            // subsequent requests should get the item in cache with shouldRefresh: undefined\n            const value = cache.get(cacheKey);\n            expect(value!.item).toEqual('Shirts');\n            expect(cache.get(cacheKey)!.shouldRefresh).toBeUndefined();\n        }, 2000);\n\n        setTimeout(() => {\n            // shoulRefresh to be true if the item is in isRefreshing state refresh expired.\n            expect(cache.get(cacheKey)!.shouldRefresh).toBeTruthy();\n            // shouldRefresh to be undefined in subsequent request.\n            expect(cache.get(cacheKey)!.shouldRefresh).toBeUndefined();\n            done();\n        }, 15000);\n    });\n});\n"]}