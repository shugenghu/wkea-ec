import { updateCartLinesAsync } from '@msdyn365-commerce/retail-proxy/dist/DataActions/CartsDataActions.g';
export default async function updateCartLineQuantityInternal(cart, cartLineId, newQuantity, actionContext) {
    if (!cart || !cart.CartLines) {
        return { cart: undefined, status: 'FAILED' };
    }
    const matchingLines = cart.CartLines.filter(cartLine => cartLine.LineId === cartLineId);
    if (matchingLines.length === 0) {
        return { cart: undefined, status: 'FAILED' };
    }
    const copyCartLine = { ...matchingLines[0] };
    copyCartLine.Quantity = Math.min(newQuantity, actionContext.requestContext.app.config.maxQuantityForCartLineItem || 10);
    return updateCartLinesAsync({ callerContext: actionContext }, cart.Id, [copyCartLine], null)
        .then(newCart => {
        return { cart: newCart, status: 'SUCCESS' };
    })
        .catch(error => {
        actionContext.telemetry.warning(error);
        actionContext.telemetry.debug('Unable to Update Cart Line');
        return { cart: undefined, status: 'FAILED' };
    });
}
//# sourceMappingURL=update-cart-line-quantity.js.map