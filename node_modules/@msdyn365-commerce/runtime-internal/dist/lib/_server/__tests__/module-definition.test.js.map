{"version":3,"file":"module-definition.test.js","sourceRoot":"","sources":["../../../../src/_server/__tests__/module-definition.test.ts"],"names":[],"mappings":"AAAA;;;GAGG;AAEH,OAAO,gBAAgB,EAAE,EAAE,kBAAkB,EAAE,MAAM,yBAAyB,CAAC;AAE/E,OAAO,KAAK,EAAE,MAAM,UAAU,CAAC;AAC/B,OAAO,MAAM,CAAC;AACd,OAAO,KAAK,IAAI,MAAM,MAAM,CAAC;AAG7B,OAAO,EAAE,mBAAmB,EAAE,0BAA0B,EAAE,oBAAoB,EAAE,MAAM,gCAAgC,CAAC;AAEvH,QAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE;IAC/B,EAAE,CAAC,4CAA4C,EAAE,KAAK,IAAI,EAAE;QACxD,aAAa;QACb,MAAM,EAAE,GAAkB;YACtB,oBAAoB,EAAE,EAAE;YACxB,cAAc,EAAE,IAAI,CAAC,OAAO,CAAC,oDAAoD,CAAC;SACrF,CAAC;QAEF,aAAa;QACb,MAAM,SAAS,GAAe;YAC1B,SAAS,EAAE,IAAI,CAAC,EAAE,EAAE;YACpB,GAAG,EAAE,IAAI,CAAC,EAAE,EAAE;SACjB,CAAC;QACF,MAAM,mBAAmB,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;QACzC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,gBAAgB,EAAE,CAAC;IACjD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,2GAA2G,EAAE,KAAK,IAAI,EAAE;QACvH,aAAa;QACb,yBAAyB;QACnB,gBAAiB,CAAC,YAAY,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;QACvE,aAAa;QACP,gBAAiB,CAAC,kBAAkB,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;QAC7E,aAAa;QACP,gBAAiB,CAAC,iBAAiB,GAAG,EAAE,CAAC;QAC/C,aAAa;QACP,gBAAiB,CAAC,iBAAiB,CAAC,wBAAwB,GAAG,IAAI,CAAC;QAC1E,aAAa;QACb,0BAA0B,GAAG,IAAI;aAC5B,EAAE,EAAE;aACJ,iBAAiB,CAAC,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,8CAA8C,CAAC,CAAC,CAAC,CAAC,CAAC;QACvH,MAAM,MAAM,GAAG,MAAM,oBAAoB,CAAC,eAAe,EAAE,kBAAkB,EAAE,CAAC,CAAC;QACjF,MAAM,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,CAAC;IACrC,CAAC,CAAC,CAAC;AACP,CAAC,CAAC,CAAC","sourcesContent":["/*!\n * Copyright (c) Microsoft Corporation.\n * All rights reserved. See LICENSE in the project root for license information.\n */\n\nimport msdyn365Commerce, { buildMockTelemetry } from '@msdyn365-commerce/core';\nimport { ITelemetry } from '@msdyn365-commerce/telemetry-internal';\nimport * as fs from 'fs-extra';\nimport 'jest';\nimport * as path from 'path';\nimport { IModuleBinder } from '../../app-initialization/models';\n\nimport { getDataJsonAndParse, getModuleDefinitionApiFile, getModuleDefinitions } from '../Definition/moduleDefinition';\n\ndescribe('Module definition', () => {\n    it('skip data definition read if path is empty', async () => {\n        // @ts-ignore\n        const mb: IModuleBinder = {\n            parentDefinitionPath: '',\n            definitionPath: path.resolve('src/_server/__mocks__/empty-module.definition.json')\n        };\n\n        // @ts-ignore\n        const telemetry: ITelemetry = {\n            exception: jest.fn(),\n            log: jest.fn()\n        };\n        await getDataJsonAndParse(mb, telemetry);\n        expect(telemetry.log).not.toHaveBeenCalled();\n    });\n\n    it('should transform DAPI response css type to string and include default class name property if not provided', async () => {\n        // @ts-ignore\n        // tslint:disable: no-any\n        (<any>msdyn365Commerce).moduleBinder = jest.fn().mockReturnValue(true);\n        // @ts-ignore\n        (<any>msdyn365Commerce).getAllModuleBinder = jest.fn().mockReturnValue(true);\n        // @ts-ignore\n        (<any>msdyn365Commerce)._platformSettings = {};\n        // @ts-ignore\n        (<any>msdyn365Commerce)._platformSettings.disableDAPIOptimizations = true;\n        // @ts-ignore\n        getModuleDefinitionApiFile = jest\n            .fn()\n            .mockResolvedValue([fs.readJSONSync(path.resolve(process.cwd(), 'src/_server/__mocks__/module.definition.json'))]);\n        const result = await getModuleDefinitions('sample-config', buildMockTelemetry());\n        expect(result).toMatchSnapshot();\n    });\n});\n"]}