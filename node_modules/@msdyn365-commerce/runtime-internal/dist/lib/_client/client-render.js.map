{"version":3,"file":"client-render.js","sourceRoot":"","sources":["../../../src/_client/client-render.tsx"],"names":[],"mappings":"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","sourcesContent":["/*!\n * Copyright (c) Microsoft Corporation.\n * All rights reserved. See LICENSE in the project root for license information.\n */\n\nimport { ActionContext } from '@msdyn365-commerce/action-internal';\nimport { RequestCache } from '@msdyn365-commerce/cache-internal';\nimport {\n    CoreContext,\n    CultureInfoFormatter,\n    IActionContext,\n    IAny,\n    ICoreContext,\n    IDictionary,\n    IGeneric,\n    IModuleContract,\n    IMSDyn365Window,\n    IPartnerThemeSettings,\n    IRequestContext,\n    IRequestContextUrl,\n    IVariants,\n    msdyn365Commerce\n} from '@msdyn365-commerce/core-internal';\n// tslint:enable:no-import-side-effect\nimport {\n    AppInsightsJSLogger,\n    EVENT_CLIENT_RENDER_START,\n    EVENT_CLIENT_RENDER_STOP,\n    EVENT_LOAD_DATA_START,\n    EXCEPTION_CLIENT_CACHE_HYDRATE,\n    EXCEPTION_LOAD_DATA_EXCEPTION,\n    EXCEPTION_PRODUCT_LIST_CLIENTSIDE_HYDRATION,\n    expAttributeRenderer,\n    GenericConsoleLogger,\n    IEventClientRenderMetrics,\n    IEventClientRenderProperties,\n    IEventLoadDataRenderProperties,\n    LogLevel,\n    MESSAGE_CLIENT_RENDER_ERROR,\n    StaticTelemetry,\n    Telemetry,\n    TelemetryEvent\n} from '@msdyn365-commerce/telemetry-internal';\nimport axios from 'axios';\n// tslint:disable:no-import-side-effect\nimport 'lazysizes';\nimport 'lazysizes/plugins/attrchange/ls.attrchange';\nimport { partition as _partition } from 'lodash';\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport {\n    RSRequestInterceptor,\n    RSRequestInterceptorErrorHandler,\n    RSResponseInterceptor,\n    RSResponseInterceptorErrorHandler\n} from '../_server/inteceptors/rs-logging-interceptor';\nimport SafeRenderModule from '../components/safe-render-module';\nimport {\n    CLIENT_RENDER_COMPLETE_EVENT,\n    CLIENT_RENDER_START_EVENT,\n    DEPRECATED_CLIENT_RENDER_COMPLETE_EVENT,\n    LAYOUT_MOUNT_POINT,\n    PROCESS_TYPE\n} from '../consts';\nimport { loadData } from '../data/load-data';\nimport { processComplexDataTypes } from '../hydrators/process-page-response';\nimport { IDisabledProperties } from '../store/authoring-edit-helper';\nimport { PageContext } from '../store/page-context';\nimport { getCurrencyCodeFromContext } from '../utils/helpers';\nimport { SessionStorageContext } from '../utils/session-storage-utils';\nimport { AuthoringToolsHelper } from './../utils/authoring-tools-helper';\nimport { CookieContext } from './../utils/cookie-utils';\n\ntype windowinitialData = IGeneric<IAny>;\n\ndeclare global {\n    // tslint:disable-next-line:interface-name\n    interface ClientWindow extends IMSDyn365Window {\n        ___initialData___: windowinitialData;\n        cache: RequestCache;\n    }\n}\n\ndeclare var window: ClientWindow;\n\naxios.interceptors.request.use(RSRequestInterceptor, RSRequestInterceptorErrorHandler);\naxios.interceptors.response.use(RSResponseInterceptor, RSResponseInterceptorErrorHandler);\n\nexport const getRequestContext = (storeData: windowinitialData): IRequestContext => {\n    const requestContext: IRequestContext = storeData.requestContext;\n\n    // See if cookie compliance is disabled at the site level\n    const disableCookieCompliance =\n        (requestContext.app && requestContext.app.platform && requestContext.app.platform.disableCookieCompliance) || false;\n    const cartSessionExpiration =\n        (requestContext.app && requestContext.app.platform && requestContext.app.platform.cartSessionExpiration) || 0;\n    const cookies = new CookieContext({\n        isConsentRequired: !disableCookieCompliance,\n        cartExpirationInDays: cartSessionExpiration,\n        sameSiteRequired: requestContext.sameSiteRequired\n    });\n    requestContext.cookies = cookies;\n    requestContext.sessionStorage = new SessionStorageContext(cookies);\n    requestContext.headers = Object.freeze({});\n    requestContext.url.requestUrl =\n        typeof requestContext.url.requestUrl === 'string' ? new URL(requestContext.url.requestUrl) : requestContext.url.requestUrl;\n    return requestContext;\n};\n\nconst getPathName = (requestContextUrl: IRequestContextUrl): string => {\n    if (requestContextUrl && requestContextUrl.requestUrl && requestContextUrl.requestUrl.pathname) {\n        return requestContextUrl.requestUrl.pathname;\n    }\n    return '';\n};\n\nconst isPaymentVerification = (requestContext: IRequestContext): boolean => {\n    return requestContext.query?.pv === '1';\n};\n\nconst isCheckoutRoute = (requestContext: IRequestContext): boolean => {\n    return (\n        requestContext.app &&\n        requestContext.app.routes &&\n        requestContext.app.routes.checkout &&\n        requestContext.app.routes.checkout.destinationUrl &&\n        getPathName(requestContext.url) === requestContext.app.routes.checkout.destinationUrl\n    );\n};\n\nconst activateExperiments = (requestContext: IRequestContext): void => {\n    // Activate experiment if an experimentation connector has been registered and active experiments are provided\n    // In a preview scenario, OneRF will not send a user ID and which we will not active the experiment\n    if (\n        msdyn365Commerce.experimentationConnector &&\n        requestContext.features.experimentation &&\n        requestContext.experiments &&\n        requestContext.experiments.userId &&\n        requestContext.experiments.activeExperiments &&\n        requestContext.experiments.activeExperiments.length > 0\n    ) {\n        const experimentInfo = requestContext.experiments;\n        // Split the experiment list into two lists, one whose experiments are coupled with a module and one whose experiments are not\n        const [experimentsWithoutModuleId, experimentsWithModuleId] = _partition(experimentInfo.activeExperiments, (value: IVariants) => {\n            return !value.moduleId;\n        });\n        // Activate experiments not tied to a module id\n        msdyn365Commerce.experimentationConnector.provider.activateExperiment(experimentInfo.userId, experimentsWithoutModuleId, {\n            Type: requestContext.device.Type\n        });\n\n        // Activate experiments once 30% of the module is visible\n        const options: IntersectionObserverInit = {\n            threshold: 0.3\n        };\n        const experimentMap: IDictionary<IVariants> = {};\n        const experimentObserver = new IntersectionObserver((entries: IntersectionObserverEntry[], observer: IntersectionObserver) => {\n            entries.forEach((entry: IntersectionObserverEntry) => {\n                if (entry.isIntersecting && entry.intersectionRatio >= 0.3) {\n                    const activatedExpId = entry.target.getAttribute(`data-exp`);\n                    if (activatedExpId) {\n                        // Find the experiment/variant combo associated with the experiment to activate\n                        msdyn365Commerce.experimentationConnector?.provider.activateExperiment(\n                            experimentInfo.userId,\n                            [experimentMap[activatedExpId]],\n                            {\n                                Type: requestContext.device.Type\n                            }\n                        );\n                    }\n                    // Once we the element has come into the view for the first time, we can stop observing it\n                    observer.unobserve(entry.target);\n                }\n            });\n            // tslint:disable-next-line: align\n        }, options);\n        for (let i = 0; i < experimentsWithModuleId.length; i++) {\n            const currentExperiment = experimentsWithModuleId[i];\n            const target = document.querySelector(`[data-exp=\"id:${currentExperiment.experimentId}\"]`);\n            if (target) {\n                experimentMap[`id:${currentExperiment.experimentId}`] = currentExperiment;\n                experimentObserver.observe(target);\n            }\n        }\n    }\n};\n\n/**\n * Checks if client side hydration should happen before loadData\n * @param requestContext Request context object\n */\nconst shouldOptimizeHydrate = (requestContext: IRequestContext) => {\n    const clientRenderOptimizationEnabled =\n        requestContext.app && requestContext.app.platform && !!requestContext.app.platform.enableClientRenderOptimization;\n    const clientRenderQsp = requestContext.query && requestContext.query.optimize_hydrate === 'true';\n    return clientRenderOptimizationEnabled || clientRenderQsp;\n};\n\n/**\n * Method to hydrate the markup returned by server on the client.\n * @param requestContext request context object\n * @param pageContext page context object\n * @param coreContext core context object\n */\nconst hydrateClient = (requestContext: IRequestContext, pageContext: PageContext, coreContext: ICoreContext) => {\n    const pageRoot = pageContext.pageRoot;\n    const body = pageRoot.modules && pageRoot.modules.body;\n    const props = body && body.length > 0 ? body[0] : pageRoot;\n\n    try {\n        ReactDOM.hydrate(\n            <CoreContext.Provider value={coreContext}>\n                <SafeRenderModule {...props} store={pageContext} root={true} />\n            </CoreContext.Provider>,\n            document.getElementById(LAYOUT_MOUNT_POINT)\n        );\n    } catch (err) {\n        // If in dev mode or debug mode, throw the error so it's visible on the page.\n        if ((process.env.NODE_ENV === 'development' || requestContext.params.isDebug) && !requestContext.params.isEditor) {\n            throw err;\n            // In editor mode, catch the error but don't throw so that the page doesn't freeze up\n        } else if (requestContext.params.isEditor) {\n            console.log(`Error running editor (client) render: ${err}`);\n        }\n    }\n};\n\n/**\n * Method to initialize authoring helper and register event to receive list of disabled properties when rendered in the context of site builder\n * @param requestContext request context object\n * @param pageContext page context object\n * @param coreContext core context object\n * @param actionContext action context object\n * @param moduleTelemetry module telemetry object\n */\nconst initAuthoringHelper = (\n    requestContext: IRequestContext,\n    pageContext: PageContext,\n    coreContext: ICoreContext,\n    actionContext: IActionContext,\n    moduleTelemetry\n) => {\n    const themeSettings: IPartnerThemeSettings = window.___initialData___.themeSettings ? window.___initialData___.themeSettings : {};\n\n    const authoringHelper = new AuthoringToolsHelper(actionContext, themeSettings, coreContext, pageContext, moduleTelemetry);\n    // @ts-ignore\n    window._msdyn365.authoringHelper = authoringHelper;\n\n    // @ts-ignore\n    document.addEventListener('_msdyn365_client_disabled_properties', (dpEvent: { detail: IDisabledProperties }) => {\n        if (dpEvent && dpEvent.detail && dpEvent.detail) {\n            Object.keys(dpEvent.detail.modules).map(key => {\n                authoringHelper.updateDisabledProperties(key, dpEvent.detail.modules[key]);\n            });\n        }\n    });\n};\n\n// tslint:disable:max-func-body-length\nexport function clientRender(): void {\n    const storeData = window.___initialData___;\n    if (!storeData || typeof storeData !== 'object') {\n        console.error(MESSAGE_CLIENT_RENDER_ERROR);\n        return;\n    }\n    const removePlaceholderModules = (modulesDictionary: { [slot: string]: IModuleContract[] }) => {\n        Object.keys(modulesDictionary || {}).forEach(slot => {\n            modulesDictionary[slot] = modulesDictionary[slot].filter(a => a.typeName !== 'place-holder-for-container-preview');\n            modulesDictionary[slot].forEach(module => module.modules && removePlaceholderModules(module.modules));\n        });\n    };\n    const requestContext = getRequestContext(storeData);\n    if (requestContext.params.isEditor) {\n        removePlaceholderModules(storeData.pageRoot.modules);\n    }\n\n    // if request is not POST or is not a checkout route or is not a payment verification, clear all checkout session storage data.\n    // TODO: Explore a way to move this logic to SSK\n    if (!requestContext.requestFormData || !isCheckoutRoute(requestContext) || !isPaymentVerification(requestContext)) {\n        requestContext.sessionStorage.removeCheckoutCartData();\n    }\n\n    // tslint:disable-next-line:no-any\n    const appCache = (msdyn365Commerce as any).getAppCache(requestContext);\n    const pageContext = new PageContext(storeData, requestContext, appCache);\n\n    // Get the 1DS instance from the browser client. Initialized as part of base-page\n    // tslint:disable-next-line:no-any no-string-literal\n    const oneDSWeb: any = window['oneDSWeb'];\n\n    // Get the registered experiment listener\n    const expListener = msdyn365Commerce.experimentationConnector?.listener;\n\n    // Set up internal SDK telemetry\n    const internalTelemetry = StaticTelemetry;\n    internalTelemetry.enableDataAnalytics(requestContext.features.enableDataAnalytics);\n    internalTelemetry.registerWebAnalyticsPlugin(oneDSWeb);\n    internalTelemetry.registerAttributeRenderer(expAttributeRenderer);\n    internalTelemetry.registerTraceLogger({ traceLogger: new AppInsightsJSLogger() });\n    internalTelemetry.setTelemetryRequestContext({\n        siteId: '[[Placeholder]]',\n        channelId: requestContext.channel?.RecordId ? requestContext.channel.RecordId.toString() : 'Unavailable',\n        pageType: requestContext.urlTokens.pageType,\n        pageId: pageContext.pageRoot.id\n    });\n\n    // Set up external module telemetry\n    const moduleTelemetry = new Telemetry();\n    moduleTelemetry.enableDataAnalytics(requestContext.features.enableDataAnalytics);\n    moduleTelemetry.registerWebAnalyticsPlugin(oneDSWeb);\n    moduleTelemetry.registerAttributeRenderer(expAttributeRenderer);\n\n    // If experimentaiton listener set up, add to event logging framework\n    if (expListener && requestContext.features.experimentation) {\n        internalTelemetry.registerExpLogger(expListener);\n\n        moduleTelemetry.registerExpLogger(expListener);\n    }\n\n    // If in debug mode, add console loggers\n    if (requestContext.params.isDebug) {\n        internalTelemetry.registerTraceLogger({ traceLogger: GenericConsoleLogger, options: { isDebug: requestContext.params.isDebug } });\n        moduleTelemetry.registerTraceLogger({ traceLogger: GenericConsoleLogger, options: { isDebug: requestContext.params.isDebug } });\n    }\n\n    pageContext\n        .putRequestedModulesInCacheOnClient(storeData, moduleTelemetry)\n        .catch(error => {\n            internalTelemetry.log(LogLevel.Error, EXCEPTION_CLIENT_CACHE_HYDRATE, { exception: error });\n        })\n        .finally(() => {\n            window._msdyn365 = {\n                requestContext: requestContext,\n                telemetry: internalTelemetry\n            };\n\n            const actionContext = new ActionContext({\n                id: 'Client Action Context',\n                requestContext: requestContext,\n                requestCache: pageContext.requestCache,\n                telemetry: moduleTelemetry,\n                appCache: null,\n                spawnChildOnExecute: true\n            });\n\n            if (requestContext.params.isDebug) {\n                // @ts-ignore\n                window._msdyn365.cache = pageContext.requestCache;\n            }\n            const coreContext: ICoreContext = {\n                actionContext: actionContext,\n                app: requestContext.app,\n                // @ts-ignore\n                internalTelemetry: internalTelemetry,\n                telemetry: moduleTelemetry,\n                request: requestContext,\n                cultureFormatter: new CultureInfoFormatter(requestContext.locale, getCurrencyCodeFromContext(requestContext))\n            };\n\n            const allModules = pageContext.allModules;\n\n            if (shouldOptimizeHydrate(requestContext)) {\n                hydrateClient(requestContext, pageContext, coreContext);\n            }\n\n            if (requestContext.params.isEditor) {\n                initAuthoringHelper(requestContext, pageContext, coreContext, actionContext, moduleTelemetry);\n            }\n\n            const correlationId = Telemetry.generateGuid();\n\n            // Fire event to let tooling know render starts. Tools on receiving this event, calls\n            // initialziation and passes the rendering helper class instance that can be used by SDK to\n            // get any information/context w.r.t tools\n            const event = new Event(CLIENT_RENDER_START_EVENT);\n            document.dispatchEvent(event);\n\n            internalTelemetry.trackEvent<IEventClientRenderProperties, {}>(EVENT_CLIENT_RENDER_START, {\n                id: correlationId\n            });\n            internalTelemetry.startTimer(correlationId);\n            internalTelemetry.trackEvent<IEventLoadDataRenderProperties, {}>(EVENT_LOAD_DATA_START, {\n                id: correlationId,\n                initiator: 'ClientRender'\n            });\n\n            let initialPromise: Promise<void> = Promise.resolve();\n            const LAZYLOAD_ALL_SWITCH: boolean = requestContext.features.lazyload_all;\n\n            initialPromise = initialPromise.then(async () => {\n                try {\n                    return processComplexDataTypes(LAZYLOAD_ALL_SWITCH, PROCESS_TYPE.client, pageContext.allModules, actionContext);\n                } catch (error) {\n                    internalTelemetry.log(LogLevel.Error, EXCEPTION_PRODUCT_LIST_CLIENTSIDE_HYDRATION, { exception: error });\n                }\n            });\n\n            initialPromise.finally(() => {\n                // tslint:disable-next-line:no-floating-promises -- we don't care about awaiting here on purpose\n                loadData(allModules, requestContext, internalTelemetry, moduleTelemetry, pageContext.requestCache, null)\n                    .then(() => {\n                        internalTelemetry.trackEvent<IEventClientRenderProperties, IEventClientRenderMetrics>(\n                            EVENT_CLIENT_RENDER_STOP,\n                            {\n                                id: correlationId\n                            },\n                            {\n                                success: 1,\n                                time: internalTelemetry.stopTimer(correlationId)\n                            }\n                        );\n                    })\n                    .catch(error => {\n                        internalTelemetry.trackEvent<IEventClientRenderProperties, IEventClientRenderMetrics>(\n                            EVENT_CLIENT_RENDER_STOP,\n                            {\n                                id: correlationId\n                            },\n                            {\n                                success: 0,\n                                time: internalTelemetry.stopTimer(correlationId)\n                            }\n                        );\n                        internalTelemetry.log(LogLevel.Error, EXCEPTION_LOAD_DATA_EXCEPTION, { exception: error });\n                    })\n                    .finally(() => {\n                        // Gets a reference to the same Telemetry, so that we can route existing log calls to new back-end without changing front-end API\n\n                        if (!shouldOptimizeHydrate(requestContext)) {\n                            hydrateClient(requestContext, pageContext, coreContext);\n                        }\n\n                        // Add the page view exp event id to the page level div\n                        const pageName = requestContext.telemetryPageName || requestContext.url.requestUrl.pathname;\n                        document.getElementById(LAYOUT_MOUNT_POINT)?.setAttribute('data-exp-event-id', `${pageName}.PageView`);\n                        // Activate any active experiments on the page\n                        activateExperiments(requestContext);\n\n                        // TODO (matt, 6/15/20): Manually firing page view event, undo once 1DS forwarding to framework implemented\n                        internalTelemetry.logEvent(TelemetryEvent.PageView, {\n                            title: requestContext.telemetryPageName || requestContext.url.requestUrl.pathname\n                        });\n\n                        // Fire event to let tooling know render is complete\n                        const deprecatedEvent = new Event(DEPRECATED_CLIENT_RENDER_COMPLETE_EVENT);\n                        document.dispatchEvent(deprecatedEvent);\n\n                        document.dispatchEvent(new Event(CLIENT_RENDER_COMPLETE_EVENT));\n                    });\n            });\n        });\n}\n"]}