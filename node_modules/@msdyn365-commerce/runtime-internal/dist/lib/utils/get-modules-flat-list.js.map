{"version":3,"file":"get-modules-flat-list.js","sourceRoot":"","sources":["../../../src/utils/get-modules-flat-list.ts"],"names":[],"mappings":"AAAA;;;GAGG;AAQH,SAAS,0BAA0B,CAAC,IAAqB,EAAE,UAAmB;IAC1E,IAAI,CAAC,IAAI,EAAE;QACP,OAAO,EAAE,CAAC;KACb;IAED,IAAI,OAAO,GAAsB,CAAC,IAAI,CAAC,CAAC;IACxC,IAAI,CAAC,OAAO;QACR,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,OAA0B,EAAE,EAAE;YAC/D,IAAI,OAAO,EAAE;gBACT,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;oBAChB,IAAI,UAAU,EAAE;wBACZ,CAAC,CAAC,EAAE,GAAG,GAAG,UAAU,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC;qBACnC;oBACD,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,0BAA0B,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC;gBACxE,CAAC,CAAC,CAAC;aACN;QACL,CAAC,CAAC,CAAC;IACP,OAAO,OAAO,CAAC;AACnB,CAAC;AAED,MAAM,UAAU,oCAAoC,CAAC,QAAyB,EAAE,UAAkB;IAC9F,IAAI,CAAC,QAAQ,EAAE;QACX,OAAO,EAAE,CAAC;KACb;IACD,OAAO,0BAA0B,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;AAC5D,CAAC;AAED,MAAM,UAAU,yBAAyB,CAAC,YAA2B;IACjE,IAAI,CAAC,YAAY,EAAE;QACf,OAAO,EAAE,CAAC;KACb;IACD,MAAM,QAAQ,GAA6B,YAAY,CAAC;IACxD,MAAM,SAAS,GAAG,QAAQ,CAAC,KAAK,CAAC;IACjC,IAAI,SAAS,EAAE;QACX,OAAO,SAAS,CAAC;KACpB;IAED,MAAM,iBAAiB,GAAG,QAAQ,CAAC,OAAO,IAAI,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;IAC9E,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,MAAM,EAAE;QAC/C,OAAO,iBAAiB,CAAC,GAAG,CAAC,CAAC,CAAkB,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;KAC3D;SAAM;QACH,OAAO,0BAA0B,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;KAC5D;AACL,CAAC","sourcesContent":["/*!\n * Copyright (c) Microsoft Corporation.\n * All rights reserved. See LICENSE in the project root for license information.\n */\n\nimport { IDictionary, IModuleContract, IPageResponse } from '@msdyn365-commerce/core-internal';\n\ninterface IPageResponseWithModules extends IPageResponse {\n    modules: IDictionary<IModuleContract>;\n}\n\nfunction getFlattenedListOfChildren(slot: IModuleContract, fragmentId?: string): IModuleContract[] {\n    if (!slot) {\n        return [];\n    }\n\n    let slotArr: IModuleContract[] = [slot];\n    slot.modules &&\n        Object.values(slot.modules).forEach((current: IModuleContract[]) => {\n            if (current) {\n                current.forEach(m => {\n                    if (fragmentId) {\n                        m.id = `${fragmentId}__${m.id}`;\n                    }\n                    slotArr = slotArr.concat(getFlattenedListOfChildren(m, fragmentId));\n                });\n            }\n        });\n    return slotArr;\n}\n\nexport function getFlattenedListOfModulesForFragment(fragment: IModuleContract, fragmentId: string): IModuleContract[] {\n    if (!fragment) {\n        return [];\n    }\n    return getFlattenedListOfChildren(fragment, fragmentId);\n}\n\nexport function getFlattenedListOfModules(pageResponse: IPageResponse): IModuleContract[] {\n    if (!pageResponse) {\n        return [];\n    }\n    const response = <IPageResponseWithModules>pageResponse;\n    const propValue = response.slots;\n    if (propValue) {\n        return propValue;\n    }\n\n    const modulesFromLegacy = response.modules && Object.values(response.modules);\n    if (modulesFromLegacy && modulesFromLegacy.length) {\n        return modulesFromLegacy.map((m: IModuleContract) => m);\n    } else {\n        return getFlattenedListOfChildren(pageResponse.pageRoot);\n    }\n}\n"]}