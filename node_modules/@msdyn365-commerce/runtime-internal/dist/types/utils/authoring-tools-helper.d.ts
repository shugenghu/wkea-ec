import { IActionContext, IAddModuleSlot, IConfigError, ICoreContext, IModuleContract, IPartnerThemeSettings, IRenderingHelper } from '@msdyn365-commerce/core-internal';
import { IDictionary } from '@msdyn365-commerce/retail-proxy';
import { Telemetry } from '@msdyn365-commerce/telemetry-internal';
import { IProductListMetaData } from '../hydrators/hydrator-action-inputs';
import { PageContext } from '../store/page-context';
import { IImageData, IVideoData } from './authoring-tools-helper-utils';
interface IModuleContent {
    data?: unknown;
    config?: unknown;
    friendlyName: string;
    configErrors?: IConfigError[];
}
interface IExpEventName {
    eventIdName: string;
    eventIdHash: string;
}
/**
 * Provides the CMS tooling a way to update the CMS content
 */
export declare class AuthoringToolsHelper {
    renderingHelper: IRenderingHelper | undefined;
    private cache;
    private readonly actionContext;
    private readonly themeSettings;
    private coreContext;
    private pageContext;
    private moduleTelemetry;
    private didFindModule;
    private foundModule;
    private enableAuthoringRemoveAndAddModule;
    constructor(actionContext: IActionContext, themeSettings: IPartnerThemeSettings, coreContext: ICoreContext, pageContext: PageContext, moduleTelemetry: Telemetry);
    initRenderingHelper(renderingHelper: IRenderingHelper): void;
    /**
     * usage:
     * window._msdyn365.authoringHelper.updateModule(
     *  "HELLO-WORLD__0",
     *  {
     *     "data": {
     *          "myTitle": {"$type":"heading","_id":"xekqxgmtadc", "text":"Hello World Heading"},
     *          "myText": {"$type":"simpleText","_id":"hkd849ztr3x", "text":"Hello............"}
     *      },
     *     "config": {
     *          showText: "test 123"
     *     },
     *     "configErrors": []
     * })
     */
    updateModule(moduleId: string, content: IModuleContent): boolean;
    /**
     * usage:
     * window._msdyn365.authoringHelper.updateModuleConfig(
     *  "HELLO-WORLD__0",
     *  {
     *          showText: "test 123"
     * })
     */
    updateModuleConfig(moduleId: string, config: unknown, configErrors: IConfigError[]): boolean;
    updateModuleClassName(moduleId: string, propertyName: string, oldValue: string, newValue: string, configErrors: IConfigError[]): boolean;
    /**
     * usage:
     * window._msdyn365.authoringHelper.updateModuleConfigErrors(
     *  "HELLO-WORLD__0",
     *  [{
     *          message: "heading_text is not configured",
     *          property: "heading_text"
     *  }])
     */
    updateModuleConfigErrors(moduleId: string, configErrors: IConfigError[]): boolean;
    /**
     * usage:
     * window._msdyn365.authoringHelper.updateModuleImage(
     *  "HELLO-WORLD__0",
     *  "['images', '0', 'primaryImage'"],
     *   {
     *       "source": "https://image-url-here",
     *       "altText": "alt-text",
     *       "$type": "image",
     *       "imageQuality": 80
     *       "title": "image title"
     *  }, []);
     */
    updateModuleImage(moduleId: string, pathToField: string[], imageData: IImageData, configErrors?: IConfigError[]): boolean;
    /**
     * usage:
     * window._msdyn365.authoringHelper.updateModuleVideo(
     *  "HELLO-WORLD__0",
     *  "['videos', '0', 'primaryVideo'"],
     *   {
     *       binaryReferences: [
     *           {
     *           $type: 'videoBinaryReference',
     *           alias: '1001',
     *           contentType: 'video/mp4',
     *           extension: '.mp4',
     *           sourceHref: 'https://streaming-west-prod.cms.commerce.dynamics.com/0c38a35a-159e-4603-9ad6-82b721f07274/1dc55c98-7d32-4ab8-9be9-5da298b4ce81.mp4',
     *           format: '1001',
     *           clientHref: 'https://streaming-west-prod.cms.commerce.dynamics.com/0c38a35a-159e-4603-9ad6-82b721f07274/1dc55c98-7d32-4ab8-9be9-5da298b4ce81.mp4'
     *           },
     *       title: 'Homepage video',
     *       fileName: '7e181ddf-1d45-497c-ba99-d17af574_650.mp4',
     *       playtime: 13,
     *       thumbnail: {
     *           $type: 'image',
     *           source: 'https://cms-ppe-imageresizer-mr.trafficmanager.net/cms/api/phpjqgrmtp/imageFileData/MAkOl',
     *           title: 'Homepage video Thumbnail',
     *           imageQuality: 70,
     *       },
     *       interactiveTriggersEnabled: false
     *       }, []);
     */
    updateModuleVideo(moduleId: string, pathToField: string[], videoData: IVideoData, configErrors?: IConfigError[]): boolean;
    /**
     * usage:
     * window._msdyn365.authoringHelper.updateModuleProductCollection(
     *  "HELLO-WORLD__0",
     *  "['productCollection', 'products'"],
     *   {
     *       "listType": "recommendation",
     *       "recommendationListId": "fbt"
     *  });
     */
    updateModuleProductCollection(moduleId: string, pathToField: string[], listMetadata: IProductListMetaData, configErrors?: IConfigError[]): Promise<boolean>;
    /**
     * usage:
     * window._msdyn365.authoringHelper.removeModule("HELLO-WORLD__0", []);
     * window._msdyn365.authoringHelper.removeModule("DEFAULT-CONTAINER__0", ["HERO__0", "HERO__1"]);
     */
    removeModule(moduleId: string, childrenIds: string[], removeFromPageFragment?: boolean): boolean;
    /**
     * usage:
     * window._msdyn365.authoringHelper.moveModule("HELLO-WORLD__0", "DEFAULT-CONTAINER__0", 0);
     *
     * If slot name is not provided the module will be moved within its current slot and cannot be moved to a new parent
     */
    moveModule(moduleId: string, parentId: string, newIndex: number, moduleSlotName?: string, moveFromPageFragment?: boolean): boolean;
    /**
     * Helper function used to sync the placeholder between rendering and tools in drag/drop scenarios
     * @param parentId module id where the module/container needs to be dropped
     * @param index index position for the module drop
     * @param slotId slot id where the module/container needs to be dropped
     */
    onDrag(parentId: string, index: number, slotId: string, moduleId?: string): void;
    /**
     * Helper function used to set modules as draggable in drag/drop scenarios.
     * @param sourceModuleId The module to be set as draggable.
     */
    setDraggable(sourceModuleId: string): void;
    /**
     * Helper function used to remove the placeholder between rendering and tools in drag/drop scenarios
     */
    removePlaceholder(): void;
    /**
     * usage: _msdyn365.authoringHelper.addModule('hero', 'hero__2', 'primaryArea__0', {config:{moduleConfig: 'config value'}});
     */
    addModule(moduleType: string, moduleId: string, parentId: string, content: IModuleContent, moduleSlotName?: string, addIndex?: number, addFromPageFragment?: boolean, imagePaths?: string[][]): Promise<boolean>;
    addFragment(fragmentId: string, parentId: string, pageFragment: IModuleContract, moduleSlotName?: string, addIndex?: number, addFromPageFragment?: boolean): Promise<boolean>;
    /**
     * usage:
     * window._msdyn365.authoringHelper.updateModuleData(
     *  "HELLO-WORLD__0",
     *  {
     *      "myTitle": {"$type":"heading","_id":"xekqxgmtadc", "text":"Hello World Heading"},
     *      "myText": {"$type":"simpleText","_id":"hkd849ztr3x", "text":"Hello............"}
     *  })
     */
    updateModuleData(moduleId: string, data: unknown): boolean;
    updateDisabledProperties(moduleName: string, disabledProperties: string[], isFragment?: boolean): void;
    /**
     * Helper function used to update the slots available in a container to add modules
     * @param moduleId module id thats being updated
     * @param addSlots lists of slots in the module where modules can be added
     */
    updateAddModuleProperties(moduleId: string, addSlots: IAddModuleSlot[]): void;
    getDisabledProperties(moduleName: string): string[];
    /**
     * usage:
     * window._msdyn365.authoringHelper.getModuleConfig("HELLO-WORLD__0");
     */
    getModuleConfig(moduleId: string): unknown;
    /**
     * usage:
     * window._msdyn365.authoringHelper.getModuleConfigErrors("HELLO-WORLD__0");
     */
    getModuleConfigErrors(moduleId: string): IConfigError[] | null;
    /**
     * usage:
     * window._msdyn365.authoringHelper.getModuleData("HELLO-WORLD__0");
     */
    getModuleData(moduleId: string): unknown;
    /**
     * This function is deprecated please use the updated function
     * getExperimentEventHashesForModule
     * @deprecated
     * @param moduleId
     */
    getExperimentEventIdsForModule(moduleId: string): IDictionary<string[]>;
    /**
     * Returns mapping of moduleId to an array of objects containing exp event name (
     * and the SHA-256 hash of its friendly name (used for the actual track event calls)
     * @param moduleId
     */
    getExperimentEventHashesForModule(moduleId: string): IDictionary<IExpEventName[]>;
    private _checkForFeatureFlagAndGetPageRoot;
    private _getPageRoot;
    /**
     * Renders the page again with the updated page structure
     */
    private _renderPage;
    private _findModule;
    private _findModuleHelper;
    private _processAddModule;
    private _addModuleFragment;
    private _setImageSettingsForDefaultImage;
}
export {};
