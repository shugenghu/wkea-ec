/*!
 * Copyright (c) Microsoft Corporation.
 * All rights reserved. See LICENSE in the project root for license information.
 */
import { ChannelConfiguration } from '@msdyn365-commerce/retail-proxy';
import { IActiveExperiments, ICommerceApiSettings, IGeoLocation, IGridSettings, ITelemetrySettings, IUrlTokens } from '../../contract';
import { IAny, IDictionary, IGeneric } from '../types';
import { ICookieContext } from './ICookieContext';
import { ISessionStorageContext } from './ISessionStorageContext';
export interface IParsedQSP<TValue> {
    hasValue: boolean;
    isTruthy: boolean;
    value: TValue | undefined;
}
export interface IRequestContextUrl {
    requestUrl: URL;
    staticCdnUrl: string;
}
export interface IRequestContextParams {
    mock?: string;
    isDebug: boolean;
    isEditor: boolean;
    isPreview: boolean;
    concatJs: IParsedQSP<boolean | string | number | undefined>;
    theme: string;
}
export interface IConnectorParams {
    expConnector?: string;
    geoLookupConnector?: string;
}
export interface IRequestContextDevice {
    Type: string;
}
export interface IRequestContextUser {
    token: string;
    isAuthenticated: boolean;
    signInUrl?: string;
    signOutUrl?: string;
    signUpUrl?: string;
    editProfileUrl?: string;
    signinName?: string;
    name?: string;
    firstName?: string;
    lastName?: string;
    emailAddress?: string;
    customerAccountNumber?: string;
    optOutWebActivityTracking: boolean;
    userClaims?: IDictionary<string>;
}
export interface IRequestContextFeatures {
    [switchName: string]: boolean;
}
export interface IRequestContextHeaders {
    readonly [header: string]: string;
}
/**
 * Any change to this interface should result an accompanying change to the
 * Fast JSON stringify constructor for request context in base-page-utils.ts
 */
export interface IRequestContext {
    url: IRequestContextUrl;
    locale: string;
    canonicalUrl?: string;
    canonicalDomain?: string;
    market?: string;
    textDirection: string;
    sitePath?: string;
    params: IRequestContextParams;
    device: IRequestContextDevice;
    user: IRequestContextUser;
    app: IGeneric<IAny>;
    query?: IDictionary<string>;
    apiSettings: ICommerceApiSettings;
    channel?: ChannelConfiguration;
    gridSettings?: IGridSettings;
    siteStylePreset?: string;
    pageStylePreset?: string;
    urlTokens: IUrlTokens;
    operationId: string;
    features: IRequestContextFeatures;
    pageData: IGeneric<IAny>;
    headers: IRequestContextHeaders;
    cookies: ICookieContext;
    sessionStorage: ISessionStorageContext;
    themeOverride: {
        url: string;
        disableDefault: boolean;
    };
    sameSiteRequired?: boolean;
    telemetrySettings: ITelemetrySettings;
    telemetryData: IDictionary<IAny>;
    requestFormData?: IDictionary<string>;
    connectors?: IConnectorParams;
    experiments?: IActiveExperiments;
    telemetryPageName?: string;
    clientIPAddress?: string;
    geoLocation?: IGeoLocation;
}
