{"version":3,"file":"AgeGate.js","sourceRoot":"./src/","sources":["videoplayer/components/age-gate/AgeGate.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { PlayerConstants, VideoPlayerNames } from '../data/player-constants';\nimport {IAgeGateProps} from './AgeGate.props';\n\n/**\n *\n * AgeGate React component for video player\n *\n */\nexport interface IDropdownState {\n    monthValue: string;\n    dayValue: string;\n    yearValue: string;\n}\n// tslint:disable-next-line:completed-docs\nexport default class AgeGate extends React.PureComponent<IAgeGateProps, IDropdownState> {\n    public static defaultProps: Partial<IAgeGateProps> = {\n        minmumAge: 18\n    };\n\n    private ageGateDiv: React.RefObject<HTMLDivElement> = React.createRef<HTMLDivElement>();\n\n    constructor(props: IAgeGateProps) {\n        super(props);\n        this._filterDateMonthYear = this._filterDateMonthYear.bind(this);\n        this.state = {\n            monthValue: 'Month',\n            dayValue: 'Day',\n            yearValue: 'Year'\n        };\n    }\n\n    public render():JSX.Element {\n        const enabled = PlayerConstants.regxForAgeGateInputValidation.test(this.state.dayValue) &&\n        PlayerConstants.regxForAgeGateInputValidation.test(this.state.monthValue) &&\n        PlayerConstants.regxForAgeGateInputValidation.test(this.state.yearValue);\n        return(\n            <div className={`${VideoPlayerNames.videoplayerContainer}__agegate__container`} ref={this.ageGateDiv} aria-hidden={this.props['aria-hidden']}>\n                <div>\n                    <div>\n                        <h3>Enter your date of birth</h3>\n                        <fieldset>\n                            <div>\n                                {this.renderSelectMonth()}\n                            </div>\n                            <div>\n                                {this.renderSelectDay()}\n                            </div>\n                            <div>\n                                {this.renderSelectYear()}\n                            </div>\n                            <button disabled={!enabled} onClick={this.props.onSubmitClick}>Submit</button>\n                        </fieldset>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    public getCalculatedAge = () => {\n        const day: number = Number(this.state.dayValue);\n        const month: number = Number(this.state.monthValue);\n        const year: number = Number(this.state.yearValue);\n        const today: Date = new Date();\n        let age = today.getFullYear() - year;\n        const birthdayMonthHasNotHappenedYet: boolean = today.getMonth() + 1 < month;\n        const birthdayDayHasNotHappenedYet: boolean = (today.getMonth() + 1 === month && today.getDate() < day);\n        if (birthdayMonthHasNotHappenedYet || birthdayDayHasNotHappenedYet) {\n            // user has not reached their birth month and/or birth day-of-month in the current year\n            age--;\n        }\n        const minimmumage = Number(this.props.minmumAge);\n        if(age >= minimmumage) {\n           return true;\n        } else {\n            return false;\n        }\n    };\n    // tslint:disable-next-line:no-any\n    private _filterDateMonthYear(e: any): void {\n        if(e.target.id === 'selectDay') {\n            return this.setState({dayValue: e.target.value});\n        } else if (e.target.id === 'selectMonth') {\n            return this.setState({monthValue: e.target.value});\n        } else if(e.target.id === 'selectYear') {\n            return this.setState({yearValue: e.target.value});\n        }\n    }\n\n    private renderSelectMonth = (): JSX.Element => {\n        const  maxOffset = 12;\n        const allMonth = [];\n        for(let month = 1; month <= maxOffset; month++) {\n            allMonth.push(month);\n        }\n        const monthList = allMonth.map((month) => { return(<option role={'menuitem'} key={month} value={month}>{month.toFixed()}</option>);});\n        return(\n            <select aria-expanded='false' className={`${VideoPlayerNames.videoplayerContainer}__agegate__select`} role={'menu'} onChange={this._filterDateMonthYear} value={this.state.monthValue} aria-label={'Enter your month of birth'} name='selectMonth' id='selectMonth'>\n                <option role={'menuitem'}>Month</option>\n                {monthList}\n            </select>\n        );\n    }\n    private renderSelectDay = (): JSX.Element => {\n        const  maxOffset = 31;\n        const allDay = [];\n        for(let day = 1; day <= maxOffset; day++) {\n            allDay.push(day);\n        }\n        const dayList = allDay.map((day) => {return(<option role={'menuitem'} key={day}>{day.toFixed()}</option>);});\n        return(\n            <select\n                    aria-expanded='false'\n                    className={`${VideoPlayerNames.videoplayerContainer}__agegate__select`}\n                    role={'menu'}\n                    onChange={this._filterDateMonthYear}\n                    value={this.state.dayValue}\n                    aria-label={'Enter your day of birth'}\n                    name='selectDay'\n                    id='selectDay'\n            >\n                <option role={'menuitem'}>Day</option>\n                {dayList}\n            </select>\n        );\n    }\n    private renderSelectYear = (): JSX.Element => {\n        const  maxOffset = 100;\n        const thisYear = (new Date()).getFullYear();\n        const allYear = [];\n        for(let year = 1; year <= maxOffset; year++) {\n            allYear.push(thisYear - year);\n        }\n        const yearList = allYear.map((year) => {return(<option role={'menuitem'} key={year}>{year.toFixed()}</option>);});\n        return(\n            <select aria-expanded='false' className={`${VideoPlayerNames.videoplayerContainer}__agegate__select`} role={'menu'} onChange={this._filterDateMonthYear} value={this.state.yearValue} aria-label={'Enter your year of birth'} name='selectYear' id='selectYear'>\n                <option role={'menuitem'}>Year</option>\n                {yearList}\n            </select>\n        );\n    }\n}"]}