/*******************************************************************************
* Copyright (c) Microsoft Corporation.
* All rights reserved. See LICENSE in the project root for license information.
*******************************************************************************/


const cp = require('child_process');
const path = require('path');

function main() {
    try {
        const jestPath = path.resolve(require.resolve('jest'), '../../bin/jest.js');
        const jestArgs = process.argv.slice(3);
        const jestDebugCommand = `node --inspect-brk ${jestPath} --runInBand --collectCoverage=false ${jestArgs}`;
        console.log(jestDebugCommand);
        const proc = cp.spawnSync(jestDebugCommand, { cwd: process.cwd(), stdio: 'inherit', shell: true });
        process.exit(proc);
    } catch (e) {
        console.error(`Could not resolve jest, please find your jest installation and run with the following command:`);
        console.error(
            `\n\tnode --inspect-brk [PATH_TO_JEST]/jest.js --runInBand --collectCoverage=false\n\nwhere [PATH_TO_JEST] should be replaced with full or relative path to jest`
        );
    }
}

main();
