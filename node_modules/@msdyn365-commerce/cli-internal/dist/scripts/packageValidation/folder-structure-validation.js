"use strict";
/*!
 * Copyright (c) Microsoft Corporation.
 * All rights reserved. See LICENSE in the project root for license information.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const utilities_internal_1 = require("@msdyn365-commerce/utilities-internal");
const path = require("path");
const validation_helpers_1 = require("../validation-helpers");
/**
 * Validates the existence of src folder in the package and that src contains valid directories
 *
 * @param options A registration object that contains the path of the package that will be validated
 */
// tslint:disable-next-line:no-any
module.exports = (options) => {
    const packagePath = options.path;
    const status = validation_helpers_1.generateStatusJson();
    const srcOptions = ['modules', 'actions', 'telemetry', 'themes'];
    // CHECK FOLDER STRUCUTRE
    const srcPath = path.join(packagePath, `src`);
    if (!validation_helpers_1.checkFileExists(srcPath, 'No src path found. Expected it here: ')) {
        return validation_helpers_1.markFailure(status);
    }
    let containsValidSrcOptions = false;
    utilities_internal_1.getDirectories(srcPath).forEach((name) => {
        if (srcOptions.indexOf(name) !== -1) {
            containsValidSrcOptions = true;
        }
    });
    if (!containsValidSrcOptions) {
        return validation_helpers_1.markFailure(status);
    }
    return status;
};
