import { createObservableDataAction, sendRequest } from '@msdyn365-commerce/core';
async function submitReview(input, ctx) {
    if (!inputIsValid(input)) {
        ctx.trace(`[SubmitUserReview] Failed to submit reviews for product due to bad input ${input}`);
        return '';
    }
    const requestUrl = `${input.serviceEndpoint}/v2.0/reviews/product/${input.productId}/user?` +
        `tenantId=${input.tenantId}&` +
        `channelId=${input.channelId}&` +
        `locale=${input.locale}`;
    return sendRequest(requestUrl, 'post', input.userReviewData, { headers: { Authorization: `id_token ${input.authorization}` } }).then((response) => {
        if (response.status !== 200 && response.status !== 201) {
            ctx.trace(`[SubmitUserReview] Failed to submit reviews for product`);
            ctx.trace(response.data);
            return '';
        }
        return response.data;
    }).catch((error) => {
        ctx.trace(`[SubmitUserReview] Failed to submit reviews for product`);
        ctx.telemetry.exception(error);
        ctx.telemetry.debug(`[SubmitUserReview] Failed to submit reviews for product`);
        ctx.trace(error);
        return '';
    });
}
function inputIsValid(input) {
    return input && !!input.productId && !!input.tenantId;
}
export const submitReviewDataAction = createObservableDataAction({
    id: '@msdyn365-commerce-modules/ratings-reviews/submit-user-review',
    action: submitReview
});
export default submitReviewDataAction;
//# sourceMappingURL=submit-user-review.js.map