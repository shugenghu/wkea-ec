{"version":3,"file":"review-modal.js","sourceRoot":"./src/","sources":["common/review-modal.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport { getRnrAuthEndpointId, getRnrPartnerId } from '@msdyn365-commerce-modules/retail-actions';\nimport {\n    Alert, Button, getPayloadObject, getTelemetryAttributes, INodeProps, ITelemetryContent, Modal, ModalBody, ModalFooter, ModalHeader, TelemetryConstant\n} from '@msdyn365-commerce-modules/utilities';\nimport { Review } from '@msdyn365-commerce/commerce-entities';\nimport { RatingComponent } from '@msdyn365-commerce/components';\nimport { getUrlSync, IAny, ICoreContext, IGeneric } from '@msdyn365-commerce/core';\nimport { SimpleProduct } from '@msdyn365-commerce/retail-proxy';\n\nimport { GetUserReviewInput } from '../actions/inputs/get-user-review-input';\nimport { SubmitUserReviewInput } from '../actions/inputs/submit-user-review-input';\nimport submitUserReview from '../actions/submit-user-review';\n\nexport interface IReviewModalProps {\n    userReview?: Review;\n    product?: SimpleProduct;\n    renderContextId: string;\n    resources: IReviewModalResources;\n    context:  ICoreContext<IGeneric<IAny>>;\n    parentId: string;\n    parentType: string;\n    isOpen: boolean;\n    rating: number;\n    reviewTitle: string;\n    reviewText: string;\n    returnRef: React.RefObject<HTMLButtonElement> | undefined;\n    hasError: boolean;\n    telemetryContent?: ITelemetryContent;\n    onModalToggle():void;\n    onTitleChange(event: React.ChangeEvent<HTMLInputElement>):void;\n    onTextChange(event: React.ChangeEvent<HTMLTextAreaElement>):void;\n    onRatingChange(value: number):void;\n    onReviewComplete?(isSuccess: boolean):void;\n}\n\nexport interface IReviewModalResources {\n    selectRatingAriaLabel: string;\n    selectRatingLabel: string;\n    reviewTitleLabel: string;\n    reviewTextLabel: string;\n    privacyPolicyTitle: string;\n    privacyPolicyTextFormat: string;\n    writeReviewModalTitle: string;\n    editReviewModalTitle: string;\n    submitReviewButtonText: string;\n    discardReviewButtonText: string;\n    errorMessageText: string;\n}\n\nexport interface IReviewModalViewProps {\n    modal: INodeProps;\n    modalHeader: React.ReactElement;\n    modalFooter: INodeProps;\n    modalBody: INodeProps;\n    cancelButton: React.ReactElement;\n    submitButton: React.ReactElement;\n    rating: React.ReactElement;\n    ratingLabel: React.ReactElement;\n    titleInput: React.ReactElement;\n    titleLabel: React.ReactElement;\n    textInput: React.ReactElement;\n    textLabel: React.ReactElement;\n    privacyPolicyUrl: React.ReactElement;\n    form: INodeProps;\n    inputRow: INodeProps;\n    error: React.ReactElement;\n}\n\n/**\n * CartLineItems component\n */\n\nexport const ReviewModal = (props: IReviewModalProps):IReviewModalViewProps  => {\n    const onClickSubmit = () => {return onSubmit(props);};\n    const payLoad = getPayloadObject('click', props.telemetryContent!, TelemetryConstant.SubmitReview);\n    const submitButtonAttribute = getTelemetryAttributes(props.telemetryContent!, payLoad);\n    payLoad.contentAction.etext = TelemetryConstant.Cancel;\n    const cancelButtonAttribute = getTelemetryAttributes(props.telemetryContent!, payLoad);\n    return {\n        modal: {tag: Modal, className: 'ms-review-modal', toggle: props.onModalToggle, applicationNode: 'renderPage', isOpen: props.isOpen, returnFocusRef: props.returnRef},\n        modalHeader: modalHeaderNode(props),\n        modalFooter: {tag: ModalFooter, className: 'ms-review-modal-footer'},\n        modalBody: {tag: ModalBody, className: 'ms-review-modal-body'},\n        cancelButton: <Button className='ms-review-modal-cancel' onClick={props.onModalToggle} {...submitButtonAttribute} >{props.resources.discardReviewButtonText}</Button>,\n        submitButton: <Button className='ms-review-modal-submit' onClick={onClickSubmit} {...cancelButtonAttribute} disabled={submitDisabled(props)}>{props.resources.submitReviewButtonText}</Button>,\n        rating: ratingsInput(props),\n        ratingLabel: ratingsLabel(props),\n        titleInput: titleInput(props),\n        titleLabel: titleLabel(props),\n        textInput: textInput(props),\n        textLabel: textLabel(props),\n        privacyPolicyUrl: privacyPolicyLink(props),\n        form: {tag: 'form', className: 'ms-review-modal-form', autoComplete: 'off'},\n        inputRow: {tag: 'div', className: 'ms-review-modal-row', autoComplete: 'off'},\n        error: <Alert className='ms-review-modal-error' isOpen={props.hasError} color='danger'>{props.resources.errorMessageText}</Alert>\n    };\n};\n\nconst modalHeaderNode = (props: IReviewModalProps) => {\n    return (\n        <ModalHeader toggle={props.onModalToggle} className='ms-review-modal-header'>\n            { props.userReview && props.userReview.reviewId ? props.resources.editReviewModalTitle : props.resources.writeReviewModalTitle }\n        </ModalHeader>\n    );\n};\n\nconst submitDisabled = (props: IReviewModalProps) => {\n    return !props.rating || !stripWhiteSpacesFromString(props.reviewText) || !stripWhiteSpacesFromString(props.reviewTitle);\n};\n\nconst ratingsInput = (props: IReviewModalProps) => {\n    return (\n        <RatingComponent\n            readOnly={false}\n            avgRating={0}\n            ariaLabel={props.resources.selectRatingAriaLabel}\n            initialRating={props.rating}\n            context={props.context}\n            id={props.parentId}\n            typeName={props.parentType}\n            data={{}}\n            key='ratings'\n            onChange={props.onRatingChange}\n        />\n    );\n};\n\nconst ratingsLabel = (props: IReviewModalProps) => {\n    return <label className='ms-review-modal-rating-label' key='ratingsLabel'>{props.resources.selectRatingLabel}*</label>;\n};\n\nconst titleInput = (props: IReviewModalProps) => {\n    const maxLength = props.context.app.config.reviewTitleMaxLength;\n\n    return (\n        <input\n            maxLength={maxLength}\n            id={`reviewTitle-${props.renderContextId}`}\n            onChange={props.onTitleChange}\n            value={props.reviewTitle}\n            aria-required='true'\n            className='ms-review-modal-title'\n        />\n    );\n};\n\nconst titleLabel = (props: IReviewModalProps) => {\n    return <label className='ms-review-modal-title-label' htmlFor={`reviewTitle-${props.renderContextId}`}>{props.resources.reviewTitleLabel}</label>;\n};\n\nconst reviewTextWidth: number = 50;\n\nconst textInput = (props: IReviewModalProps) => {\n    const maxLength = props.context.app.config.reviewTextMaxLength;\n    return (\n        <textarea\n            maxLength={maxLength}\n            className='ms-review-modal-text'\n            id={`reviewTextArea-${props.renderContextId}`}\n            onChange={props.onTextChange}\n            rows={maxLength / reviewTextWidth}\n            value={props.reviewText}\n            aria-required='true'\n        />\n    );\n};\n\nconst textLabel = (props: IReviewModalProps) => {\n    return <label htmlFor={`reviewTextArea-${props.renderContextId}`} className='ms-review-modal-text-label'>{props.resources.reviewTextLabel}</label>;\n};\n\nconst privacyPolicyLink = (props: IReviewModalProps) => {\n    const policyTextBlocks = props.resources.privacyPolicyTextFormat.split('{0}');\n    const isSeparatorAtStart = props.resources.privacyPolicyTextFormat.startsWith('{0}');\n    const isSeparatorAtEnd = props.resources.privacyPolicyTextFormat.endsWith('{0}');\n    const privacyPolicyUrl = getUrlSync('rnrPrivacyPolicy', props.context.actionContext);\n    const payLoad = getPayloadObject('click', props.telemetryContent!, TelemetryConstant.PrivacyPolicy);\n    const privacyPolicyAttribute = getTelemetryAttributes(props.telemetryContent!, payLoad);\n\n    return (\n        <p className='ms-review-modal-policy'>\n            {isSeparatorAtStart ? '' : policyTextBlocks[0]}\n            <a href={privacyPolicyUrl} target='_blank' className='msc-link' {...privacyPolicyAttribute}>{props.resources.privacyPolicyTitle}</a>\n            {isSeparatorAtEnd ? '' : isSeparatorAtStart ? policyTextBlocks[0] : policyTextBlocks[1] }\n        </p>\n    );\n};\n\nconst onSubmit = (props: IReviewModalProps): void => {\n    if (props.product) {\n        submitReview(props.product, props.reviewTitle, props.reviewText, props.rating, props.context, props.userReview, props.onReviewComplete);\n    }\n};\n\n/**\n * This method strips content of extra white spaces\n * @param text The text to be stripped of extra white spaces\n */\nconst stripWhiteSpacesFromString = (text: string): string => {\n    return text\n        .replace(new RegExp('\\\\r?\\\\n|\\\\r+', 'g'), ' ')\n        .replace(new RegExp('\\\\s+', 'g'), ' ')\n        .trim();\n};\n\nexport const submitReview = (product: SimpleProduct, title: string, text: string, rating: number, context: ICoreContext, userReview?: Review, onReviewSubmission?: (isSuccessful: boolean) => void) => {\n    const { request } = context;\n    const { user } = request;\n    if (user && request) {\n        const input = new SubmitUserReviewInput(\n            product.RecordId.toString(),\n            getRnrPartnerId(context.actionContext),\n            request.apiSettings.channelId.toString(),\n            request.locale,\n            {\n                productName: product && product.Name,\n                rating: rating,\n                reviewText: stripWhiteSpacesFromString(text),\n                title: stripWhiteSpacesFromString(title),\n                userEmail: user.emailAddress,\n                userName: user.name\n            },\n            request.user.token,\n            getRnrAuthEndpointId(context.actionContext)\n        );\n\n        submitUserReview(input, context.actionContext).then(reviewId => {\n            const review = !!reviewId ? {\n                rating: rating,\n                title: stripWhiteSpacesFromString(title),\n                reviewText: stripWhiteSpacesFromString(text),\n                submittedDateTime: new Date(),\n                helpfulPositive: userReview ? userReview.helpfulPositive : 0,\n                helpfulNegative: userReview ? userReview.helpfulNegative : 0,\n                reviewId: reviewId,\n                userName: request.user.firstName || request.user.name\n            } : userReview;\n\n            const getReviewInput = new GetUserReviewInput(input.productId!, input.tenantId, input.authorization, input.serviceEndpoint);\n            context.actionContext.update(getReviewInput, review);\n\n            if (onReviewSubmission) {\n                onReviewSubmission(!!reviewId);\n            }\n        }).catch(() => {\n            const productId = product.RecordId;\n            context.telemetry.error(`Failed to submit review for product with recordId: ${productId}`);\n            context.telemetry.debug(`Failed to submit review for product with recordId: ${productId}`);\n            if (onReviewSubmission) {\n                onReviewSubmission(false);\n            }\n        });\n    }\n};"]}