{"version":3,"file":"tab.js","sourceRoot":"./src/","sources":["modules/tab/tab.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { IModuleProps, INodeProps, NodeTag } from '@msdyn365-commerce-modules/utilities';\nimport * as MsDyn365 from '@msdyn365-commerce/core';\nimport classnames from 'classnames';\nimport { observer } from 'mobx-react';\nimport * as React from 'react';\nimport { createTabStateInput } from '../../data-actions/tab-state-data-action';\nimport { getContentID, TabItemType } from '../tab-item/tab-item';\nimport { ITabData } from './tab.data';\nimport { ITabProps } from './tab.props.autogenerated';\n\n/**\n *\n * Tab component\n * @extends {React.PureComponent<ITabProps<ITabData>>}\n */\n\nexport interface ICallToActionProps {\n  link: INodeProps[];\n}\n\nexport interface ITabViewProps extends ITabProps<{}> {\n  heading?: React.ReactNode;\n  TabContainer: IModuleProps;\n  headerSection: INodeProps;\n  tabHeaderSection: INodeProps;\n  tabsSection: INodeProps;\n  tabItemContainer: INodeProps;\n  tabHeaders: React.ReactNode;\n  tabContents: React.ReactNode;\n}\n\nexport interface ITabViewStates {\n  currentTabIndex: number;\n}\n/**\n *\n * Tab component\n * @extends {React.Component<ITabProps<ITabData>>}\n */\n@observer\nclass Tab extends React.Component<ITabProps<ITabData>, ITabViewStates> {\n  public readonly tabIndexQuery: string = 'activeTab';\n  private activeLink: HTMLLIElement | null;\n\n  constructor(props: ITabProps<ITabData>) {\n    super(props);\n    const { defaultTabIndex } = this.props.config;\n    const { slots } = this.props;\n    const slotLength = slots && slots.tabItems && slots.tabItems.length || 0;\n    let initialIndex = defaultTabIndex && defaultTabIndex <= slotLength && defaultTabIndex > 0 ? defaultTabIndex - 1 : 0;\n    const queryString: string = this.props.context && this.props.context.request && this.props.context.request.query && this.props.context.request.query.activeTab || '';\n    let queryTabIndex: number = 0;\n    if (queryString.indexOf(':') > 0) {\n      const arr = queryString.split(':');\n      const moduleId = arr[0];\n      if (moduleId === this.props.id) {\n        queryTabIndex = parseInt(arr[1], 10);\n      }\n    }\n    initialIndex = queryTabIndex > 0 && queryTabIndex <= slotLength ? queryTabIndex - 1 : initialIndex;\n    this.state = { currentTabIndex: initialIndex };\n\n    this._getTabHeader = this._getTabHeader.bind(this);\n    this._getTabContent = this._getTabContent.bind(this);\n    this._onClick = this._onClick.bind(this);\n    this._onKeyDown = this._onKeyDown.bind(this);\n    this._setGetParameter = this._setGetParameter.bind(this);\n    this.activeLink = null;\n  }\n  public render(): JSX.Element {\n    const { slots } = this.props;\n    const { heading, className } = this.props.config;\n\n    const headingComponent = heading && (\n      <MsDyn365.Text\n        className='ms-tab-header-section__heading'\n        tag={heading.tag || 'h2'}\n        text={heading.text}\n        editProps={{ onEdit: this.handleHeadingChange, requestContext: this.props.context.request }}\n      />\n    );\n    const slotLength = slots && slots.tabItems && slots.tabItems.length || 0;\n    // const queryTabIndex = this.props.context && this.props.context.request && this.props.context.request.query && +this.props.context.request.query.activeTabIndex || 0;\n    // let activeIndex = defaultTabIndex && defaultTabIndex <= slotLength && defaultTabIndex > 0 ? defaultTabIndex - 1 : 0;\n    // activeIndex = queryTabIndex > 0 && queryTabIndex <= slotLength ? queryTabIndex - 1 : activeIndex;\n\n    const tabViewProps = {\n      ...this.props,\n      TabContainer: {\n        moduleProps: this.props,\n        className: classnames('ms-tab', className)\n      },\n      headerSection: { className: 'ms-tab-header-section' },\n      tabsSection: { className: 'ms-tab-tabs-section', tag: 'ul' as NodeTag, role: 'tablist' },\n      heading: headingComponent,\n      config: this.props && this.props.config,\n      tabItemContainer: {\n        tag: 'div' as NodeTag,\n        className: 'ms-tab-content-section',\n      },\n      tabContents: slotLength > 0 && slots.tabItems.map((item: React.ReactNode, index: number) => this._getTabContent(item, index)),\n      tabHeaders: slotLength > 0 && slots.tabItems.map((item: React.ReactNode, index: number) => this._getTabHeader(item, index)),\n    };\n    return this.props.renderView(tabViewProps) as React.ReactElement;\n  }\n\n  public handleHeadingChange = (event: MsDyn365.ContentEditableEvent) => this.props.config.heading!.text = event.target.value;\n\n  public componentDidUpdate(): void {\n    const { data } = this.props;\n    const dataActionTabId = data && data.activeTabState && data.activeTabState.result && data.activeTabState.result.tabId;\n    if (dataActionTabId) {\n      if (this.props.id === dataActionTabId) {\n        this.activeLink && this.activeLink.focus();\n      }\n    } else {\n      const queryString: string = this.props.context && this.props.context.request && this.props.context.request.query && this.props.context.request.query.activeTab || '';\n      if (queryString.indexOf(':') > 0) {\n        const arr = queryString.split(':');\n        const moduleId = arr[0];\n        if (moduleId === this.props.id) {\n          this.activeLink && this.activeLink.focus();\n        }\n      }\n    }\n  }\n\n  private _getTabHeader(item: React.ReactNode, index: number): React.ReactNode {\n    const { data } = this.props;\n    const activeContentIndex = data && data.activeTabState && data.activeTabState.result && data.activeTabState.result.activeContentIndex;\n    const dataActionTabId = data && data.activeTabState && data.activeTabState.result && data.activeTabState.result.tabId;\n    const selected = activeContentIndex !== undefined && dataActionTabId === this.props.id ? activeContentIndex === index : this.state.currentTabIndex === index;\n    const contentID = getContentID(index, this.props.id);\n\n    return (\n      <li\n        key={index}\n        className='ms-tab-tabs-section-li'\n        tabIndex={selected ? 0 : -1}\n        onClick={this._onClick(index, this.props.id)}\n        onKeyDown={this._onKeyDown(index, this.props.id)}\n        // tslint:disable-next-line:react-this-binding-issue\n        ref={link => { if (index === this.state.currentTabIndex) { this.activeLink = link; } }}\n        aria-controls={contentID}\n        aria-selected={selected}\n        role='tab'\n      >\n        <React.Fragment key={index}>\n          {React.cloneElement(item as React.ReactElement, { tabItemType: TabItemType.TabHeader, isSelected: index === this.state.currentTabIndex, itemIndex: index, tabId: this.props.id })}\n        </React.Fragment>\n      </li>\n    );\n  }\n\n  private _onClick = (index: number, id: string) => (e: React.MouseEvent<HTMLLIElement>) => {\n    const activeTabState = { activeContentIndex: index, tabId: id };\n    this.props.context.actionContext.update(createTabStateInput(activeTabState), activeTabState);\n    this.setState({ currentTabIndex: index });\n    // Update query paramter\n    const requestContext = this.props.context.request;\n    const newUrl = this._setGetParameter(requestContext, this.tabIndexQuery, `${this.props.id}:${String(index + 1)}`);\n    requestContext && window.history.pushState({ path: newUrl }, '', newUrl);\n  }\n\n  private _onKeyDown = (index: number, id: string) => (e: React.KeyboardEvent<HTMLLIElement>) => {\n    debugger;\n    if (e.keyCode === 13) {\n      const activeTabState = { activeContentIndex: index, tabId: id };\n      this.props.context.actionContext.update(createTabStateInput(activeTabState), activeTabState);\n      this.setState({ currentTabIndex: index });\n      // Update query paramter\n      const requestContext = this.props.context.request;\n      const newUrl = this._setGetParameter(requestContext, this.tabIndexQuery, `${this.props.id}:${String(index + 1)}`);\n      requestContext && window.history.pushState({ path: newUrl }, '', newUrl);\n    }\n\n    if (e.keyCode === 39 || e.keyCode === 37) {\n      const { slots } = this.props;\n      const slotLength = slots && slots.tabItems && slots.tabItems.length || 0;\n\n      if (e.keyCode === 39) {\n\n        // If we're at the end, go to the start\n        if (index + 1 === slotLength) {\n          index = -1;\n        }\n        const activeTabState = { activeContentIndex: index + 1, tabId: id };\n        this.props.context.actionContext.update(createTabStateInput(activeTabState), activeTabState);\n        this.setState({ currentTabIndex: index + 1 });\n        // Update query paramter\n        const requestContext = this.props.context.request;\n        const newUrl = this._setGetParameter(requestContext, this.tabIndexQuery, `${this.props.id}:${String(index + 2)}`);\n        requestContext && window.history.pushState({ path: newUrl }, '', newUrl);\n\n        // Move left\n      } else if (e.keyCode === 37) {\n        // If we're at the start, move to the end\n        if (index === 0) {\n          index = slotLength;\n        }\n        const activeTabState = { activeContentIndex: index - 1, tabId: id };\n        this.props.context.actionContext.update(createTabStateInput(activeTabState), activeTabState);\n        this.setState({ currentTabIndex: index - 1 });\n        // Update query paramter\n        const requestContext = this.props.context.request;\n        const newUrl = this._setGetParameter(requestContext, this.tabIndexQuery, `${this.props.id}:${String(index)}`);\n        requestContext && window.history.pushState({ path: newUrl }, '', newUrl);\n      }\n    }\n  }\n\n  private _getTabContent(item: React.ReactNode, index: number): React.ReactNode {\n    return (\n      <React.Fragment key={index}>\n        {React.cloneElement(item as React.ReactElement, { tabItemType: TabItemType.TabContent, isSelected: index === this.state.currentTabIndex, itemIndex: index, tabId: this.props.id })}\n      </React.Fragment>\n    );\n  }\n\n  private _setGetParameter(requestContext: MsDyn365.IRequestContext, paramName: string, paramValue: string): string {\n    let url;\n\n    if (MsDyn365.msdyn365Commerce.isBrowser) {\n      url = new URL(window.location.href);\n    } else {\n      url = new URL(requestContext.url.requestUrl.href);\n    }\n\n    const params = new window.URLSearchParams(url.search);\n    params.set(paramName, paramValue);\n    url.search = decodeURIComponent(params.toString());\n    return url.toString();\n  }\n}\n\nexport default Tab;\n"]}