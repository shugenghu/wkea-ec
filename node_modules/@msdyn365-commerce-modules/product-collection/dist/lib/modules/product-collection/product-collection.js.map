{"version":3,"file":"product-collection.js","sourceRoot":"./src/","sources":["modules/product-collection/product-collection.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { getTelemetryObject, IComponentNodeProps, IModuleProps, INodeProps, ISingleSlideCarouselProps, ITelemetryContent, NodeTag, SingleSlideCarousel } from '@msdyn365-commerce-modules/utilities';\nimport { ProductComponent } from '@msdyn365-commerce/components';\nimport * as Msdyn365 from '@msdyn365-commerce/core';\nimport { ProductSearchResult } from '@msdyn365-commerce/retail-proxy';\nimport classnames from 'classnames';\nimport * as React from 'react';\nimport { IProductCollectionProps, layout } from './product-collection.props.autogenerated';\n\nexport interface IProductCollectionViewProps extends IProductCollectionProps<{}> {\n    heading?: React.ReactNode;\n    ProductCollectionContainer: IModuleProps;\n    SingleSlideCarouselComponentProps: INodeProps;\n    GridComponentProps: INodeProps;\n    products: IProductComponentViewProps[];\n    isCarousel: boolean;\n}\n\nexport interface IProductComponentViewProps {\n    ProductContainer: INodeProps;\n    productComponent: React.ReactNode;\n}\n\n/**\n * ProductCollection component\n */\nclass ProductCollection extends React.PureComponent<IProductCollectionProps<{}>> {\n    private telemetryContent: ITelemetryContent;\n\n    constructor(props: IProductCollectionProps<{}>) {\n        super(props);\n        this.telemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!,\n                                                   this.props.friendlyName,\n                                                   this.props.telemetry);\n    }\n\n    public render(): JSX.Element | null {\n        const { heading, productCollection, className } = this.props.config;\n        const { resources } = this.props;\n        const products = productCollection && productCollection.products;\n        const isCarousel = this.props.config.layout === layout.carousel;\n        const headingComponent = heading && (\n            <Msdyn365.Text\n                className='ms-product-collection__heading'\n                tag={heading.tag || 'h1'}\n                text={heading.text}\n                editProps={{onEdit:this.handleHeadingChange, requestContext:this.props.context.request}}\n            />\n        );\n\n        const productCollectionViewProps = {\n            ...this.props,\n            heading: headingComponent,\n            SingleSlideCarouselComponentProps: {\n                tag: SingleSlideCarousel,\n                className: '',\n                flipperPrevLabel: resources.flipperPrevious,\n                flipperNextLabel: resources.flipperNext,\n                parentId: this.props.id,\n                telemetryContent: this.telemetryContent\n            } as IComponentNodeProps<ISingleSlideCarouselProps>,\n            ProductCollectionContainer: {\n                moduleProps: this.props,\n                className:  classnames('ms-product-collection', className)\n            },\n            GridComponentProps: {\n                tag: 'ul' as NodeTag,\n                className: 'ms-product-collection__items',\n            },\n            isCarousel: isCarousel,\n            products: products && products.length > 0 && products.map((item: ProductSearchResult, index: number) => this._getProduct(item, index)),\n        };\n        return this.props.renderView(productCollectionViewProps) as React.ReactElement;\n    }\n    public handleHeadingChange = (event: Msdyn365.ContentEditableEvent) => this.props.config.heading!.text = event.target.value;\n\n    private _getProduct = (product:ProductSearchResult, index: number): IProductComponentViewProps | null => {\n        if(!product || !product.Name) {\n            this.props.telemetry.trace('[product-collection] Product or product name is null');\n            return null;\n        }\n        const telemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!,\n                                                    this.props.friendlyName,\n                                                    this.props.telemetry);\n        const { imageSettings, allowBackNavigation } = this.props.config;\n        const resources = this.props.resources;\n        const breaCrumbType = this.props.context.app.config.breadcrumbType;\n        const allowBack = allowBackNavigation && (breaCrumbType === 'back' || breaCrumbType === 'categoryAndBack');\n        return {\n            ProductContainer: {\n                tag: 'li' as NodeTag,\n                className: 'ms-product-collection__item',\n                role: 'listitem',\n                key: index,\n            },\n            productComponent: (\n                <ProductComponent\n                    context={this.props.context}\n                    telemetryContent={telemetryContent}\n                    imageSettings={imageSettings}\n                    freePriceText={resources.priceFree}\n                    originalPriceText={resources.originalPriceText}\n                    currentPriceText={resources.currentPriceText}\n                    ratingAriaLabel={resources.ratingAriaLabel}\n                    allowBack={allowBack}\n                    id={this.props.id}\n                    typeName={this.props.typeName}\n                    data={{product: product}}\n                />\n            )\n        };\n    }\n}\n\nexport default ProductCollection;\n"]}