import { createObservableDataAction } from '@msdyn365-commerce/core';
import { retailAction } from '@msdyn365-commerce/retail-proxy/dist';
import { createSearchByTextInput } from '@msdyn365-commerce/retail-proxy/dist/DataActions/ProductsDataActions.g';
import { QueryResultSettingsProxy } from './utilities/QueryResultSettingsProxy';
/**
 * createInput method for the searchByText data action
 */
export function createSearchByTextInputFunc(inputData) {
    const { requestContext: { query, apiSettings: { channelId } } } = inputData;
    const search = query && query.q;
    if (!search) {
        throw new Error('Unable to preform search without search text. Query string ?q={searchText} must be present or should be configued in module data.');
    }
    const querySettingsProxy = QueryResultSettingsProxy.fromInputData(inputData);
    return createSearchByTextInput(querySettingsProxy.QueryResultSettings, Number(channelId), 0, search);
}
/**
 * The searchByText data action
 * Queries RetailServers product searchByText API using a
 * query string parameter and returns a list of ProductSearchResults
 */
export default createObservableDataAction({
    id: '@msdyn365-commerce-modules/retail-actions/search-by-text',
    action: retailAction,
    input: createSearchByTextInputFunc
});
//# sourceMappingURL=search-by-text.js.map