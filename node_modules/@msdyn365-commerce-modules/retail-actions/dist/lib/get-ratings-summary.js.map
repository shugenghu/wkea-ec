{"version":3,"file":"get-ratings-summary.js","sourceRoot":"","sources":["../../src/get-ratings-summary.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAGhG,OAAO,EAAE,0BAA0B,EAA+E,WAAW,EAAE,MAAM,yBAAyB,CAAC;AAC/J,OAAO,EAAE,sBAAsB,EAAE,mCAAmC,EAAE,MAAM,SAAS,CAAC;AACtF,OAAO,EAAE,gBAAgB,EAAE,eAAe,EAAE,MAAM,wBAAwB,CAAC;AAE3E,MAAM,CAAC,MAAM,WAAW,GAAG,CAAC,KAA2C,EAAgB,EAAE;IACrF,MAAM,SAAS,GAAG,mCAAmC,CAAC,KAAK,CAAC,CAAC;IAC7D,IAAI,SAAS,EAAE;QACX,OAAO,IAAI,sBAAsB,CAAC,SAAS,EAAE,eAAe,CAAC,KAAK,CAAC,EAAE,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAAC;KACjG;IACD,MAAM,IAAI,KAAK,CAAC,sGAAsG,CAAC,CAAC;AAC5H,CAAC,CAAC;AAEF;;GAEG;AACH,KAAK,UAAU,iBAAiB,CAAC,KAA6B,EAAE,GAAmB;IAC/E,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,EAAE;QACtB,GAAG,CAAC,KAAK,CAAC,+DAA+D,CAAC,CAAC;QAC3E,OAAO,EAAE,CAAC;KACb;IAED,MAAM,UAAU,GAAG,GAAG,KAAK,CAAC,eAAe,yBAAyB,KAAK,CAAC,SAAS,WAAW;QAC1F,YAAY,KAAK,CAAC,QAAQ,EAAE,CAAC;IACjC,OAAO,WAAW,CAAiB,UAAU,EAAE,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,EAAE;QACpE,OAAO,QAAQ,CAAC,IAAI,CAAC;IACzB,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,EAAE;QACf,GAAG,CAAC,KAAK,CAAC,+DAA+D,CAAC,CAAC;QAC3E,MAAM,KAAK,CAAC;IAChB,CAAC,CAAC,CAAC;AACP,CAAC;AAED,SAAS,YAAY,CAAC,KAA6B;IAC/C,OAAO,KAAK,IAAI,KAAK,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,IAAI,KAAK,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;AAC5E,CAAC;AAED,eAAe,0BAA0B,CAAC;IACtC,EAAE,EAAE,+DAA+D;IACnE,MAAM,EAA2B,iBAAiB;IAClD,KAAK,EAAE,WAAW;CACrB,CAAC,CAAC","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { RatingsSummary } from '@msdyn365-commerce/commerce-entities';\nimport { createObservableDataAction, IAction, IActionContext, IActionInput, IAny, ICreateActionContext, IGeneric, sendRequest } from '@msdyn365-commerce/core';\nimport { GetRatingsSummaryInput, getSelectedProductIdFromActionInput } from './index';\nimport { getRnrEndpointId, getRnrPartnerId } from './utilities/getRnrKeys';\n\nexport const createInput = (input: ICreateActionContext<IGeneric<IAny>>): IActionInput => {\n    const productId = getSelectedProductIdFromActionInput(input);\n    if (productId) {\n        return new GetRatingsSummaryInput(productId, getRnrPartnerId(input), getRnrEndpointId(input));\n    }\n    throw new Error('[GetRatingsSummary] Not all necessary parameters found while creating Input for getRatingsSummaryApi');\n};\n\n/**\n * This function gets the ratings summary\n */\nasync function getRatingsSummary(input: GetRatingsSummaryInput, ctx: IActionContext): Promise<RatingsSummary> {\n    if (!inputIsValid(input)) {\n        ctx.trace(`[GetRatingsSummary] Failed to get ratings summary for product`);\n        return {};\n    }\n\n    const requestUrl = `${input.serviceEndpoint}/v2.0/ratings/product/${input.productId}/summary?` +\n        `tenantId=${input.tenantId}`;\n    return sendRequest<RatingsSummary>(requestUrl, 'get').then((response) => {\n        return response.data;\n    }).catch((error) => {\n        ctx.trace(`[GetRatingsSummary] Failed to get ratings summary for product`);\n        throw error;\n    });\n}\n\nfunction inputIsValid(input: GetRatingsSummaryInput): boolean {\n    return input && input.productId.length > 0 && input.tenantId.length > 0;\n}\n\nexport default createObservableDataAction({\n    id: '@msdyn365-commerce-modules/retail-actions/get-ratings-summary',\n    action: <IAction<RatingsSummary>>getRatingsSummary,\n    input: createInput\n});"]}