{"version":3,"file":"update-address.js","sourceRoot":"","sources":["../../src/update-address.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,0BAA0B,EAA8B,MAAM,yBAAyB,CAAC;AAEjG,OAAO,EAAE,4BAA4B,EAAE,4BAA4B,EAA2B,MAAM,eAAe,CAAC;AAEpH,uDAAuD;AACvD,MAAM,UAAU,oBAAoB,CAAC,QAAkB,EAAE,OAAgB;IACrE,QAAQ,CAAC,SAAS,GAAG,QAAQ,CAAC,SAAS,IAAI,EAAE,CAAC;IAC9C,IAAI,OAAO,CAAC,SAAS,EAAE;QACnB,QAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,SAAS,GAAG,KAAK,CAAC,CAAA;KAC3D;IACD,QAAQ,CAAC,SAAS,GAAG,CAAC,GAAG,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,QAAQ,KAAK,OAAO,CAAC,QAAQ,CAAC,EAAE,OAAO,CAAC,CAAC;IACvG,OAAO,QAAQ,CAAC;AACpB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,mBAAmB,CAAC,KAA8B,EAAE,GAAmB;IACzF,OAAO,4BAA4B,CAAC,KAAK,EAAE,GAAG,EAAE,oBAAoB,CAAC,CAAC;AAC1E,CAAC;AAED;;;;;GAKG;AACH,eAAe,0BAA0B,CAAY;IACjD,EAAE,EAAE,0DAA0D;IAC9D,MAAM,EAAsB,mBAAmB;IAC/C,KAAK,EAAuD,4BAA6B;CAC5F,CAAC,CAAC","sourcesContent":["import { IAction, IActionContext, IActionInput } from '@msdyn365-commerce/core';\nimport { createObservableDataAction, IAny, ICreateActionContext } from '@msdyn365-commerce/core';\nimport { Address, Customer } from '@msdyn365-commerce/retail-proxy/dist/Entities/CommerceTypes.g';\nimport { createAddressManagementInput, doAddressManagementOperation, IAddressManagementInput } from './add-address';\n\n// TODO: Centralize this logic in a common utility area\nexport function updateAddressHandler(customer: Customer, address: Address): Customer {\n    customer.Addresses = customer.Addresses || [];\n    if (address.IsPrimary) {\n        customer.Addresses.forEach(cur => cur.IsPrimary = false)\n    }\n    customer.Addresses = [...customer.Addresses.filter(cur => cur.RecordId !== address.RecordId), address];\n    return customer;\n}\n\nexport async function updateAddressAction(input: IAddressManagementInput, ctx: IActionContext): Promise<Address[]> {\n    return doAddressManagementOperation(input, ctx, updateAddressHandler);\n}\n\n/**\n * The updateAddress data action\n * Calls the read RetailServer API to get information about a customer\n * Merge the passed address information with the address information from\n * the retireved customer, and then updates that customer via the update RetailServer API.\n */\nexport default createObservableDataAction<Address[]>({\n    id: '@msdyn365-commerce-modules/retail-actions/update-address',\n    action: <IAction<Address[]>>updateAddressAction,\n    input: <(args: ICreateActionContext) => IActionInput>(<IAny>createAddressManagementInput)\n});\n"]}