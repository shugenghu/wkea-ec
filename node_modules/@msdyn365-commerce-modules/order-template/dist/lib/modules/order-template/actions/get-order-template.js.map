{"version":3,"file":"get-order-template.js","sourceRoot":"./src/","sources":["modules/order-template/actions/get-order-template.ts"],"names":[],"mappings":"AAAA,OAAO,EACH,0BAA0B,EAC1B,oBAAoB,EACpB,yBAAyB,EAGzB,wBAAwB,EAC3B,MAAM,2CAA2C,CAAC;AACnD,OAAO,EAEH,0BAA0B,EAM7B,MAAM,yBAAyB,CAAC;AAMjC,MAAM,OAAO,6BAA6B;IAKtC,YAAY,cAA+B,EAAE,MAAwC;QAc9E,gBAAW,GAAG,GAAW,EAAE,CAAE,0BAA0B,CAAC,0BAA0B,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;QACzG,uBAAkB,GAAG,GAAW,EAAE,CAAC,0BAA0B,CAAC;QAC9D,kBAAa,GAAG,GAAc,EAAE,CAAC,UAAU,CAAC;QAC5C,sBAAiB,GAAG,GAAG,EAAE,CAAC,KAAK,CAAC;QAhBnC,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,EAAE,EAAE;YAC3B,MAAM,IAAI,KAAK,CAAC,iDAAiD,CAAC,CAAC;SACtE;QACD,IAAI,CAAC,MAAM,EAAE;YACT,MAAM,IAAI,KAAK,CAAC,mDAAmD,CAAC,CAAC;SACxE;QACD,IAAI,CAAC,eAAe,GAAG,cAAc,CAAC,KAAK,CAAC,EAAE,CAAC;QAC/C,IAAI,CAAC,mBAAmB,GAAG,wBAAwB,CAAC,cAAc,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC,mBAAmB,CAAC;QAE/G,IAAI,CAAC,mBAAmB,CAAC,KAAK,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,cAAc,GAAG,cAAc,CAAC;IACzC,CAAC;CAMJ;AAKD,MAAM,CAAC,KAAK,UAAU,2BAA2B,CAAC,KAAoC,EAAE,OAAuB;IAC3G,OAAO,oBAAoB,CAAC,IAAI,yBAAyB,CAAC,KAAK,CAAC,eAAe,EAAE,KAAK,CAAC,mBAAmB,CAAC,EAAE,OAAO,CAAC,CAAC;AAC1H,CAAC;AAED,eAAe,0BAA0B,CAAC;IACtC,EAAE,EAAE,mFAAmF;IACvF,MAAM,EAA0B,2BAA2B;IAC3D,KAAK,EAAE,CAAC,OAA6B,EAAE,EAAE;QACrC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;YACjB,MAAM,IAAI,KAAK,CAAC,mDAAmD,CAAC,CAAC;SACxE;QACD,OAAO,IAAI,6BAA6B,CAAC,OAAO,CAAC,cAAc,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC;IACrF,CAAC;CACJ,CAAC,CAAC","sourcesContent":["import {\n    buildCacheKeyWithUrlTokens,\n    getFullOrderTemplate,\n    GetFullOrderTemplateInput,\n    IQueryResultSettingsModuleConfig,\n    OrderTemplate,\n    QueryResultSettingsProxy\n} from '@msdyn365-commerce-modules/retail-actions';\nimport {\n    CacheType,\n    createObservableDataAction,\n    IAction,\n    IActionContext,\n    IActionInput,\n    ICreateActionContext,\n    IRequestContext\n} from '@msdyn365-commerce/core';\nimport { IQueryResultSettings } from '@msdyn365-commerce/retail-proxy';\n\n/**\n * Input class for getActiveOrderTemplateLines data action\n */\nexport class ActiveOrderTemplateLinesInput implements IActionInput {\n    public requestContext: IRequestContext;\n    public orderTemplateId: string;\n    public queryResultSettings: IQueryResultSettings;\n\n    constructor(requestContext: IRequestContext, config: IQueryResultSettingsModuleConfig) {\n        if (!requestContext.query?.id) {\n            throw new Error('Failed to get order template id from the query.');\n        }\n        if (!config) {\n            throw new Error('Failed to get order template module configuration');\n        }\n        this.orderTemplateId = requestContext.query.id;\n        this.queryResultSettings = QueryResultSettingsProxy.fromModuleData(requestContext, config).QueryResultSettings;\n\n        this.queryResultSettings.count = true;\n        this.requestContext = requestContext;\n    }\n\n    public getCacheKey = (): string =>  buildCacheKeyWithUrlTokens('ActiveOrderTemplateLines', this.requestContext);\n    public getCacheObjectType = (): string => 'ActiveOrderTemplateLines';\n    public dataCacheType = (): CacheType => 'instance';\n    public shouldCacheOutput = () => false;\n}\n\n/**\n * Calls the Retail API and returns a ProductList object based on the passed GetCartInput\n */\nexport async function getActiveOrderTemplateLines(input: ActiveOrderTemplateLinesInput, context: IActionContext): Promise<OrderTemplate> {\n    return getFullOrderTemplate(new GetFullOrderTemplateInput(input.orderTemplateId, input.queryResultSettings), context);\n}\n\nexport default createObservableDataAction({\n    id: '@msdyn365-commerce-modules/order-template/order-template/get-order-template-lines',\n    action: <IAction<OrderTemplate>>getActiveOrderTemplateLines,\n    input: (context: ICreateActionContext) => {\n        if (!context.config) {\n            throw new Error('Failed to get order template module configuration');\n        }\n        return new ActiveOrderTemplateLinesInput(context.requestContext, context.config);\n    }\n});\n"]}