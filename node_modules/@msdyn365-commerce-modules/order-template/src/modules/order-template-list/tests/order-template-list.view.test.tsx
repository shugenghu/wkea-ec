/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
import { buildHydratedMockActionContext, buildMockModuleProps } from '@msdyn365-commerce/core';
import { render } from 'enzyme';
import * as React from 'react';
import { ISingleOrderTemplateViewProps } from '../components';
import { IOrderTemplateListViewProps } from '../order-template-list';
import OrderTemplateListView from '../order-template-list.view';

const mockActionContext = buildHydratedMockActionContext();
// @ts-ignore
mockActionContext.requestContext.apiSettings = {baseImageUrl: 'https://cms-ppe-imageresizer-mr.trafficmanager.net/cms/api/fabrikamsb/imageFileData/search?fileName=/'};
// @ts-ignore
const mockContext: ICoreContext<{}> = {
  actionContext: mockActionContext,
  request: {
    user: {
      isAuthenticated: true,
      token: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Ilg1ZVhrNHh5b2pORnVtMWtsMll0djhkbE5QNC1jNTdkTzZRR1RWQndhTmsifQ.eyJleHAiOjE1NzQzODA2MTQsIm5iZiI6MTU3NDM3NzAxNCwidmVyIjoiMS4wIiwiaXNzIjoiaHR0cHM6Ly9sb2dpbi5mYWJyaWthbS5jb20vMDcxODA4YzMtMDIxMy00ZjQzLWI1ZTItZGYwMTI2NmU0NGFlL3YyLjAvIiwic3ViIjoiMmE2YjYwZjMtNTE3NS00YmExLWI5YzYtODM2ODQ5MWYyMWQ2IiwiYXVkIjoiNWY2M2Y1MGQtZDdlNy00YTRlLTg1MzQtZTg3NTk5ZmMwZmQ5Iiwibm9uY2UiOiI2MzcwOTk3MzgxMzc3MDMyNjYuTURnM056a3lOekl0T0RnNE9TMDBOVGxqTFRnNFpqa3RPRFUyTm1VelkyWmtObUU0WWpFMlpUVXhOREF0TUdRMU5DMDBOR0UyTFdFNVlUTXRabU0xWmpjM05EQTFPRGhrIiwiaWF0IjoxNTc0Mzc3MDE0LCJhdXRoX3RpbWUiOjE1NzQzNzcwMTQsIm9pZCI6IjJhNmI2MGYzLTUxNzUtNGJhMS1iOWM2LTgzNjg0OTFmMjFkNiIsImdpdmVuX25hbWUiOiJKb3JkYW5Ud28iLCJmYW1pbHlfbmFtZSI6IkV1Z2VuaW8iLCJlbWFpbHMiOlsidi1qb2V1Z0BtaWNyb3NvZnQuY29tIl0sInRmcCI6IkIyQ18xX3Npc3VfcjJwcGUiLCJjX2hhc2giOiI3a2ZPSnFMRDhNUUFfMnBmdnBpQVBnIn0.XUqgKAIBfc2eQBGSeBjgvAzGNyxmftcxEQktcbvM2aeChseBrZfl9-Jd8E5FbwY4x2cAxeTG_-NH6J7An_Q4gcCiGVb625BSEmgVuOj9KLN3yuUmgz3BwRgyu_pbByqpLWQXQGdiNTUDPUEGRReINEVneqCQ18iXScTgy_r4kMjB3dHeV8eWfrdtXlFz4IAinfKU19eoc_FixpJ_6jjUzcnrwt9E9eEnd09dOjSeByM4KRUAY9RWVNrJiqK33-kyUXPT8QCR3bEP9ApTe2DTSirMvAfpQ7_9m99EB7MbF2a6CqpBaBlUTAdvavwIDSPGItSklJ8zNvNWDIL-laf5gg',
      customerAccountNumber: '004219'
    }
  },
  app: {
    config: {
      maxQuantityForCartLineItem: 10,
      outOfStockThreshold: 2,
      enableStockCheck: false
    }
  },
};

const mockOrderTemplates: ISingleOrderTemplateViewProps[] = [
    {
        key: 'index1',
        orderTemplateImage: <div>Product Image</div>,
        addToCartButton: <div>Add to Cart Button</div>,
        removeButton: <div>Remove Button</div>
    },
    {
        key: 'index2',
        orderTemplateImage: <div>Product Image</div>,
        addToCartButton: <div>Add to Cart Button</div>,
        removeButton: <div>Remove Button</div>
    },
];

describe('OrderTemplateList unit tests -', () => {
    it('View renders correctly', () => {
        const moduleProps: IOrderTemplateListViewProps = buildMockModuleProps({}, {}) as IOrderTemplateListViewProps;

        const mockProps: IOrderTemplateListViewProps = {
            ...moduleProps,
            OrderTemplateList: {
                moduleProps: moduleProps,
                className: 'ms-order-template'
            },
            status: 'SUCCESS',
            heading: <div className={'ms-order-template__heading'}>Heading</div>,
            OrderTemplates: {
                className: 'ms-order-template__list-item',
                tag: 'ul',
            },
            OrderTemplate: {
                className: 'ms-order-template__tile',
                tag: 'li',
            },
            orderTemplates: mockOrderTemplates
        };

        const component = render(<OrderTemplateListView {...mockProps} />);
        expect(component).toMatchSnapshot();
    });
});