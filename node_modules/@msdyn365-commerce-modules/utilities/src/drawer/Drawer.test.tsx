import { mount } from 'enzyme';
import * as React from 'react';
import Drawer from './Drawer';

describe('Drawer component mounting tests', () => {
    it('calls the toggle function if a toggle function is passed', () => {
        const spyOnToggle = jest.fn();
        const wrapper = mount(
            <Drawer
                collapseProps={{
                    className: 'drawer',
                    timeout: 1000
                }}
                toggleButtonText={'Select Shipping Address'}
                toggleButtonProps={{
                    color: 'primary',
                    tag: 'button'
                }}
                openGlyph={'fa fa-chevron-up'}
                closeGlyph={'fa fa-chevron-down'}
                glyphPlacement={'end'}
                onToggle={spyOnToggle}
            >
                <div className='card drawer__card'>
                    <span>This is a card</span>
                </div>
            </Drawer>,
            { attachTo: document.body.firstElementChild as HTMLElement }
        );
        const toggleButton = document.querySelector('.btn-block') as HTMLElement;
        toggleButton.click();
        expect(spyOnToggle).toHaveBeenCalled();
        wrapper.unmount();
    });

    it('toggles when clicked', () => {
        const wrapper = mount(
            <Drawer
                collapseProps={{
                    className: 'drawer',
                    timeout: 1000
                }}
                toggleButtonText={'Select Shipping Address'}
                toggleButtonProps={{
                    color: 'primary',
                    tag: 'button'
                }}
                openGlyph={'fa fa-chevron-up'}
                closeGlyph={'fa fa-chevron-down'}
                glyphPlacement={'end'}
            >
                <div className='card drawer__card'>
                    <span>This is a card</span>
                </div>
            </Drawer>,
            { attachTo: document.body.firstElementChild as HTMLElement }
        );
        const drawer = wrapper.instance() as Drawer;
        const toggleButton = document.querySelector('.btn-block') as HTMLElement;
        toggleButton.click();
        expect(drawer.state.isOpen).toBe(true);
        wrapper.unmount();
    });
});
