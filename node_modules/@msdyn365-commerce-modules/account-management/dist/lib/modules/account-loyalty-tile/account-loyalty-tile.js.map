{"version":3,"file":"account-loyalty-tile.js","sourceRoot":"./src/","sources":["modules/account-loyalty-tile/account-loyalty-tile.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as Msdyn365 from '@msdyn365-commerce/core';\nimport classnames from 'classnames';\nimport * as React from 'react';\n\nimport { format, getTelemetryObject, IModuleProps, ITelemetryContent } from '@msdyn365-commerce-modules/utilities';\nimport { LoyaltyRewardPoint } from '@msdyn365-commerce/retail-proxy';\n\nimport { IAccountLoyaltyTileData } from './account-loyalty-tile.data';\nimport { IAccountLoyaltyTileProps } from './account-loyalty-tile.props.autogenerated';\nimport DescriptionComponent from './components/account-loyalty-tile-description';\nimport LinksComponent from './components/account-loyalty-tile-links';\n\nexport interface IAccountLoyaltyTileViewProps extends IAccountLoyaltyTileProps<IAccountLoyaltyTileData> {\n    AccountLoyaltyTile: IModuleProps;\n    className: string;\n    heading?: React.ReactNode;\n    links?: React.ReactNode;\n    description?: React.ReactNode;\n}\n\n/**\n *\n * AccountLoyalty component\n * @extends {React.PureComponent<IAccountLoyaltyTileProps<IAccountLoyaltyTileData>>}\n */\nclass AccountLoyaltyTile extends React.PureComponent<IAccountLoyaltyTileProps<IAccountLoyaltyTileData>> {\n\n    private telemetryContent: ITelemetryContent;\n    constructor(props: IAccountLoyaltyTileProps<IAccountLoyaltyTileData>) {\n        super(props);\n        this.telemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!, this.props.friendlyName, this.props.telemetry);\n    }\n\n    public render(): JSX.Element {\n        const { config, data, resources, context } = this.props;\n        const { className, heading, signUpLinkText, signUpLinkAriaLabel, viewLinkText, viewLinkAriaLabel } = config;\n        const { accountLoyaltySummary, accountLoyaltyMemberSummary } = resources;\n        const { loyaltyCard } = data;\n\n        let description = accountLoyaltySummary;\n        let url = Msdyn365.getUrlSync('loyaltyJoin', context.actionContext) || '';\n        const link = { linkText: signUpLinkText, linkUrl: { destinationUrl: url }, ariaLabel: signUpLinkAriaLabel };\n\n        if (loyaltyCard && loyaltyCard.result && loyaltyCard.result.CardNumber) {\n            let points = 0;\n\n            if (loyaltyCard.result.RewardPoints && loyaltyCard.result.RewardPoints.length > 0) {\n                loyaltyCard.result.RewardPoints.forEach((rewardPoint: LoyaltyRewardPoint) => {\n                    points += rewardPoint.ActivePoints!;\n                });\n            }\n            link.ariaLabel = viewLinkAriaLabel;\n            link.linkText = viewLinkText;\n            url = Msdyn365.getUrlSync('loyalty', context.actionContext) || '';\n            link.linkUrl.destinationUrl = url;\n            description = format(accountLoyaltyMemberSummary, points);\n        }\n\n        const viewProps = {\n            ...this.props,\n            className: className,\n            AccountLoyaltyTile: {\n                moduleProps: this.props,\n                className: classnames('ms-account-loyalty-tile', config.className)\n            },\n           // heading: heading && <Heading className='ms-account-loyalty-tile__heading' headingTag={heading.tag} text={heading.text} />,\n            heading: heading && heading.text && (\n                <Msdyn365.Text\n                  className='ms-account-loyalty-tile__heading'\n                  tag={heading.tag || 'h2'}\n                  text={heading.text}\n                  editProps = {{onEdit: this.handleHeadingChange, requestContext: this.props.context.request}}\n                />\n            ),\n            links: <LinksComponent {...{ links: [link], onTextChange: this.handleLinkTextChange, requestContext: this.props.context.request, telemetryContent: this.telemetryContent }} />,\n            description: <DescriptionComponent description={description} />\n        };\n\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n    public handleHeadingChange = (event: Msdyn365.ContentEditableEvent) => this.props.config.heading.text = event.target.value;\n    public handleLinkTextChange = (linkIndex: number) => (event: Msdyn365.ContentEditableEvent) => {\n        if(this.props.config.signUpLinkText && this.props.config.viewLinkText) {\n          this.props.config.viewLinkText = event.target.value;\n        }\n    };\n\n}\n\nexport default AccountLoyaltyTile;\n"]}