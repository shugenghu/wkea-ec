/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

/// <reference types="jest" />
// tslint:disable-next-line:no-unused-variable
import * as React from 'react';
import * as renderer from 'react-test-renderer';

import { buildMockModuleProps } from '@msdyn365-commerce/core';

import PasswordResetVerification from '../password-reset-verification';
import {
    HeadingTag, IPasswordResetVerificationConfig, IPasswordResetVerificationProps,
    IPasswordResetVerificationResources
} from '../password-reset-verification.props.autogenerated';

const mockConfig: IPasswordResetVerificationConfig = {
  heading: {
    text: 'Verify your email address',
    tag: HeadingTag.h2
  },
};

const mockResources: IPasswordResetVerificationResources = {
  emailAddressLabelText: 'Email Address',
  verificationCodeLabelText: 'Verification Code',
  sendCodeButtonText: 'Send verification code',
  sendCodeButtonAriaLabel: 'Send verification code',
  resendCodeButtonText: 'Send new code',
  resendCodeButtonAriaLabel: 'Send new code',
  verifyCodeButtonText: 'Verify code',
  verifyCodeButtonAriaLabel: 'Verify code',
  changeEmailButtonText: 'Change e-mail',
  changeEmailButtonAriaLabel: 'Change e-mail',
  continueButtonText: 'Continue',
  continueButtonAriaLabel: 'Continue',
  cancelButtonText: 'Cancel',
  cancelButtonAriaLabel: 'Cancel',
  verificationCodeSendSuccess: 'Verification code has been sent to your inbox. Please copy it to the verification code input box.',
  emailAddressVerifiedSuccess: 'E-mail address verified. You can now continue',
  requriedEmailError: 'Please enter a valid email address',
  invalidEmailError: 'Incorrect format',
  retryError: 'That code is incorrect. Please try again',
  retryNotAllowedError: 'You have made too many incorrect attempts. Please try again later',
  throttledError: 'There have been too many requests to verify this email address. Please wait a while, then try again.',
  codeExpiredError: 'That code is expired. Please request a new code',
  serverError: 'We are having trouble verifying your email address. Please enter a valid email address and try again',
  loadingMessage: 'Please wait.'
};

const mockActions = {};

describe('PasswordResetVerification', () => {
  let moduleProps: IPasswordResetVerificationProps<IPasswordResetVerificationConfig>;
  beforeAll(() => {
    moduleProps = { ...buildMockModuleProps({}, mockActions, mockConfig) as IPasswordResetVerificationProps<IPasswordResetVerificationConfig>, resources: mockResources };
  });
  it('renders correctly', () => {
    const component: renderer.ReactTestRenderer = renderer.create(
      <PasswordResetVerification {...moduleProps} />
    );
    const tree = component.toJSON();
    expect(tree).toMatchSnapshot();
  });
});
