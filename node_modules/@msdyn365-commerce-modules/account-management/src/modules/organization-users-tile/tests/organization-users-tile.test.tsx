/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

import { buildMockModuleProps} from '@msdyn365-commerce/core-internal';
/// <reference types="jest" />

// tslint:disable-next-line:no-unused-variable
import * as React from 'react';
import * as renderer from 'react-test-renderer';

import OrganizationUsersTile from '../organization-users-tile';
import { IOrganizationUsersTileData } from '../organization-users-tile.data';
import {
  IOrganizationUsersTileConfig,
  IOrganizationUsersTileProps,
  IOrganizationUsersTileResources,
} from '../organization-users-tile.props.autogenerated';

const mockData: IOrganizationUsersTileData = {
  // @ts-ignore partial mock
  users: {
    status: 'SUCCESS',
    result: 10
  }
};

const mockConfig: IOrganizationUsersTileConfig = {
  heading:{
    text: 'Sample text',
      },
  links:[
    {
      linkText: 'view',
      linkUrl: {
        destinationUrl: '#'
      },
      ariaLabel: 'View details',
      openInNewTab: false
    }
  ],
  className:' '
};

const mockActions = {};
const mockResources:IOrganizationUsersTileResources= {
  accountOrganizationUsersTileDescription: 'You have not added any organization user.'
};

describe('OrganizationUsersTile', () => {
  let moduleProps: IOrganizationUsersTileProps<IOrganizationUsersTileData>;
  beforeAll(() => {
    moduleProps = {...buildMockModuleProps(mockData, mockActions, mockConfig) as IOrganizationUsersTileProps<IOrganizationUsersTileData>, resources:mockResources};
  });
  it('renders correctly', () => {
    const component: renderer.ReactTestRenderer = renderer.create(
      <OrganizationUsersTile {...moduleProps} />
    );
    const tree = component.toJSON();
    expect(tree).toMatchSnapshot();
  });
});
