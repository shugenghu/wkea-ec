/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

/// <reference types="jest" />
// tslint:disable-next-line:no-unused-variable
import * as React from 'react';
import * as renderer from 'react-test-renderer';

import { buildMockModuleProps } from '@msdyn365-commerce/core';

import AccountProfileEdit from '../account-profile-edit';
import {
  HeadingTag,
  IAccountProfileEditConfig,
  IAccountProfileEditProps,
  IAccountProfileEditResources
} from '../account-profile-edit.props.autogenerated';

const mockConfig: IAccountProfileEditConfig = {
  showEmail: true,
  heading: {
    tag: HeadingTag.h2,
    text: 'Account Information'
  },
};

const mockResources: IAccountProfileEditResources = {
  firstNameLabelText: 'First Name',
  firstNameMaxLength: '20',
  lastNameLabelText: 'Last Name',
  lastNameMaxLength: '20',
  emailAddressLabelText: 'Email Address',
  saveButtonText: 'Save',
  saveButtonAriaLabel: 'Save',
  cancelButtonText: 'Cancel',
  cancelButtonAriaLabel: 'Cancel',
  requiredFieldMissingSummaryError: 'A required field is missing. Please fill out all required fields and try again.',
  fieldIncorrectError: 'One or more fields are filled out incorrectly. Please check your entries and try again',
  invalidEmailAddressError: 'Please enter a valid email address.',
  requiredFieldMissingError: 'This information is required.',
  loadingMessage: 'Please wait.'
};

const mockActions = {};

describe('AccountProfileEdit', () => {
  let moduleProps: IAccountProfileEditProps<IAccountProfileEditConfig>;
  beforeAll(() => {
    moduleProps = { ...buildMockModuleProps({}, mockActions, mockConfig) as IAccountProfileEditProps<IAccountProfileEditConfig>, resources: mockResources };
  });
  it('renders correctly', () => {
    const component: renderer.ReactTestRenderer = renderer.create(
      <AccountProfileEdit {...moduleProps} />
    );
    const tree = component.toJSON();
    expect(tree).toMatchSnapshot();
  });
});
