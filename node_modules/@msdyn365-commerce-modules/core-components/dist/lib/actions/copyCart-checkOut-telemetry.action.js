/*!
 * Copyright (c) Microsoft Corporation.
 * All rights reserved. See LICENSE in the project root for license information.
 */
import { createDataActionHook } from '@msdyn365-commerce/core';
import { TelemetryEvent } from '@msdyn365-commerce/telemetry-internal';
const beforeCopyCart = async (inputs) => {
};
const afterCopyCart = async (_inputs, cart, actionContext) => {
    if (window && window._msdyn365 && window._msdyn365.telemetry) {
        const cartObject = Array.isArray(cart) ? cart[0] : cart;
        const cartLineProductUnits = [];
        if (cartObject && cartObject.CartLines && Array.isArray(cartObject.CartLines) && cartObject.CartLines.length > 0) {
            cartObject.CartLines.forEach((cartLineitem) => {
                if (cartLineitem.ProductId) {
                    cartLineProductUnits.push({
                        productChannelId: cartObject.ChannelId ? cartObject.ChannelId.toString() : '',
                        productChannelName: '',
                        productCategoryId: '',
                        productCategoryName: '',
                        productId: cartLineitem.ProductId.toString(),
                        productName: '',
                        productSku: '',
                        productPrice: cartLineitem.Price ? cartLineitem.Price.toString() : '',
                        productQuantity: cartLineitem.Quantity ? cartLineitem.Quantity.toString() : '',
                        productCurrency: actionContext.requestContext.channel ? actionContext.requestContext.channel.Currency || '' : ''
                    });
                }
            });
        }
        window._msdyn365.telemetry.logEvent(TelemetryEvent.CheckOut, {
            cartId: cartObject.Id,
            cartVersion: cartObject.Version ? cartObject.Version.toString() : '',
            products: cartLineProductUnits,
            orderId: cartObject.OrderNumber ? cartObject.OrderNumber.toString() : ''
        });
    }
};
createDataActionHook({
    actionId: '@msdyn365-commerce/retail-proxy/Carts/Copy',
    postReaderHook: afterCopyCart,
    preReaderHook: beforeCopyCart
});
//# sourceMappingURL=copyCart-checkOut-telemetry.action.js.map