{"version":3,"file":"get-org-unit-locations.js","sourceRoot":"./src/","sources":["actions/get-org-unit-locations.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,aAAa,EAAE,MAAM,2CAA2C,CAAC;AAC1E,OAAO,EAEH,0BAA0B,EAQ7B,MAAM,yBAAyB,CAAC;AAEjC,OAAO,EAAE,8BAA8B,EAAE,MAAM,wEAAwE,CAAC;AAMxH,MAAM,UAAU,GAAe;IAC3B,MAAM,EAAE,IAAI,CAAC,GAAG,EAAE;IAClB,iBAAiB,EAAE,CAAC;CACvB,CAAC;AAKF,MAAM,mBAAmB,GAAG,GAAG,EAAE,CAAC,KAAK,EAAE,GAAmB,EAA8B,EAAE;IACxF,OAAO,8BAA8B,CACjC;QACI,aAAa,EAAE,GAAG;QAClB,mBAAmB,EAAE,EAAE;KAC1B,EACD,UAAU,CACb,CAAC;AACN,CAAC,CAAC;AAKF,MAAM,OAAO,wBAAwB;IAGjC,YAAY,WAAiC;QAItC,gBAAW,GAAG,GAAG,EAAE,CAAC,aAAa,CAAC,kBAAkB,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QACxE,uBAAkB,GAAG,GAAG,EAAE,CAAC,kBAAkB,CAAC;QAC9C,kBAAa,GAAG,GAAc,EAAE,CAAC,SAAS,CAAC;QAL9C,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;IACnC,CAAC;CAKJ;AAKD,MAAM,2BAA2B,GAAG,CAAC,SAA+C,EAAE,EAAE;IACpF,OAAO,IAAI,wBAAwB,CAAC,SAAS,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;AAC9E,CAAC,CAAC;AAKF,MAAM,CAAC,KAAK,UAAU,yBAAyB,CAC3C,KAA+B,EAC/B,GAAmB;IAEnB,IAAI,CAAC,GAAG,EAAE;QACN,MAAM,IAAI,KAAK,CAAC,qEAAqE,CAAC,CAAC;KAC1F;IAED,IAAI,gBAAgB,GAAsB,EAAE,CAAC;IAE7C,IAAI;QACA,gBAAgB,GAAG,MAAM,mBAAmB,EAAE,CAAC,GAAG,CAAC,CAAC;KACvD;IAAC,OAAO,KAAK,EAAE;QACZ,MAAM,KAAK,CAAC;KACf;IAED,OAAO,EAAE,gBAAgB,EAAE,gBAAgB,EAAE,CAAC;AAClD,CAAC;AAED,eAAe,0BAA0B,CAAC;IACtC,EAAE,EAAE,oEAAoE;IACxE,MAAM,EAA8B,yBAAyB;IAC7D,KAAK,EAAE,2BAA2B;CACrC,CAAC,CAAC","sourcesContent":["import { buildCacheKey } from '@msdyn365-commerce-modules/retail-actions';\nimport {\n    CacheType,\n    createObservableDataAction,\n    IAction,\n    IActionContext,\n    IActionInput,\n    IAny,\n    ICommerceApiSettings,\n    ICreateActionContext,\n    IGeneric\n} from '@msdyn365-commerce/core';\nimport { OrgUnitLocation, SearchArea } from '@msdyn365-commerce/retail-proxy';\nimport { getOrgUnitLocationsByAreaAsync } from '@msdyn365-commerce/retail-proxy/dist/DataActions/OrgUnitsDataActions.g';\n\ninterface IOrgUnitLocations {\n    orgUnitLocations: OrgUnitLocation[];\n}\n\nconst searchArea: SearchArea = {\n    Radius: Math.max(),\n    DistanceUnitValue: 0 // 0 is miles\n};\n\n/**\n * Calls the Retail API and returns the orgUnitLocations\n */\nconst getOrgUnitLocations = () => async (ctx: IActionContext): Promise<OrgUnitLocation[]> => {\n    return getOrgUnitLocationsByAreaAsync(\n        {\n            callerContext: ctx,\n            queryResultSettings: {}\n        },\n        searchArea\n    );\n};\n\n/**\n *  Action input\n */\nexport class GetOrgUnitLocationsInput implements IActionInput {\n    private apiSettings: ICommerceApiSettings;\n\n    constructor(apiSettings: ICommerceApiSettings) {\n        this.apiSettings = apiSettings;\n    }\n\n    public getCacheKey = () => buildCacheKey(`OrgUnitLocations`, this.apiSettings);\n    public getCacheObjectType = () => `OrgUnitLocations`;\n    public dataCacheType = (): CacheType => 'request';\n}\n\n/**\n * Creates the input required to make the retail api call\n */\nconst createOrgUnitLocationsInput = (inputData: ICreateActionContext<IGeneric<IAny>>) => {\n    return new GetOrgUnitLocationsInput(inputData.requestContext.apiSettings);\n};\n\n/**\n * Get orgUnitLocations action\n */\nexport async function getOrgUnitLocationsAction(\n    input: GetOrgUnitLocationsInput,\n    ctx: IActionContext\n): Promise<IOrgUnitLocations> {\n    if (!ctx) {\n        throw new Error(`getOrgUnitLocationsAction - Action context cannot be null/undefined`);\n    }\n\n    let orgUnitLocations: OrgUnitLocation[] = [];\n\n    try {\n        orgUnitLocations = await getOrgUnitLocations()(ctx);\n    } catch (error) {\n        throw error;\n    }\n\n    return { orgUnitLocations: orgUnitLocations };\n}\n\nexport default createObservableDataAction({\n    id: '@msdyn365-commerce-modules/order-management/get-org-unit-locations',\n    action: <IAction<IOrgUnitLocations>>getOrgUnitLocationsAction,\n    input: createOrgUnitLocationsInput\n});\n"]}