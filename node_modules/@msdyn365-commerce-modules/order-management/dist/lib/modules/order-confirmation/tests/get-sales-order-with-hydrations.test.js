import * as coreActions from '@msdyn365-commerce-modules/retail-actions';
import { buildHydratedMockActionContext } from '@msdyn365-commerce/core';
import * as salesOrderActions from '@msdyn365-commerce/retail-proxy/dist/DataActions/SalesOrdersDataActions.g';
import 'jest';
import { getSalesOrderWithHydrationsAction, GetSalesOrderWithHydrationsInput } from '../../../actions/get-sales-order-with-hydrations';
import { mockProducts, mockRequestContextJson, mockTransaction } from './__mock__';
describe('GetSalesOrderDetailsBySalesIdInput', () => {
    it('Should Create Inputs Properly', () => {
        const actionContext = buildHydratedMockActionContext({ requestContext: mockRequestContextJson });
        const input = new GetSalesOrderWithHydrationsInput('type', '456', actionContext.requestContext.apiSettings);
        expect(input.orderType).toEqual('type');
        expect(input.orderId).toEqual('456');
    });
});
describe('getSalesOrderWithHydrationsAction Unit Tests', () => {
    let actionContext;
    beforeEach(() => {
        jest.mock('@msdyn365-commerce-modules/retail-actions');
        jest.mock('@msdyn365-commerce/retail-proxy/dist/DataActions/SalesOrdersDataActions.g');
        actionContext = buildHydratedMockActionContext({ requestContext: mockRequestContextJson });
        salesOrderActions.GetSalesOrderDetailsByTransactionIdInput = jest.fn();
        salesOrderActions.getSalesOrderDetailsByTransactionIdAsync = jest.fn().mockResolvedValue(mockTransaction);
        coreActions.ProductInput = jest.fn();
        coreActions.getSimpleProducts = jest.fn().mockResolvedValue(mockProducts);
    });
    it('Should fetch sales order and products by transaction id', async () => {
        await getSalesOrderWithHydrationsAction(new GetSalesOrderWithHydrationsInput("transaction", '456', actionContext.requestContext.apiSettings), actionContext)
            .then(response => {
            expect(response.salesOrder.Id).toBe('UiE~EWeXya9o0byTIE7KeP8bIEjpGv9-');
            expect(response.products.length).toBe(2);
            expect(response.products[0].RecordId).toBe(22565430654);
            expect(salesOrderActions.getSalesOrderDetailsByTransactionIdAsync).toBeCalled();
        })
            .catch(error => {
            console.log(error);
            throw new Error('Unable to run getSalesOrderWithHydrationsAction Action');
        });
    });
    afterEach(() => {
        salesOrderActions.getSalesOrderDetailsByTransactionIdAsync.mockReset();
        salesOrderActions.GetSalesOrderDetailsByTransactionIdInput.mockReset();
        coreActions.ProductInput.mockReset();
        coreActions.getSimpleProducts.mockReset();
    });
    afterAll(() => {
        jest.unmock('@msdyn365-commerce-modules/retail-actions');
        jest.unmock('@msdyn365-commerce/retail-proxy/dist/DataActions/SalesOrdersDataActions.g');
    });
});
//# sourceMappingURL=get-sales-order-with-hydrations.test.js.map