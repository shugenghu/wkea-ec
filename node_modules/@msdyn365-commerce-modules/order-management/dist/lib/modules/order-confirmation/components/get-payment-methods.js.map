{"version":3,"file":"get-payment-methods.js","sourceRoot":"./src/","sources":["modules/order-confirmation/components/get-payment-methods.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { PriceComponent } from '@msdyn365-commerce/components';\nimport { TenderLine } from '@msdyn365-commerce/retail-proxy/dist/Entities/CommerceTypes.g';\nimport * as React from 'react';\nimport { IPaymentMethods, IPaymentMethodsInput } from '../../../common';\n\nexport const getOrderConfirmationPaymentMethods = ({\n    priceContext,\n    tenderLines,\n    tenderIdOperationIdMap,\n    resource: { paymentMethodsTitle, creditCardEndingLabel, giftCardEndingLabel, amountCoveredLabel, loyaltyCardUsedLabel, cashUsedLabel }\n}: IPaymentMethodsInput): IPaymentMethods => {\n    const getLastFourDigit = (digits = '') => digits.substr(-4);\n\n    const getCard = (tenderLine: TenderLine) => {\n        const cardLastFourDigit = getLastFourDigit(tenderLine.MaskedCardNumber);\n        // @ts-ignore\n        const isValidCardNumber = cardLastFourDigit && !isNaN(cardLastFourDigit);\n\n        return (\n            <div className='ms-order-confirmation__payment-methods-line' key={tenderLine.TenderTypeId}>\n                <p className='ms-order-confirmation__payment-methods-card'>\n                    {`${tenderLine.CardTypeId} ${isValidCardNumber ? `${creditCardEndingLabel} ${cardLastFourDigit}` : ``}`}\n                </p>\n            </div>);\n    };\n\n    const getGiftCertificate = (tenderLine: TenderLine) => (\n        <div className='ms-order-confirmation__payment-methods-line' key={tenderLine.TenderTypeId}>\n            <p className='ms-order-confirmation__payment-methods-gift-card-number'>\n                {giftCardEndingLabel} {getLastFourDigit(tenderLine.GiftCardId)}\n            </p>\n            <p className='ms-order-confirmation__payment-methods-gift-card-amount-info'>\n                {amountCoveredLabel}\n                <PriceComponent\n                    {...priceContext}\n                    className='ms-order-confirmation__payment-methods-gift-card-amount'\n                    data={{ price: { CustomerContextualPrice: tenderLine.Amount || 0 } }}\n                />\n            </p>\n        </div>\n    );\n\n    const getLoyalty = (tenderLine: TenderLine) => (\n        <div className='ms-order-confirmation__payment-methods-line' key={tenderLine.TenderTypeId}>\n            <p className='ms-order-confirmation__payment-methods-loyalty-number'>\n                {loyaltyCardUsedLabel} {tenderLine.LoyaltyCardId}\n            </p>\n            <p className='ms-order-confirmation__payment-methods-loyalty-amount-info'>\n                {amountCoveredLabel}\n                <PriceComponent\n                    {...priceContext}\n                    className='ms-order-confirmation__payment-methods-loyalty-amount'\n                    data={{ price: { CustomerContextualPrice: tenderLine.Amount || 0 } }}\n                />\n            </p>\n        </div>\n    );\n\n    const getCash = (tenderLine: TenderLine) => (\n        <div className='ms-order-confirmation__payment-methods-line' key={tenderLine.TenderTypeId}>\n            <p className='ms-order-confirmation__payment-methods-cash'>{cashUsedLabel}</p>\n            <p className='ms-order-confirmation__payment-methods-cash-amount-info'>\n                {amountCoveredLabel}\n                <PriceComponent\n                    {...priceContext}\n                    className='ms-order-confirmation__payment-methods-cash-amount'\n                    data={{ price: { CustomerContextualPrice: tenderLine.Amount || 0 } }}\n                />\n            </p>\n        </div>\n    );\n\n    return {\n        paymentMethodsProps: { className: 'ms-order-confirmation__payment-methods' },\n        title: <div className='ms-order-confirmation__payment-methods-title'>{paymentMethodsTitle}</div>,\n        methods: tenderLines.reduce((lines: React.ReactNode[], tenderLine) => {\n            if (!tenderLine.TenderTypeId) {\n                return lines;\n            }\n            switch (tenderIdOperationIdMap[tenderLine.TenderTypeId]) {\n                case 201:\n                    lines.push(getCard(tenderLine));\n                    break;\n                case 214:\n                    lines.push(getGiftCertificate(tenderLine));\n                    break;\n                case 207:\n                    lines.push(getLoyalty(tenderLine));\n                    break;\n                case 200:\n                    lines.push(getCash(tenderLine));\n                    break;\n                default:\n                // do nothing\n            }\n            return lines;\n        },                          [])\n    };\n};\n"]}