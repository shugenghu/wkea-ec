{"version":3,"file":"get-sales-order.js","sourceRoot":"./src/","sources":["modules/order-history/components/get-sales-order.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Button, getPayloadObject, getTelemetryAttributes, INodeProps, ITelemetryContent, TelemetryConstant } from '@msdyn365-commerce-modules/utilities';\nimport { getUrlSync } from '@msdyn365-commerce/core';\nimport { ChannelIdentity, OrderShipments, OrgUnitLocation, SimpleProduct } from '@msdyn365-commerce/retail-proxy';\nimport * as React from 'react';\nimport { getGroups, IGroups } from '../../../common/get-groups';\nimport { getOrderInfomationInput, getOrderInformation, IOrderInformation } from '../../../common/get-order-information';\nimport { getSalesLines, getSalesLinesInput } from '../../../common/get-sales-lines';\nimport { IOrderHistoryData } from '../order-history.data';\nimport { IOrderHistoryProps } from '../order-history.props.autogenerated';\n\nexport interface ISalesOrderProps extends IOrderHistoryProps<IOrderHistoryData> {\n    salesOrder: OrderShipments;\n    products: SimpleProduct[];\n    channelIdentities?: ChannelIdentity[];\n    orgUnitLocations?: OrgUnitLocation[];\n    showChannelInfo?: boolean;\n    telemetryContent?: ITelemetryContent;\n}\n\nexport interface ISalesOrder {\n    salesOrderProps: INodeProps;\n    orderInfomation: IOrderInformation;\n    groups?: IGroups;\n    orderDetailsLink: React.ReactNode;\n}\n\nexport const getSalesOrder = (input: ISalesOrderProps): ISalesOrder => {\n    const {\n        id,\n        typeName,\n        context,\n        telemetry,\n        products,\n        salesOrder,\n        showChannelInfo,\n        channelIdentities,\n        orgUnitLocations,\n        telemetryContent,\n        resources: { freePriceText, detailsAriaLabel, detailsLabel, orderItemLabel, orderItemsLabel },\n        context: { actionContext }\n    } = input;\n\n    const moduleName = 'ms-order-history';\n\n    const priceContext = {\n        id,\n        typeName,\n        context,\n        telemetry,\n        freePriceText\n    };\n\n    const _getorderDetailsPageUrl = (): string => {\n        const url = getUrlSync('orderDetails', actionContext) || '';\n        const separator = url.includes('?') ? '&' : '?';\n        if (salesOrder.SalesId) {\n            // Redirect with sales order sales id\n            return `${url}${separator}salesId=${salesOrder.SalesId}`;\n        } else {\n            // Redirect with sales order transaction id\n            return `${url}${separator}transactionId=${salesOrder.TransactionId}`;\n        }\n    };\n\n    const salesOrderProps = { className: 'ms-order-history__sales-order', key: salesOrder.SalesId || salesOrder.TransactionId };\n\n    const orderInfomationInput = getOrderInfomationInput(input, moduleName, salesOrder, priceContext, channelIdentities, orgUnitLocations, showChannelInfo);\n    const orderInfomation = getOrderInformation(orderInfomationInput);\n\n    const salesLinesInput = products && getSalesLinesInput(input, moduleName, salesOrder, products, priceContext);\n    const salesLines = salesLinesInput && getSalesLines({ ...salesLinesInput, imageOnly: true });\n    const payLoad = getPayloadObject('click', telemetryContent!, TelemetryConstant.OrderDetails);\n    const orderDetailsAttributes = getTelemetryAttributes(telemetryContent!, payLoad);\n\n    const groups =\n        salesLines &&\n        getGroups({\n            moduleName,\n            salesLines,\n            resources: { orderItemLabel, orderItemsLabel }\n        });\n\n    const orderDetailsLink = (\n        <Button\n            href={_getorderDetailsPageUrl()}\n            aria-label={\n                salesOrder.ChannelReferenceId && detailsAriaLabel\n                    ? detailsAriaLabel.replace('{orderId}', salesOrder.ChannelReferenceId)\n                    : ''\n            }\n            className='ms-order-history__btn-order-details'\n            {...orderDetailsAttributes}\n        >\n            {detailsLabel}\n        </Button>\n    );\n\n    return {\n        salesOrderProps,\n        orderInfomation,\n        groups,\n        orderDetailsLink\n    };\n};\n"]}