{"version":3,"file":"get-payment-methods.js","sourceRoot":"./src/","sources":["modules/order-details/components/get-payment-methods.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { PriceComponent } from '@msdyn365-commerce/components';\nimport { TenderLine } from '@msdyn365-commerce/retail-proxy/dist/Entities/CommerceTypes.g';\nimport * as React from 'react';\nimport { IPaymentMethods, IPaymentMethodsInput } from '../../../common';\n\n// tslint:disable-next-line:max-func-body-length\nexport const getOrderDetailsPaymentMethods = ({\n    priceContext,\n    tenderLines,\n    tenderIdOperationIdMap,\n    resource: { paymentMethodsTitle, creditCardEndingLabel, giftCardEndingLabel, amountCoveredLabel, loyaltyCardUsedLabel, cashUsedLabel, customerAccountUsedLabel }\n}: IPaymentMethodsInput): IPaymentMethods => {\n\n    const OPERATIONS = {\n        PayCard: 201,\n        PayGiftCertificate: 214,\n        PayLoyalty: 207,\n        PayCash: 200,\n        PayCustomerAccount: 202,\n    };\n\n    const getLastFourDigit = (digits = '') => digits.substr(-4);\n\n    const getCard = (tenderLine: TenderLine) => {\n        const cardLastFourDigit = getLastFourDigit(tenderLine.MaskedCardNumber);\n        // @ts-ignore\n        const isValidCardNumber = cardLastFourDigit && !isNaN(cardLastFourDigit);\n\n        return (\n            <div className='ms-order-details__payment-methods-line' key={tenderLine.TenderTypeId}>\n                <p className='ms-order-details__payment-methods-card'>\n                    {`${tenderLine.CardTypeId} ${isValidCardNumber ? `${creditCardEndingLabel} ${cardLastFourDigit}` : ``}`}\n                </p>\n            </div>\n        );\n    };\n\n    const getCustomerAccountPayment = (tenderLine: TenderLine) => (\n        <div className='ms-order-details__payment-methods-line' key={tenderLine.TenderTypeId}>\n            <p className='ms-order-details__payment-methods-customer-account'>\n                {customerAccountUsedLabel} {tenderLine.CustomerId}\n            </p>\n            <p className='ms-order-details__payment-methods-customer-account-info'>\n                {amountCoveredLabel}\n                <PriceComponent\n                    {...priceContext}\n                    className='ms-order-details__payment-methods-customer-account-amount'\n                    data={{ price: { CustomerContextualPrice: tenderLine.Amount || 0 } }}\n                />\n            </p>\n        </div>\n    );\n\n    const getGiftCertificate = (tenderLine: TenderLine) => (\n        <div className='ms-order-details__payment-methods-line' key={tenderLine.TenderTypeId}>\n            <p className='ms-order-details__payment-methods-gift-card-number'>\n                {giftCardEndingLabel} {getLastFourDigit(tenderLine.GiftCardId)}\n            </p>\n            <p className='ms-order-details__payment-methods-gift-card-amount-info'>\n                {amountCoveredLabel}\n                <PriceComponent\n                    {...priceContext}\n                    className='ms-order-details__payment-methods-gift-card-amount'\n                    data={{ price: { CustomerContextualPrice: tenderLine.Amount || 0 } }}\n                />\n            </p>\n        </div>\n    );\n\n    const getLoyalty = (tenderLine: TenderLine) => (\n        <div className='ms-order-details__payment-methods-line' key={tenderLine.TenderTypeId}>\n            <p className='ms-order-details__payment-methods-loyalty-number'>\n                {loyaltyCardUsedLabel} {tenderLine.LoyaltyCardId}\n            </p>\n            <p className='ms-order-details__payment-methods-loyalty-amount-info'>\n                {amountCoveredLabel}\n                <PriceComponent\n                    {...priceContext}\n                    className='ms-order-details__payment-methods-loyalty-amount'\n                    data={{ price: { CustomerContextualPrice: tenderLine.Amount || 0 } }}\n                />\n            </p>\n        </div>\n    );\n\n    const getCash = (tenderLine: TenderLine) => (\n        <div className='ms-order-details__payment-methods-line' key={tenderLine.TenderTypeId}>\n            <p className='ms-order-details__payment-methods-cash'>{cashUsedLabel}</p>\n            <p className='ms-order-details__payment-methods-cash-amount-info'>\n                {amountCoveredLabel}\n                <PriceComponent\n                    {...priceContext}\n                    className='ms-order-details__payment-methods-cash-amount'\n                    data={{ price: { CustomerContextualPrice: tenderLine.Amount || 0 } }}\n                />\n            </p>\n        </div>\n    );\n\n    return {\n        paymentMethodsProps: { className: 'ms-order-details__payment-methods' },\n        title: <div className='ms-order-details__payment-methods-title'>{paymentMethodsTitle}</div>,\n        methods: tenderLines.reduce((lines: React.ReactNode[], tenderLine) => {\n            if (!tenderLine.TenderTypeId) {\n                return lines;\n            }\n            switch (tenderIdOperationIdMap[tenderLine.TenderTypeId]) {\n                case OPERATIONS.PayCard:\n                    lines.push(getCard(tenderLine));\n                    break;\n                case OPERATIONS.PayGiftCertificate:\n                    lines.push(getGiftCertificate(tenderLine));\n                    break;\n                case OPERATIONS.PayLoyalty:\n                    lines.push(getLoyalty(tenderLine));\n                    break;\n                case OPERATIONS.PayCash:\n                    lines.push(getCash(tenderLine));\n                    break;\n                case OPERATIONS.PayCustomerAccount:\n                    lines.push(getCustomerAccountPayment(tenderLine));\n                    break;\n                default:\n                // do nothing\n            }\n            return lines;\n        },                          [])\n    };\n};\n"]}