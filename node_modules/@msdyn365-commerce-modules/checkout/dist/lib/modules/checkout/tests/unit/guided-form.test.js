import { shallow } from 'enzyme';
import * as React from 'react';
import GuidedCardComponent from '../../components/guided-card';
import GuidedFormComponent from '../../components/guided-form';
import { mockResources } from '../__mock__';
let mockProps;
let mockModuleState;
const mockItem1 = {
    props: {
        id: 'mock-item-1',
        config: {
            heading: 'mock-heading-1'
        }
    }
};
const mockItem2 = {
    props: {
        id: 'mock-item-2',
        config: {
            heading: 'mock-heading-2'
        }
    }
};
describe('Checkout unit tests - Guided card', () => {
    beforeEach(() => {
        mockModuleState = {
            childIds: ['mock-item-1', 'mock-item-2'],
            init: jest.fn(),
            getModule: jest.fn(() => ({
                hasModuleState: true,
                isDisabled: false
            }))
        };
        mockProps = {
            items: [mockItem1, mockItem2],
            resource: mockResources,
            moduleState: mockModuleState
        };
    });
    it('renders correctly', () => {
        const wrapper = shallow(React.createElement(GuidedFormComponent, Object.assign({}, mockProps)));
        expect(wrapper).toMatchSnapshot();
    });
    it('handles onNext', () => {
        const wrapper = shallow(React.createElement(GuidedFormComponent, Object.assign({}, mockProps)));
        let guidedCards = wrapper.find(GuidedCardComponent);
        expect(guidedCards).toHaveLength(2);
        expect(wrapper.instance().state.currentStep).toBe(0);
        expect(guidedCards.at(0).props()).toMatchObject({
            title: 'mock-heading-1',
            step: 0,
            disabled: false,
            isActive: true,
            isVisted: false,
            isExpanded: true
        });
        expect(guidedCards.at(1).props()).toMatchObject({
            title: 'mock-heading-2',
            step: 1,
            disabled: false,
            isActive: false,
            isVisted: false,
            isExpanded: false
        });
        wrapper.instance().onNext();
        guidedCards = wrapper.find(GuidedCardComponent);
        expect(wrapper.instance().state.currentStep).toBe(1);
        expect(guidedCards.at(0).props()).toMatchObject({
            title: 'mock-heading-1',
            step: 0,
            disabled: false,
            isActive: false,
            isVisted: true,
            isExpanded: true
        });
        expect(guidedCards.at(1).props()).toMatchObject({
            title: 'mock-heading-2',
            step: 1,
            disabled: false,
            isActive: true,
            isVisted: false,
            isExpanded: true
        });
        wrapper.instance().onNext();
        guidedCards = wrapper.find(GuidedCardComponent);
        expect(wrapper.instance().state.currentStep).toBe(2);
        expect(guidedCards.at(0).props()).toMatchObject({
            title: 'mock-heading-1',
            step: 0,
            disabled: false,
            isActive: false,
            isVisted: true,
            isExpanded: true
        });
        expect(guidedCards.at(1).props()).toMatchObject({
            title: 'mock-heading-2',
            step: 1,
            disabled: false,
            isActive: false,
            isVisted: true,
            isExpanded: true
        });
    });
    it('disables the disabled item', () => {
        mockProps = {
            ...mockProps,
            moduleState: {
                ...mockModuleState,
                getModule: jest.fn(id => ({
                    hasModuleState: true,
                    isDisabled: id === 'mock-item-1'
                }))
            }
        };
        const wrapper = shallow(React.createElement(GuidedFormComponent, Object.assign({}, mockProps)));
        let guidedCards = wrapper.find(GuidedCardComponent);
        expect(wrapper.instance().state.currentStep).toBe(0);
        expect(guidedCards.at(0).props()).toMatchObject({
            title: 'mock-heading-1',
            step: -1,
            disabled: true,
            isActive: false,
            isVisted: false,
            isExpanded: false
        });
        expect(guidedCards.at(1).props()).toMatchObject({
            title: 'mock-heading-2',
            step: 0,
            disabled: false,
            isActive: true,
            isVisted: false,
            isExpanded: true
        });
        wrapper.instance().onNext();
        guidedCards = wrapper.find(GuidedCardComponent);
        expect(wrapper.instance().state.currentStep).toBe(1);
        expect(guidedCards.at(0).props()).toMatchObject({
            title: 'mock-heading-1',
            step: -1,
            disabled: true,
            isActive: false,
            isVisted: false,
            isExpanded: false
        });
        expect(guidedCards.at(1).props()).toMatchObject({
            title: 'mock-heading-2',
            step: 0,
            disabled: false,
            isActive: false,
            isVisted: true,
            isExpanded: true
        });
    });
});
//# sourceMappingURL=guided-form.test.js.map