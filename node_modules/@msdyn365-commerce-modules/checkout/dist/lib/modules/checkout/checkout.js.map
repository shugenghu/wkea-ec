{"version":3,"file":"checkout.js","sourceRoot":"./src/","sources":["modules/checkout/checkout.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/ //\nimport { IModuleStateManager, IModuleStateProps, withModuleState } from '@msdyn365-commerce-modules/checkout-utilities';\nimport { getAvailabilitiesForCartLineItems, ProductAvailabilitiesForCartLineItems } from '@msdyn365-commerce-modules/retail-actions';\nimport { Button, getPayloadObject, getTelemetryAttributes, getTelemetryObject, IModuleProps, INodeProps, ITelemetryContent, TelemetryConstant, Waiting } from '@msdyn365-commerce-modules/utilities';\nimport * as Msdyn365 from '@msdyn365-commerce/core';\nimport { Cart } from '@msdyn365-commerce/retail-proxy';\nimport classnames from 'classnames';\nimport get from 'lodash/get';\nimport isEmpty from 'lodash/isEmpty';\nimport { computed, reaction, when } from 'mobx';\nimport { observer } from 'mobx-react';\nimport * as React from 'react';\nimport { ICheckoutData } from './checkout.data';\nimport { ICheckoutHeadingData, ICheckoutProps } from './checkout.props.autogenerated';\nimport AlertComponent from './components/alert';\nimport { getLineItems, ILineItems } from './components/get-line-items';\nimport { getOrderSummary, IOrderSummary } from './components/get-order-summary';\nimport GuidedFormComponent from './components/guided-form';\nimport PlaceOrderButtonComponent from './components/place-order-button';\nimport placeOrder from './methods/place-order';\n\nexport * from './components/get-line-items';\nexport * from './components/get-order-summary';\n\ntype DeviceType = 'Mobile';\n\ninterface ICheckoutState {\n    errorMessage: string;\n}\n\nexport interface ICheckoutViewProps extends ICheckoutProps<ICheckoutData> {\n    className: string;\n    canShow?: boolean;\n    isEmptyCart?: boolean;\n    isConsentGiven?: boolean;\n    hasError?: boolean;\n    cartStatus?: string;\n    isMobile?: boolean;\n    isEditorialMode?: boolean;\n    backToShoppingUrl?: string;\n    editCartLink?: string;\n    hasSalesOrder: boolean;\n\n    checkoutProps: IModuleProps;\n    headerProps: INodeProps;\n    bodyProps: INodeProps;\n    mainProps: INodeProps;\n    mainControlProps: INodeProps;\n    sideProps: INodeProps;\n    sideControlFirstProps: INodeProps;\n    sideControlSecondProps: INodeProps;\n    termsAndConditionsProps: INodeProps;\n\n    guidedForm?: React.ReactNode;\n    title?: React.ReactNode;\n    loading?: React.ReactNode;\n    alert?: React.ReactNode;\n    orderSummary?: IOrderSummary;\n    lineItems?: ILineItems;\n    placeOrderButton?: React.ReactNode;\n    termsAndConditions?: React.ReactNode;\n    keepShoppingButton?: React.ReactNode;\n    orderConfirmation?: React.ReactNode;\n}\n\nexport interface ICheckoutModuleProps extends ICheckoutProps<ICheckoutData>, IModuleStateProps { }\n\n/**\n *\n * CheckoutContainer component\n * @extends {React.Component<ICheckoutModuleProps>}\n */\n// @ts-ignore\n@withModuleState\n@observer\nclass Checkout extends React.Component<ICheckoutModuleProps> {\n\n    @computed get cartStatus(): Msdyn365.AsyncResultStatus {\n        return get(this.props, 'data.checkout.status');\n    }\n\n    @computed get isEmptyCart(): boolean {\n        if (this.isEditorialMode) {\n            // Editorial mode: Ignore empty cart\n            return false;\n        }\n        const cart = get(this.props, 'data.checkout.result.checkoutCart.cart');\n        return this.cartStatus === 'SUCCESS' && !!cart && !isEmpty(cart) && (!cart.CartLines || cart.CartLines.length === 0);\n    }\n\n    @computed get hasError(): boolean {\n        const cart = get(this.props, 'data.checkout.result.checkoutCart.cart');\n        return this.cartStatus === 'FAILED' || (this.cartStatus === 'SUCCESS' && (!cart || isEmpty(cart)));\n    }\n\n    @computed get isEditorialMode(): boolean {\n        return get(this.props, 'context.request.params.isEditor');\n    }\n\n    @computed get canPlaceOrder(): boolean {\n        const isTermsAndConditionAccepted = this.props.data.checkout.result && this.props.data.checkout.result?.isTermsAndConditionAccepted;\n        // if isTermsAndConditionAccepted is undefined means TermsAndCondition module is not added to page and we should able to place order.\n        return this.props.moduleState.isReady && (isTermsAndConditionAccepted === undefined || isTermsAndConditionAccepted) && this.state.errorMessage === '';\n    }\n    public state: ICheckoutState = {\n        errorMessage: ''\n    };\n    private telemetryContent: ITelemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!,\n                                                                     this.props.friendlyName,\n                                                                     this.props.telemetry);\n\n    public componentDidMount(): void {\n        const {\n            resources: { genericErrorMessage }\n        } = this.props;\n        // @ts-ignore: Compiler not reconizing condition check for function params\n        when(\n            () => this.hasError,\n            () => {\n                this.setState({\n                    errorMessage: genericErrorMessage\n                });\n                this.props.context.telemetry.error('Failed to get cart');\n            }\n        );\n\n        // @ts-ignore: Compiler not reconizing condition check for function params\n        when(\n            () => {\n                return this.isEmptyCart;\n            },\n            () => {\n                const editCartLink = Msdyn365.getUrlSync('cart', this.props.context.actionContext) || '';\n                if (window && editCartLink) {\n                    // Redirect to cart page if cart is empty\n                    window.location.assign(editCartLink);\n                } else {\n                    this.setState({\n                        errorMessage: genericErrorMessage\n                    });\n                    this.props.context.telemetry.error('Cart is empty, but no editCartLink found');\n                }\n            }\n        );\n\n        reaction(\n            () => this.props.moduleState.isReady,\n            () => {\n                this.onContainerReady();\n            }\n        );\n    }\n\n    // tslint:disable-next-line:max-func-body-length cyclomatic-complexity\n    public render(): JSX.Element {\n        const {\n            moduleState,\n            config: { className, checkoutHeading, disableGuidedCheckoutFlow },\n            resources\n        } = this.props;\n        const { errorMessage } = this.state;\n        const { backToShopping, placeOrderText, cookieConsentRequiredMessage, genericErrorMessage } = resources;\n        const checkoutClass = classnames('ms-checkout', className);\n        const checkoutInformation = this.getSlotItems('checkoutInformation');\n\n        const isConsentGiven =\n            this.props.context.request &&\n            this.props.context.request.cookies &&\n            this.props.context.request.cookies.isConsentGiven &&\n            this.props.context.request.cookies.isConsentGiven();\n\n        const isMobile =\n            this.props.context.request &&\n            this.props.context.request.device &&\n            (this.props.context.request.device.Type as DeviceType) === 'Mobile';\n\n        const backToShoppingUrl = Msdyn365.getUrlSync('home', this.props.context.actionContext) || '';\n        const editCartLink = Msdyn365.getUrlSync('cart', this.props.context.actionContext) || '';\n\n        const termsAndConditions =\n            this.props.slots.termsAndConditions &&\n            this.props.slots.termsAndConditions.length > 0 &&\n            this.props.slots.termsAndConditions[0];\n\n        const payLoad = getPayloadObject('click', this.telemetryContent, TelemetryConstant.BackToShopping);\n        const backToShoppingAttributes =  getTelemetryAttributes(this.telemetryContent, payLoad);\n\n        let viewProps: ICheckoutViewProps = {\n            ...this.props,\n            className: checkoutClass,\n            isEmptyCart: this.isEmptyCart,\n            isConsentGiven,\n            hasError: this.hasError,\n            hasSalesOrder: this.props.data.checkout && this.props.data.checkout.result !== undefined && this.props.data.checkout.result.salesOrder !== undefined,\n            cartStatus: this.cartStatus,\n            isMobile,\n            backToShoppingUrl,\n            editCartLink,\n            isEditorialMode: this.isEditorialMode,\n            orderConfirmation: this.props.slots.orderConfirmation && this.props.slots.orderConfirmation.length > 0 ? this.props.slots.orderConfirmation[0] : undefined,\n            checkoutProps: { moduleProps: this.props, className: checkoutClass },\n            headerProps: { className: 'ms-checkout__head' },\n            bodyProps: { className: 'ms-checkout__body' },\n            mainProps: { className: 'ms-checkout__main' },\n            mainControlProps: { className: 'ms-checkout__main-control' },\n            sideProps: { className: 'ms-checkout__side' },\n            sideControlFirstProps: { className: 'ms-checkout__side-control-first' },\n            sideControlSecondProps: { className: 'ms-checkout__side-control-second' },\n            termsAndConditionsProps: { className: 'ms-checkout__terms-and-conditions' },\n            title: checkoutHeading && (\n                this.renderMsdyn365Text(checkoutHeading)\n            )\n        };\n\n        if (isConsentGiven === false) {\n            viewProps = {\n                ...viewProps,\n                alert: <AlertComponent {...{ message: cookieConsentRequiredMessage }} />\n            };\n        } else if (this.isLoading()) {\n            viewProps = {\n                ...viewProps,\n                loading: <Waiting className='msc-waiting-circular msc-waiting-lg' />\n            };\n        } else if (this.hasError) {\n            viewProps = {\n                ...viewProps,\n                alert: <AlertComponent {...{ message: genericErrorMessage }} />\n            };\n        } else {\n            viewProps = {\n                ...viewProps,\n                alert: errorMessage && <AlertComponent {...{ message: errorMessage }} />,\n                canShow: true,\n                guidedForm: checkoutInformation ? (\n                    <GuidedFormComponent\n                        {...{\n                            items: checkoutInformation,\n                            moduleState: moduleState,\n                            disableGuidedCheckoutFlow: disableGuidedCheckoutFlow,\n                            resource: resources,\n                            requestContext: this.props.context,\n                            isMobile: isMobile,\n                            isEditor: this.isEditorialMode,\n                            telemetryContent: this.telemetryContent\n                        }}\n                    />\n                ) : (\n                        undefined\n                    ),\n                orderSummary: getOrderSummary(this.props),\n                lineItems: getLineItems(this.props, this.telemetryContent),\n                placeOrderButton: (\n                    <PlaceOrderButtonComponent {...{ placeOrderText, placeOrder: this.onPlaceOrder, canPlaceOrder: this.canPlaceOrder, telemetryContent: this.telemetryContent }} />\n                ),\n                termsAndConditions: termsAndConditions,\n                keepShoppingButton: backToShoppingUrl && (\n                    <Button\n                        className='ms-checkout__btn-keep-shopping msc-btn'\n                        title={backToShopping}\n                        color='secondary'\n                        href={backToShoppingUrl}\n                        {...backToShoppingAttributes}\n                    >\n                        {backToShopping}\n                    </Button>\n                )\n            };\n        }\n\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n\n    public renderMsdyn365Text(checkoutHeading: ICheckoutHeadingData): React.ReactNode {\n        return (\n            <Msdyn365.Text\n                {...checkoutHeading}\n                tag={checkoutHeading.tag || 'h2'}\n                className='ms-checkout__title'\n                text={checkoutHeading.text}\n                editProps={{ onEdit: this.handleCheckoutHeadingChange, requestContext: this.props.context.request }}\n            />\n        );\n    }\n\n    public handleCheckoutHeadingChange = (event: Msdyn365.ContentEditableEvent) => this.props.config.checkoutHeading!.text = event.target.value;\n\n    private isLoading = (): boolean => {\n        return !this.cartStatus || this.cartStatus === 'LOADING' || this.isEmptyCart;\n    }\n\n    private getSlotItems = (key: string): React.ReactNode[] | undefined => {\n        const { slots } = this.props;\n        return slots && slots[key] && slots[key].length ? slots[key] : undefined;\n    };\n\n    private onPlaceOrder = async (): Promise<void> => {\n         const {\n            resources: { checkoutOutOfStockErrorMessage, genericErrorMessage },\n            context: { actionContext, app: { config: { enableStockCheck = false } } },\n            slots: { orderConfirmation },\n            data: { checkout }\n         } = this.props;\n\n         if (enableStockCheck && await this.isOverMaxQuantity((await checkout).checkoutCart.cart)) {\n            this.setState({\n                errorMessage: checkoutOutOfStockErrorMessage\n            });\n            this.props.context.telemetry.error(checkoutOutOfStockErrorMessage);\n        } else {\n            const hasOrderConfirmation = orderConfirmation && orderConfirmation.length > 0;\n            await placeOrder(actionContext, this.props.data.checkout.result, this.props.data.products.result, !hasOrderConfirmation).catch(error => {\n                this.setState({\n                    errorMessage: genericErrorMessage\n                });\n                this.props.telemetry.exception(error);\n            });\n        }\n    };\n\n    // return true if any product in the cart is over its max quantity\n    private isOverMaxQuantity = async (cart: Cart): Promise<boolean> => {\n        let isOverMaxQuantity = false;\n\n        await getAvailabilitiesForCartLineItems(\n            new ProductAvailabilitiesForCartLineItems(this.props.context.actionContext.requestContext.apiSettings),\n            this.props.context.actionContext\n        ).then(productInventoryInformation => {\n            cart.CartLines?.map((cartline) => {\n                if (productInventoryInformation && productInventoryInformation.length > 0) {\n                    const foundProductAvailability = productInventoryInformation.find((productInventory) => {\n                        return productInventory.ProductAvailableQuantity?.ProductId! === cartline.ProductId;\n                    });\n\n                    if (!(foundProductAvailability?.IsProductAvailable && foundProductAvailability.ProductAvailableQuantity.AvailableQuantity !== undefined\n                        && cartline.Quantity && cartline.Quantity <= foundProductAvailability.ProductAvailableQuantity.AvailableQuantity)) {\n                        isOverMaxQuantity = true;\n                    }\n                }\n            });\n        })\n        .catch(error => {\n            this.props.context.actionContext.telemetry.exception(error);\n            throw new Error('[getAvailabilitiesForCartLineItems] Unable to get availabilities for products in checkout cart');\n        });\n\n        return isOverMaxQuantity;\n    }\n\n    private getActiveChildModuleStates = (): IModuleStateManager[] => {\n        const { childIds, getModule } = this.props.moduleState;\n        return childIds\n            .map(getModule)\n            .filter((state): state is IModuleStateManager => !!state && !state.isDisabled && state.hasModuleState);\n    };\n\n    private onContainerReady = (): void => {\n        this.getActiveChildModuleStates().forEach(state => {\n            state.isReady && state.onContainerReady && state.onContainerReady();\n        });\n    };\n}\n\nexport default Checkout;\n"]}