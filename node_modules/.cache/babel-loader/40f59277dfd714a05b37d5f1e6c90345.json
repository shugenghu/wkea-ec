{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/esm/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import{__decorate}from\"tslib\";import{format}from'@msdyn365-commerce-modules/utilities';import{RatingComponent}from'@msdyn365-commerce/components';import*as Msdyn365 from'@msdyn365-commerce/core';import classname from'classnames';import{observer}from'mobx-react';import*as React from'react';import{createRatingsReviewsStateInput}from'../../actions/ratings-reviews-state-data-action';import{AverageRatingNumber,HistogramItems,TotalReviews}from'./component/components';var RatingsHistogram=/*#__PURE__*/function(_React$Component){_inherits(RatingsHistogram,_React$Component);var _super=_createSuper(RatingsHistogram);function RatingsHistogram(props){var _this;_classCallCheck(this,RatingsHistogram);_this=_super.call(this,props);_this.handleHeadingChange=function(event){return _this.props.config.heading.text=event.target.value;};_this.selectFilterBy=_this.selectFilterBy.bind(_assertThisInitialized(_this));return _this;}_createClass(RatingsHistogram,[{key:\"render\",value:function render(){var resources=this.props.resources;var _this$props$config=this.props.config,className=_this$props$config.className,heading=_this$props$config.heading;var ratingsSummary=this.props.data.ratingsSummary.result;var ratingCount=ratingsSummary&&ratingsSummary.totalRatingsCount?\"\".concat(ratingsSummary.totalRatingsCount):'0';var completeClass=classname('ms-ratings-histogram',className);var viewProps=_objectSpread(_objectSpread({},this.props),{},{className:completeClass,callbacks:{selectFilterBy:this.selectFilterBy},moduleProps:{moduleProps:this.props,className:completeClass},histogramItems:ratingsSummary?HistogramItems({ratingsSummary:ratingsSummary,resources:_objectSpread({},resources),locale:this.props.context.request.locale,onClick:this.selectFilterBy}):[],averageRating:ratingsSummary&&/*#__PURE__*/React.createElement(RatingComponent,{avgRating:ratingsSummary.averageRating,ratingCount:ratingCount,ariaLabel:format(this.props.resources.averageRatingAriaLabel,ratingsSummary.averageRating,'5'),readOnly:true,context:this.props.context,hideCount:true,id:this.props.id,typeName:this.props.typeName,data:{}}),averageNumber:ratingsSummary&&/*#__PURE__*/React.createElement(AverageRatingNumber,{summary:ratingsSummary}),totalReviews:ratingsSummary&&/*#__PURE__*/React.createElement(TotalReviews,{summary:ratingsSummary}),ratingsSummaryProps:{className:'ms-ratings-histogram__summary'},heading:heading&&/*#__PURE__*/React.createElement(Msdyn365.Text,{className:'ms-ratings-histogram__heading',tag:heading.tag||'h2',text:heading.text,editProps:{onEdit:this.handleHeadingChange,requestContext:this.props.context.request}}),histogramProps:{className:'ms-ratings-histogram__histogram'}});return this.props.renderView(viewProps);}},{key:\"selectFilterBy\",value:function selectFilterBy(stars){var filterKey=\"\".concat(stars);this.props.context.actionContext.update(createRatingsReviewsStateInput({filterKey:filterKey}),{filterKey:filterKey});}}]);return RatingsHistogram;}(React.Component);RatingsHistogram=__decorate([observer],RatingsHistogram);export default RatingsHistogram;","map":{"version":3,"sources":["modules/ratings-histogram/ratings-histogram.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { format, IModuleProps, INodeProps } from '@msdyn365-commerce-modules/utilities';\nimport { RatingComponent } from '@msdyn365-commerce/components';\nimport * as Msdyn365 from '@msdyn365-commerce/core';\nimport classname from 'classnames';\nimport { observer } from 'mobx-react';\nimport * as React from 'react';\nimport { createRatingsReviewsStateInput } from '../../actions/ratings-reviews-state-data-action';\nimport { AverageRatingNumber, HistogramItems, IHistogramItemViewProps, TotalReviews } from './component/components';\nimport { IRatingsHistogramData } from './ratings-histogram.data';\nimport { IRatingsHistogramProps } from './ratings-histogram.props.autogenerated';\n\nexport interface IRatingsHistogramViewProps extends IRatingsHistogramProps<IRatingsHistogramData> {\n    className: string;\n    histogramItems: IHistogramItemViewProps[];\n    moduleProps: IModuleProps;\n    heading: React.ReactNode;\n    averageRating: React.ReactNode;\n    averageNumber: React.ReactNode;\n    totalReviews: React.ReactNode;\n    histogramProps: INodeProps;\n    ratingsSummaryProps: INodeProps;\n    callbacks: IRatingsHistogramCallbacks;\n}\n\nexport interface IRatingsHistogramCallbacks {\n    selectFilterBy(stars: number): void;\n}\n\n/**\n * RatingsHistogram component\n * @extends {React.Component<IRatingsHistogramProps<IRatingsHistogramData>>}\n */\n@observer\nclass RatingsHistogram extends React.Component<IRatingsHistogramProps<IRatingsHistogramData>> {\n\n    constructor(props: IRatingsHistogramProps<IRatingsHistogramData>) {\n        super(props);\n        this.selectFilterBy = this.selectFilterBy.bind(this);\n    }\n\n    public render(): JSX.Element | null {\n        const { resources } = this.props;\n        const { className, heading  } = this.props.config;\n        const {ratingsSummary: {result: ratingsSummary}} = this.props.data;\n        const ratingCount = ratingsSummary && ratingsSummary.totalRatingsCount  ? `${ratingsSummary.totalRatingsCount}` : '0';\n\n        const completeClass = classname('ms-ratings-histogram', className);\n        const viewProps: IRatingsHistogramViewProps = {\n            ...this.props,\n            className: completeClass,\n            callbacks: {\n                selectFilterBy: this.selectFilterBy\n            },\n            moduleProps: {\n                moduleProps: this.props,\n                className: completeClass\n            },\n            histogramItems: ratingsSummary ? HistogramItems({ratingsSummary: ratingsSummary, resources: {...resources}, locale: this.props.context.request.locale, onClick: this.selectFilterBy}) : [],\n            averageRating: ratingsSummary && (\n                            <RatingComponent\n                                avgRating={ratingsSummary.averageRating!}\n                                ratingCount={ratingCount}\n                                ariaLabel={format(this.props.resources.averageRatingAriaLabel, ratingsSummary.averageRating, '5')}\n                                readOnly={true}\n                                context={this.props.context}\n                                hideCount={true}\n                                id={this.props.id}\n                                typeName={this.props.typeName}\n                                data={{}}\n                            />\n            ),\n            averageNumber: ratingsSummary && <AverageRatingNumber summary={ratingsSummary}/>,\n            totalReviews: ratingsSummary && <TotalReviews summary={ratingsSummary}/>,\n            ratingsSummaryProps: {className: 'ms-ratings-histogram__summary'},\n            heading: heading && (\n                <Msdyn365.Text\n                    className='ms-ratings-histogram__heading'\n                    tag={heading.tag || 'h2'}\n                    text={heading.text}\n                    editProps={{onEdit:this.handleHeadingChange, requestContext: this.props.context.request}}\n                />\n            ),\n            histogramProps: {className: 'ms-ratings-histogram__histogram'}\n        };\n\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n\n    public handleHeadingChange = (event: Msdyn365.ContentEditableEvent) => this.props.config.heading!.text = event.target.value;\n\n    public selectFilterBy(stars: number): void {\n        const filterKey = `${stars}`;\n        this.props.context.actionContext.update(createRatingsReviewsStateInput({filterKey}), {filterKey});\n    }\n}\n\nexport default RatingsHistogram;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}