{"ast":null,"code":"import\"core-js/modules/es.object.assign.js\";import\"core-js/modules/es.regexp.to-string.js\";import{format,getPayloadObject,getTelemetryAttributes,mapToCssModules,UncontrolledTooltip}from'@msdyn365-commerce-modules/utilities';import classNames from'classnames';import*as React from'react';import CarouselContext from'./CarouselContext';import CarouselItem from'./CarouselItem';export default class Carousel extends React.Component{constructor(props){var _this;super(props);_this=this;this.directionTextPrev='prev';this.directionTextNext='next';this.setInterval=function(){let props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:_this.props;_this.clearInterval();const{interval,autoplay}=props;if(interval&&!(autoplay===false)){_this.cycleInterval=setInterval(()=>{props.next();},interval);}};this.clearInterval=()=>{clearInterval(this.cycleInterval);};this.hoverStart=e=>{const{pause,mouseEnter}=this.props;if(pause==='hover'){this.clearInterval();}if(mouseEnter){mouseEnter(e);}};this.hoverEnd=e=>{const{pause,mouseLeave}=this.props;if(pause==='hover'){this.setInterval();}if(mouseLeave){mouseLeave(e);}};this.handleKeyPress=e=>{const{keyboard,previous,next}=this.props;if(keyboard){if(e.keyCode===37){previous();}else if(e.keyCode===39){next();}}};this.renderItems=(carouselItems,className)=>{const{slide,handleOnExiting,handleOnExited,activeIndex}=this.props;const slides=carouselItems&&carouselItems.length?carouselItems.map((slotContent,index)=>{return/*#__PURE__*/React.createElement(CarouselItem,{key:index,onExiting:handleOnExiting,onExited:handleOnExited},slotContent);}):[];return/*#__PURE__*/React.createElement(\"div\",{className:className},slides.map((item,index)=>{const isIn=index===activeIndex;return/*#__PURE__*/React.cloneElement(item,{in:isIn,slide:slide});}));};this._handleKeyPressPrev=e=>{if(e.keyCode===13){e.preventDefault();this.props.previous();}};this._handleKeyPressNext=e=>{if(e.keyCode===13){e.preventDefault();this.props.next();}};this.props=props;this.handleKeyPress=this.handleKeyPress.bind(this);this._handleTouchStart=this._handleTouchStart.bind(this);this._handleTouchEnd=this._handleTouchEnd.bind(this);this.renderItems=this.renderItems.bind(this);this.hoverStart=this.hoverStart.bind(this);this.scrollThreshold=this.props.touchScrollThreshold!==undefined?this.props.touchScrollThreshold:100;this.state={direction:'right',indicatorClicked:false};this._onClickPrev=this._onClickPrev.bind(this);this._onClickNext=this._onClickNext.bind(this);this._handleKeyPressPrev=this._handleKeyPressPrev.bind(this);this._handleKeyPressNext=this._handleKeyPressNext.bind(this);this.linkRefPrev=/*#__PURE__*/React.createRef();this.linkRefNext=/*#__PURE__*/React.createRef();this.payLoad=getPayloadObject('click',this.props.telemetryContent,'');}componentDidMount(){if(this.props.ride==='carousel'){this.setInterval();}document.addEventListener('keyup',this.handleKeyPress);}componentWillReceiveProps(nextProps){this.setInterval(nextProps);const{activeIndex}=this.props;if(activeIndex!==null){if(activeIndex+1===nextProps.activeIndex){this.setState({direction:'right'});}else if(activeIndex-1===nextProps.activeIndex){this.setState({direction:'left'});}else if(activeIndex>nextProps.activeIndex){this.setState({direction:this.state.indicatorClicked?'left':'right'});}else if(activeIndex!==nextProps.activeIndex){this.setState({direction:this.state.indicatorClicked?'right':'left'});}this.setState({indicatorClicked:false});}}componentWillUnmount(){this.clearInterval();document.removeEventListener('keyup',this.handleKeyPress);}render(){const{cssModule,className,transitionType,dismissEnabled,hideFlipper,showPaginationTooltip,items,hideIndicator}=this.props;function carouselClass(transitionTypeValue){switch(transitionTypeValue){case'slide':return'slide';case'fade':return'carousel-fade';default:return null;}}const showTooltip=showPaginationTooltip!==undefined?showPaginationTooltip:true;const outerClasses=mapToCssModules(classNames(className,'msc-carousel',carouselClass(transitionType)),cssModule);const innerClasses=mapToCssModules(classNames('msc-carousel__inner'),cssModule);const dismiss=dismissEnabled&&this._renderDismissCarousel();const indicators=!hideIndicator&&this._renderIndicators(showTooltip);const carouselControls=!hideFlipper&&this._renderCarouselControls(showTooltip);if(items&&items.length){return/*#__PURE__*/React.createElement(CarouselContext.Provider,{value:{direction:this.state.direction}},/*#__PURE__*/React.createElement(\"div\",{className:outerClasses,onMouseEnter:this.hoverStart,onMouseLeave:this.hoverEnd,onTouchStart:this._handleTouchStart,onTouchEnd:this._handleTouchEnd},items&&items.length&&this.renderItems(items,innerClasses),items&&items.length>1&&carouselControls,items&&items.length>1&&indicators,dismiss));}else{return null;}}_handleTouchStart(evt){if(evt.touches.length===0){this.scrollStart=undefined;}else{this.scrollStart=evt.touches[0].screenX;}}_handleTouchEnd(evt){if(evt.changedTouches.length>0&&this.scrollStart!==undefined){const{previous,next}=this.props;const newTarget=evt.changedTouches[0].screenX;const delta=newTarget-this.scrollStart;if(delta>this.scrollThreshold){previous();}if(delta<-this.scrollThreshold){next();}}this.scrollStart=undefined;return;}_renderIndicators(showTooltip){const{items,activeIndex,cssModule,onIndicatorsClickHandler,indicatorAriaText}=this.props;const listClasses=mapToCssModules('msc-carousel__indicators',cssModule);const indicators=items&&items.length&&items.map((item,idx)=>{const indicatorClasses=mapToCssModules(classNames({active:activeIndex===idx}),cssModule);const label=indicatorAriaText?format(indicatorAriaText,idx+1):'';const indicatorId=\"indicatorSlide\"+\"\".concat(idx+1);this.payLoad.contentAction.etext=(idx+1).toString();const attribute=getTelemetryAttributes(this.props.telemetryContent,this.payLoad);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"li\",Object.assign({id:indicatorId,\"aria-label\":label,\"aria-setsize\":items.length,\"aria-posinset\":idx+1,\"aria-selected\":activeIndex===idx?true:false,key:\"\".concat(item.key||item.src).concat(item.caption).concat(item.altText),role:'tab',tabIndex:0,className:indicatorClasses,onClick:e=>{e.preventDefault();onIndicatorsClickHandler(idx);this.setState({indicatorClicked:true});}},attribute)),showTooltip&&/*#__PURE__*/React.createElement(UncontrolledTooltip,{trigger:'hover focus',target:\"\".concat(indicatorId)},label));});return/*#__PURE__*/React.createElement(\"ol\",{className:listClasses,role:'tablist'},indicators);}_renderCarouselControls(showTooltip){const{cssModule,directionTextPrev,directionTextNext}=this.props;const anchorClassesPrev=mapToCssModules('msc-carousel__control__prev',cssModule);const anchorClassesNext=mapToCssModules('msc-carousel__control__next',cssModule);const iconClassesPrev=mapToCssModules('msc-carousel__control__prev__icon',cssModule);const iconClassesNext=mapToCssModules('msc-carousel__control__next__icon',cssModule);const screenReaderClasses=mapToCssModules('screen-reader-only',cssModule);const indexNumber=0;this.payLoad.contentAction.etext=this.directionTextPrev;const prevAttribute=getTelemetryAttributes(this.props.telemetryContent,this.payLoad);this.payLoad.contentAction.etext=this.directionTextNext;const nextAttribute=getTelemetryAttributes(this.props.telemetryContent,this.payLoad);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"a\",Object.assign({className:anchorClassesPrev,role:'button',tabIndex:indexNumber,onClick:this._onClickPrev,onKeyUp:this._handleKeyPressPrev,ref:this.linkRefPrev},prevAttribute),/*#__PURE__*/React.createElement(\"span\",{className:iconClassesPrev,\"aria-hidden\":'true'}),/*#__PURE__*/React.createElement(\"span\",{className:screenReaderClasses},directionTextPrev||this.directionTextPrev)),showTooltip&&/*#__PURE__*/React.createElement(UncontrolledTooltip,{trigger:'hover focus',target:this.linkRefPrev},directionTextPrev),/*#__PURE__*/React.createElement(\"a\",Object.assign({className:anchorClassesNext,role:'button',tabIndex:indexNumber,onClick:this._onClickNext,onKeyUp:this._handleKeyPressNext,ref:this.linkRefNext},nextAttribute),/*#__PURE__*/React.createElement(\"span\",{className:iconClassesNext,\"aria-hidden\":'true'}),/*#__PURE__*/React.createElement(\"span\",{className:screenReaderClasses},directionTextNext||this.directionTextNext)),showTooltip&&/*#__PURE__*/React.createElement(UncontrolledTooltip,{trigger:'hover focus',target:this.linkRefNext},directionTextNext));}_onClickPrev(e){e.preventDefault();this.props.previous();}_onClickNext(e){e.preventDefault();this.props.next();}_renderDismissCarousel(){const{handleDismissCarousel,dismissCarouselAriaText}=this.props;return/*#__PURE__*/React.createElement(\"button\",{className:'msc-carousel__dismiss msi msi-times',\"aria-label\":dismissCarouselAriaText,onClick:handleDismissCarousel});}}Carousel.defaultProps={interval:5000,pause:'hover',keyboard:true,slide:true,hideIndicator:false};","map":{"version":3,"sources":["carousel/Carousel.tsx"],"names":[],"mappings":"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","sourcesContent":["import { format, getPayloadObject, getTelemetryAttributes, IPayLoad, mapToCssModules, UncontrolledTooltip } from '@msdyn365-commerce-modules/utilities';\nimport classNames from 'classnames';\nimport * as React from 'react';\nimport { ICarouselProps } from './Carousel.props';\nimport CarouselContext from './CarouselContext';\nimport CarouselItem from './CarouselItem';\n\nexport interface ICarouselState {\n    direction: string;\n    indicatorClicked: boolean;\n}\n\nexport type carouselTransition = 'slide' | 'fade';\n\n// tslint:disable:no-any\n/**\n * Carousel component\n */\nexport default class Carousel extends React.Component<ICarouselProps, ICarouselState> {\n\n    public static defaultProps: Partial<ICarouselProps> = {\n        interval: 5000,\n        pause: 'hover',\n        keyboard: true,\n        slide: true,\n        hideIndicator: false\n    };\n    public props: ICarouselProps;\n    public state: ICarouselState;\n    public cycleInterval?: any;\n    private scrollStart: number | undefined;\n    private payLoad: IPayLoad;\n    private scrollThreshold: number;\n    private linkRefPrev: React.RefObject<HTMLAnchorElement>;\n    private linkRefNext: React.RefObject<HTMLAnchorElement>;\n    private directionTextPrev: string = 'prev';\n    private directionTextNext: string = 'next';\n\n    constructor(props: ICarouselProps) {\n        super(props);\n        this.props = props;\n        this.handleKeyPress = this.handleKeyPress.bind(this);\n        this._handleTouchStart = this._handleTouchStart.bind(this);\n        this._handleTouchEnd = this._handleTouchEnd.bind(this);\n        this.renderItems = this.renderItems.bind(this);\n        this.hoverStart = this.hoverStart.bind(this);\n        this.scrollThreshold = this.props.touchScrollThreshold !== undefined ? this.props.touchScrollThreshold : 100;\n        this.state = {\n            direction: 'right',\n            indicatorClicked: false\n        };\n        this._onClickPrev = this._onClickPrev.bind(this);\n        this._onClickNext = this._onClickNext.bind(this);\n        this._handleKeyPressPrev = this._handleKeyPressPrev.bind(this);\n        this._handleKeyPressNext = this._handleKeyPressNext.bind(this);\n        this.linkRefPrev = React.createRef();\n        this.linkRefNext = React.createRef();\n        this.payLoad = getPayloadObject('click', this.props.telemetryContent!, '');\n    }\n\n    public componentDidMount(): void {\n        // Set up the cycle\n        if (this.props.ride === 'carousel') {\n            this.setInterval();\n        }\n        // TODO: move this to the specific carousel like bootstrap. Currently it will trigger ALL carousels on the page.\n        document.addEventListener('keyup', this.handleKeyPress);\n    }\n\n    public componentWillReceiveProps(nextProps: any): void {\n        this.setInterval(nextProps);\n\n        const { activeIndex } = this.props;\n\n        if (activeIndex !== null) {\n            // Calculate the direction to turn\n            if (activeIndex + 1 === nextProps.activeIndex) {\n                this.setState({ direction: 'right' });\n            } else if (activeIndex - 1 === nextProps.activeIndex) {\n                this.setState({ direction: 'left' });\n            } else if (activeIndex > nextProps.activeIndex) {\n                this.setState({ direction: this.state.indicatorClicked ? 'left' : 'right' });\n            } else if (activeIndex !== nextProps.activeIndex) {\n                this.setState({ direction: this.state.indicatorClicked ? 'right' : 'left' });\n            }\n            this.setState({ indicatorClicked: false });\n        }\n    }\n\n    public componentWillUnmount(): void {\n        this.clearInterval();\n        document.removeEventListener('keyup', this.handleKeyPress);\n    }\n\n    public setInterval = (props: ICarouselProps = this.props) => {\n        // make sure not to have multiple intervals going...\n        this.clearInterval();\n\n        const { interval, autoplay } = props;\n        if (interval && !(autoplay === false)) {\n            this.cycleInterval = setInterval(() => {\n                props.next();\n            },\n                // tslint:disable-next-line\n                interval\n            );\n        }\n    }\n\n    public clearInterval = () => {\n        clearInterval(this.cycleInterval);\n    }\n\n    public hoverStart = (e: React.MouseEvent) => {\n        const { pause, mouseEnter } = this.props;\n\n        if (pause === 'hover') {\n            this.clearInterval();\n        }\n\n        if (mouseEnter) {\n            mouseEnter(e);\n        }\n    }\n\n    public hoverEnd = (e: React.MouseEvent) => {\n        const { pause, mouseLeave } = this.props;\n\n        if (pause === 'hover') {\n            this.setInterval();\n        }\n\n        if (mouseLeave) {\n            mouseLeave(e);\n        }\n    }\n\n    public handleKeyPress = (e: any) => {\n        const { keyboard, previous, next } = this.props;\n\n        if (keyboard) {\n            if (e.keyCode === 37) {\n                previous();\n            } else if (e.keyCode === 39) {\n                next();\n            }\n        }\n    }\n\n    public renderItems = (carouselItems: React.ReactNode[], className: string) => {\n        const { slide, handleOnExiting, handleOnExited, activeIndex } = this.props;\n\n        const slides = carouselItems && carouselItems.length ? (\n            carouselItems.map((slotContent: React.ReactNode, index: number) => {\n                return (\n                    <CarouselItem key={index} onExiting={handleOnExiting} onExited={handleOnExited}>\n                        {slotContent}\n                    </CarouselItem>\n                );\n            })\n        ) : (\n                []\n            );\n\n        return (\n            <div className={className}>\n                {slides.map((item: any, index: any) => {\n                    const isIn = (index === activeIndex);\n\n                    return React.cloneElement(item, {\n                        in: isIn,\n                        slide: slide,\n                    });\n                })}\n            </div>\n        );\n    }\n\n    public render(): JSX.Element | null {\n        const { cssModule, className, transitionType, dismissEnabled, hideFlipper, showPaginationTooltip, items, hideIndicator } = this.props;\n\n        function carouselClass(transitionTypeValue: any):any {\n            switch(transitionTypeValue) {\n                case 'slide':\n                   return 'slide';\n                case 'fade':\n                   return 'carousel-fade';\n                default:\n                   return null;\n            }\n        }\n\n        const showTooltip = showPaginationTooltip !== undefined ? showPaginationTooltip : true;\n\n        const outerClasses = mapToCssModules(classNames(className,'msc-carousel', carouselClass(transitionType)), cssModule);\n        const innerClasses = mapToCssModules(classNames('msc-carousel__inner'), cssModule);\n        const dismiss = dismissEnabled && this._renderDismissCarousel();\n        const indicators = !hideIndicator && this._renderIndicators(showTooltip);\n        const carouselControls = !hideFlipper && this._renderCarouselControls(showTooltip);\n\n        if (items && items.length) {\n                // Rendering indicators, slides and controls\n                return (\n                    <CarouselContext.Provider\n                        value={{ direction: this.state.direction }}\n                    >\n                        <div\n                            className={outerClasses}\n                            onMouseEnter={this.hoverStart}\n                            onMouseLeave={this.hoverEnd}\n                            onTouchStart={this._handleTouchStart}\n                            onTouchEnd={this._handleTouchEnd}\n                        >\n                            {items && items.length &&  this.renderItems(items, innerClasses)}\n                            {items && items.length > 1 && carouselControls}\n                            {items && items.length > 1 && indicators}\n                            {dismiss}\n                        </div>\n                    </CarouselContext.Provider>\n                );\n        } else {\n            return (null);\n        }\n\n    }\n\n    private _handleTouchStart(evt: React.TouchEvent<HTMLDivElement>): void {\n        if (evt.touches.length === 0) {\n            this.scrollStart = undefined;\n        } else {\n            this.scrollStart = evt.touches[0].screenX;\n        }\n    }\n\n    private _handleTouchEnd(evt: React.TouchEvent<HTMLDivElement>): void {\n        if (evt.changedTouches.length > 0 && this.scrollStart !== undefined) {\n            const { previous, next } = this.props;\n            const newTarget: number = evt.changedTouches[0].screenX;\n\n            const delta = newTarget - this.scrollStart;\n\n            if (delta > this.scrollThreshold) {\n                previous();\n            }\n\n            if (delta < -this.scrollThreshold) {\n                next();\n            }\n        }\n\n        this.scrollStart = undefined;\n\n        return;\n    }\n\n    private _renderIndicators(showTooltip: boolean): JSX.Element {\n        const { items, activeIndex, cssModule, onIndicatorsClickHandler, indicatorAriaText } = this.props;\n\n        const listClasses = mapToCssModules('msc-carousel__indicators', cssModule);\n        const indicators = items && items.length && items.map((item: any, idx: number) => {\n          const indicatorClasses = mapToCssModules(classNames(\n            { active: activeIndex === idx }\n          ),                                       cssModule);\n\n          const label = indicatorAriaText ? format(indicatorAriaText, idx + 1) : '';\n          const indicatorId = `indicatorSlide` + `${idx + 1}`;\n          this.payLoad.contentAction.etext = (idx + 1).toString();\n          const attribute = getTelemetryAttributes(this.props.telemetryContent!, this.payLoad);\n\n          return (\n            <>\n                <li\n                    id={indicatorId}\n                    aria-label = {label}\n                    aria-setsize = {items.length}\n                    aria-posinset = {idx + 1}\n                    aria-selected={activeIndex === idx? true : false}\n                    key={`${item.key || item.src}${item.caption}${item.altText}`}\n                    role='tab'\n                    tabIndex={0}\n                    className={indicatorClasses}\n                    // tslint:disable-next-line\n                    onClick={(e) => {\n                        e.preventDefault();\n                        onIndicatorsClickHandler(idx);\n                        this.setState({indicatorClicked: true });\n                    }}\n                    {...attribute}\n                />\n                {   showTooltip && <UncontrolledTooltip trigger={'hover focus'} target={`${indicatorId}`}>{label}</UncontrolledTooltip>}\n            </>\n            );\n        });\n\n        return (\n                <ol className={listClasses} role='tablist'>\n                    {indicators}\n                </ol>\n            );\n    }\n\n    private _renderCarouselControls(showTooltip: boolean): JSX.Element {\n        const { cssModule, directionTextPrev, directionTextNext } = this.props;\n\n        const anchorClassesPrev = mapToCssModules('msc-carousel__control__prev', cssModule);\n        const anchorClassesNext = mapToCssModules('msc-carousel__control__next', cssModule);\n        const iconClassesPrev = mapToCssModules('msc-carousel__control__prev__icon', cssModule);\n        const iconClassesNext = mapToCssModules('msc-carousel__control__next__icon', cssModule);\n        const screenReaderClasses = mapToCssModules('screen-reader-only', cssModule);\n        const indexNumber: number = 0;\n        this.payLoad.contentAction.etext = this.directionTextPrev;\n        const prevAttribute = getTelemetryAttributes(this.props.telemetryContent!, this.payLoad);\n        this.payLoad.contentAction.etext = this.directionTextNext;\n        const nextAttribute = getTelemetryAttributes(this.props.telemetryContent!, this.payLoad);\n\n        return (\n            <>\n                <a\n                    className={anchorClassesPrev}\n                    role='button'\n                    tabIndex={indexNumber}\n                    onClick={this._onClickPrev}\n                    onKeyUp={this._handleKeyPressPrev}\n                    ref={this.linkRefPrev}\n                    {...prevAttribute}\n                >\n                    <span className={iconClassesPrev} aria-hidden='true' />\n                    <span className={screenReaderClasses}>{directionTextPrev || this.directionTextPrev}</span>\n                </a>\n                {showTooltip && <UncontrolledTooltip trigger={'hover focus'} target={this.linkRefPrev}>{directionTextPrev}</UncontrolledTooltip>}\n                <a\n                    className={anchorClassesNext}\n                    role='button'\n                    tabIndex={indexNumber}\n                    onClick={this._onClickNext}\n                    onKeyUp={this._handleKeyPressNext}\n                    ref={this.linkRefNext}\n                    {...nextAttribute}\n                >\n                    <span className={iconClassesNext} aria-hidden='true' />\n                    <span className={screenReaderClasses}>{directionTextNext || this.directionTextNext}</span>\n                </a>\n                {showTooltip && <UncontrolledTooltip trigger={'hover focus'} target={this.linkRefNext}>{directionTextNext}</UncontrolledTooltip>}\n            </>\n        );\n    }\n\n    private _onClickPrev(e: React.MouseEvent): void {\n        e.preventDefault();\n        this.props.previous();\n    }\n\n    private _onClickNext(e: React.MouseEvent): void {\n        e.preventDefault();\n        this.props.next();\n    }\n\n    private _handleKeyPressPrev = (e: React.KeyboardEvent) => {\n        if (e.keyCode === 13) {\n            e.preventDefault();\n            this.props.previous();\n        }\n    }\n\n    private _handleKeyPressNext = (e: React.KeyboardEvent) => {\n        // Handle Enter key\n        if (e.keyCode === 13) {\n            e.preventDefault();\n            this.props.next();\n        }\n    }\n\n    private _renderDismissCarousel(): JSX.Element {\n        const { handleDismissCarousel, dismissCarouselAriaText } = this.props;\n        return (\n            <button\n                className='msc-carousel__dismiss msi msi-times'\n                aria-label={dismissCarouselAriaText}\n                onClick={handleDismissCarousel}\n            />\n        );\n    }\n}"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}