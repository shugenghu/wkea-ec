{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _asyncToGenerator from\"@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import{buildCacheKeyWithUrlTokens,getList,ListInput}from'@msdyn365-commerce-modules/retail-actions';import{createObservableDataAction}from'@msdyn365-commerce/core';export var ListPageSummaryInput=function ListPageSummaryInput(config,requestContext){var _this=this;_classCallCheck(this,ListPageSummaryInput);this.getCacheObjectType=function(){return'ListPageSummary';};this.getCacheKey=function(){return buildCacheKeyWithUrlTokens('ListPageSummary',_this.requestContext);};this.dataCacheType=function(){return'request';};this.config=config||{};this.requestContext=requestContext;};function getSubListUrl(listName,sitePath){if(!listName){return'';}if(!sitePath){return\"/\".concat(listName,\".l\");}return\"\".concat(sitePath,\"/\").concat(listName,\".l\");}function getSubListItem(item,sitePathOfRequest){var imageList=getImages(item.fields.content.images);var sublistHref=getSubListUrl(item.fields._name,sitePathOfRequest);return{Title:item.fields.content.title,Description:item.fields.content.description,ShortDescription:item.fields.content.shortDescription,BackgroundColor:item.fields.content.backgroundColor,ForegroundColor:item.fields.content.foregroundColor,Href:sublistHref,Images:imageList};}function getSitePath(inputData){return inputData&&inputData.requestContext&&inputData.requestContext.sitePath?inputData.requestContext.sitePath:'';}function getItemsPerPage(inputData){if(!inputData||!inputData.config||!inputData.config.itemsPerPage){return 50;}var result=Number(inputData.config.itemsPerPage);if(isNaN(result)){return 50;}return result;}function getSkipCount(inputData){return inputData&&inputData.requestContext&&inputData.requestContext.query&&inputData.requestContext.query.skipCount?Number(inputData.requestContext.query.skipCount):0;}function getImages(images){var resultImageList=[];if(!images){return resultImageList;}images.forEach(function(item){if(item&&item.image&&item.image.href){var imageItem={href:item.image.href,altText:item.image.altText,title:item.image.title,width:item.image.width,height:item.image.height};resultImageList.push(imageItem);}});return resultImageList;}function getInputListData(inputData){var listData=!inputData||!inputData.requestContext||!inputData.requestContext.pageData?null:inputData.requestContext.pageData.list;if(!inputData||!inputData.requestContext||!inputData.requestContext.pageData||!inputData.requestContext.pageData.list||!inputData.requestContext.pageData.list.content||!inputData.requestContext.pageData.list.content.items||!inputData.requestContext.pageData.list.content.title||!inputData.requestContext.pageData.list._id){if(!inputData||!inputData.data||!inputData.data.list||!inputData.data.list.content||!inputData.data.list.content.items||!inputData.data.list.content.title||!inputData.data.list._id){console.error('data is not well defined for list action input');throw new Error('data is not well defined for list action input');}listData=inputData.data.list;}return listData;}var createGetListInput=function createGetListInput(inputData){var listData=getInputListData(inputData);var listItems=[];var productList=[];var parentImageList=getImages(listData.content.images);var itemsPerPage=getItemsPerPage(inputData);var skipCount=getSkipCount(inputData);var productItems=[];var sum=skipCount+itemsPerPage;for(var index=skipCount;index<listData.content.items.length&&index<sum;index++){var item=listData.content.items[index];if(item.type===\"list\"){if(!item.fields||!item.fields.content||!item.fields.content.title){console.error(\"sublist item fields, content or title missing in list \".concat(listData._id));continue;}if(!(productList.length===0)){var clonedList=_toConsumableArray(productList);listItems.push(clonedList);productList=[];}listItems.push(getSubListItem(item,getSitePath(inputData)));}if(item.type===\"product\"){if(!item.fields||!item.fields.recordId){console.error(\"product item missing recordId in list \".concat(listData._id));continue;}var productItem={RecordId:item.fields.recordId,CatalogId:item.fields.catalogId||'0'};productList.push(productItem);productItems.push(productItem);}}if(!(productList.length===0)){listItems.push(productList);}return new ListInput(listData._id,listData.content.title,listData.content.description,listData.content.shortDescription,listData.content.backgroundColor,listData.content.foregroundColor,parentImageList,listItems,productItems,listData.content.items.length,itemsPerPage,skipCount);};var action=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(input,context){var config,listData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:config=input.config;_context.prev=1;_context.next=4;return getList(createGetListInput(context),context);case 4:listData=_context.sent;_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](1);case 9:if(!(listData&&listData.Title)){_context.next=13;break;}return _context.abrupt(\"return\",{title:listData.Title,description:listData.Description});case 13:if(!config){_context.next=17;break;}return _context.abrupt(\"return\",{title:config.title,description:config.description});case 17:return _context.abrupt(\"return\",{});case 18:case\"end\":return _context.stop();}}},_callee,null,[[1,7]]);}));return function action(_x,_x2){return _ref.apply(this,arguments);};}();export default createObservableDataAction({id:'@msdyn365-commerce-modules/page-summary/list-page-summary',action:action,input:function input(args){return new ListPageSummaryInput(args.config,args.requestContext);}});","map":{"version":3,"sources":["modules/list-page-summary/list-page-summary.action.ts"],"names":[],"mappings":"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","sourcesContent":["import { Image, ISubList } from '@msdyn365-commerce-modules/data-types';\nimport { buildCacheKeyWithUrlTokens, getList, ListInput } from '@msdyn365-commerce-modules/retail-actions';\nimport { IProductItem } from '@msdyn365-commerce-modules/retail-actions/dist/types/get-list';\nimport {\n    CacheType,\n    createObservableDataAction,\n    IAction,\n    IActionContext,\n    IActionInput,\n    IAny,\n    ICreateActionContext,\n    IGeneric,\n    IRequestContext\n} from '@msdyn365-commerce/core';\nimport { IDefaultPageSummaryConfig } from '../default-page-summary/default-page-summary.props.autogenerated';\nimport { IPageSummaryData } from '../IPageSummaryData';\n\n/** List Page Summary Input */\nexport class ListPageSummaryInput implements IActionInput {\n    public requestContext: IRequestContext;\n    public config: IDefaultPageSummaryConfig;\n\n    constructor(config: IDefaultPageSummaryConfig, requestContext: IRequestContext) {\n        this.config = config || {};\n        this.requestContext = requestContext;\n    }\n\n    public getCacheObjectType = (): string => 'ListPageSummary';\n    public getCacheKey = (): string => buildCacheKeyWithUrlTokens('ListPageSummary', this.requestContext);\n    public dataCacheType = (): CacheType => 'request';\n}\n\n/**\n * List item type enum\n */\nconst enum ListItemType {\n    list = 'list',\n    product = 'product'\n}\n\n/**\n * Get the url of sub list.\n */\nfunction getSubListUrl(listName: string, sitePath: string): string {\n    if (!listName) {\n        return '';\n    }\n\n    if (!sitePath) {\n        return `/${listName}.l`;\n    }\n\n    // sitePath has a leading '/'\n    return `${sitePath}/${listName}.l`;\n}\n\n/**\n * Get sub list item.\n */\nfunction getSubListItem(item: IGeneric<IAny>, sitePathOfRequest: string): ISubList {\n    const imageList: Image[] = getImages(item.fields.content.images);\n\n    const sublistHref = getSubListUrl(item.fields._name, sitePathOfRequest);\n    return {\n        Title: item.fields.content.title,\n        Description: item.fields.content.description,\n        ShortDescription: item.fields.content.shortDescription,\n        BackgroundColor: item.fields.content.backgroundColor,\n        ForegroundColor: item.fields.content.foregroundColor,\n        Href: sublistHref,\n        Images: imageList\n    };\n}\n\n/**\n * Get site path\n */\nfunction getSitePath(inputData: ICreateActionContext<IGeneric<IAny>, IGeneric<IAny>>): string {\n    // @ts-ignore\n    return inputData && inputData.requestContext && inputData.requestContext.sitePath ? inputData.requestContext.sitePath : '';\n}\n\n/**\n * Get items per page\n */\nfunction getItemsPerPage(inputData: ICreateActionContext<IGeneric<IAny>, IGeneric<IAny>>): number {\n    if (!inputData || !inputData.config || !inputData.config.itemsPerPage) {\n        return 50;\n    }\n\n    const result = Number(inputData.config.itemsPerPage);\n    if (isNaN(result)) {\n        return 50;\n    }\n\n    return result;\n}\n\n/**\n * Get skip count\n */\nfunction getSkipCount(inputData: ICreateActionContext<IGeneric<IAny>, IGeneric<IAny>>): number {\n    return inputData && inputData.requestContext && inputData.requestContext.query && inputData.requestContext.query.skipCount\n        ? Number(inputData.requestContext.query.skipCount)\n        : 0;\n}\n\n/**\n * Get images.\n */\nfunction getImages(images: IGeneric<IAny>[]): Image[] {\n    const resultImageList: Image[] = [];\n\n    if (!images) {\n        return resultImageList;\n    }\n\n    images.forEach(item => {\n        if (item && item.image && item.image.href) {\n            // add image item\n            const imageItem: Image = {\n                href: item.image.href,\n                altText: item.image.altText,\n                title: item.image.title,\n                width: item.image.width,\n                height: item.image.height\n            };\n\n            resultImageList.push(imageItem);\n        }\n    });\n\n    return resultImageList;\n}\n\n/**\n * Get input list data.\n */\nfunction getInputListData(inputData: ICreateActionContext<IGeneric<IAny>, IGeneric<IAny>>): IGeneric<IAny> {\n    let listData =\n        !inputData || !inputData.requestContext || !inputData.requestContext.pageData ? null : inputData.requestContext.pageData.list;\n    if (\n        !inputData ||\n        !inputData.requestContext ||\n        !inputData.requestContext.pageData ||\n        !inputData.requestContext.pageData.list ||\n        !inputData.requestContext.pageData.list.content ||\n        !inputData.requestContext.pageData.list.content.items ||\n        !inputData.requestContext.pageData.list.content.title ||\n        !inputData.requestContext.pageData.list._id\n    ) {\n        if (\n            !inputData ||\n            !inputData.data ||\n            !inputData.data.list ||\n            !inputData.data.list.content ||\n            !inputData.data.list.content.items ||\n            !inputData.data.list.content.title ||\n            !inputData.data.list._id\n        ) {\n            console.error('data is not well defined for list action input');\n            throw new Error('data is not well defined for list action input');\n        }\n\n        listData = inputData.data.list;\n    }\n    return listData;\n}\n\nconst createGetListInput = (inputData: IActionContext): ListInput => {\n    const listData: IGeneric<IAny> = getInputListData(inputData);\n    const listItems: (IProductItem[] | ISubList)[] = [];\n    let productList: IProductItem[] = [];\n\n    const parentImageList: Image[] = getImages(listData.content.images);\n\n    const itemsPerPage = getItemsPerPage(inputData);\n    const skipCount = getSkipCount(inputData);\n\n    // This is the list contains all product and will be used to call getSimpleProducts data action.\n    const productItems: IProductItem[] = [];\n    const sum = skipCount + itemsPerPage;\n    for (let index = skipCount; index < listData.content.items.length && index < sum; index++) {\n        const item = listData.content.items[index];\n        if (item.type === ListItemType.list) {\n            if (!item.fields || !item.fields.content || !item.fields.content.title) {\n                console.error(`sublist item fields, content or title missing in list ${listData._id}`);\n                continue;\n            }\n\n            // if any elements in product list, then copy it and add to list items\n            if (!(productList.length === 0)) {\n                const clonedList = [...productList];\n                listItems.push(clonedList);\n                productList = [];\n            }\n\n            // build and add sublist item\n            listItems.push(getSubListItem(item, getSitePath(inputData)));\n        }\n\n        if (item.type === ListItemType.product) {\n            if (!item.fields || !item.fields.recordId) {\n                console.error(`product item missing recordId in list ${listData._id}`);\n                continue;\n            }\n\n            // add product item\n            const productItem: IProductItem = {\n                RecordId: item.fields.recordId,\n                CatalogId: item.fields.catalogId || '0'\n            };\n\n            productList.push(productItem);\n            productItems.push(productItem);\n        }\n    }\n\n    // save the last portion of product items.\n    if (!(productList.length === 0)) {\n        listItems.push(productList);\n    }\n\n    return new ListInput(\n        listData._id,\n        listData.content.title,\n        listData.content.description,\n        listData.content.shortDescription,\n        listData.content.backgroundColor,\n        listData.content.foregroundColor,\n        parentImageList,\n        listItems,\n        productItems,\n        listData.content.items.length,\n        itemsPerPage,\n        skipCount\n    );\n};\n\nconst action = async (input: ListPageSummaryInput, context: IActionContext): Promise<IPageSummaryData> => {\n    const { config } = input;\n    let listData;\n    try {\n        listData = await getList(createGetListInput(context), context);\n    } catch (e) {\n        // Do nothing, if there's an error running the action fall back to values defined from data\n    }\n    if (listData && listData.Title) {\n        return {\n            title: listData.Title,\n            description: listData.Description\n        };\n        // If the action fails fallback to values defined from data\n    } else if (config) {\n        return {\n            title: config.title,\n            description: config.description\n        };\n    } else {\n        return {};\n    }\n};\n\nexport default createObservableDataAction({\n    id: '@msdyn365-commerce-modules/page-summary/list-page-summary',\n    action: <IAction<IPageSummaryData>>action,\n    input: (args: ICreateActionContext) => {\n        return new ListPageSummaryInput(<IDefaultPageSummaryConfig>args.config, args.requestContext);\n    }\n});\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}