{"ast":null,"code":"import{getFallbackImageUrl}from'@msdyn365-commerce-modules/retail-actions';import{Alert,Button,getPayloadObject,getTelemetryAttributes}from'@msdyn365-commerce-modules/utilities';import{PriceComponent}from'@msdyn365-commerce/components';import{Image}from'@msdyn365-commerce/core';import*as React from'react';import{WishlistItemDimension}from'./wishlist-items-dimensions';var _addItemToCart=function _addItemToCart(props){var product=props.product,itemKey=props.itemKey,handlers=props.handlers;var onAddToCart=handlers.onAddToCart;onAddToCart&&product&&itemKey&&onAddToCart(product,itemKey);};var _removeItemFromWishlist=function _removeItemFromWishlist(props){var onRemoveItem=props.handlers.onRemoveItem;var RecordId=props.product.RecordId;onRemoveItem&&RecordId&&onRemoveItem(RecordId);};var WishListItemActions={addToCart:_addItemToCart,removeItem:_removeItemFromWishlist};export var WishlistItem=function WishlistItem(input){var product=input.product,productUrl=input.productUrl,price=input.price,context=input.context,imageSettings=input.imageSettings,isInStock=input.isInStock,removeFromWishlistText=input.removeFromWishlistText,addToCartText=input.addToCartText,outOfStockText=input.outOfStockText,wishlistState=input.wishlistState,itemKey=input.itemKey,handlers=input.handlers,enableImageProductLink=input.enableImageProductLink,inventoryInformationLabel=input.inventoryInformationLabel,inventoryLabelClassName=input.inventoryLabelClassName,telemetryContent=input.telemetryContent;if(!product){return null;}var RecordId=product.RecordId,Name=product.Name,PrimaryImageUrl=product.PrimaryImageUrl,Dimensions=product.Dimensions;var addItemAction=function addItemAction(event){return WishListItemActions.addToCart(input);};var removeItemAction=function removeItemAction(event){return WishListItemActions.removeItem(input);};var onDismiss=handlers.onDismiss;var inventoryCssName=inventoryLabelClassName?\"ms-wishlist-items__inventory-label \".concat(inventoryLabelClassName):'ms-wishlist-items__inventory-label';var fallbackImage=getFallbackImageUrl(product.ItemId,context.actionContext.requestContext.apiSettings);var payLoad=getPayloadObject('click',telemetryContent,'',RecordId.toString());var productAttributes=getTelemetryAttributes(telemetryContent,payLoad);var PRODUCTASSERVICE=2;var isServiceItem=product.ItemTypeValue===PRODUCTASSERVICE;return{key:\"\".concat(RecordId,\"-item\"),productImage:PrimaryImageUrl&&Name&&_renderProductImage(context,product.Name,PrimaryImageUrl,fallbackImage,imageSettings),productLink:productUrl&&/*#__PURE__*/React.createElement(\"a\",Object.assign({href:productUrl,className:'ms-wishlist-items__product-link'},productAttributes,{\"aria-label\":_renderAriaLabel(input)}),Name),productDimensions:Dimensions&&_renderProductDimensions(input),productPrice:price&&_renderPrice(input),entireProductLink:enableImageProductLink?productUrl:undefined,productAriaLabel:enableImageProductLink?_renderAriaLabel(input):undefined,productName:enableImageProductLink&&/*#__PURE__*/React.createElement(\"div\",{className:'ms-wishlist-items__product-title'},Name),addToCartButton:/*#__PURE__*/React.createElement(Button,{className:'ms-wishlist-items__product-add-button',title:(isServiceItem||isInStock)&&addToCartText||outOfStockText,onClick:addItemAction,disabled:!(isServiceItem||isInStock)},(isServiceItem||isInStock)&&addToCartText||outOfStockText),inventoryInformation:inventoryInformationLabel&&/*#__PURE__*/React.createElement(\"span\",{className:inventoryCssName},inventoryInformationLabel),removeButton:/*#__PURE__*/React.createElement(\"button\",{className:'ms-wishlist-items__product-remove-button',\"aria-label\":removeFromWishlistText,onClick:removeItemAction}),productStatusMessage:wishlistState&&wishlistState.isOpen&&wishlistState.productId===RecordId&&wishlistState.itemKey===itemKey&&/*#__PURE__*/React.createElement(\"div\",{className:'ms-wishlist-items__product-status'},/*#__PURE__*/React.createElement(Alert,{color:wishlistState.statusCssString,isOpen:wishlistState.isOpen,toggle:onDismiss},/*#__PURE__*/React.createElement(\"span\",null,wishlistState.userMessage)))};};var _renderProductImage=function _renderProductImage(context,heading,image,fallbackImage,imageSettings){var defaultImageSettings={viewports:{xs:{q:\"w=315&h=315&m=6\",w:0,h:0},lg:{q:\"w=315&h=315&m=6\",w:0,h:0},xl:{q:\"w=315&h=315&m=6\",w:0,h:0}},lazyload:true};if(image){return/*#__PURE__*/React.createElement(Image,{className:'ms-wishlist-items__product-image',altText:heading,title:heading,src:image,fallBackSrc:fallbackImage,gridSettings:context.request.gridSettings,imageSettings:imageSettings||defaultImageSettings,loadFailureBehavior:'empty'});}return null;};var _renderPrice=function _renderPrice(props){var price=props.price,context=props.context,moduleId=props.moduleId,moduleTypeName=props.moduleTypeName,resources=props.resources;if(price){return/*#__PURE__*/React.createElement(PriceComponent,{id:moduleId,typeName:moduleTypeName,data:{price:price},className:'ms-wishlist-items__product-price',freePriceText:resources.freePriceText,originalPriceText:resources.originalPriceText,currentPriceText:resources.currentPriceText,context:context});}return null;};var _renderProductDimensions=function _renderProductDimensions(props){var product=props.product,resources=props.resources;if(!product||!product.Dimensions){return[];}return product.Dimensions.map(function(dimension,index){if(!dimension.DimensionValue||!dimension.DimensionValue.Value){return undefined;}var type='';switch(dimension.DimensionTypeValue){case 1:{type=resources.productDimensionTypeColor;break;}case 3:{type=resources.productDimensionTypeSize;break;}case 4:{type=resources.productDimensionTypeStyle;break;}default:return undefined;}return/*#__PURE__*/React.createElement(WishlistItemDimension,{key:\"\".concat(product.RecordId,\"-dimensions-\").concat(index),className:'msc-price ms-wishlist-items__product-dimension',dimensionType:type,dimensionValue:dimension.DimensionValue.Value});});};var _renderAriaLabel=function _renderAriaLabel(props){var product=props.product,price=props.price,context=props.context,resources=props.resources;var Name=product.Name,Dimensions=product.Dimensions;var productDimensionTypeColor=resources.productDimensionTypeColor,productDimensionTypeSize=resources.productDimensionTypeSize,productDimensionTypeStyle=resources.productDimensionTypeStyle;var formattedPrice='Free';var dimensions=null;if(price){formattedPrice=price.BasePrice===0?resources.freePriceText:context.cultureFormatter.formatCurrency(price.BasePrice,price.CurrencyCode);}if(Dimensions){dimensions=Dimensions.map(function(productDimension){switch(productDimension.DimensionTypeValue){case 1:return\"\".concat(productDimensionTypeColor).concat(productDimension.DimensionValue&&productDimension.DimensionValue.Value);case 3:return\"\".concat(productDimensionTypeSize).concat(productDimension.DimensionValue&&productDimension.DimensionValue.Value);case 4:return\"\".concat(productDimensionTypeStyle).concat(productDimension.DimensionValue&&productDimension.DimensionValue.Value);default:return'';}});}return\"\".concat(Name,\" \").concat(formattedPrice,\" \").concat(dimensions&&dimensions.join('')||'');};","map":{"version":3,"sources":["modules/wishlist-items/components/wishlist-item.tsx"],"names":[],"mappings":"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","sourcesContent":["import { getFallbackImageUrl } from '@msdyn365-commerce-modules/retail-actions';\nimport { Alert, Button, getPayloadObject, getTelemetryAttributes, ITelemetryContent } from '@msdyn365-commerce-modules/utilities';\nimport { PriceComponent } from '@msdyn365-commerce/components';\nimport { ICoreContext, IImageSettings, Image, ITelemetry } from '@msdyn365-commerce/core';\nimport { CommerceListLine, ProductPrice, ReleasedProductType, SimpleProduct } from '@msdyn365-commerce/retail-proxy/dist/Entities/CommerceTypes.g';\nimport * as React from 'react';\nimport { IWishlistItemActionMessageState } from '../wishlist-items';\nimport { WishlistItemDimension } from './wishlist-items-dimensions';\n\nexport interface IWishlistItemProps extends CommerceListLine {\n    product: SimpleProduct;\n    wishlistState: IWishlistItemActionMessageState;\n    price?: ProductPrice;\n    context: ICoreContext;\n    productUrl: string;\n    imageSettings?: IImageSettings;\n    removeFromWishlistText: string;\n    isInStock: boolean;\n    addToCartText: string;\n    outOfStockText: string;\n    index: number;\n    itemKey: string;\n    telemetry: ITelemetry;\n    moduleId: string;\n    moduleTypeName: string;\n    enableImageProductLink?: boolean;\n    inventoryInformationLabel?: string;\n    inventoryLabelClassName?:string;\n    telemetryContent?: ITelemetryContent;\n    handlers: {\n        onAddToCart(product: SimpleProduct, itemKey: string): void;\n        onRemoveItem(productId: number): void | undefined;\n        onDismiss(): void;\n    };\n    resources:{\n        productDimensionTypeColor: string;\n        productDimensionTypeSize: string;\n        productDimensionTypeStyle: string;\n        originalPriceText: string;\n        currentPriceText: string;\n        freePriceText: string;\n    };\n}\n\nexport interface IWishlistItemViewProps {\n    key: string;\n    productImage: React.ReactNode;\n    productLink: React.ReactNode;\n    productDimensions?: React.ReactNode[];\n    productPrice?: React.ReactNode;\n    addToCartButton?: React.ReactNode;\n    removeButton?: React.ReactNode;\n    productStatusMessage?: React.ReactNode;\n    productName?: React.ReactNode;\n    productAriaLabel?: string;\n    entireProductLink?: string;\n    inventoryInformation?: React.ReactNode;\n}\n\nconst _addItemToCart = (props: IWishlistItemProps): void => {\n    const { product, itemKey, handlers } = props;\n    const { onAddToCart } = handlers;\n\n    onAddToCart && product && itemKey && onAddToCart(product, itemKey);\n};\n\nconst _removeItemFromWishlist = (props: IWishlistItemProps): void => {\n    const { onRemoveItem } = props.handlers;\n    const { RecordId } = props.product;\n\n    onRemoveItem && RecordId && onRemoveItem(RecordId);\n};\n\nconst WishListItemActions = {\n    addToCart: _addItemToCart,\n    removeItem: _removeItemFromWishlist,\n};\n\n// tslint:disable-next-line:cyclomatic-complexity\nexport const WishlistItem = (input: IWishlistItemProps): IWishlistItemViewProps | null => {\n    const { product, productUrl, price, context, imageSettings, isInStock, removeFromWishlistText,\n        addToCartText, outOfStockText, wishlistState, itemKey, handlers, enableImageProductLink, inventoryInformationLabel, inventoryLabelClassName, telemetryContent } = input;\n\n    if (!product) {\n        return null;\n    }\n\n    const { RecordId, Name, PrimaryImageUrl, Dimensions } = product;\n\n    const addItemAction = (event: React.MouseEvent<HTMLElement>) => { return WishListItemActions.addToCart(input); };\n    const removeItemAction = (event: React.MouseEvent<HTMLElement>) => { return WishListItemActions.removeItem(input); };\n    const { onDismiss } = handlers;\n    const inventoryCssName = inventoryLabelClassName? `ms-wishlist-items__inventory-label ${inventoryLabelClassName}` : 'ms-wishlist-items__inventory-label';\n    const fallbackImage = getFallbackImageUrl(product.ItemId, context.actionContext.requestContext.apiSettings);\n    const payLoad = getPayloadObject('click', telemetryContent!, '', RecordId.toString());\n    const productAttributes = getTelemetryAttributes(telemetryContent!, payLoad);\n\n    // check if the product is service or not by product type\n    const PRODUCTASSERVICE = 2 as ReleasedProductType.Service;\n    const isServiceItem = product.ItemTypeValue === PRODUCTASSERVICE;\n\n    return {\n        key: `${RecordId}-item`,\n        productImage: PrimaryImageUrl && Name && _renderProductImage(context, product.Name!, PrimaryImageUrl, fallbackImage, imageSettings),\n        productLink: productUrl &&\n            (\n                <a href={productUrl} className='ms-wishlist-items__product-link' {...productAttributes} aria-label={ _renderAriaLabel(input) }>\n                    {Name}\n                </a>\n            ),\n        productDimensions: Dimensions && _renderProductDimensions(input),\n        productPrice: price && _renderPrice(input),\n        entireProductLink: enableImageProductLink ? productUrl : undefined,\n        productAriaLabel: enableImageProductLink ? _renderAriaLabel(input) : undefined,\n        productName: enableImageProductLink &&\n            (\n                <div className='ms-wishlist-items__product-title'>{Name}</div>\n            ),\n\n        addToCartButton:\n            (\n                <Button\n                    className='ms-wishlist-items__product-add-button'\n                    title={ (isServiceItem || isInStock) && addToCartText || outOfStockText }\n                    onClick={ addItemAction }\n                    disabled={ !(isServiceItem || isInStock) }\n                >\n                    { (isServiceItem || isInStock) && addToCartText ||  outOfStockText }\n                </Button>\n            ),\n            inventoryInformation: inventoryInformationLabel && (\n                <span className={inventoryCssName}>{inventoryInformationLabel}</span>\n            ),\n        removeButton:\n            (\n                <button\n                    className='ms-wishlist-items__product-remove-button'\n                    aria-label={ removeFromWishlistText }\n                    onClick={ removeItemAction }\n                />\n            ),\n        productStatusMessage: wishlistState && wishlistState.isOpen &&\n            wishlistState.productId === RecordId && wishlistState.itemKey === itemKey &&\n            (\n                <div className='ms-wishlist-items__product-status'>\n                    <Alert color={wishlistState.statusCssString} isOpen={wishlistState.isOpen} toggle={onDismiss}>\n                        <span>{wishlistState.userMessage}</span>\n                    </Alert>\n                </div>\n            )\n\n    };\n\n};\n\nconst _renderProductImage = (context: ICoreContext, heading: string, image?: string, fallbackImage?: string, imageSettings?: IImageSettings): JSX.Element | null => {\n    const defaultImageSettings: IImageSettings = {\n        viewports: {\n            xs: { q: `w=315&h=315&m=6`, w: 0, h: 0 },\n            lg: { q: `w=315&h=315&m=6`, w: 0, h: 0 },\n            xl: { q: `w=315&h=315&m=6`, w: 0, h: 0 }\n        },\n        lazyload: true\n    };\n\n    if (image) {\n        return (\n            <Image\n                className='ms-wishlist-items__product-image'\n                altText={heading}\n                title={heading}\n                src={image}\n                fallBackSrc = {fallbackImage}\n                gridSettings={context.request.gridSettings!}\n                imageSettings={imageSettings || defaultImageSettings}\n                loadFailureBehavior='empty'\n            />\n        );\n    }\n    return null;\n};\n\nconst _renderPrice = (props: IWishlistItemProps): JSX.Element | null => {\n    const { price, context, moduleId, moduleTypeName, resources } = props;\n\n    if (price) {\n        return (\n                <PriceComponent\n                    id={moduleId}\n                    typeName={moduleTypeName}\n                    data={{price: price}}\n                    className='ms-wishlist-items__product-price'\n                    freePriceText={resources.freePriceText}\n                    originalPriceText={resources.originalPriceText}\n                    currentPriceText={resources.currentPriceText}\n                    context={context}\n                />\n        );\n    }\n    return null;\n};\n\nconst _renderProductDimensions = (props: IWishlistItemProps): (React.ReactNode | undefined)[] => {\n    const { product, resources } = props;\n\n    if (!product || !product.Dimensions) {\n        return [];\n    }\n\n    return product.Dimensions.map((dimension, index) => {\n        if (!dimension.DimensionValue || !dimension.DimensionValue.Value) {\n            return undefined;\n        }\n\n        let type = '';\n\n        switch(dimension.DimensionTypeValue) {\n            case 1: {\n                type = resources.productDimensionTypeColor;\n                break;\n            }\n            case 3: {\n                type = resources.productDimensionTypeSize;\n                break;\n            }\n            case 4: {\n                type = resources.productDimensionTypeStyle;\n                break;\n            }\n            default:\n                return undefined;\n        }\n\n        return (\n            <WishlistItemDimension\n                key={`${product.RecordId}-dimensions-${index}`}\n                className='msc-price ms-wishlist-items__product-dimension'\n                dimensionType={type}\n                dimensionValue={dimension.DimensionValue.Value}\n            />\n        );\n    });\n};\n\nconst _renderAriaLabel = (props: IWishlistItemProps): string => {\n    const { product, price, context, resources } = props;\n\n    const { Name, Dimensions, } = product;\n    const { productDimensionTypeColor, productDimensionTypeSize, productDimensionTypeStyle } = resources;\n\n    let formattedPrice = 'Free';\n    let dimensions = null;\n\n    if (price) {\n        formattedPrice = price.BasePrice === 0 ? resources.freePriceText : context.cultureFormatter.formatCurrency(price.BasePrice!, price.CurrencyCode);\n    }\n\n    if (Dimensions) {\n        dimensions = Dimensions.map(productDimension => {\n            switch(productDimension.DimensionTypeValue) {\n                case 1:\n                    return (`${productDimensionTypeColor}${productDimension.DimensionValue && productDimension.DimensionValue.Value}`);\n                case 3:\n                        return (`${productDimensionTypeSize}${productDimension.DimensionValue && productDimension.DimensionValue.Value}`);\n                case 4:\n                    return (`${productDimensionTypeStyle}${productDimension.DimensionValue && productDimension.DimensionValue.Value}`);\n                default:\n                    return '';\n            }\n        });\n    }\n\n    return (`${Name} ${formattedPrice} ${dimensions && dimensions.join('') || ''}`);\n};\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}