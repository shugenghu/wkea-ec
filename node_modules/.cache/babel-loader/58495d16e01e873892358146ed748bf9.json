{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _asyncToGenerator from\"@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import{createObservableDataAction}from'@msdyn365-commerce/core';import{getCategoriesAsync}from'@msdyn365-commerce/retail-proxy/dist/DataActions/CategoriesDataActions.g';/**\r\n * Input for get-categories data action\r\n */export var CategoriesInput=function CategoriesInput(context,mappedToHierarchy,maxItems){var _this=this;_classCallCheck(this,CategoriesInput);this.getCacheKey=function(){return\"\".concat(_this.channelId,\"|top-\").concat(_this.maxItems||250);};this.getCacheObjectType=function(){return _this._mappedToHierarchy?'CategoryHierarchy':'Category';};this.dataCacheType=function(){return'application';};this._mappedToHierarchy=mappedToHierarchy;this.maxItems=maxItems||250;this.channelId=context&&context.apiSettings&&context.apiSettings.channelId?Number(context.apiSettings.channelId):0;};/**\r\n * Creates the input required to make the retail api call\r\n */export var createCategoriesInput=function createCategoriesInput(inputData){var topItems=inputData.config&&inputData.config.topCategories&&parseInt(inputData.config.topCategories,10);return new CategoriesInput(inputData.requestContext,false,topItems);};/**\r\n * Calls the Retail API and returns all the categories as a flat list\r\n */export function getCategoryAction(_x,_x2){return _getCategoryAction.apply(this,arguments);}function _getCategoryAction(){_getCategoryAction=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(input,ctx){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt(\"return\",getCategoriesAsync({callerContext:ctx},input.channelId));case 1:case\"end\":return _context.stop();}}},_callee);}));return _getCategoryAction.apply(this,arguments);}export default createObservableDataAction({id:'@msdyn365-commerce-modules/retail-actions/get-categories',action:getCategoryAction,input:createCategoriesInput});","map":{"version":3,"sources":["../../src/get-categories.ts"],"names":[],"mappings":"8MAEA,OAAS,0BAAT,KAAkG,yBAAlG,CACA,OAAS,kBAAT,KAAmC,0EAAnC,CAEA;;AAEG,GACH,UAAa,CAAA,eAAb,CAII,yBAAY,OAAZ,CAAsC,iBAAtC,CAAkE,QAAlE,CAAmF,sDAM5E,KAAA,WAAA,CAAc,2BAAS,KAAI,CAAC,SAAd,iBAA+B,KAAI,CAAC,QAAL,EAAiB,GAAhD,GAAd,CACA,KAAA,kBAAA,CAAqB,iBAAO,CAAA,KAAI,CAAC,kBAAL,CAA0B,mBAA1B,CAAgD,UAAvD,EAArB,CACA,KAAA,aAAA,CAAgB,iBAAiB,aAAjB,EAAhB,CAPH,KAAK,kBAAL,CAA0B,iBAA1B,CACA,KAAK,QAAL,CAAgB,QAAQ,EAAI,GAA5B,CACA,KAAK,SAAL,CAAiB,OAAO,EAAI,OAAO,CAAC,WAAnB,EAAkC,OAAO,CAAC,WAAR,CAAoB,SAAtD,CAAkE,MAAM,CAAC,OAAO,CAAC,WAAR,CAAoB,SAArB,CAAxE,CAA0G,CAA3H,CACH,CARL,CAeA;;AAEG,GACH,MAAO,IAAM,CAAA,qBAAqB,CAAG,QAAxB,CAAA,qBAAwB,CAAC,SAAD,CAAkE,CACnG,GAAM,CAAA,QAAQ,CAAG,SAAS,CAAC,MAAV,EAAoB,SAAS,CAAC,MAAV,CAAiB,aAArC,EAAsD,QAAQ,CAAC,SAAS,CAAC,MAAV,CAAiB,aAAlB,CAAiC,EAAjC,CAA/E,CACA,MAAO,IAAI,CAAA,eAAJ,CAAoB,SAAS,CAAC,cAA9B,CAA8C,KAA9C,CAAqD,QAArD,CAAP,CACH,CAHM,CAKP;;AAEG,GACH,eAAsB,CAAA,iBAAtB,0D,yGAAO,iBAAiC,KAAjC,CAAyD,GAAzD,kJACmC,kBAAkB,CAAC,CAAE,aAAa,CAAE,GAAjB,CAAD,CAAyB,KAAK,CAAC,SAA/B,CADrD,wD,oDAIP,cAAe,CAAA,0BAA0B,CAAC,CACtC,EAAE,CAAE,0DADkC,CAEtC,MAAM,CAAgC,iBAFA,CAGtC,KAAK,CAAE,qBAH+B,CAAD,CAAzC","sourcesContent":["import { CategoryHierarchy } from '@msdyn365-commerce/commerce-entities';\nimport { CacheType, IAction, IActionContext, IActionInput } from '@msdyn365-commerce/core';\nimport { createObservableDataAction, IAny, ICreateActionContext, IGeneric, IRequestContext } from '@msdyn365-commerce/core';\nimport { getCategoriesAsync } from '@msdyn365-commerce/retail-proxy/dist/DataActions/CategoriesDataActions.g';\n\n/**\n * Input for get-categories data action\n */\nexport class CategoriesInput implements IActionInput {\n    public readonly maxItems: number;\n    public readonly channelId: number;\n    private _mappedToHierarchy: boolean;\n    constructor(context: IRequestContext, mappedToHierarchy: boolean, maxItems?: number) {\n        this._mappedToHierarchy = mappedToHierarchy;\n        this.maxItems = maxItems || 250;\n        this.channelId = context && context.apiSettings && context.apiSettings.channelId ? Number(context.apiSettings.channelId) : 0;\n    }\n\n    public getCacheKey = () => `${this.channelId}|top-${this.maxItems || 250}`;\n    public getCacheObjectType = () => (this._mappedToHierarchy ? 'CategoryHierarchy' : 'Category');\n    public dataCacheType = (): CacheType => 'application';\n}\n\n/**\n * Creates the input required to make the retail api call\n */\nexport const createCategoriesInput = (inputData: ICreateActionContext<IGeneric<IAny>>): IActionInput => {\n    const topItems = inputData.config && inputData.config.topCategories && parseInt(inputData.config.topCategories, 10);\n    return new CategoriesInput(inputData.requestContext, false, topItems);\n};\n\n/**\n * Calls the Retail API and returns all the categories as a flat list\n */\nexport async function getCategoryAction(input: CategoriesInput, ctx: IActionContext): Promise<CategoryHierarchy[]> {\n    return <CategoryHierarchy[]><unknown>(getCategoriesAsync({ callerContext: ctx }, input.channelId));\n}\n\nexport default createObservableDataAction({\n    id: '@msdyn365-commerce-modules/retail-actions/get-categories',\n    action: <IAction<CategoryHierarchy[]>>getCategoryAction,\n    input: createCategoriesInput\n});\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}