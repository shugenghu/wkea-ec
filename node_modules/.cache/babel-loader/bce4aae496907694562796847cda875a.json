{"ast":null,"code":"import\"core-js/modules/es.object.assign.js\";import\"core-js/modules/es.regexp.to-string.js\";import\"core-js/modules/es.string.includes.js\";import\"core-js/modules/es.string.match.js\";import\"core-js/modules/web.dom-collections.for-each.js\";import _objectWithoutProperties from\"@babel/runtime/helpers/esm/objectWithoutProperties\";import{getPayloadObject,getTelemetryAttributes,Slider,UncontrolledTooltip}from'@msdyn365-commerce-modules/utilities';import*as React from'react';import ActionToggle from'../action-toggle/ActionToggle';import{MenuCategories,VideoPlayerNames}from'../data/player-constants';import{LocalizationConstants}from'../helper/localization-helper';import Menu from'../menu/menu';export const ButtonMenuTypes={ClosedCaption:'close-caption',Options:'options'};const volumeSliderDivOffset=162;export default class VideoControls extends React.PureComponent{constructor(props){super(props);this.selectedMenuItems=[];this.volumeButtonDiv=/*#__PURE__*/React.createRef();this.playButtonRef=/*#__PURE__*/React.createRef();this.pauseButtonRef=/*#__PURE__*/React.createRef();this.closedCaptionRef=/*#__PURE__*/React.createRef();this.optionButtonRef=/*#__PURE__*/React.createRef();this.fullscreenButtonRef=/*#__PURE__*/React.createRef();this.exitFullScreenButtonRef=/*#__PURE__*/React.createRef();this.videoControlDiv=/*#__PURE__*/React.createRef();this.closedCaptionButtonDiv=/*#__PURE__*/React.createRef();this.optionButtonDiv=/*#__PURE__*/React.createRef();this.menuRef=/*#__PURE__*/React.createRef();this.muteButtonRef=/*#__PURE__*/React.createRef();this.unMuteButtonRef=/*#__PURE__*/React.createRef();this.showVolumeControl=autohide=>()=>{const offsetPosition=this._getOffsetPosition(this.volumeButtonDiv);window&&window.clearTimeout(this.volumeAutoHideTimer);this.setState({showVolumeSlider:true,volumeSliderLeftPosition:offsetPosition.offsetLeft,volumeSliderTopPosition:offsetPosition.offsetTop-volumeSliderDivOffset+1});if(autohide&&document.activeElement.parentElement!==this.volumeButtonDiv.current.firstChild){this.volumeAutoHideTimer=window&&window.setTimeout(()=>{this._hideVolumeControl();},VideoControls.volumeAutoHideTimeout);}};this._onDocumentClick=e=>{const target=e.target;if(!(this.currentMenu===ButtonMenuTypes.ClosedCaption&&(target===this.closedCaptionButtonDiv.current.firstChild||target.parentElement===this.closedCaptionButtonDiv.current.firstChild)||this.currentMenu===ButtonMenuTypes.Options&&(target===this.optionButtonDiv.current.firstChild||target.parentElement===this.optionButtonDiv.current.firstChild))){this.setState({showMenu:!this.state.showMenu});}};this._renderClosedCaptionButton=()=>{return/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(VideoControls.videoControlsClassName,\"__closedcaption__container\"),ref:this.closedCaptionButtonDiv},/*#__PURE__*/React.createElement(\"button\",{ref:this.closedCaptionRef,\"aria-label\":this.props.resources.closedCaptionLabel,className:\"\".concat(VideoControls.videoControlsClassName,\"__closedcaptionbtn\"),onClick:this._onClosedCaptionClick}),/*#__PURE__*/React.createElement(UncontrolledTooltip,{trigger:'hover focus',target:this.closedCaptionRef},this.props.resources.closedCaptionLabel));};this._renderOptionButton=()=>{return/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(VideoControls.videoControlsClassName,\"__moreoptions__container\"),ref:this.optionButtonDiv},/*#__PURE__*/React.createElement(\"button\",{ref:this.optionButtonRef,\"aria-label\":this.props.resources.optionButtonLabel,className:\"\".concat(VideoControls.videoControlsClassName,\"__moreoptionsbtn\"),onClick:this._onOptionsButtonClick}),/*#__PURE__*/React.createElement(UncontrolledTooltip,{trigger:'hover focus',target:this.optionButtonRef},this.props.resources.optionButtonLabel));};this._renderFullScreenButton=()=>{this.payLoad.contentAction.etext=this.props.isInFullScreen?LocalizationConstants.exitFullScreenAriaLabel:LocalizationConstants.fullScreenAriaLabel;const attribute=getTelemetryAttributes(this.props.telemetryContent,this.payLoad);return/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(VideoControls.videoControlsClassName,\"__fullscreenbtn__container\")},/*#__PURE__*/React.createElement(ActionToggle,{onChange:this.props.toggleFullScreen,toggled:this.props.isInFullScreen,className:\"\".concat(VideoControls.videoControlsClassName,\"__fullscreenbtn__wrapper\")},/*#__PURE__*/React.createElement(\"button\",Object.assign({ref:this.fullscreenButtonRef,\"aria-label\":this.props.resources.fullScreenAriaLabel,className:\"\".concat(VideoControls.videoControlsClassName,\"__fullscreenbtn\")},attribute)),/*#__PURE__*/React.createElement(\"button\",Object.assign({ref:this.exitFullScreenButtonRef,\"aria-label\":this.props.resources.exitFullScreenAriaLabel,className:\"\".concat(VideoControls.videoControlsClassName,\"__exitfullscreenbtn\")},attribute))),/*#__PURE__*/React.createElement(UncontrolledTooltip,{className:\"\".concat(VideoControls.videoControlsClassName,\"__fullscreenbtn__tooltip\"),trigger:'hover focus',target:this.fullscreenButtonRef},\" \",this.props.resources.fullScreenAriaLabel),/*#__PURE__*/React.createElement(UncontrolledTooltip,{trigger:'hover focus',target:this.exitFullScreenButtonRef},\" \",this.props.resources.exitFullScreenAriaLabel));};this._renderVolumeButton=()=>{this.payLoad.contentAction.etext=this.props.isMuted?LocalizationConstants.unMuteAriaLabel:LocalizationConstants.muteAriaLabel;const attribute=getTelemetryAttributes(this.props.telemetryContent,this.payLoad);const volumeButtonProps={className:\"\".concat(VideoControls.videoControlsClassName,\"__muteunmutebtn__wrapper\"),onChange:this.props.onMuteClick,toggled:this.props.isMuted,onFocus:this.showVolumeControl(),onBlur:this._hideVolumeControl,onMouseOver:this.showVolumeControl(),onMouseOut:this._hideVolumeControl};return/*#__PURE__*/React.createElement(ActionToggle,Object.assign({},volumeButtonProps),/*#__PURE__*/React.createElement(\"button\",Object.assign({\"aria-label\":this.props.resources.muteAriaLabel,ref:this.muteButtonRef,className:\"\".concat(VideoControls.videoControlsClassName,\"__mutebtn\")},attribute)),/*#__PURE__*/React.createElement(\"button\",Object.assign({\"aria-label\":this.props.resources.unMuteAriaLabel,ref:this.unMuteButtonRef,className:\"\".concat(VideoControls.videoControlsClassName,\"__unmutebtn\")},attribute)));};this._renderVideoSlider=()=>{const videoProps={id:'VideoSlider',inForm:false,className:\"\".concat(VideoControls.videoControlsClassName,\"__slidercontainer\"),min:this.props.playPosition.startTime,max:this.props.playPosition.endTime,ariaLabel:this.props.resources.seekBarLabel,fillTrackValue:this.props.playPosition.bufferedDuration,step:this.props.videoSeekSteps||1,orientation:'horizontal',showProgressBar:true,onChange:this.props.onProgressChange,showLabels:false,showTooltip:true,handleTooltipText:this._handleProgressToolTipText(this.props.playPosition.currentTime),sliderThumbs:[{id:'VideoSliderThumb',value:this.props.playPosition.currentTime,ariaValueText:this.props.playPosition.currentTime.toString()}]};return/*#__PURE__*/React.createElement(Slider,Object.assign({},videoProps));};this._renderVolumeSlider=()=>{const volumeSliderProps={id:'VolumeSlider',inForm:false,className:\"\".concat(VideoControls.videoControlsClassName,\"__volumeslider\"),min:0,max:100,step:this.props.volumeSeekSteps||5,orientation:'vertical',showProgressBar:false,onChange:this.props.onVolumeChange,onFocus:this.showVolumeControl(),onBlur:this._hideVolumeControl,showLabels:false,showTooltip:true,sliderThumbs:[{id:'VolumeSliderThumb',value:Math.round(this.props.currentVolume),ariaValueText:Math.round(this.props.currentVolume).toString()}]};return/*#__PURE__*/React.createElement(Slider,Object.assign({},volumeSliderProps));};this._handleProgressToolTipText=tooltip=>()=>{return this._toElapsedTimeString(tooltip);};this.volumeAutoHideTimer=0;this.focusedMenuItemIndex=0;this.currentMenu='';this._hideVolumeControl=this._hideVolumeControl.bind(this);this._onMenuItemClick=this._onMenuItemClick.bind(this);this._reevaluateWidth=this._reevaluateWidth.bind(this);this._onClosedCaptionClick=this._onClosedCaptionClick.bind(this);this._onDocumentClick=this._onDocumentClick.bind(this);this._onOptionsButtonClick=this._onOptionsButtonClick.bind(this);this._onMenuBlur=this._onMenuBlur.bind(this);this._onMenuFocus=this._onMenuFocus.bind(this);this._onMouseOver=this._onMouseOver.bind(this);this._onMouseOut=this._onMouseOut.bind(this);this._onMenuKeyDown=this._onMenuKeyDown.bind(this);this._onMenuKeyUp=this._onMenuKeyUp.bind(this);this.state={showVolumeSlider:false,volumeSliderLeftPosition:0,volumeSliderTopPosition:-160,showMenu:false,menuLeftPosition:0,currentMenu:this.props.closedCaptionMenu,toolTipClass:''};this.payLoad=getPayloadObject('click',this.props.telemetryContent,'');}componentDidUpdate(prevProps){if(!this.props.isControlPanelVisible){this.setState({showMenu:false});}if(this.props.currentClosedCaptionLanguage!==prevProps.currentClosedCaptionLanguage||this.props.currentClosedCaptionsSetting!==prevProps.currentClosedCaptionsSetting||this.props.currentAudioTrack!==prevProps.currentAudioTrack){this._updateSelectedMenu();}}render(){const _this$props=this.props,{className}=_this$props,props=_objectWithoutProperties(_this$props,[\"className\"]);const currentTime=this._toElapsedTimeString(props.playPosition.currentTime);const endTime=this._toElapsedTimeString(props.playPosition.endTime);const volumeDivStyle={top:this.state.volumeSliderTopPosition,left:this.state.volumeSliderLeftPosition};const menuDivStyle={left:this.state.menuLeftPosition};this.payLoad.contentAction.etext=this.props.playing?LocalizationConstants.pauseAriaLabel:LocalizationConstants.playAriaLabel;const attribute=getTelemetryAttributes(this.props.telemetryContent,this.payLoad);return/*#__PURE__*/React.createElement(\"div\",{className:className,ref:this.videoControlDiv,role:'none',onKeyDown:this.props.handleControlsKeyDownHandler,onBlur:this.props.onBlur,onFocus:this.props.onFocus},/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(VideoControls.videoControlsClassName,\"__wrapper\")},/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(VideoControls.videoControlsClassName,\"__playpausebtn__container\")},/*#__PURE__*/React.createElement(ActionToggle,{className:\"\".concat(VideoControls.videoControlsClassName,\"__playpausebtn__wrapper\"),onChange:this.props.onPlayClick,toggled:this.props.playing},/*#__PURE__*/React.createElement(\"button\",Object.assign({ref:this.playButtonRef,\"aria-label\":this.props.resources.playAriaLabel,className:\"\".concat(VideoControls.videoControlsClassName,\"__playbtn\")},attribute)),/*#__PURE__*/React.createElement(\"button\",Object.assign({ref:this.pauseButtonRef,\"aria-label\":this.props.resources.pauseAriaLabel,className:\"\".concat(VideoControls.videoControlsClassName,\"__pausebtn\")},attribute))),/*#__PURE__*/React.createElement(UncontrolledTooltip,{className:this.state.toolTipClass,trigger:'hover focus',target:this.playButtonRef},\" \",this.props.resources.playAriaLabel),/*#__PURE__*/React.createElement(UncontrolledTooltip,{trigger:'hover focus',target:this.pauseButtonRef},\" \",this.props.resources.pauseAriaLabel)),/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(VideoControls.videoControlsClassName,\"__time\")},/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(VideoControls.videoControlsClassName,\"__time__screenreader\"),\"aria-hidden\":this.props.isMobileDevice,\"aria-live\":'polite'},\"\".concat(this.props.resources.videoTimeDurationLabel,\" \").concat(currentTime,\" / \").concat(endTime)),/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(VideoControls.videoControlsClassName,\"__time__text\"),\"aria-hidden\":'true'},currentTime,\" /\",\" \",endTime)),/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(VideoControls.videoControlsClassName,\"__slider__container\")},this._renderVideoSlider()),this.props.closedCaptionMenu&&this._renderClosedCaptionButton(),this.props.optionMenu&&this._renderOptionButton(),this.state.showMenu&&/*#__PURE__*/React.createElement(Menu,{ref:this.menuRef,className:\"\".concat(VideoControls.videoControlsClassName,\"__menu\"),playerMenu:this.state.currentMenu,style:menuDivStyle,onDocumentClick:this._onDocumentClick,onMenuItemClick:this._onMenuItemClick,onFocus:this._onMenuFocus,onBlur:this._onMenuBlur,onMouseOver:this._onMouseOver,onMouseOut:this._onMouseOut,onKeyDown:this._onMenuKeyDown,onKeyUp:this._onMenuKeyUp}),!this.props.isMobileDevice&&/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(VideoControls.videoControlsClassName,\"__muteunmutebtn__container\"),ref:this.volumeButtonDiv},this._renderVolumeButton()),!this.props.isMobileDevice&&/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(VideoControls.videoControlsClassName,\"__volumeslider__container \").concat(this.state.showVolumeSlider?'show':'hide'),onFocus:this.showVolumeControl(),onBlur:this._hideVolumeControl,onMouseOver:this.showVolumeControl(),onMouseOut:this._hideVolumeControl,style:volumeDivStyle,role:'presentation'},this._renderVolumeSlider()),this._renderFullScreenButton()));}setFocusOnPlay(){this.playButtonRef.current.focus();}setFocusOnMenuButton(){if(this.props.isControlPanelVisible){if(this.currentMenu===ButtonMenuTypes.ClosedCaption){this.closedCaptionRef.current.focus();}else{this.optionButtonRef.current.focus();}}}componentDidMount(){window&&window.addEventListener('resize',this._reevaluateWidth);this._reevaluateWidth();if(this._isIPhone()){const fullscreen=document.getElementsByClassName(\"\".concat(VideoControls.videoControlsClassName,\"__fullscreenbtn__container\"));fullscreen[0].setAttribute('hidden','true');}}componentWillUnmount(){window&&window.removeEventListener('resize',this._reevaluateWidth);}_reevaluateWidth(){const rowDiv=this.videoControlDiv.current.children[0];let controlBarButtonsWidth=0;for(let i=0;i<rowDiv.children.length;i++){if(rowDiv.children[i].children[0]!==undefined&&rowDiv.children[i].children[0].className.includes('action-toggle')){controlBarButtonsWidth+=rowDiv.children[i].clientWidth;}}const sliderWidth=controlBarButtonsWidth+100;rowDiv.children[2].setAttribute('style','width: calc(100% - '.concat(sliderWidth,'px)'));if(this.state.showVolumeSlider){this._hideVolumeControl();}if(!this.props.isMobileDevice){const offsetPosition=this._getOffsetPosition(this.volumeButtonDiv);this.setState({volumeSliderLeftPosition:offsetPosition.offsetLeft,volumeSliderTopPosition:offsetPosition.offsetTop-volumeSliderDivOffset});}if(this.state.showMenu){this.setState({showMenu:false});}const videoControlWidth=this.videoControlDiv.current.clientWidth;const viewportMax=window&&window.innerWidth;this._applyTooltipClassOnWidthChange(videoControlWidth,viewportMax);}_onMenuFocus(e){const button=e.target;const hasEvents=button.getAttribute('data-has-events');if(hasEvents){this.props.onMenuItemFocus({category:button.parentElement.parentElement.parentElement.getAttribute('data-category'),id:button.parentElement.id,data:button.getAttribute('data-info')});}}_onMenuBlur(e){const button=e.target;const hasEvents=button.getAttribute('data-has-events');if(hasEvents){this.props.onMenuItemBlur();}}_onMouseOver(e){const button=e.target;const hasEvents=button.getAttribute('data-has-events');if(hasEvents){this.props.onMenuItemFocus({category:button.parentElement.parentElement.parentElement.getAttribute('data-category'),id:button.parentElement.id,data:button.getAttribute('data-info')});}}_onMouseOut(e){const button=e.target;const hasEvents=button.getAttribute('data-has-events');if(hasEvents){this.props.onMenuItemBlur();}}_onMenuKeyDown(e){this._onMenuKeyPressed(e);}_onMenuKeyUp(event){const e=event;const key=e.keyCode;if(key===32){event.preventDefault();}}_onMenuKeyPressed(event){const key=event.keyCode;const target=event.target;const currentMenuItem=this.state.currentMenu;this._resetFocusForCurrentMenu(currentMenuItem);switch(key){case 37:case 39:event.stopPropagation();event.preventDefault();if(key===39&&target.getAttribute('data-has-children')==='true'){this._onMenuItemClick(event);}if(key===37&&target.getAttribute('data-isbackbutton')==='true'){this._onMenuItemClick(event);}break;case 13:case 32:event.preventDefault();this._onMenuItemClick(event);break;case 38:case 40:event.stopPropagation();event.preventDefault();if(key===38){this.focusedMenuItemIndex-=1;if(this.focusedMenuItemIndex<0){this.focusedMenuItemIndex=currentMenuItem.items.length-1;}}else{this.focusedMenuItemIndex=(this.focusedMenuItemIndex+1)%currentMenuItem.items.length;}currentMenuItem.items[this.focusedMenuItemIndex].hasFocus=true;this.setState({currentMenu:currentMenuItem},()=>{if(this.menuRef.current){this.menuRef.current.forceUpdate();}});break;case 33:case 36:event.stopPropagation();event.preventDefault();this.focusedMenuItemIndex=0;currentMenuItem.items[this.focusedMenuItemIndex].hasFocus=true;this.setState({currentMenu:currentMenuItem},()=>{if(this.menuRef.current){this.menuRef.current.forceUpdate();}});break;case 35:case 34:event.stopPropagation();event.preventDefault();this.focusedMenuItemIndex=currentMenuItem.items.length-1;currentMenuItem.items[this.focusedMenuItemIndex].hasFocus=true;this.setState({currentMenu:currentMenuItem},()=>{if(this.menuRef.current){this.menuRef.current.forceUpdate();}});break;case 27:this.setFocusOnMenuButton();this.setState({showMenu:false});break;case 9:if((this.focusedMenuItemIndex<currentMenuItem.items.length-1||this.focusedMenuItemIndex===currentMenuItem.items.length-1&&event.shiftKey)&&this.focusedMenuItemIndex>=0&&!(this.focusedMenuItemIndex===0&&event.shiftKey)){this.focusedMenuItemIndex+=event.shiftKey?-1:1;currentMenuItem.items[this.focusedMenuItemIndex].hasFocus=true;this.setState({currentMenu:currentMenuItem});}else{event.stopPropagation();event.preventDefault();this.setState({showMenu:false});if(event.shiftKey){this.setFocusOnMenuButton();}else{if(this.currentMenu===ButtonMenuTypes.ClosedCaption&&this.optionButtonRef.current){this.optionButtonRef.current.focus();}else{this.props.isMuted?this.unMuteButtonRef.current.focus():this.muteButtonRef.current.focus();}}}}}_onMenuItemClick(e){const button=e.currentTarget;if(button.getAttribute('data-has-children')==='true'){const index=Number(button.getAttribute('data-itemindex'));this.selectedMenuItems.push(index);const currentMenuItem=this._getSelectedMenuFromList();this.focusedMenuItemIndex=0;currentMenuItem.items[this.focusedMenuItemIndex].hasFocus=true;this.setState({currentMenu:currentMenuItem});}else if(button.getAttribute('data-isbackbutton')==='true'){this.focusedMenuItemIndex=this.selectedMenuItems.pop();const currentMenuItem=this._getSelectedMenuFromList();currentMenuItem.items[this.focusedMenuItemIndex].hasFocus=true;this.setState({currentMenu:currentMenuItem});}else{const currentMenuItem=this._getSelectedMenuFromList();this._resetFocusForCurrentMenu(currentMenuItem);const index=Number(button.getAttribute('data-itemindex'));this.focusedMenuItemIndex=index;const data=this.currentMenu===ButtonMenuTypes.ClosedCaption?button.getAttribute('data-info'):JSON.stringify({url:button.getAttribute('data-info'),lang:button.getAttribute('lang')});this.props.onMenuItemClick({category:button.parentElement.parentElement.parentElement.getAttribute('data-category'),id:button.parentElement.id,data:data});}this._updateSelectedMenu();}_resetFocusForCurrentMenu(currentMenu){currentMenu.items.forEach(item=>item.hasFocus=false);}_getSelectedMenuFromList(){let menuItem=this.currentMenu===ButtonMenuTypes.ClosedCaption?this.props.closedCaptionMenu:this.props.optionMenu;for(let i=0;i<this.selectedMenuItems.length;i++){menuItem=menuItem.items[this.selectedMenuItems[i]].subMenu;}return menuItem;}_updateSelectedMenu(){const currentMenuItem=this._getSelectedMenuFromList();if(currentMenuItem){switch(currentMenuItem.category){case MenuCategories.ClosedCaption:currentMenuItem.items.forEach(item=>{if(item.data&&item.data===this.props.currentClosedCaptionLanguage){item.selected=true;}else{item.selected=false;}});break;case MenuCategories.ClosedCaptionSettings:currentMenuItem.items.forEach(item=>{for(const setting in this.props.currentClosedCaptionsSetting){const data=\"\".concat(setting,\":\").concat(this.props.currentClosedCaptionsSetting[setting]);if(item.data&&item.data===data){item.selected=true;break;}else{item.selected=false;}}});break;case MenuCategories.AudioTracks:currentMenuItem.items.forEach(item=>{if(item.language&&item.language===this.props.currentAudioTrack){item.selected=true;}else{item.selected=false;}});}this.setState({currentMenu:currentMenuItem},()=>{if(this.menuRef.current){this.menuRef.current.forceUpdate();}});}}_getOffsetPosition(refDiv){const buttonWidth=refDiv.current.children[0].clientWidth;const elementwidth=refDiv.current.offsetWidth;const offsetLeft=refDiv.current.offsetLeft+(elementwidth-buttonWidth)/2;const offsetTop=refDiv.current.offsetTop;return{offsetLeft,offsetTop};}_onClosedCaptionClick(){this.currentMenu=ButtonMenuTypes.ClosedCaption;const offsetLeft=this._getOffsetPosition(this.closedCaptionButtonDiv).offsetLeft;this.focusedMenuItemIndex=0;this.selectedMenuItems=[];const closedCaptionMenu=this.props.closedCaptionMenu;this._resetFocusForCurrentMenu(closedCaptionMenu);closedCaptionMenu.items[this.focusedMenuItemIndex].hasFocus=true;this.setState({showMenu:this.currentMenu===ButtonMenuTypes.ClosedCaption&&!this.state.showMenu,menuLeftPosition:offsetLeft-120,currentMenu:closedCaptionMenu});this._updateSelectedMenu();}_onOptionsButtonClick(){this.currentMenu=ButtonMenuTypes.Options;const offsetLeft=this._getOffsetPosition(this.optionButtonDiv).offsetLeft;this.focusedMenuItemIndex=0;this.selectedMenuItems=[];const optionMenu=this.props.optionMenu;this._resetFocusForCurrentMenu(optionMenu);optionMenu.items[this.focusedMenuItemIndex].hasFocus=true;this.setState({showMenu:this.currentMenu===ButtonMenuTypes.Options&&!this.state.showMenu,menuLeftPosition:offsetLeft-120,currentMenu:optionMenu});this._updateSelectedMenu();}_hideVolumeControl(){window&&window.clearTimeout(this.volumeAutoHideTimer);this.setState({showVolumeSlider:false});}_toElapsedTimeString(seconds){const negative=seconds<0;if(negative){seconds*=-1;}const hours=Math.floor(seconds/3600);const remainder=seconds%3600;const minutes=Math.floor(remainder/60);let elapsedTime='';elapsedTime=hours>0?\"\".concat(hours,\":\"):'';seconds=Math.floor(remainder%60);elapsedTime+=\"\".concat((minutes<10?'0':'')+minutes.toString());elapsedTime+=\":\".concat(seconds===0?'00':(seconds<10?'0':'')+seconds.toString());return negative?\"-\".concat(elapsedTime):elapsedTime;}_applyTooltipClassOnWidthChange(videoControlWidth,viewportMax){if(videoControlWidth){this.setState({toolTipClass:videoControlWidth>this.props.viewportMin&&videoControlWidth<viewportMax?\"\".concat(VideoControls.videoControlsClassName,\"__playpausebtn__tooltip\"):''});}}_isIPhone(){const useragent=window&&window.navigator.userAgent;return!!useragent.match(/iPhone/i);}}VideoControls.defaultProps={resources:{playAriaLabel:LocalizationConstants.playAriaLabel,pauseAriaLabel:LocalizationConstants.pauseAriaLabel,closeAriaLabel:LocalizationConstants.closeAriaLabel,muteAriaLabel:LocalizationConstants.muteAriaLabel,unMuteAriaLabel:LocalizationConstants.unMuteAriaLabel,fullScreenAriaLabel:LocalizationConstants.fullScreenAriaLabel,exitFullScreenAriaLabel:LocalizationConstants.exitFullScreenAriaLabel,pausedAriaLabel:LocalizationConstants.pausedAriaLabel,playingAriaLabel:LocalizationConstants.playingAriaLabel,seekBarLabel:LocalizationConstants.seekBarLabel,videoTimeDurationLabel:LocalizationConstants.videoTimeDurationLabel,closedCaptionLabel:LocalizationConstants.closedCaptionLabel},viewportMin:200};VideoControls.videoControlsClassName=\"\".concat(VideoPlayerNames.videoplayerContainer,\"__controls\");VideoControls.volumeAutoHideTimeout=2000;","map":{"version":3,"sources":["videoplayer/components/video-controls/VideoControls.tsx"],"names":[],"mappings":"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","sourcesContent":["import { getPayloadObject, getTelemetryAttributes, IPayLoad, ISliderProps, Slider, UncontrolledTooltip } from '@msdyn365-commerce-modules/utilities';\nimport * as React from 'react';\nimport ActionToggle from '../action-toggle/ActionToggle';\nimport { IPlayerMenu, MenuCategories, VideoPlayerNames } from '../data/player-constants';\nimport { LocalizationConstants } from '../helper/localization-helper';\nimport Menu from '../menu/menu';\nimport { KeyCodes } from '../utilities/KeyCodes';\nimport { IVideoControlsProps } from './VideoControls.props';\n\nexport interface IVideoControlState {\n    showVolumeSlider: boolean;\n    volumeSliderLeftPosition: number;\n    volumeSliderTopPosition: number;\n    showMenu: boolean;\n    menuLeftPosition: number;\n    currentMenu?: IPlayerMenu;\n    toolTipClass: string;\n}\n\nexport interface IOffsetPosition {\n    offsetLeft: number;\n    offsetTop: number;\n}\nexport const ButtonMenuTypes = {\n    ClosedCaption: 'close-caption',\n    Options: 'options'\n};\n\nconst volumeSliderDivOffset: number = 162;\n\n/**\n *\n * VideoControls React component for video player\n *\n */\nexport default class VideoControls extends React.PureComponent<IVideoControlsProps, IVideoControlState> {\n    public static defaultProps: Partial<IVideoControlsProps> = {\n        resources: {\n            playAriaLabel: LocalizationConstants.playAriaLabel,\n            pauseAriaLabel: LocalizationConstants.pauseAriaLabel,\n            closeAriaLabel: LocalizationConstants.closeAriaLabel,\n            muteAriaLabel: LocalizationConstants.muteAriaLabel,\n            unMuteAriaLabel: LocalizationConstants.unMuteAriaLabel,\n            fullScreenAriaLabel: LocalizationConstants.fullScreenAriaLabel,\n            exitFullScreenAriaLabel: LocalizationConstants.exitFullScreenAriaLabel,\n            pausedAriaLabel: LocalizationConstants.pausedAriaLabel,\n            playingAriaLabel: LocalizationConstants.playingAriaLabel,\n            seekBarLabel: LocalizationConstants.seekBarLabel,\n            videoTimeDurationLabel: LocalizationConstants.videoTimeDurationLabel,\n            closedCaptionLabel: LocalizationConstants.closedCaptionLabel\n        },\n        viewportMin: 200\n    };\n\n    private static videoControlsClassName: string = `${VideoPlayerNames.videoplayerContainer}__controls`;\n    private static volumeAutoHideTimeout: number = 2000;\n    private selectedMenuItems: number[] = [];\n    private volumeAutoHideTimer: number;\n    private focusedMenuItemIndex: number;\n    private currentMenu: string;\n    private volumeButtonDiv: React.RefObject<HTMLDivElement> = React.createRef<HTMLDivElement>();\n    private playButtonRef: React.RefObject<HTMLButtonElement> = React.createRef<HTMLButtonElement>();\n    private pauseButtonRef: React.RefObject<HTMLButtonElement> = React.createRef<HTMLButtonElement>();\n    private closedCaptionRef: React.RefObject<HTMLButtonElement> = React.createRef<HTMLButtonElement>();\n    private optionButtonRef: React.RefObject<HTMLButtonElement> = React.createRef<HTMLButtonElement>();\n    private fullscreenButtonRef: React.RefObject<HTMLButtonElement> = React.createRef<HTMLButtonElement>();\n    private exitFullScreenButtonRef: React.RefObject<HTMLButtonElement> = React.createRef<HTMLButtonElement>();\n    private videoControlDiv: React.RefObject<HTMLDivElement> = React.createRef<HTMLDivElement>();\n    private closedCaptionButtonDiv: React.RefObject<HTMLDivElement> = React.createRef<HTMLDivElement>();\n    private optionButtonDiv: React.RefObject<HTMLDivElement> = React.createRef<HTMLDivElement>();\n    private menuRef: React.RefObject<Menu> = React.createRef<Menu>();\n    private muteButtonRef: React.RefObject<HTMLButtonElement> = React.createRef<HTMLButtonElement>();\n    private unMuteButtonRef: React.RefObject<HTMLButtonElement> = React.createRef<HTMLButtonElement>();\n    private payLoad: IPayLoad;\n\n    constructor(props: IVideoControlsProps) {\n        super(props);\n        this.volumeAutoHideTimer = 0;\n        this.focusedMenuItemIndex = 0;\n        this.currentMenu = '';\n        this._hideVolumeControl = this._hideVolumeControl.bind(this);\n        this._onMenuItemClick = this._onMenuItemClick.bind(this);\n        this._reevaluateWidth = this._reevaluateWidth.bind(this);\n        this._onClosedCaptionClick = this._onClosedCaptionClick.bind(this);\n        this._onDocumentClick = this._onDocumentClick.bind(this);\n        this._onOptionsButtonClick = this._onOptionsButtonClick.bind(this);\n        this._onMenuBlur = this._onMenuBlur.bind(this);\n        this._onMenuFocus = this._onMenuFocus.bind(this);\n        this._onMouseOver = this._onMouseOver.bind(this);\n        this._onMouseOut = this._onMouseOut.bind(this);\n        this._onMenuKeyDown = this._onMenuKeyDown.bind(this);\n        this._onMenuKeyUp = this._onMenuKeyUp.bind(this);\n        this.state = {\n            showVolumeSlider: false,\n            volumeSliderLeftPosition: 0,\n            volumeSliderTopPosition: -160,\n            showMenu: false,\n            menuLeftPosition: 0,\n            currentMenu: this.props.closedCaptionMenu,\n            toolTipClass: ''\n        };\n\n        // Construct telemetry attribute to render\n        this.payLoad = getPayloadObject('click', this.props.telemetryContent!, '');\n    }\n\n    public componentDidUpdate(prevProps: IVideoControlsProps): void {\n        if (!this.props.isControlPanelVisible) {\n            this.setState({\n                showMenu: false\n            });\n        }\n       // Updating the selected menu as setstate in player takes time to update\n        if (this.props.currentClosedCaptionLanguage !== prevProps.currentClosedCaptionLanguage\n            || this.props.currentClosedCaptionsSetting !== prevProps.currentClosedCaptionsSetting\n            || this. props.currentAudioTrack !== prevProps.currentAudioTrack) {\n            this._updateSelectedMenu();\n        }\n    }\n\n    // tslint:disable-next-line: max-func-body-length\n    public render(): JSX.Element {\n        const { className, ...props } = this.props;\n\n        const currentTime = this._toElapsedTimeString(props.playPosition.currentTime);\n        const endTime = this._toElapsedTimeString(props.playPosition.endTime);\n\n        const volumeDivStyle = {\n            top: this.state.volumeSliderTopPosition,\n            left: this.state.volumeSliderLeftPosition\n        };\n\n        const menuDivStyle = {\n            left: this.state.menuLeftPosition\n        };\n\n        this.payLoad.contentAction.etext = this.props.playing ? LocalizationConstants.pauseAriaLabel : LocalizationConstants.playAriaLabel;\n        const attribute = getTelemetryAttributes(this.props.telemetryContent!, this.payLoad);\n        return (\n            <div\n                className={className}\n                ref={this.videoControlDiv}\n                role='none'\n                onKeyDown={this.props.handleControlsKeyDownHandler}\n                onBlur={this.props.onBlur}\n                onFocus={this.props.onFocus}\n            >\n                <div className={`${VideoControls.videoControlsClassName}__wrapper`}>\n                    <div className={`${VideoControls.videoControlsClassName}__playpausebtn__container`}>\n                        <ActionToggle className={`${VideoControls.videoControlsClassName}__playpausebtn__wrapper`} onChange={this.props.onPlayClick} toggled={this.props.playing}>\n                            <button\n                                ref={this.playButtonRef}\n                                aria-label={this.props.resources.playAriaLabel}\n                                className={`${VideoControls.videoControlsClassName}__playbtn`}\n                                {...attribute}\n                            />\n                            <button\n                                ref={this.pauseButtonRef}\n                                aria-label={this.props.resources.pauseAriaLabel}\n                                className={`${VideoControls.videoControlsClassName}__pausebtn`}\n                                {...attribute}\n                            />\n                        </ActionToggle>\n                        <UncontrolledTooltip className={this.state.toolTipClass} trigger={'hover focus'} target={this.playButtonRef}> {this.props.resources.playAriaLabel}</UncontrolledTooltip>\n                        <UncontrolledTooltip trigger={'hover focus'} target={this.pauseButtonRef}> {this.props.resources.pauseAriaLabel}</UncontrolledTooltip>\n                    </div>\n                    <div className={`${VideoControls.videoControlsClassName}__time`}>\n                        <div className={`${VideoControls.videoControlsClassName}__time__screenreader`} aria-hidden={this.props.isMobileDevice} aria-live='polite'>{`${this.props.resources.videoTimeDurationLabel} ${currentTime} / ${endTime}`}</div>\n                        <div className={`${VideoControls.videoControlsClassName}__time__text`} aria-hidden='true'>{currentTime} /{` `}{endTime}</div>\n                    </div>\n                    <div className={`${VideoControls.videoControlsClassName}__slider__container`}>\n                        {this._renderVideoSlider()}\n                    </div>\n                    {(this.props.closedCaptionMenu) &&\n                        this._renderClosedCaptionButton()\n                    }\n                    {(this.props.optionMenu) &&\n                        this._renderOptionButton()\n                    }\n                    {(this.state.showMenu) &&\n                        (<Menu\n                            ref={this.menuRef}\n                            className={`${VideoControls.videoControlsClassName}__menu`}\n                            playerMenu={this.state.currentMenu!}\n                            style={menuDivStyle}\n                            onDocumentClick={this._onDocumentClick}\n                            onMenuItemClick={this._onMenuItemClick}\n                            onFocus={this._onMenuFocus}\n                            onBlur={this._onMenuBlur}\n                            onMouseOver={this._onMouseOver}\n                            onMouseOut={this._onMouseOut}\n                            onKeyDown={this._onMenuKeyDown}\n                            onKeyUp={this._onMenuKeyUp}\n                        />)\n                    }\n                    {(!this.props.isMobileDevice) && <div className={`${VideoControls.videoControlsClassName}__muteunmutebtn__container`} ref={this.volumeButtonDiv}>\n                        {this._renderVolumeButton()}\n                    </div>}\n                    {(!this.props.isMobileDevice) && <div\n                        className={`${VideoControls.videoControlsClassName}__volumeslider__container ${this.state.showVolumeSlider ? 'show' : 'hide' }`}\n                        onFocus={this.showVolumeControl()}\n                        onBlur={this._hideVolumeControl}\n                        onMouseOver={this.showVolumeControl()}\n                        onMouseOut={this._hideVolumeControl}\n                        style={volumeDivStyle}\n                        role='presentation'\n                    >\n                        {this._renderVolumeSlider()}\n                    </div>}\n                    {this._renderFullScreenButton()}\n                </div>\n            </div>\n        );\n    }\n\n    public showVolumeControl = (autohide?: boolean) => () => {\n        const offsetPosition = this._getOffsetPosition(this.volumeButtonDiv);\n        window && window.clearTimeout(this.volumeAutoHideTimer);\n\n        this.setState({\n            showVolumeSlider: true,\n            volumeSliderLeftPosition: offsetPosition.offsetLeft,\n            volumeSliderTopPosition: offsetPosition.offsetTop - volumeSliderDivOffset + 1\n        });\n        if (autohide && document.activeElement!.parentElement !== this.volumeButtonDiv.current!.firstChild) {\n            this.volumeAutoHideTimer = window && window.setTimeout(() => {\n                this._hideVolumeControl();\n            },                                                     VideoControls.volumeAutoHideTimeout);\n        }\n    };\n\n    public setFocusOnPlay(): void {\n        this.playButtonRef.current!.focus();\n    }\n\n    public setFocusOnMenuButton(): void {\n        // Don't set focus if control panel is not visible\n        if (this.props.isControlPanelVisible) {\n            if(this.currentMenu === ButtonMenuTypes.ClosedCaption) {\n                this.closedCaptionRef.current!.focus();\n            } else {\n                this.optionButtonRef.current!.focus();\n            }\n        }\n    }\n\n    public componentDidMount(): void {\n        window && window.addEventListener('resize', this._reevaluateWidth);\n        this._reevaluateWidth();\n        if(this._isIPhone()) {\n          const fullscreen = document.getElementsByClassName(`${VideoControls.videoControlsClassName}__fullscreenbtn__container`);\n          fullscreen[0].setAttribute('hidden','true');\n        }\n    }\n\n    public componentWillUnmount(): void {\n        window && window.removeEventListener('resize', this._reevaluateWidth);\n    }\n\n    private _reevaluateWidth(): void {\n        const rowDiv = this.videoControlDiv.current!.children[0];\n        let controlBarButtonsWidth = 0;\n        // Not able to use for-of loop as it causes another ts-lint issue because rowDiv.children is a HTMLCollection object and HTMLCollection\n        // is not an array type and string type. So I am surpressing the ts-lint error here rather than other error\n        // tslint:disable-next-line: prefer-for-of\n        for (let i = 0; i < rowDiv.children.length; i++) {\n            if (rowDiv.children[i].children[0] !== undefined && rowDiv.children[i].children[0].className.includes('action-toggle')) {\n                controlBarButtonsWidth += rowDiv.children[i].clientWidth;\n            }\n        }\n\n        const sliderWidth = controlBarButtonsWidth + 100;\n        rowDiv.children[2].setAttribute('style', `${'width: calc(100% - '}${sliderWidth}${'px)'}`);\n        if (this.state.showVolumeSlider) {\n            this._hideVolumeControl();\n        }\n        if(!this.props.isMobileDevice) {\n            const offsetPosition = this._getOffsetPosition(this.volumeButtonDiv);\n            this.setState({\n                volumeSliderLeftPosition: offsetPosition.offsetLeft,\n                volumeSliderTopPosition: offsetPosition.offsetTop - volumeSliderDivOffset\n            });\n        }\n        if (this.state.showMenu) {\n            this.setState({\n                showMenu: false\n            });\n        }\n\n        const videoControlWidth = this.videoControlDiv.current!.clientWidth;\n        const viewportMax = window && window.innerWidth;\n        this._applyTooltipClassOnWidthChange(videoControlWidth, viewportMax);\n    }\n\n    private _onDocumentClick = (e: Event): void => {\n        const target = e.target as HTMLElement;\n        if (!(((this.currentMenu === ButtonMenuTypes.ClosedCaption) && (target === this.closedCaptionButtonDiv.current!.firstChild || target.parentElement === this.closedCaptionButtonDiv.current!.firstChild)) ||\n        ((this.currentMenu === ButtonMenuTypes.Options) && (target === this.optionButtonDiv.current!.firstChild || target.parentElement === this.optionButtonDiv.current!.firstChild)))\n            ) {\n            this.setState({\n                showMenu: !this.state.showMenu\n            });\n        }\n    }\n\n    private _onMenuFocus(e: Event): void {\n        const button: HTMLButtonElement = e.target as HTMLButtonElement;\n        const hasEvents = button.getAttribute('data-has-events');\n        if (hasEvents) {\n            this.props.onMenuItemFocus({\n                category: button.parentElement!.parentElement!.parentElement!.getAttribute('data-category')!,\n                id: button.parentElement!.id,\n                data: button.getAttribute('data-info')!\n            });\n        }\n    }\n\n    private _onMenuBlur(e: Event): void {\n        const button: HTMLButtonElement = e.target as HTMLButtonElement;\n        const hasEvents = button.getAttribute('data-has-events');\n        if (hasEvents) {\n            this.props.onMenuItemBlur();\n        }\n    }\n\n    private _onMouseOver(e: Event): void {\n        const button: HTMLButtonElement = e.target as HTMLButtonElement;\n        const hasEvents = button.getAttribute('data-has-events');\n        if (hasEvents) {\n            this.props.onMenuItemFocus({\n                category: button.parentElement!.parentElement!.parentElement!.getAttribute('data-category')!,\n                id: button.parentElement!.id,\n                data: button.getAttribute('data-info')!\n            });\n        }\n    }\n\n    private _onMouseOut(e: Event): void {\n        const button: HTMLButtonElement = e.target as HTMLButtonElement;\n        const hasEvents = button.getAttribute('data-has-events');\n        if (hasEvents) {\n            this.props.onMenuItemBlur();\n        }\n    }\n\n    private _onMenuKeyDown(e: Event): void {\n        this._onMenuKeyPressed(e as unknown as KeyboardEvent);\n    }\n\n    private _onMenuKeyUp(event: Event): void {\n        const e = event as unknown as KeyboardEvent;\n        const key = e.keyCode;\n\n        if (key === KeyCodes.Space) {\n            event.preventDefault();\n        }\n    }\n\n    /**\n     * @name - onMenuKeyPressed\n     * @description - Event handler for menu's keyboard events\n     * @private\n     * @param {KeyboardEvent} event - The dialog that is allowed to remain open.\n     * @returns {void}\n     */\n    // tslint:disable-next-line: max-func-body-length cyclomatic-complexity\n    private _onMenuKeyPressed(event: KeyboardEvent): void {\n        const key = event.keyCode;\n        const target = event.target as HTMLElement;\n        const currentMenuItem = this.state.currentMenu!;\n        this._resetFocusForCurrentMenu(currentMenuItem);\n\n        // tslint:disable-next-line: switch-default\n        switch (key) {\n            case KeyCodes.ArrowLeft:\n            case KeyCodes.ArrowRight:\n                event.stopPropagation();\n                event.preventDefault();\n                if (key === KeyCodes.ArrowRight && target.getAttribute('data-has-children') === 'true') {\n                    this._onMenuItemClick(event);\n                }\n                if (key === KeyCodes.ArrowLeft && target.getAttribute('data-isbackbutton') === 'true') {\n                    this._onMenuItemClick(event);\n                }\n                break;\n\n            case KeyCodes.Enter:\n            case KeyCodes.Space:\n                event.preventDefault();\n                this._onMenuItemClick(event);\n                break;\n\n            case KeyCodes.ArrowUp:\n            case KeyCodes.ArrowDown:\n                event.stopPropagation();\n                event.preventDefault();\n\n                if (key === KeyCodes.ArrowUp) {\n                    this.focusedMenuItemIndex -= 1;\n                    if (this.focusedMenuItemIndex < 0) {\n                        this.focusedMenuItemIndex = currentMenuItem.items.length - 1;\n                    }\n                } else {\n                    this.focusedMenuItemIndex = ((this.focusedMenuItemIndex + 1) % currentMenuItem.items.length);\n                }\n\n                currentMenuItem.items[this.focusedMenuItemIndex].hasFocus = true;\n                this.setState({\n                    currentMenu: currentMenuItem\n                },            () => { if(this.menuRef.current) {this.menuRef.current.forceUpdate();} });\n                break;\n\n            case KeyCodes.PageUp:\n            case KeyCodes.Home:\n                event.stopPropagation();\n                event.preventDefault();\n                this.focusedMenuItemIndex = 0;\n                currentMenuItem.items[this.focusedMenuItemIndex].hasFocus = true;\n                this.setState({\n                    currentMenu: currentMenuItem\n                },            () => { if(this.menuRef.current) {this.menuRef.current.forceUpdate();} });\n                break;\n\n            case KeyCodes.End:\n            case KeyCodes.PageDown:\n                event.stopPropagation();\n                event.preventDefault();\n                this.focusedMenuItemIndex = currentMenuItem.items.length - 1;\n                currentMenuItem.items[this.focusedMenuItemIndex].hasFocus = true;\n                this.setState({\n                    currentMenu: currentMenuItem\n                },            () => { if(this.menuRef.current) {this.menuRef.current.forceUpdate();} });\n                break;\n\n            case KeyCodes.Escape:\n                this.setFocusOnMenuButton();\n                this.setState({\n                    showMenu: false\n                });\n                break;\n            case KeyCodes.Tab:\n                if (((this.focusedMenuItemIndex < currentMenuItem.items.length - 1 || this.focusedMenuItemIndex === currentMenuItem.items.length - 1 && event.shiftKey) && this.focusedMenuItemIndex >= 0) && !(\n                    this.focusedMenuItemIndex === 0 && event.shiftKey)) {\n                    this.focusedMenuItemIndex += event.shiftKey ? -1 : 1;\n\n                    currentMenuItem.items[this.focusedMenuItemIndex].hasFocus = true;\n                    this.setState({\n                        currentMenu: currentMenuItem\n                    });\n                } else {\n                    event.stopPropagation();\n                    event.preventDefault();\n                    this.setState({\n                        showMenu: false\n                    });\n                    if(event.shiftKey) {\n                        this.setFocusOnMenuButton();\n                    } else {\n                        if(this.currentMenu === ButtonMenuTypes.ClosedCaption && this.optionButtonRef.current) {\n                            this.optionButtonRef.current.focus();\n                        } else {\n                            this.props.isMuted ? this.unMuteButtonRef.current!.focus() : this.muteButtonRef.current!.focus();\n                        }\n                    }\n                }\n        }\n    }\n\n    private _onMenuItemClick(e: KeyboardEvent): void {\n        const button: HTMLButtonElement = e.currentTarget as HTMLButtonElement;\n        if (button.getAttribute('data-has-children')! === 'true') {\n            const index: number = Number(button.getAttribute('data-itemindex')!);\n            this.selectedMenuItems.push(index);\n            const currentMenuItem = this._getSelectedMenuFromList();\n            this.focusedMenuItemIndex = 0;\n            currentMenuItem.items[this.focusedMenuItemIndex].hasFocus = true;\n            this.setState({\n                currentMenu: currentMenuItem\n            });\n        } else if (button.getAttribute('data-isbackbutton')! === 'true') {\n            this.focusedMenuItemIndex = this.selectedMenuItems.pop()!;\n            const currentMenuItem = this._getSelectedMenuFromList();\n            currentMenuItem.items[this.focusedMenuItemIndex].hasFocus = true;\n            this.setState({\n                currentMenu: currentMenuItem\n            });\n        } else {\n            const currentMenuItem = this._getSelectedMenuFromList();\n            this._resetFocusForCurrentMenu(currentMenuItem);\n            const index: number = Number(button.getAttribute('data-itemindex')!);\n            this.focusedMenuItemIndex = index;\n            const data = this.currentMenu === ButtonMenuTypes.ClosedCaption ? button.getAttribute('data-info') :\n            JSON.stringify({url: button.getAttribute('data-info')!, lang: button.getAttribute('lang')! });\n            this.props.onMenuItemClick({\n                category: button.parentElement!.parentElement!.parentElement!.getAttribute('data-category')!,\n                id: button.parentElement!.id,\n                data: data!\n            });\n        }\n        this._updateSelectedMenu();\n    }\n\n    private _resetFocusForCurrentMenu(currentMenu: IPlayerMenu): void {\n        currentMenu.items.forEach(item => item.hasFocus = false);\n    }\n\n    private _getSelectedMenuFromList(): IPlayerMenu {\n        let menuItem = this.currentMenu === ButtonMenuTypes.ClosedCaption ? this.props.closedCaptionMenu! : this.props.optionMenu!;\n        // tslint:disable-next-line: prefer-for-of\n        for (let i = 0; i < this.selectedMenuItems.length; i++) {\n            menuItem = menuItem.items[this.selectedMenuItems[i]].subMenu!;\n        }\n        return menuItem;\n    }\n\n    private _updateSelectedMenu(): void {\n        const currentMenuItem = this._getSelectedMenuFromList();\n        if(currentMenuItem) {\n\n            // tslint:disable-next-line: switch-default\n            switch (currentMenuItem.category) {\n                case MenuCategories.ClosedCaption:\n                    currentMenuItem.items.forEach((item) => {\n                        if (item.data && item.data === this.props.currentClosedCaptionLanguage) {\n                            item.selected = true;\n                        } else {\n                            item.selected = false;\n                        }\n                    });\n                    break;\n                case MenuCategories.ClosedCaptionSettings:\n                    currentMenuItem.items.forEach((item) => {\n                        // tslint:disable-next-line: forin no-for-in\n                        for (const setting in this.props.currentClosedCaptionsSetting) {\n                            const data = `${setting}:${this.props.currentClosedCaptionsSetting[setting]}`;\n                            if (item.data && item.data === data) {\n                                item.selected = true;\n                                break;\n                            } else {\n                                item.selected = false;\n                            }\n                        }\n                    });\n                    break;\n                case MenuCategories.AudioTracks:\n                    currentMenuItem.items.forEach((item) => {\n                        if (item.language && item.language === this.props.currentAudioTrack) {\n                            item.selected = true;\n                        } else {\n                            item.selected = false;\n                        }\n                    });\n            }\n\n            this.setState({\n                currentMenu: currentMenuItem\n            },            () => { if(this.menuRef.current) {this.menuRef.current.forceUpdate();} });\n        }\n    }\n\n    private _renderClosedCaptionButton = (): JSX.Element => {\n        return (\n            <div className={`${VideoControls.videoControlsClassName}__closedcaption__container`} ref={this.closedCaptionButtonDiv}>\n                <button\n                    ref={this.closedCaptionRef}\n                    aria-label={this.props.resources.closedCaptionLabel}\n                    className={`${VideoControls.videoControlsClassName}__closedcaptionbtn`}\n                    onClick={this._onClosedCaptionClick}\n                />\n                <UncontrolledTooltip trigger={'hover focus'} target={this.closedCaptionRef}>{this.props.resources.closedCaptionLabel}</UncontrolledTooltip>\n            </div>\n        );\n    }\n\n    private _renderOptionButton = (): JSX.Element => {\n        return (\n            <div className={`${VideoControls.videoControlsClassName}__moreoptions__container`} ref={this.optionButtonDiv}>\n                <button\n                    ref={this.optionButtonRef}\n                    aria-label={this.props.resources.optionButtonLabel}\n                    className={`${VideoControls.videoControlsClassName}__moreoptionsbtn`}\n                    onClick={this._onOptionsButtonClick}\n                />\n                <UncontrolledTooltip trigger={'hover focus'} target={this.optionButtonRef}>{this.props.resources.optionButtonLabel}</UncontrolledTooltip>\n            </div>\n        );\n    }\n\n    private _renderFullScreenButton = (): JSX.Element => {\n        this.payLoad.contentAction.etext = this.props.isInFullScreen ? LocalizationConstants.exitFullScreenAriaLabel : LocalizationConstants.fullScreenAriaLabel;\n        const attribute = getTelemetryAttributes(this.props.telemetryContent!, this.payLoad);\n        return (\n            <div className={`${VideoControls.videoControlsClassName}__fullscreenbtn__container`}>\n            <ActionToggle\n                onChange={this.props.toggleFullScreen}\n                toggled={this.props.isInFullScreen}\n                className={`${VideoControls.videoControlsClassName}__fullscreenbtn__wrapper`}\n            >\n                <button\n                    ref={this.fullscreenButtonRef}\n                    aria-label={this.props.resources.fullScreenAriaLabel}\n                    className={`${VideoControls.videoControlsClassName}__fullscreenbtn`}\n                    {...attribute}\n                />\n                <button\n                    ref={this.exitFullScreenButtonRef}\n                    aria-label={this.props.resources.exitFullScreenAriaLabel}\n                    className={`${VideoControls.videoControlsClassName}__exitfullscreenbtn`}\n                    {...attribute}\n                />\n            </ActionToggle>\n            <UncontrolledTooltip className={`${VideoControls.videoControlsClassName}__fullscreenbtn__tooltip`} trigger={'hover focus'} target={this.fullscreenButtonRef}> {this.props.resources.fullScreenAriaLabel}</UncontrolledTooltip>\n            <UncontrolledTooltip trigger={'hover focus'} target={this.exitFullScreenButtonRef}> {this.props.resources.exitFullScreenAriaLabel}</UncontrolledTooltip>\n        </div>\n        );\n    }\n\n    private _renderVolumeButton = (): JSX.Element => {\n        this.payLoad.contentAction.etext = this.props.isMuted ? LocalizationConstants.unMuteAriaLabel : LocalizationConstants.muteAriaLabel;\n        const attribute = getTelemetryAttributes(this.props.telemetryContent!, this.payLoad);\n        const volumeButtonProps = {\n            className: `${VideoControls.videoControlsClassName}__muteunmutebtn__wrapper`,\n            onChange: this.props.onMuteClick,\n            toggled: this.props.isMuted,\n            onFocus: this.showVolumeControl(),\n            onBlur: this._hideVolumeControl,\n            onMouseOver: this.showVolumeControl(),\n            onMouseOut: this._hideVolumeControl,\n        };\n\n        return (\n            <ActionToggle {...volumeButtonProps}>\n                <button\n                    aria-label={this.props.resources.muteAriaLabel}\n                    ref={this.muteButtonRef}\n                    className={`${VideoControls.videoControlsClassName}__mutebtn`}\n                    {...attribute}\n                />\n                <button\n                    aria-label={this.props.resources.unMuteAriaLabel}\n                    ref={this.unMuteButtonRef}\n                    className={`${VideoControls.videoControlsClassName}__unmutebtn`}\n                    {...attribute}\n                />\n            </ActionToggle>\n        );\n    }\n\n    private _renderVideoSlider = (): JSX.Element => {\n        const videoProps: ISliderProps = {\n            id: 'VideoSlider',\n            inForm: false,\n            className: `${VideoControls.videoControlsClassName}__slidercontainer`,\n            min: this.props.playPosition.startTime,\n            max: this.props.playPosition.endTime,\n            ariaLabel: this.props.resources.seekBarLabel,\n            fillTrackValue: this.props.playPosition.bufferedDuration,\n            step: this.props.videoSeekSteps || 1,\n            orientation: 'horizontal',\n            showProgressBar: true,\n            onChange: this.props.onProgressChange,\n            showLabels: false,\n            showTooltip: true,\n            handleTooltipText: this._handleProgressToolTipText(this.props.playPosition.currentTime),\n            sliderThumbs: [\n                {\n                    id: 'VideoSliderThumb',\n                    value: this.props.playPosition.currentTime,\n                    ariaValueText: this.props.playPosition.currentTime.toString()\n                }\n            ]\n        };\n\n        return (\n            <Slider {...videoProps} />\n        );\n    }\n\n    private _renderVolumeSlider = (): JSX.Element => {\n        const volumeSliderProps: ISliderProps = {\n            id: 'VolumeSlider',\n            inForm: false,\n            className: `${VideoControls.videoControlsClassName}__volumeslider`,\n            min: 0,\n            max: 100,\n            step: this.props.volumeSeekSteps || 5,\n            orientation: 'vertical',\n            showProgressBar: false,\n            onChange: this.props.onVolumeChange,\n            onFocus: this.showVolumeControl(),\n            onBlur: this._hideVolumeControl,\n            showLabels: false,\n            showTooltip: true,\n            sliderThumbs: [\n                {\n                    id: 'VolumeSliderThumb',\n                    value: Math.round(this.props.currentVolume),\n                    ariaValueText: Math.round(this.props.currentVolume).toString(),\n                }\n            ]\n        };\n        return (\n            <Slider {...volumeSliderProps} />\n        );\n    }\n\n    private _getOffsetPosition(refDiv: React.RefObject<HTMLDivElement>): IOffsetPosition {\n        const buttonWidth = refDiv.current!.children[0].clientWidth;\n        const elementwidth = refDiv.current!.offsetWidth;\n        const offsetLeft = refDiv.current!.offsetLeft + (elementwidth - buttonWidth) / 2;\n        const offsetTop = refDiv.current!.offsetTop;\n        return {\n            offsetLeft,\n            offsetTop\n        };\n    }\n\n    private _onClosedCaptionClick(): void {\n        this.currentMenu = ButtonMenuTypes.ClosedCaption;\n        const offsetLeft = this._getOffsetPosition(this.closedCaptionButtonDiv).offsetLeft;\n        this.focusedMenuItemIndex = 0;\n        this.selectedMenuItems = [];\n        const closedCaptionMenu = this.props.closedCaptionMenu!;\n        this._resetFocusForCurrentMenu(closedCaptionMenu);\n        closedCaptionMenu.items[this.focusedMenuItemIndex].hasFocus = true;\n        this.setState({\n            showMenu: (this.currentMenu === ButtonMenuTypes.ClosedCaption && !this.state.showMenu),\n            menuLeftPosition: offsetLeft - 120,\n            currentMenu: closedCaptionMenu,\n        });\n        this._updateSelectedMenu();\n    }\n\n    private _onOptionsButtonClick(): void {\n        this.currentMenu = ButtonMenuTypes.Options;\n        const offsetLeft = this._getOffsetPosition(this.optionButtonDiv).offsetLeft;\n        this.focusedMenuItemIndex = 0;\n        this.selectedMenuItems = [];\n        const optionMenu = this.props.optionMenu!;\n        this._resetFocusForCurrentMenu(optionMenu);\n        optionMenu.items[this.focusedMenuItemIndex].hasFocus = true;\n        this.setState({\n            showMenu: (this.currentMenu === ButtonMenuTypes.Options && !this.state.showMenu),\n            menuLeftPosition: offsetLeft - 120,\n            currentMenu: optionMenu,\n        });\n        this._updateSelectedMenu();\n    }\n\n    private _hideVolumeControl(): void {\n        window && window.clearTimeout(this.volumeAutoHideTimer);\n        this.setState({\n            showVolumeSlider: false\n        });\n    }\n\n    private _handleProgressToolTipText = (tooltip: number) => () => {\n        return this._toElapsedTimeString(tooltip);\n    };\n\n    private _toElapsedTimeString(seconds: number): string {\n        const negative = seconds < 0;\n        if (negative) {\n            seconds *= -1;\n        }\n\n        const hours = Math.floor(seconds / 3600);\n        const remainder = seconds % 3600;\n        const minutes = Math.floor(remainder / 60);\n\n        let elapsedTime = '';\n        elapsedTime = hours > 0 ? `${hours}:` : '';\n\n        seconds = Math.floor(remainder % 60);\n        elapsedTime += `${(minutes < 10 ? '0' : '') + minutes.toString()}`;\n        elapsedTime += `:${seconds === 0 ? '00' : (seconds < 10 ? '0' : '') + seconds.toString()}`;\n\n        return negative ? `-${elapsedTime}` : elapsedTime;\n    }\n\n    private _applyTooltipClassOnWidthChange(videoControlWidth: number, viewportMax: number): void {\n        if(videoControlWidth) {\n            this.setState({\n                toolTipClass: (videoControlWidth > this.props.viewportMin! && videoControlWidth < viewportMax) ? `${VideoControls.videoControlsClassName}__playpausebtn__tooltip` : ''\n            });\n        }\n    }\n\n    private _isIPhone(): boolean {\n        const useragent = window && window.navigator.userAgent;\n        return !!useragent.match(/iPhone/i);\n    }\n}\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}