{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _asyncToGenerator from\"@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _inherits from\"@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/esm/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol===\"undefined\"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length===\"number\"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};},e:function e(_e){throw _e;},f:F};}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]();},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e2){didErr=true;err=_e2;},f:function f(){try{if(!normalCompletion&&it[\"return\"]!=null)it[\"return\"]();}finally{if(didErr)throw err;}}};}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import{__decorate}from\"tslib\";import{getProductUrlSync}from'@msdyn365-commerce-modules/retail-actions';import{getTelemetryObject}from'@msdyn365-commerce-modules/utilities';import*as MsDyn365 from'@msdyn365-commerce/core';import{createGetByCustomerInput,removeLinesAsync}from'@msdyn365-commerce/retail-proxy/dist/DataActions/CommerceListsDataActions.g';import classnames from'classnames';import{observer}from'mobx-react';import*as React from'react';import getItemsInWishlists,{ActiveWishlistInput}from'./actions/get-items-in-wishlists';import{WishlistItem,WishlistItemsStatusMessage}from'./components/';var WishlistItems=/*#__PURE__*/function(_React$Component){_inherits(WishlistItems,_React$Component);var _super=_createSuper(WishlistItems);function WishlistItems(props){var _this;_classCallCheck(this,WishlistItems);_this=_super.call(this,props);_this.handleHeadingChange=function(event){return _this.props.config.heading.text=event.target.value;};_this._onDismiss=function(){_this.setState({isOpen:false});};_this._renderHeading=function(heading){if(!heading){return undefined;}return/*#__PURE__*/React.createElement(MsDyn365.Text,{className:'ms-wishlist-items__heading',tag:heading.tag||'h2',text:heading.text,editProps:{onEdit:_this.handleHeadingChange,requestContext:_this.props.context.request}});};_this._addItemToCart=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(product,itemKey){var _this$props,context,data,resources,telemetry,cart,productAvailability,addedToCartSuccessMessage,addedToCartFailureMessage,productInventoryInformation,addProductToCartInput;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this$props=_this.props,context=_this$props.context,data=_this$props.data,resources=_this$props.resources,telemetry=_this$props.telemetry;cart=data.cart,productAvailability=data.productAvailability;addedToCartSuccessMessage=resources.addedToCartSuccessMessage,addedToCartFailureMessage=resources.addedToCartFailureMessage;productInventoryInformation=_this._getProductInventory({ProductDetails:product},productAvailability.result);if(context){if(cart.result){addProductToCartInput={product:product,quantity:1,enableStockCheck:context.app.config.enableStockCheck,availableQuantity:productInventoryInformation?productInventoryInformation.ProductAvailableQuantity.AvailableQuantity:0};cart.result.addProductToCart(addProductToCartInput).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(result){var _yield$cart$cart,_yield$cart$cart$Cart,_yield$cart$cart$Cart2,curQuantity,maxQtyLimitReachedMessage;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(result.status==='SUCCESS')){_context.next=4;break;}_this.setState({productId:product.RecordId,itemKey:itemKey,userMessage:addedToCartSuccessMessage,statusCssString:'success',messageGlyph:'fas fa-check',isOpen:true});_context.next=26;break;case 4:if(!(result.substatus==='MAXQUANTITY')){_context.next=24;break;}_context.next=7;return cart;case 7:_context.t2=_yield$cart$cart=_context.sent.cart;_context.t1=_context.t2===null;if(_context.t1){_context.next=11;break;}_context.t1=_yield$cart$cart===void 0;case 11:if(!_context.t1){_context.next=15;break;}_context.t3=void 0;_context.next=16;break;case 15:_context.t3=(_yield$cart$cart$Cart=_yield$cart$cart.CartLines)===null||_yield$cart$cart$Cart===void 0?void 0:(_yield$cart$cart$Cart2=_yield$cart$cart$Cart.find(function(item){return item.ProductId===product.RecordId;}))===null||_yield$cart$cart$Cart2===void 0?void 0:_yield$cart$cart$Cart2.Quantity;case 16:_context.t0=_context.t3;if(_context.t0){_context.next=19;break;}_context.t0=0;case 19:curQuantity=_context.t0;maxQtyLimitReachedMessage=_this._getInventoryValueMessage(productInventoryInformation,curQuantity);_this.setState({productId:product.RecordId,itemKey:itemKey,userMessage:maxQtyLimitReachedMessage,statusCssString:'danger',messageGlyph:'fas fa-exclamation-triangle',isOpen:true});_context.next=26;break;case 24:_this.props.telemetry.debug('[wishlist-items] Unable to Update Cart Line from the wishlist');_this.setState({productId:product.RecordId,itemKey:itemKey,userMessage:addedToCartFailureMessage,statusCssString:'danger',messageGlyph:'fas fa-exclamation-triangle',isOpen:true});case 26:case\"end\":return _context.stop();}}},_callee);}));return function(_x3){return _ref2.apply(this,arguments);};}())[\"catch\"](function(error){telemetry.warning(error);telemetry.debug('[wishlist-items] Error trying to Update Cart Line from the wishlist');_this.setState({productId:product.RecordId,itemKey:itemKey,userMessage:addedToCartFailureMessage,statusCssString:'danger',messageGlyph:'fas fa-exclamation-triangle',isOpen:true});});}}case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x,_x2){return _ref.apply(this,arguments);};}();_this._removeItemFromWishlist=function(productId){var _this$props2=_this.props,context=_this$props2.context,data=_this$props2.data,telemetry=_this$props2.telemetry;var wishlists=data.wishlists;if(context&&context.actionContext){var userToken=context.request.user.isAuthenticated&&context.request.user.token;var wishlistLineId=_this._getWishlistLineIdFromProductId(productId);if(userToken&&wishlists.result&&wishlists.result[0]&&wishlistLineId){removeLinesAsync({callerContext:context.actionContext},wishlists.result[0].Id,[{LineId:wishlistLineId}]).then(function(commerceList){var castCommerceList=commerceList;if(castCommerceList&&castCommerceList.Id&&context.request.user.isAuthenticated){context.actionContext.update(createGetByCustomerInput({},null),[castCommerceList]);getItemsInWishlists(new ActiveWishlistInput(),context.actionContext).then(function(products){var castSimpleProducts=products;if(castSimpleProducts&&castSimpleProducts.length>0){context.actionContext.update(new ActiveWishlistInput(),castSimpleProducts);}})[\"catch\"](function(error){telemetry.warning('[wishlist-items] Unable to hyderate the wishlist with product information');telemetry.error(error);});}})[\"catch\"](function(error){telemetry.warning('[wishlist-items] Unable remove items from the wishlist');telemetry.error(error);});}else{telemetry.warning('[wishlist-items] Unable remove items from the wishlist user token or lineItemID wasn\\'t found');}}};_this._inventoryLabel=function(product){var productAvailability=_this.props.data.productAvailability;if(productAvailability&&productAvailability.result){var productInventoryInformation=_this._getProductInventory(product,productAvailability.result);if(productInventoryInformation){return productInventoryInformation.StockLevelLabel;}}return undefined;};_this._inventoryClassName=function(product){var productAvailability=_this.props.data.productAvailability;if(productAvailability&&productAvailability.result){var productInventoryInformation=_this._getProductInventory(product,productAvailability.result);if(productInventoryInformation&&productInventoryInformation.StockLevelCode){return\"ms-wishlist-items__\".concat(productInventoryInformation.StockLevelCode.toLowerCase());}}return undefined;};_this._isProductInStock=function(product){var _this$props3=_this.props,data=_this$props3.data,context=_this$props3.context;var productAvailability=data.productAvailability;if(!context.app.config.enableStockCheck){return true;}if(!productAvailability.result||!product.ProductDetails){return false;}var _iterator=_createForOfIteratorHelper(productAvailability.result),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var productResult=_step.value;if(productResult.ProductAvailableQuantity&&productResult.ProductAvailableQuantity.ProductId&&productResult.ProductAvailableQuantity.ProductId===product.ProductDetails.RecordId){return productResult.IsProductAvailable;}}}catch(err){_iterator.e(err);}finally{_iterator.f();}return false;};_this._getWishlistLineIdFromProductId=function(productId){var wishlists=_this.props.data.wishlists;if(!wishlists.result||!(wishlists.result.length>0)||!wishlists.result[0].CommerceListLines||!(wishlists.result[0].CommerceListLines.length>0)){_this.props.telemetry.error('Wishlist content is empty, module wont render.');return null;}var foundWishlistItem=wishlists.result[0].CommerceListLines.filter(function(commerceListLine){return commerceListLine.ProductId===productId;});if(foundWishlistItem&&foundWishlistItem[0].LineId){return foundWishlistItem[0].LineId;}else{return null;}};_this.telemetryContent=getTelemetryObject(_this.props.context.request.telemetryPageName,_this.props.friendlyName,_this.props.telemetry);return _this;}_createClass(WishlistItems,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:this.setState({});case 1:case\"end\":return _context3.stop();}}},_callee3,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this$props$config=this.props.config,heading=_this$props$config.heading,className=_this$props$config.className;var _this$props$resources=this.props.resources,emptyWishlistText=_this$props$resources.emptyWishlistText,wishlistErrorGettingWishlist=_this$props$resources.wishlistErrorGettingWishlist;var _this$props$data=this.props.data,cart=_this$props$data.cart,productAvailability=_this$props$data.productAvailability,wishlists=_this$props$data.wishlists,products=_this$props$data.products;if(cart.status==='LOADING'||productAvailability.status==='LOADING'||wishlists.status==='LOADING'){var errorProps=_objectSpread(_objectSpread({},this.props),{},{WishlistItems:{moduleProps:this.props,className:classnames('ms-wishlist-items',className)},status:'LOADING',statusMessage:/*#__PURE__*/React.createElement(WishlistItemsStatusMessage,{errorType:'LOADING',text:'Loading...'}),heading:this._renderHeading(heading)});return this.props.renderView(errorProps);}if(cart.status==='FAILED'||productAvailability.status==='FAILED'||wishlists.status==='FAILED'){var _errorProps=_objectSpread(_objectSpread({},this.props),{},{WishlistItems:{moduleProps:this.props,className:classnames('ms-wishlist-items',className)},status:'FAILED',statusMessage:/*#__PURE__*/React.createElement(WishlistItemsStatusMessage,{errorType:'FAILED',text:wishlistErrorGettingWishlist}),heading:this._renderHeading(heading)});return this.props.renderView(_errorProps);}var productsList=products&&products.result;if(!!productsList&&productsList.length===0){var emptyViewProps=_objectSpread(_objectSpread({},this.props),{},{WishlistItems:{moduleProps:this.props,className:classnames('ms-wishlist-items',className)},status:'EMPTY',statusMessage:/*#__PURE__*/React.createElement(WishlistItemsStatusMessage,{errorType:'EMPTY',text:emptyWishlistText}),heading:this._renderHeading(heading)});return this.props.renderView(emptyViewProps);}var viewProps=_objectSpread(_objectSpread({},this.props),{},{WishlistItems:{moduleProps:this.props,className:classnames('ms-wishlist-items',className)},status:'SUCCESS',heading:this._renderHeading(heading),Products:{className:'ms-wishlist-items__products',tag:'ul'},Product:{className:'ms-wishlist-items__product',tag:'li'},ProductDetails:{className:'ms-wishlist-items__product-link',tag:'a'},telemetryContent:this.telemetryContent,ProductDimensions:{className:'ms-wishlist-items__product-dimensions'},products:productsList&&this._renderProductList(productsList)});return this.props.renderView(viewProps);}},{key:\"_renderProductList\",value:function _renderProductList(products){var _this2=this;var _this$props$resources2=this.props.resources,priceFree=_this$props$resources2.priceFree,originalPriceText=_this$props$resources2.originalPriceText,currentPriceText=_this$props$resources2.currentPriceText,addToCartButtonText=_this$props$resources2.addToCartButtonText,outOfStockText=_this$props$resources2.outOfStockText,removeButtonText=_this$props$resources2.removeButtonText,productDimensionTypeColor=_this$props$resources2.productDimensionTypeColor,productDimensionTypeSize=_this$props$resources2.productDimensionTypeSize,productDimensionTypeStyle=_this$props$resources2.productDimensionTypeStyle;var _this$props4=this.props,context=_this$props4.context,telemetry=_this$props4.telemetry;var _this$props$config2=this.props.config,imageSettings=_this$props$config2.imageSettings,enableImageProductLink=_this$props$config2.enableImageProductLink;return products.map(function(product,index){var currentProductProps={product:product.ProductDetails,price:product.ProductPrice,context:context,wishlistState:_this2.state,productUrl:getProductUrlSync(product.ProductDetails,context.actionContext,undefined),imageSettings:imageSettings,removeFromWishlistText:removeButtonText,isInStock:_this2._isProductInStock(product),addToCartText:addToCartButtonText,outOfStockText:outOfStockText,index:index,itemKey:\"\".concat(product.ProductDetails.RecordId,\"-\").concat(product.ProductDetails.ItemId,\"-\").concat(index),telemetry:telemetry,moduleId:_this2.props.id,moduleTypeName:_this2.props.typeName,enableImageProductLink:enableImageProductLink,inventoryInformationLabel:_this2._inventoryLabel(product),inventoryLabelClassName:_this2._inventoryClassName(product),telemetryContent:_this2.telemetryContent,handlers:{onAddToCart:_this2._addItemToCart,onRemoveItem:_this2._removeItemFromWishlist,onDismiss:_this2._onDismiss},resources:{productDimensionTypeColor:productDimensionTypeColor,productDimensionTypeSize:productDimensionTypeSize,productDimensionTypeStyle:productDimensionTypeStyle,freePriceText:priceFree,originalPriceText:originalPriceText,currentPriceText:currentPriceText}};return WishlistItem(currentProductProps);});}},{key:\"_getInventoryValueMessage\",value:function _getInventoryValueMessage(product,curQuantity){var _this$props5=this.props,context=_this$props5.context,resources=_this$props5.resources;var maxQuantityLimitText=resources.maxQuantityLimitText;var maxQuantityForLineItem=context.app.config.maxQuantityForCartLineItem||10;if(!product||!product.ProductAvailableQuantity.AvailableQuantity||!context.app.config.enableStockCheck){return maxQuantityLimitText.replace('{maxQuantity}',maxQuantityForLineItem.toString()).replace('{curQuantity}',curQuantity.toString());}var minInventory=Math.min(maxQuantityForLineItem,product.ProductAvailableQuantity.AvailableQuantity);return maxQuantityLimitText.replace('{maxQuantity}',minInventory.toString()).replace('{curQuantity}',curQuantity.toString());}},{key:\"_getProductInventory\",value:function _getProductInventory(product,productInventoryCollection){if(productInventoryCollection&&productInventoryCollection.length){var _iterator2=_createForOfIteratorHelper(productInventoryCollection),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var productResult=_step2.value;if(product.ProductDetails.RecordId===productResult.ProductAvailableQuantity.ProductId){return productResult;}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}return undefined;}}]);return WishlistItems;}(React.Component);WishlistItems=__decorate([observer],WishlistItems);export default WishlistItems;","map":{"version":3,"sources":["modules/wishlist-items/wishlist-items.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getProductUrlSync, IProductInventoryInformation } from '@msdyn365-commerce-modules/retail-actions';\nimport { getTelemetryObject, IModuleProps, INodeProps, ITelemetryContent } from '@msdyn365-commerce-modules/utilities';\nimport { FullProduct } from '@msdyn365-commerce/commerce-entities';\nimport * as MsDyn365 from '@msdyn365-commerce/core';\nimport { AsyncResult, CommerceList, SimpleProduct } from '@msdyn365-commerce/retail-proxy';\nimport { createGetByCustomerInput, removeLinesAsync } from '@msdyn365-commerce/retail-proxy/dist/DataActions/CommerceListsDataActions.g';\nimport classnames from 'classnames';\nimport { observer } from 'mobx-react';\nimport * as React from 'react';\nimport getItemsInWishlists, { ActiveWishlistInput } from './actions/get-items-in-wishlists';\nimport { IWishlistItemViewProps, WishlistItem, WishlistItemsStatusMessage } from './components/';\nimport { IWishlistItemsData } from './wishlist-items.data';\nimport { IHeadingData, IWishlistItemsProps } from './wishlist-items.props.autogenerated';\n\nexport interface IWishlistItemActionMessageState {\n    productId: number;\n    itemKey: string;\n    userMessage: string;\n    statusCssString: string;\n    messageGlyph: string;\n    isOpen: boolean;\n}\n\nexport type wishlistStatus = 'LOADING' | 'SUCCESS' | 'FAILED' | 'EMPTY';\n\nexport interface IWishlistItemsViewProps extends IWishlistItemsProps<IWishlistItemsData> {\n    WishlistItems: IModuleProps;\n    status?: wishlistStatus;\n    statusMessage?: React.ReactNode;\n    heading?: React.ReactNode;\n    Products?: INodeProps;\n    Product?: INodeProps;\n    ProductDetails?: INodeProps;\n    ProductDimensions?: INodeProps;\n    products?: IWishlistItemViewProps[];\n    telemetryContent?: ITelemetryContent;\n}\n\n/**\n *\n * WishlistItems component\n * @extends {React.PureComponent<IWishlistItemsProps<IWishlistItemsData>, IWishlistItemActionMessageState>}\n */\n@observer\nclass WishlistItems extends React.Component<IWishlistItemsProps<IWishlistItemsData>, IWishlistItemActionMessageState> {\n\n    private telemetryContent: ITelemetryContent;\n\n    constructor(props: IWishlistItemsProps<IWishlistItemsData>) {\n        super(props);\n        this.telemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!,  this.props.friendlyName, this.props.telemetry);\n    }\n\n    public async componentDidMount(): Promise<void> {\n        this.setState({});\n    }\n\n    public render(): JSX.Element | null {\n        const { heading, className } = this.props.config;\n        const { emptyWishlistText, wishlistErrorGettingWishlist } = this.props.resources;\n        const { cart, productAvailability, wishlists, products } = this.props.data;\n\n        if (cart.status === 'LOADING' || productAvailability.status === 'LOADING' || wishlists.status === 'LOADING') {\n            const errorProps: IWishlistItemsViewProps = {\n                ...(this.props as IWishlistItemsProps<IWishlistItemsData>),\n                WishlistItems: {\n                    moduleProps: this.props,\n                    className: classnames('ms-wishlist-items', className),\n                },\n                status: 'LOADING',\n                // statusMessage: <Waiting className={ waitingClass || 'ms-wishlist-items__message-loading'} />\n                statusMessage: <WishlistItemsStatusMessage errorType='LOADING' text='Loading...'/>,\n                heading: this._renderHeading(heading)\n            };\n            return this.props.renderView(errorProps);\n        }\n\n        if (cart.status === 'FAILED' || productAvailability.status === 'FAILED' || wishlists.status === 'FAILED') {\n            const errorProps: IWishlistItemsViewProps = {\n                ...(this.props as IWishlistItemsProps<IWishlistItemsData>),\n                WishlistItems: {\n                    moduleProps: this.props,\n                    className: classnames('ms-wishlist-items', className),\n                },\n                status: 'FAILED',\n                statusMessage: <WishlistItemsStatusMessage errorType='FAILED' text={ wishlistErrorGettingWishlist }/>,\n                heading: this._renderHeading(heading)\n            };\n\n            return this.props.renderView(errorProps);\n        }\n\n        const productsList = products && (products as AsyncResult<FullProduct[]>).result;\n\n        if (!!productsList && productsList.length === 0) {\n            const emptyViewProps: IWishlistItemsViewProps = {\n                ...(this.props as IWishlistItemsProps<IWishlistItemsData>),\n                WishlistItems: {\n                    moduleProps: this.props,\n                    className: classnames('ms-wishlist-items', className),\n                },\n                status: 'EMPTY',\n                statusMessage: <WishlistItemsStatusMessage errorType='EMPTY' text={ emptyWishlistText }/>,\n                heading: this._renderHeading(heading)\n            };\n\n            return this.props.renderView(emptyViewProps);\n        }\n\n        const viewProps: IWishlistItemsViewProps = {\n            ...(this.props as IWishlistItemsProps<IWishlistItemsData>),\n            WishlistItems: {\n                moduleProps: this.props,\n                className: classnames('ms-wishlist-items', className),\n            },\n            status: 'SUCCESS',\n            heading: this._renderHeading(heading),\n            Products: {\n                className: 'ms-wishlist-items__products',\n                tag: 'ul',\n            },\n            Product: {\n                className: 'ms-wishlist-items__product',\n                tag: 'li',\n            },\n            ProductDetails: {\n                className: 'ms-wishlist-items__product-link',\n                tag: 'a',\n            },\n            telemetryContent: this.telemetryContent,\n            ProductDimensions: {\n                className: 'ms-wishlist-items__product-dimensions',\n            },\n            products: productsList && this._renderProductList(productsList),\n        };\n\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n\n    public handleHeadingChange = (event: MsDyn365.ContentEditableEvent) => this.props.config.heading!.text = event.target.value;\n\n    private _renderProductList(products: FullProduct[]): IWishlistItemViewProps[] {\n\n        const { priceFree, originalPriceText, currentPriceText, addToCartButtonText, outOfStockText, removeButtonText, productDimensionTypeColor, productDimensionTypeSize, productDimensionTypeStyle} = this.props.resources;\n        const { context, telemetry } = this.props;\n        const { imageSettings, enableImageProductLink } = this.props.config;\n\n        return products.map((product: FullProduct, index) => {\n            const currentProductProps = {\n                product: product.ProductDetails,\n                price: product.ProductPrice,\n                context: context,\n                wishlistState: this.state,\n                productUrl: getProductUrlSync(product.ProductDetails, context.actionContext, undefined),\n                imageSettings: imageSettings,\n                removeFromWishlistText: removeButtonText,\n                isInStock: this._isProductInStock(product),\n                addToCartText: addToCartButtonText,\n                outOfStockText: outOfStockText,\n                index: index,\n                itemKey: `${product.ProductDetails.RecordId}-${product.ProductDetails.ItemId}-${index}`,\n                telemetry: telemetry,\n                moduleId: this.props.id,\n                moduleTypeName: this.props.typeName,\n                enableImageProductLink: enableImageProductLink,\n                inventoryInformationLabel: this._inventoryLabel(product),\n                inventoryLabelClassName: this._inventoryClassName(product),\n                telemetryContent: this.telemetryContent,\n                handlers: {\n                    onAddToCart: this._addItemToCart,\n                    onRemoveItem: this._removeItemFromWishlist,\n                    onDismiss: this._onDismiss\n                },\n                resources: {\n                    productDimensionTypeColor: productDimensionTypeColor,\n                    productDimensionTypeSize: productDimensionTypeSize,\n                    productDimensionTypeStyle: productDimensionTypeStyle,\n                    freePriceText: priceFree,\n                    originalPriceText: originalPriceText,\n                    currentPriceText: currentPriceText\n                }\n            };\n\n            return (\n                WishlistItem(currentProductProps)!\n            );\n        });\n    }\n\n    // dismiss alert when addingToCart/removeItem\n    private _onDismiss = () => {\n        this.setState({\n            isOpen: false\n        });\n    }\n\n    private _renderHeading = (heading?: IHeadingData): JSX.Element | undefined => {\n        if(!heading) {\n            return undefined;\n        }\n        return(\n            <MsDyn365.Text\n                className={'ms-wishlist-items__heading'}\n                tag={heading.tag || 'h2'}\n                text= {heading.text}\n                editProps={{onEdit:this.handleHeadingChange, requestContext: this.props.context.request}}\n            />\n        );\n    }\n\n    private _addItemToCart = async (product: SimpleProduct, itemKey: string): Promise<void> => {\n        const { context, data, resources, telemetry } = this.props;\n        const { cart, productAvailability } = data;\n        const { addedToCartSuccessMessage, addedToCartFailureMessage } = resources;\n\n        const productInventoryInformation = this._getProductInventory({ProductDetails:product}, productAvailability.result);\n\n        if (context) {\n            if (cart.result) {\n                const addProductToCartInput = {\n                    product: product,\n                    quantity: 1,\n                    enableStockCheck: context.app.config.enableStockCheck,\n                    availableQuantity: productInventoryInformation?productInventoryInformation.ProductAvailableQuantity.AvailableQuantity : 0\n                };\n\n                cart.result.addProductToCart(addProductToCartInput)\n                        .then(async result => {\n                            if (result.status === 'SUCCESS') {\n                                this.setState({\n                                    productId: product.RecordId,\n                                    itemKey: itemKey,\n                                    userMessage: addedToCartSuccessMessage,\n                                    statusCssString: 'success',\n                                    messageGlyph: 'fas fa-check',\n                                    isOpen: true\n                                });\n                            } else if (result.substatus === 'MAXQUANTITY') {\n                                const curQuantity = (await cart).cart?.CartLines?.find(item => item.ProductId === product.RecordId)?.Quantity || 0;\n                                const maxQtyLimitReachedMessage =  this._getInventoryValueMessage(productInventoryInformation, curQuantity);\n\n                                this.setState({\n                                    productId: product.RecordId,\n                                    itemKey: itemKey,\n                                    userMessage: maxQtyLimitReachedMessage,\n                                    statusCssString: 'danger',\n                                    messageGlyph: 'fas fa-exclamation-triangle',\n                                    isOpen: true\n                                });\n                            } else {\n                                this.props.telemetry.debug('[wishlist-items] Unable to Update Cart Line from the wishlist');\n                                this.setState({\n                                    productId: product.RecordId,\n                                    itemKey: itemKey,\n                                    userMessage: addedToCartFailureMessage,\n                                    statusCssString: 'danger',\n                                    messageGlyph: 'fas fa-exclamation-triangle',\n                                    isOpen: true\n                                });\n                            }\n                        })\n                        .catch(error => {\n                            telemetry.warning(error);\n                            telemetry.debug('[wishlist-items] Error trying to Update Cart Line from the wishlist');\n                            this.setState({\n                                productId: product.RecordId,\n                                itemKey: itemKey,\n                                userMessage: addedToCartFailureMessage,\n                                statusCssString: 'danger',\n                                messageGlyph: 'fas fa-exclamation-triangle',\n                                isOpen: true\n                            });\n                        });\n            }\n        }\n    };\n\n    private _removeItemFromWishlist = (productId: number): void => {\n        const { context, data, telemetry } = this.props;\n        const { wishlists } = data;\n\n        if (context && context.actionContext) {\n            const userToken = context.request.user.isAuthenticated && context.request.user.token;\n            const wishlistLineId = this._getWishlistLineIdFromProductId(productId);\n            if (userToken && wishlists.result && wishlists.result[0] && wishlistLineId) {\n                removeLinesAsync({ callerContext: context.actionContext }, wishlists.result[0].Id, [{ LineId: wishlistLineId }])\n                    .then(commerceList => {\n                        const castCommerceList: CommerceList | null = commerceList as (CommerceList | null);\n\n                        if (castCommerceList && castCommerceList.Id && context.request.user.isAuthenticated) {\n                            context.actionContext.update(createGetByCustomerInput({}, null), [castCommerceList]);\n                            getItemsInWishlists(new ActiveWishlistInput(), context.actionContext)\n                                .then((products) => {\n                                    const castSimpleProducts: FullProduct[] | null = products as (FullProduct[] | null);\n                                    if (castSimpleProducts && castSimpleProducts.length > 0) {\n                                        context.actionContext.update(new ActiveWishlistInput(), castSimpleProducts);\n                                    }\n                                })\n                                .catch(error => {\n                                    telemetry.warning('[wishlist-items] Unable to hyderate the wishlist with product information');\n                                    telemetry.error(error);\n                                });\n                        }\n                    })\n                    .catch(error => {\n                        telemetry.warning('[wishlist-items] Unable remove items from the wishlist');\n                        telemetry.error(error);\n                    });\n            } else {\n                telemetry.warning('[wishlist-items] Unable remove items from the wishlist user token or lineItemID wasn\\'t found');\n            }\n        }\n    }\n\n    private _getInventoryValueMessage(product: IProductInventoryInformation | undefined, curQuantity: number):string {\n        const { context, resources } = this.props;\n        const { maxQuantityLimitText } = resources;\n\n        const maxQuantityForLineItem = context.app.config.maxQuantityForCartLineItem || 10;\n\n        if(!product || !product.ProductAvailableQuantity.AvailableQuantity || !context.app.config.enableStockCheck) {\n            return maxQuantityLimitText.replace('{maxQuantity}', maxQuantityForLineItem.toString()).replace('{curQuantity}', curQuantity.toString());\n        }\n\n        const minInventory = Math.min(maxQuantityForLineItem, product.ProductAvailableQuantity.AvailableQuantity);\n\n        return maxQuantityLimitText.replace('{maxQuantity}', minInventory.toString()).replace('{curQuantity}', curQuantity.toString());\n    }\n\n    private _getProductInventory(product: FullProduct, productInventoryCollection: IProductInventoryInformation[] | undefined): IProductInventoryInformation | undefined {\n        if(productInventoryCollection && productInventoryCollection.length) {\n            for (const productResult of productInventoryCollection) {\n                if(product.ProductDetails.RecordId === productResult.ProductAvailableQuantity.ProductId) {\n                    return productResult;\n                }\n            }\n        }\n        return undefined;\n    }\n\n    private _inventoryLabel = (product: FullProduct):string | undefined => {\n        const { productAvailability } = this.props.data;\n        if(productAvailability && productAvailability.result) {\n            const productInventoryInformation = this._getProductInventory(product, productAvailability.result);\n            if(productInventoryInformation) {\n                return productInventoryInformation.StockLevelLabel;\n            }\n        }\n\n        return undefined;\n    }\n\n    private _inventoryClassName = (product: FullProduct):string | undefined => {\n        const { productAvailability } = this.props.data;\n        if(productAvailability && productAvailability.result) {\n            const productInventoryInformation = this._getProductInventory(product, productAvailability.result);\n            if(productInventoryInformation && productInventoryInformation.StockLevelCode) {\n                return `ms-wishlist-items__${productInventoryInformation.StockLevelCode.toLowerCase()}`;\n            }\n        }\n\n        return undefined;\n    }\n\n    private _isProductInStock = (product: FullProduct): boolean => {\n        const { data, context } = this.props;\n        const { productAvailability } = data;\n\n        if (!context.app.config.enableStockCheck) {\n            return true;\n        }\n\n        if (!productAvailability.result || !product.ProductDetails) {\n            return false;\n        }\n\n        for (const productResult of productAvailability.result) {\n            if (productResult.ProductAvailableQuantity &&\n                productResult.ProductAvailableQuantity.ProductId &&\n                productResult.ProductAvailableQuantity.ProductId === product.ProductDetails.RecordId) {\n                return productResult.IsProductAvailable;\n            }\n        }\n\n        return false;\n    }\n\n    private _getWishlistLineIdFromProductId = (productId: number): number | null => {\n        const { wishlists } = this.props.data;\n\n        if (!wishlists.result || !(wishlists.result.length > 0) || !wishlists.result[0].CommerceListLines || !(wishlists.result[0].CommerceListLines.length > 0)) {\n            this.props.telemetry.error('Wishlist content is empty, module wont render.');\n            return null;\n        }\n\n        const foundWishlistItem = wishlists.result[0].CommerceListLines.filter((commerceListLine) => {\n            return commerceListLine.ProductId === productId;\n        });\n\n        if (foundWishlistItem && foundWishlistItem[0].LineId) {\n            return foundWishlistItem[0].LineId;\n        } else {\n            return null;\n        }\n    }\n}\n\nexport default WishlistItems;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}