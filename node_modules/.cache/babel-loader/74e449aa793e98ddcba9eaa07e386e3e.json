{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import{getTelemetryObject,SingleSlideCarousel}from'@msdyn365-commerce-modules/utilities';import{ProductComponent}from'@msdyn365-commerce/components';import*as Msdyn365 from'@msdyn365-commerce/core';import classnames from'classnames';import*as React from'react';class ProductCollection extends React.PureComponent{constructor(props){super(props);this.handleHeadingChange=event=>this.props.config.heading.text=event.target.value;this._getProduct=(product,index)=>{if(!product||!product.Name){this.props.telemetry.trace('[product-collection] Product or product name is null');return null;}const telemetryContent=getTelemetryObject(this.props.context.request.telemetryPageName,this.props.friendlyName,this.props.telemetry);const{imageSettings,allowBackNavigation}=this.props.config;const resources=this.props.resources;const breaCrumbType=this.props.context.app.config.breadcrumbType;const allowBack=allowBackNavigation&&(breaCrumbType==='back'||breaCrumbType==='categoryAndBack');return{ProductContainer:{tag:'li',className:'ms-product-collection__item',role:'listitem',key:index},productComponent:/*#__PURE__*/React.createElement(ProductComponent,{context:this.props.context,telemetryContent:telemetryContent,imageSettings:imageSettings,freePriceText:resources.priceFree,originalPriceText:resources.originalPriceText,currentPriceText:resources.currentPriceText,ratingAriaLabel:resources.ratingAriaLabel,allowBack:allowBack,id:this.props.id,typeName:this.props.typeName,data:{product:product}})};};this.telemetryContent=getTelemetryObject(this.props.context.request.telemetryPageName,this.props.friendlyName,this.props.telemetry);}render(){const{heading,productCollection,className}=this.props.config;const{resources}=this.props;const products=productCollection&&productCollection.products;const isCarousel=this.props.config.layout===\"carousel\";const headingComponent=heading&&/*#__PURE__*/React.createElement(Msdyn365.Text,{className:'ms-product-collection__heading',tag:heading.tag||'h1',text:heading.text,editProps:{onEdit:this.handleHeadingChange,requestContext:this.props.context.request}});const productCollectionViewProps=_objectSpread(_objectSpread({},this.props),{},{heading:headingComponent,SingleSlideCarouselComponentProps:{tag:SingleSlideCarousel,className:'',flipperPrevLabel:resources.flipperPrevious,flipperNextLabel:resources.flipperNext,parentId:this.props.id,telemetryContent:this.telemetryContent},ProductCollectionContainer:{moduleProps:this.props,className:classnames('ms-product-collection',className)},GridComponentProps:{tag:'ul',className:'ms-product-collection__items'},isCarousel:isCarousel,products:products&&products.length>0&&products.map((item,index)=>this._getProduct(item,index))});return this.props.renderView(productCollectionViewProps);}}export default ProductCollection;","map":{"version":3,"sources":["modules/product-collection/product-collection.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { getTelemetryObject, IComponentNodeProps, IModuleProps, INodeProps, ISingleSlideCarouselProps, ITelemetryContent, NodeTag, SingleSlideCarousel } from '@msdyn365-commerce-modules/utilities';\nimport { ProductComponent } from '@msdyn365-commerce/components';\nimport * as Msdyn365 from '@msdyn365-commerce/core';\nimport { ProductSearchResult } from '@msdyn365-commerce/retail-proxy';\nimport classnames from 'classnames';\nimport * as React from 'react';\nimport { IProductCollectionProps, layout } from './product-collection.props.autogenerated';\n\nexport interface IProductCollectionViewProps extends IProductCollectionProps<{}> {\n    heading?: React.ReactNode;\n    ProductCollectionContainer: IModuleProps;\n    SingleSlideCarouselComponentProps: INodeProps;\n    GridComponentProps: INodeProps;\n    products: IProductComponentViewProps[];\n    isCarousel: boolean;\n}\n\nexport interface IProductComponentViewProps {\n    ProductContainer: INodeProps;\n    productComponent: React.ReactNode;\n}\n\n/**\n * ProductCollection component\n */\nclass ProductCollection extends React.PureComponent<IProductCollectionProps<{}>> {\n    private telemetryContent: ITelemetryContent;\n\n    constructor(props: IProductCollectionProps<{}>) {\n        super(props);\n        this.telemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!,\n                                                   this.props.friendlyName,\n                                                   this.props.telemetry);\n    }\n\n    public render(): JSX.Element | null {\n        const { heading, productCollection, className } = this.props.config;\n        const { resources } = this.props;\n        const products = productCollection && productCollection.products;\n        const isCarousel = this.props.config.layout === layout.carousel;\n        const headingComponent = heading && (\n            <Msdyn365.Text\n                className='ms-product-collection__heading'\n                tag={heading.tag || 'h1'}\n                text={heading.text}\n                editProps={{onEdit:this.handleHeadingChange, requestContext:this.props.context.request}}\n            />\n        );\n\n        const productCollectionViewProps = {\n            ...this.props,\n            heading: headingComponent,\n            SingleSlideCarouselComponentProps: {\n                tag: SingleSlideCarousel,\n                className: '',\n                flipperPrevLabel: resources.flipperPrevious,\n                flipperNextLabel: resources.flipperNext,\n                parentId: this.props.id,\n                telemetryContent: this.telemetryContent\n            } as IComponentNodeProps<ISingleSlideCarouselProps>,\n            ProductCollectionContainer: {\n                moduleProps: this.props,\n                className:  classnames('ms-product-collection', className)\n            },\n            GridComponentProps: {\n                tag: 'ul' as NodeTag,\n                className: 'ms-product-collection__items',\n            },\n            isCarousel: isCarousel,\n            products: products && products.length > 0 && products.map((item: ProductSearchResult, index: number) => this._getProduct(item, index)),\n        };\n        return this.props.renderView(productCollectionViewProps) as React.ReactElement;\n    }\n    public handleHeadingChange = (event: Msdyn365.ContentEditableEvent) => this.props.config.heading!.text = event.target.value;\n\n    private _getProduct = (product:ProductSearchResult, index: number): IProductComponentViewProps | null => {\n        if(!product || !product.Name) {\n            this.props.telemetry.trace('[product-collection] Product or product name is null');\n            return null;\n        }\n        const telemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!,\n                                                    this.props.friendlyName,\n                                                    this.props.telemetry);\n        const { imageSettings, allowBackNavigation } = this.props.config;\n        const resources = this.props.resources;\n        const breaCrumbType = this.props.context.app.config.breadcrumbType;\n        const allowBack = allowBackNavigation && (breaCrumbType === 'back' || breaCrumbType === 'categoryAndBack');\n        return {\n            ProductContainer: {\n                tag: 'li' as NodeTag,\n                className: 'ms-product-collection__item',\n                role: 'listitem',\n                key: index,\n            },\n            productComponent: (\n                <ProductComponent\n                    context={this.props.context}\n                    telemetryContent={telemetryContent}\n                    imageSettings={imageSettings}\n                    freePriceText={resources.priceFree}\n                    originalPriceText={resources.originalPriceText}\n                    currentPriceText={resources.currentPriceText}\n                    ratingAriaLabel={resources.ratingAriaLabel}\n                    allowBack={allowBack}\n                    id={this.props.id}\n                    typeName={this.props.typeName}\n                    data={{product: product}}\n                />\n            )\n        };\n    }\n}\n\nexport default ProductCollection;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}