{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _asyncToGenerator from\"@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import{createObservableDataAction}from'@msdyn365-commerce/core';import{getAttributeDefinitionsAsync}from'@msdyn365-commerce/retail-proxy/dist/DataActions/StoreOperationsDataActions.g';import{buildCacheKey}from'./utilities/utils';/**\r\n * Input class for get attribute definitions data action\r\n */export var GetAttributeDefinitionsInput=function GetAttributeDefinitionsInput(apiSettings,attributeDefinitionCriteria){var _this=this;_classCallCheck(this,GetAttributeDefinitionsInput);this.getCacheKey=function(){return buildCacheKey('AttributeDefinitions',_this.apiSettings);};this.getCacheObjectType=function(){return'CustomerAttribute';};this.dataCacheType=function(){return'request';};this.attributeDefinitionCriteria=attributeDefinitionCriteria;this.apiSettings=apiSettings;};/**\r\n * Creates the input required to make the retail api call\r\n */var createInput=function createInput(inputData){var _inputData$requestCon=inputData.requestContext,apiSettings=_inputData$requestCon.apiSettings,channel=_inputData$requestCon.channel;if(!channel||!channel.CustomerAttributeGroupId){throw new Error('[getAttributeDefinitions][createInput]: Customer attribute group id is not found.');}return new GetAttributeDefinitionsInput(apiSettings,{AttributeGroupIdentifier:channel.CustomerAttributeGroupId});};var getAttributeDefinitionsAction=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(input,ctx){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(input&&ctx.requestContext.channel&&ctx.requestContext.channel.CustomerAttributeGroupId)){_context.next=2;break;}return _context.abrupt(\"return\",getAttributeDefinitionsAsync({callerContext:ctx},input.attributeDefinitionCriteria||null).then(function(response){return response;}));case 2:ctx.trace('[getAttributeDefinitions]Invalid input passed to action');return _context.abrupt(\"return\",[]);case 4:case\"end\":return _context.stop();}}},_callee);}));return function getAttributeDefinitionsAction(_x,_x2){return _ref.apply(this,arguments);};}();export default createObservableDataAction({id:'@msdyn365-commerce-modules/retail-actions/get-custom-attributes',action:getAttributeDefinitionsAction,input:createInput});","map":{"version":3,"sources":["../../src/get-attribute-definitions.ts"],"names":[],"mappings":"8MACA,OAAS,0BAAT,KAAiG,yBAAjG,CACA,OACI,4BADJ,KAEO,+EAFP,CAIA,OAAS,aAAT,KAA8B,mBAA9B,CAEA;;AAEG,GACH,UAAa,CAAA,4BAAb,CAII,sCAAY,WAAZ,CAA+C,2BAA/C,CAAwG,mEAKjG,KAAA,WAAA,CAAc,iBAAM,CAAA,aAAa,CAAC,sBAAD,CAAyB,KAAI,CAAC,WAA9B,CAAnB,EAAd,CACA,KAAA,kBAAA,CAAqB,iBAAM,mBAAN,EAArB,CACA,KAAA,aAAA,CAAgB,iBAAiB,SAAjB,EAAhB,CANH,KAAK,2BAAL,CAAmC,2BAAnC,CACA,KAAK,WAAL,CAAmB,WAAnB,CACH,CAPL,CAcA;;AAEG,GACH,GAAM,CAAA,WAAW,CAAG,QAAd,CAAA,WAAc,CAAC,SAAD,CAAkF,2BACjE,SAAS,CAAC,cADuD,CAC1F,WAD0F,uBAC1F,WAD0F,CAC7E,OAD6E,uBAC7E,OAD6E,CAElG,GAAI,CAAC,OAAD,EAAY,CAAC,OAAO,CAAC,wBAAzB,CAAmD,CAC/C,KAAM,IAAI,CAAA,KAAJ,CAAU,mFAAV,CAAN,CACH,CAED,MAAO,IAAI,CAAA,4BAAJ,CAAiC,WAAjC,CAA8C,CAAC,wBAAwB,CAAE,OAAO,CAAC,wBAAnC,CAA9C,CAAP,CACH,CAPD,CASA,GAAM,CAAA,6BAA6B,0FAAG,iBAAO,KAAP,CAA4C,GAA5C,uHAC9B,KAAK,EAAI,GAAG,CAAC,cAAJ,CAAmB,OAA5B,EAAuC,GAAG,CAAC,cAAJ,CAAmB,OAAnB,CAA2B,wBADpC,0DAEvB,4BAA4B,CAAC,CAAE,aAAa,CAAE,GAAjB,CAAD,CAAyB,KAAK,CAAC,2BAAN,EAAqC,IAA9D,CAA5B,CAAgG,IAAhG,CAAqG,SAAA,QAAQ,CAAG,CACnH,MAAQ,CAAA,QAAR,CACH,CAFM,CAFuB,SAOlC,GAAG,CAAC,KAAJ,CAAU,yDAAV,EAPkC,gCAQ3B,EAR2B,wDAAH,kBAA7B,CAAA,6BAA6B,gDAAnC,CAWA,cAAe,CAAA,0BAA0B,CAAC,CACtC,EAAE,CAAE,iEADkC,CAEtC,MAAM,CAAkC,6BAFF,CAGtC,KAAK,CAAE,WAH+B,CAAD,CAAzC","sourcesContent":["import { CacheType, IAction, IActionInput, ICommerceApiSettings } from '@msdyn365-commerce/core';\nimport { createObservableDataAction, IActionContext, IAny, ICreateActionContext, IGeneric } from '@msdyn365-commerce/core';\nimport {\n    getAttributeDefinitionsAsync\n} from '@msdyn365-commerce/retail-proxy/dist/DataActions/StoreOperationsDataActions.g';\nimport { AttributeDefinition, AttributeDefinitionCriteria} from '@msdyn365-commerce/retail-proxy/dist/Entities/CommerceTypes.g';\nimport { buildCacheKey } from './utilities/utils';\n\n/**\n * Input class for get attribute definitions data action\n */\nexport class GetAttributeDefinitionsInput implements IActionInput {\n    public attributeDefinitionCriteria?: AttributeDefinitionCriteria;\n    private apiSettings: ICommerceApiSettings;\n\n    constructor(apiSettings: ICommerceApiSettings, attributeDefinitionCriteria?: AttributeDefinitionCriteria) {\n        this.attributeDefinitionCriteria = attributeDefinitionCriteria;\n        this.apiSettings = apiSettings;\n    }\n\n    public getCacheKey = () => buildCacheKey('AttributeDefinitions', this.apiSettings);\n    public getCacheObjectType = () => 'CustomerAttribute';\n    public dataCacheType = (): CacheType => 'request';\n}\n\n/**\n * Creates the input required to make the retail api call\n */\nconst createInput = (inputData: ICreateActionContext<IGeneric<IAny>>): GetAttributeDefinitionsInput => {\n    const { apiSettings, channel } = inputData.requestContext;\n    if (!channel || !channel.CustomerAttributeGroupId) {\n        throw new Error('[getAttributeDefinitions][createInput]: Customer attribute group id is not found.');\n    }\n\n    return new GetAttributeDefinitionsInput(apiSettings, {AttributeGroupIdentifier: channel.CustomerAttributeGroupId});\n};\n\nconst getAttributeDefinitionsAction = async (input: GetAttributeDefinitionsInput, ctx: IActionContext): Promise<AttributeDefinition[]> => {\n    if (input && ctx.requestContext.channel && ctx.requestContext.channel.CustomerAttributeGroupId) {\n        return getAttributeDefinitionsAsync({ callerContext: ctx }, input.attributeDefinitionCriteria || null).then(response => {\n            return  response;\n        });\n    }\n\n    ctx.trace('[getAttributeDefinitions]Invalid input passed to action');\n    return [];\n};\n\nexport default createObservableDataAction({\n    id: '@msdyn365-commerce-modules/retail-actions/get-custom-attributes',\n    action: <IAction<AttributeDefinition[]>>getAttributeDefinitionsAction,\n    input: createInput\n});\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}