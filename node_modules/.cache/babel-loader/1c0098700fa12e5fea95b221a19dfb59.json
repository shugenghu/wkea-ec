{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _asyncToGenerator from\"@babel/runtime/helpers/esm/asyncToGenerator\";import{createObservableDataAction,sendRequest}from'@msdyn365-commerce/core';function submitHelpfulnessVote(_x,_x2){return _submitHelpfulnessVote.apply(this,arguments);}function _submitHelpfulnessVote(){_submitHelpfulnessVote=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(input,ctx){var requestUrl,requestBody,requestHeader;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(inputIsValid(input)){_context.next=2;break;}throw new Error(\"[SubmitHelpfulnessVote] Invalid input. ReviewId=\".concat(input.reviewId,\",tenantId=\").concat(input.tenantId,\", locale= \").concat(input.locale,\",\"));case 2:requestUrl=\"\".concat(input.serviceEndpoint,\"/v2.0/votes/review/\").concat(input.reviewId)+\"?tenantId=\".concat(input.tenantId)+\"&locale=\".concat(input.locale);requestBody={isHelpful:!!input.isHelpful};requestHeader={headers:{Authorization:\"id_token \".concat(input.authToken)}};return _context.abrupt(\"return\",sendRequest(requestUrl,'post',requestBody,requestHeader).then(function(response){return response.status===200||response.status===201;})[\"catch\"](function(error){ctx.trace(\"[SubmitHelpfulnessVote] Failed to vote on a review\");ctx.telemetry.exception(error);ctx.telemetry.debug(\"[SubmitHelpfulnessVote] Failed to vote on a review\");return false;}));case 6:case\"end\":return _context.stop();}}},_callee);}));return _submitHelpfulnessVote.apply(this,arguments);}function inputIsValid(input){return input&&input.reviewId.length>0&&input.tenantId.length>0&&input.locale.length>0&&input.authToken.length>0;}export default createObservableDataAction({id:'@msdyn365-commerce-modules/ratings-reviews/submit-helpfulness-vote',action:submitHelpfulnessVote});","map":{"version":3,"sources":["actions/submit-helpfulness-vote.ts"],"names":[],"mappings":"uIAAA,OAAS,0BAAT,CAA8D,WAA9D,KAAiF,yBAAjF,C,QAGe,CAAA,qB,+KAAf,iBAAqC,KAArC,CAAwE,GAAxE,8JACS,YAAY,CAAC,KAAD,CADrB,8BAEc,IAAI,CAAA,KAAJ,2DACiD,KAAK,CAAC,QADvD,sBAC4E,KAAK,CAAC,QADlF,sBAEE,KAAK,CAAC,MAFR,MAFd,QASU,UATV,CAUQ,UAAG,KAAK,CAAC,eAAT,+BAA8C,KAAK,CAAC,QAApD,sBACa,KAAK,CAAC,QADnB,oBAEW,KAAK,CAAC,MAFjB,CAVR,CAcU,WAdV,CAcwB,CAChB,SAAS,CAAE,CAAC,CAAC,KAAK,CAAC,SADH,CAdxB,CAkBU,aAlBV,CAkB0B,CAClB,OAAO,CAAE,CACL,aAAa,oBAAc,KAAK,CAAC,SAApB,CADR,CADS,CAlB1B,iCAwBW,WAAW,CAAU,UAAV,CAAsB,MAAtB,CAA8B,WAA9B,CAA2C,aAA3C,CAAX,CACF,IADE,CACG,SAAA,QAAQ,CAAG,CACb,MAAO,CAAA,QAAQ,CAAC,MAAT,GAAoB,GAApB,EAA2B,QAAQ,CAAC,MAAT,GAAoB,GAAtD,CACH,CAHE,WAII,SAAC,KAAD,CAAU,CACb,GAAG,CAAC,KAAJ,uDACA,GAAG,CAAC,SAAJ,CAAc,SAAd,CAAwB,KAAxB,EACA,GAAG,CAAC,SAAJ,CAAc,KAAd,uDACA,MAAO,MAAP,CACH,CATE,CAxBX,wD,wDAoCA,QAAS,CAAA,YAAT,CAAsB,KAAtB,CAAuD,CACnD,MACI,CAAA,KAAK,EACL,KAAK,CAAC,QAAN,CAAe,MAAf,CAAwB,CADxB,EAEA,KAAK,CAAC,QAAN,CAAe,MAAf,CAAwB,CAFxB,EAGA,KAAK,CAAC,MAAN,CAAa,MAAb,CAAsB,CAHtB,EAIA,KAAK,CAAC,SAAN,CAAgB,MAAhB,CAAyB,CAL7B,CAOH,CAED,cAAe,CAAA,0BAA0B,CAAC,CACtC,EAAE,CAAE,oEADkC,CAEtC,MAAM,CAAoB,qBAFY,CAAD,CAAzC","sourcesContent":["import { createObservableDataAction, IAction, IActionContext, sendRequest } from '@msdyn365-commerce/core';\nimport { SubmitHelpfulnessVoteInput } from './inputs/submit-helpfulness-vote-input';\n\nasync function submitHelpfulnessVote(input: SubmitHelpfulnessVoteInput, ctx: IActionContext): Promise<boolean> {\n    if (!inputIsValid(input)) {\n        throw new Error(\n            `[SubmitHelpfulnessVote] Invalid input. ReviewId=${input.reviewId},tenantId=${input.tenantId}, locale= ${\n                input.locale\n            },`\n        );\n    }\n\n    const requestUrl =\n        `${input.serviceEndpoint}/v2.0/votes/review/${input.reviewId}` +\n        `?tenantId=${input.tenantId}` +\n        `&locale=${input.locale}`;\n\n    const requestBody = {\n        isHelpful: !!input.isHelpful\n    };\n\n    const requestHeader = {\n        headers: {\n            Authorization: `id_token ${input.authToken}`\n        }\n    };\n\n    return sendRequest<boolean>(requestUrl, 'post', requestBody, requestHeader)\n        .then(response => {\n            return response.status === 200 || response.status === 201;\n        })\n        .catch((error) => {\n            ctx.trace(`[SubmitHelpfulnessVote] Failed to vote on a review`);\n            ctx.telemetry.exception(error);\n            ctx.telemetry.debug(`[SubmitHelpfulnessVote] Failed to vote on a review`);\n            return false;\n        });\n}\n\nfunction inputIsValid(input: SubmitHelpfulnessVoteInput): boolean {\n    return (\n        input &&\n        input.reviewId.length > 0 &&\n        input.tenantId.length > 0 &&\n        input.locale.length > 0 &&\n        input.authToken.length > 0\n    );\n}\n\nexport default createObservableDataAction({\n    id: '@msdyn365-commerce-modules/ratings-reviews/submit-helpfulness-vote',\n    action: <IAction<boolean>>submitHelpfulnessVote\n});\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}