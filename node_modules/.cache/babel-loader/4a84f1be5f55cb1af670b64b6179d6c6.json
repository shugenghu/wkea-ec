{"ast":null,"code":"import\"core-js/modules/es.array.reduce.js\";import\"core-js/modules/es.object.assign.js\";import\"core-js/modules/web.dom-collections.iterator.js\";import*as React from'react';import{Button,format,getPayloadObject,getTelemetryAttributes,TelemetryConstant}from'@msdyn365-commerce-modules/utilities';import{PriceComponent}from'@msdyn365-commerce/components';class PromoCode extends React.Component{constructor(props,state){super(props);this._onInputChange=e=>{const error=e.target.value===''?'':this.state.error;this.setState({promoCodeInputValue:e.target.value,error:error,canApply:e.target.value?true:false});};this._applyPromotion=cartState=>{if(!cartState||!cartState.cart){return;}const appliedPromo=this.state.promoCodeInputValue;cartState.addPromoCode({promoCode:appliedPromo}).then(result=>{if(result.status==='SUCCESS'){this.setState({promoCodeInputValue:'',error:'',canApply:false});}else if(result.substatus==='ALREADYADDED'){this.setState({error:this.props.duplicatePromoCodeErrorText});}else{this.setState({error:this.props.invalidPromoCodeErrorText});}}).catch(error=>{this.setState({error:this.props.failedToAddPromoCodeErrorText});});};this._renderForm=(promoPlaceholderText,promoCodeApplyButtonText,cartState)=>{const _onSubmit=event=>{event.preventDefault();this._applyPromotion(cartState);};const _applyPromotion=event=>{this._applyPromotion(cartState);};const attributes=getTelemetryAttributes(this.props.telemetryContent,this.payLoad);return/*#__PURE__*/React.createElement(\"form\",{onSubmit:_onSubmit,className:'msc-promo-code__form-container'},/*#__PURE__*/React.createElement(\"div\",{className:'msc-promo-code__group'},/*#__PURE__*/React.createElement(\"input\",{className:'msc-promo-code__input-box',\"aria-label\":promoPlaceholderText,onChange:this._onInputChange,value:this.state.promoCodeInputValue,placeholder:promoPlaceholderText}),/*#__PURE__*/React.createElement(Button,Object.assign({title:promoCodeApplyButtonText,className:'msc-promo-code__apply-btn btn',onClick:_applyPromotion,disabled:!this.state.canApply},attributes),promoCodeApplyButtonText)));};this._removePromotion=(cartState,event)=>{if(!cartState){return;}const code=event.currentTarget.getAttribute('data-value')||'';cartState.removePromoCodes({promoCodes:[code]}).then(result=>{if(result.status==='SUCCESS'){this.setState({error:''});}}).catch(()=>{this.setState({error:this.props.failedToRemovePromoCodeErrorText});});};this._calculateDiscount=(code,cartState)=>{if(!cartState||!cartState.cart||!cartState.cart.CartLines||cartState.cart.CartLines.length===0||!code){return;}let discountAmount=0;for(const line of cartState.cart.CartLines){if(line.DiscountLines){for(const discountLine of line.DiscountLines){if(discountLine.DiscountCode===code){discountAmount+=discountLine.DiscountCost;}}}}return discountAmount*-1;};this._renderAppliedPromoCode=props=>{if(!props.cart||!props.cart.cart||!props.cart.cart.Coupons||!(props.cart.cart.Coupons.length>0)){return;}const _removePromotion=event=>{this._removePromotion(props.cart,event);};const promoCodTotalDiscount=props.cart.cart.Coupons.reduce((count,coupon)=>{return count+(this._calculateDiscount(coupon.Code||'',props.cart)||0);},0);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:'msc-promo-code__discount'},/*#__PURE__*/React.createElement(\"div\",{className:'msc-promo-code__discount-heading'},this.props.appliedPromoCodeHeadingText),/*#__PURE__*/React.createElement(PriceComponent,{data:{price:{CustomerContextualPrice:promoCodTotalDiscount}},context:props.context,id:props.id,typeName:props.typeName,className:'msc-promo-code__discount-value'})),props.cart.cart.Coupons.map(coupon=>{const ariaLabel=props.removePromoAriaLabelFormat?format(props.removePromoAriaLabelFormat,props.removePromoText,coupon.Code):'';return/*#__PURE__*/React.createElement(\"div\",{key:coupon.Code,className:'msc-promo-code__line-container'},/*#__PURE__*/React.createElement(\"div\",{className:'msc-promo-code__line-value'},coupon.Code,\" (\",/*#__PURE__*/React.createElement(PriceComponent,{data:{price:{CustomerContextualPrice:this._calculateDiscount(coupon.Code||'',props.cart)}},context:props.context,id:props.id,typeName:props.typeName,className:'msc-promo-code__line-discount-value'}),\")\"),/*#__PURE__*/React.createElement(Button,{title:props.removePromoText,className:'msc-promo-code__line__btn-remove',onClick:_removePromotion,\"data-value\":coupon.Code,\"aria-label\":ariaLabel},props.removePromoText));}));};this.payLoad=getPayloadObject('click',this.props.telemetryContent,TelemetryConstant.ApplyPromoCode);this.state={isCollapseOpen:false,promoCodeInputValue:'',error:'',canApply:false};}render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:'msc-promo-code-heading'},this.props.promoCodeHeadingText),this._renderForm(this.props.promoPlaceholderText,this.props.promoCodeApplyButtonText,this.props.cart),/*#__PURE__*/React.createElement(\"p\",{className:this.state.error?'msc-alert-danger':'',\"aria-live\":'assertive'},this.state.error),this._renderAppliedPromoCode(this.props));}}export default PromoCode;","map":{"version":3,"sources":["modules/fabrikam/views/components/promocode.component.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\n\nimport { Button, format, getPayloadObject, getTelemetryAttributes, IPayLoad, ITelemetryContent, TelemetryConstant } from '@msdyn365-commerce-modules/utilities';\nimport { PriceComponent } from '@msdyn365-commerce/components';\nimport { IComponentProps } from '@msdyn365-commerce/core';\nimport { ICartState } from '@msdyn365-commerce/global-state';\nimport { Coupon } from '@msdyn365-commerce/retail-proxy/dist/Entities/CommerceTypes.g';\n\nexport interface IPromoCodeProps extends IComponentProps<{}> {\n    cart: ICartState | undefined;\n    promoCodeHeadingText: string;\n    appliedPromoCodeHeadingText: string;\n    removePromoAriaLabelFormat: string;\n    promoPlaceholderText: string;\n    promoCodeApplyButtonText: string;\n    collapseTimeOut: number;\n    removePromoText: string;\n    invalidPromoCodeErrorText: string;\n    failedToAddPromoCodeErrorText: string;\n    duplicatePromoCodeErrorText: string;\n    failedToRemovePromoCodeErrorText: string;\n    /** The telemetry content */\n    telemetryContent?: ITelemetryContent;\n    promoCodeApplyCallback?(): void;\n}\n\ninterface IPromoCodeState {\n    isCollapseOpen: boolean;\n    promoCodeInputValue: string;\n    error: string;\n    canApply: boolean;\n}\n\n/**\n *\n * The PromoCode component renders the promocode section.\n * @extends {React.PureComponent<IRefineSubmenuProps>}\n */\nclass PromoCode extends React.Component<IPromoCodeProps, IPromoCodeState> {\n\n    private payLoad: IPayLoad;\n\n    constructor(props: IPromoCodeProps, state: IPromoCodeState) {\n        super(props);\n        this.payLoad = getPayloadObject('click', this.props.telemetryContent!, TelemetryConstant.ApplyPromoCode);\n        this.state = {\n            isCollapseOpen: false,\n            promoCodeInputValue: '',\n            error: '',\n            canApply: false\n        };\n    }\n\n    public render(): JSX.Element {\n        return (\n            <div>\n                <div className='msc-promo-code-heading'>{this.props.promoCodeHeadingText}</div>\n                {this._renderForm(this.props.promoPlaceholderText, this.props.promoCodeApplyButtonText, this.props.cart)}\n                <p className={this.state.error ? 'msc-alert-danger' : ''}aria-live='assertive'>{this.state.error}</p>\n                {this._renderAppliedPromoCode(this.props)}\n            </div>\n        );\n    }\n\n    private _onInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const error = e.target.value === '' ? '' : this.state.error;\n        this.setState({\n            promoCodeInputValue: e.target.value, error: error,\n            canApply: e.target.value ? true : false\n        });\n    }\n\n    private _applyPromotion = (cartState: ICartState | undefined) => {\n        if (!cartState || !cartState.cart) {\n            return;\n        }\n        const appliedPromo = this.state.promoCodeInputValue;\n\n        cartState.addPromoCode({ promoCode: appliedPromo })\n            .then(result => {\n                if (result.status === 'SUCCESS') {\n                    // show success text\n                    this.setState({ promoCodeInputValue: '', error: '', canApply: false});\n                } else if (result.substatus === 'ALREADYADDED') {\n                    this.setState({ error: this.props.duplicatePromoCodeErrorText });\n                } else {\n                    this.setState({ error: this.props.invalidPromoCodeErrorText });\n                }\n            })\n            .catch(error => {\n                this.setState({ error: this.props.failedToAddPromoCodeErrorText });\n            });\n    }\n\n    private _renderForm = (promoPlaceholderText: string, promoCodeApplyButtonText: string, cartState: ICartState | undefined) => {\n        const _onSubmit = (event: React.FormEvent<HTMLFormElement>) => {event.preventDefault(); this._applyPromotion(cartState);};\n        const _applyPromotion = (event: React.MouseEvent<HTMLElement>) => {this._applyPromotion(cartState);};\n        const attributes = getTelemetryAttributes(this.props.telemetryContent!, this.payLoad);\n\n        return (\n            <form onSubmit={_onSubmit} className='msc-promo-code__form-container'>\n                <div className='msc-promo-code__group'>\n                    <input\n                        className='msc-promo-code__input-box'\n                        aria-label={promoPlaceholderText}\n                        onChange={this._onInputChange}\n                        value={this.state.promoCodeInputValue}\n                        placeholder={promoPlaceholderText}\n                    />\n                    <Button\n                        title={promoCodeApplyButtonText}\n                        className='msc-promo-code__apply-btn btn'\n                        onClick={_applyPromotion}\n                        disabled={!this.state.canApply}\n                        {...attributes}\n                    >\n                        {promoCodeApplyButtonText}\n                    </Button>\n                </div>\n            </form>\n        );\n    }\n\n    private _removePromotion = (cartState: ICartState | undefined, event: React.MouseEvent) => {\n        if (!cartState) {\n            return;\n        }\n        const code = event.currentTarget.getAttribute('data-value') || '';\n        cartState.removePromoCodes({\n            promoCodes: [\n                code\n            ]\n        })\n            .then(result => {\n                if (result.status === 'SUCCESS') {\n                    this.setState({ error: ''});\n                }\n            })\n            .catch(() => {\n                this.setState({ error: this.props.failedToRemovePromoCodeErrorText});\n            });\n\n    }\n    private _calculateDiscount = (code: string, cartState: ICartState | undefined) => {\n        if (!cartState || !cartState.cart || !cartState.cart.CartLines || cartState.cart.CartLines.length === 0 || !code) {\n            return;\n        }\n        let discountAmount = 0;\n        for (const line of cartState.cart.CartLines) {\n            if (line.DiscountLines) {\n                for (const discountLine of line.DiscountLines) {\n                    if (discountLine.DiscountCode === code) {\n                        discountAmount += discountLine.DiscountCost!;\n                    }\n                }\n            }\n        }\n        return discountAmount * -1;\n    }\n\n    private _renderAppliedPromoCode = (props: IPromoCodeProps) => {\n        if (!props.cart || !props.cart.cart || !props.cart.cart.Coupons || !(props.cart.cart.Coupons.length > 0)) {\n            return;\n        }\n\n        const _removePromotion = (event: React.MouseEvent<HTMLElement>) => {this._removePromotion(props.cart, event);};\n\n        const promoCodTotalDiscount = props.cart.cart.Coupons.reduce(\n            (count: number, coupon: Coupon) => {\n                return count + (this._calculateDiscount(coupon.Code || '', props.cart) || 0);\n            },\n            0);\n\n        return (\n            <>\n                <div className='msc-promo-code__discount'>\n                    <div className='msc-promo-code__discount-heading'>{this.props.appliedPromoCodeHeadingText}</div>\n                    <PriceComponent\n                        data={{\n                            price: {\n                                CustomerContextualPrice: promoCodTotalDiscount\n\n                            }\n                        }}\n                        context = {props.context}\n                        id = {props.id}\n                        typeName = {props.typeName}\n                        className = {'msc-promo-code__discount-value'}\n                    />\n                </div>\n                {\n                     props.cart.cart.Coupons.map((coupon: Coupon) => {\n                        const ariaLabel = props.removePromoAriaLabelFormat ? format(props.removePromoAriaLabelFormat, props.removePromoText, coupon.Code) : '';\n\n                        return (\n                            <div key={coupon.Code} className='msc-promo-code__line-container'>\n                                <div className='msc-promo-code__line-value'>\n                                    {coupon.Code} (\n                                        <PriceComponent\n                                            data={{\n                                                price: {\n                                                    CustomerContextualPrice: this._calculateDiscount(coupon.Code || '', props.cart)\n\n                                                }\n                                            }}\n                                            context = {props.context}\n                                            id = {props.id}\n                                            typeName = {props.typeName}\n                                            className = {'msc-promo-code__line-discount-value'}\n                                        />)\n                                </div>\n                                <Button\n                                    title={props.removePromoText}\n                                    className={'msc-promo-code__line__btn-remove'}\n                                    onClick={_removePromotion}\n                                    data-value={coupon.Code}\n                                    aria-label={ariaLabel}\n                                >\n                                    {props.removePromoText}\n                                </Button>\n                            </div>\n                        );\n                    })\n                }\n            </>\n        );\n    }\n}\n\nexport default PromoCode;"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}