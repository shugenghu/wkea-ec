{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/esm/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import{generateImageUrl}from'@msdyn365-commerce-modules/retail-actions';import{Drawer,getPayloadObject,getTelemetryAttributes,getTelemetryObject,Module,Node,onTelemetryClick}from'@msdyn365-commerce-modules/utilities';import{Image}from'@msdyn365-commerce/core';import classnames from'classnames';import*as React from'react';export var NavigationMenuView=/*#__PURE__*/function(_React$PureComponent){_inherits(NavigationMenuView,_React$PureComponent);var _super=_createSuper(NavigationMenuView);function NavigationMenuView(props){var _this;_classCallCheck(this,NavigationMenuView);_this=_super.call(this,props);_this.supportedLevel=2;_this.currentLevel=0;_this.escapeKey=27;_this._updateCategoryImage=function(categoryImage){return function(){_this.setState({categoryImage:categoryImage!==''?categoryImage:'empty'});};};_this._handleDropdownToggle=function(data,parentId){return function(){if(!_this.props.isMobileView){_this.setState({activeMenu:_this.state.activeMenu&&_this.state.activeMenu===data.id?undefined:data.id,parentMenu:parentId});if(_this.props.showCategoryImage){_this._updateCategoryImage(data.imageSource)();}}else{_this.setState({activeMenu:data.id,mobileViewLabelText:data.linkText,parentMenu:parentId});}_this._resetFocus();};};_this._resetFocus=function(){if(_this.props.isMobileView){setTimeout(function(){_this.menuNode&&_this.menuNode.current&&_this.menuNode.current.focus();},0);}};_this._handleClickOutside=function(event){if(_this.menuNode.current&&!_this.menuNode.current.contains(event.target)){_this.setState({activeMenu:undefined,mobileViewLabelText:''});}};_this._escFunction=function(event){if(event.keyCode===_this.escapeKey){_this._closeSubmenu();}};_this._getCategoryImage=function(categoryImage){var categoryImageUrl=generateImageUrl(\"\".concat(categoryImage),_this.props.context.actionContext.requestContext.apiSettings);var defaultImageSettings={viewports:{xs:{q:'w=300&h=250&m=8',w:0,h:0},sm:{q:'w=300&h=250&m=8',w:0,h:0},md:{q:'w=300&h=250&m=8',w:0,h:0},lg:{q:'w=300&h=250&m=8',w:0,h:0}},lazyload:true};if(categoryImageUrl!==undefined){var ImageData={src:categoryImageUrl};return/*#__PURE__*/React.createElement(Image,Object.assign({className:'ms-nav-image__item'},ImageData,{gridSettings:_this.props.context.request.gridSettings,imageSettings:_this.props.config.categoryImageSettings||defaultImageSettings,loadFailureBehavior:'hide',role:'tabpanel',id:\"\".concat(categoryImage,\"__categoryImage\")}));}return null;};_this.menuNode=/*#__PURE__*/React.createRef();_this.state={activeMenu:undefined,mobileViewLabelText:'',parentMenu:undefined};_this._closeSubmenu=_this._closeSubmenu.bind(_assertThisInitialized(_this));_this._escFunction=_this._escFunction.bind(_assertThisInitialized(_this));_this.telemetryContent=getTelemetryObject(_this.props.context.request.telemetryPageName,_this.props.friendlyName,_this.props.telemetry);_this.payLoad=getPayloadObject('click',_this.telemetryContent,'','');return _this;}_createClass(NavigationMenuView,[{key:\"componentDidMount\",value:function componentDidMount(){document.body&&document.addEventListener('keydown',this._escFunction,false);document.body&&document.body.addEventListener('mousedown',this._handleClickOutside);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){document.body&&document.removeEventListener('keydown',this._escFunction,false);document.body&&document.body.removeEventListener('mousedown',this._handleClickOutside,false);}},{key:\"render\",value:function render(){var isMobileView=this.props.isMobileView;this.currentLevel=1;return/*#__PURE__*/React.createElement(React.Fragment,null,isMobileView?this._renderMobileMenu():this._renderDesktopMenu());}},{key:\"_renderMobileMenu\",value:function _renderMobileMenu(){var _this2=this;var _this$props=this.props,isMobileView=_this$props.isMobileView,menuItemData=_this$props.menuItemData,Navigation=_this$props.Navigation;return/*#__PURE__*/React.createElement(Module,Object.assign({},Navigation,{className:classnames(Navigation.className,isMobileView?'mobile-view':'desktop-view')}),menuItemData.map(function(menuItem){return _this2._renderDrawerMenu(menuItem);}));}},{key:\"_renderDesktopMenu\",value:function _renderDesktopMenu(){var _this$props2=this.props,MenuList=_this$props2.MenuList,Navigation=_this$props2.Navigation;return/*#__PURE__*/React.createElement(Module,Object.assign({},Navigation,{className:classnames(Navigation.className)}),/*#__PURE__*/React.createElement(Node,Object.assign({},MenuList,{ref:this.menuNode,tabIndex:'-1'}),this._renderDisplay()));}},{key:\"_renderDrawerMenu\",value:function _renderDrawerMenu(menuItem){if(menuItem&&menuItem.subMenu&&menuItem.subMenu.length>0){return this._renderDrawer(menuItem);}else{return this._renderLinkMenuItem(menuItem);}}},{key:\"_renderDrawer\",value:function _renderDrawer(menuItem){var _this3=this;var toggleButtonText=menuItem.linkText;return/*#__PURE__*/React.createElement(Drawer,{key:menuItem.id,className:'ms-nav__drawer',openGlyph:'ms-nav__drawer-open',closeGlyph:'ms-nav__drawer-close',glyphPlacement:'end',toggleButtonText:this._renderLinkText(toggleButtonText)},/*#__PURE__*/React.createElement(\"div\",null,menuItem.subMenu.map(function(menuSubItem){return _this3._renderDrawerLink(menuSubItem);})));}},{key:\"_renderLinkText\",value:function _renderLinkText(linkText){return/*#__PURE__*/React.createElement(React.Fragment,null,linkText);}},{key:\"_renderDrawerLink\",value:function _renderDrawerLink(item){if(item&&item.linkText&&item.linkURL&&item.linkURL.length>0){return this._renderLinkMenuItem(item);}else if(item&&item.linkText&&!item.linkURL){return this._renderSpanMenuItem(item);}return null;}},{key:\"_renderDisplay\",value:function _renderDisplay(){var _this4=this;var _this$props3=this.props,ListItem=_this$props3.ListItem,menuItemData=_this$props3.menuItemData,isMobileView=_this$props3.isMobileView;var activeMenu=this.state.activeMenu;var menuItemList=[];if(isMobileView&&activeMenu!==undefined&&menuItemData.length>0){var menuItem={};for(var i=0;i<menuItemData.length;i++){if(menuItemData[i]&&menuItemData[i].id===activeMenu){menuItem=menuItemData[i];this.setState({parentMenu:undefined,mobileViewLabelText:menuItemData[i].linkText});break;}menuItem=this._getFromSubMenu(menuItemData[i]);if(menuItem&&menuItem.id===activeMenu){break;}}menuItem&&menuItemList.push(/*#__PURE__*/React.createElement(Node,Object.assign({key:menuItem.id},ListItem),\" \",this._createMenuItemList(menuItem),\" \"));}else{menuItemData.forEach(function(item,index){menuItemList.push(/*#__PURE__*/React.createElement(Node,Object.assign({key:index},ListItem),_this4._createMenuItemList(item)));});}return menuItemList;}},{key:\"_getFromSubMenu\",value:function _getFromSubMenu(item){var subMenus=item&&item.subMenu;if(subMenus&&subMenus.length>0){for(var i=0;i<=subMenus.length-1;i++){if(subMenus[i].id===this.state.activeMenu){this.setState({parentMenu:item&&item.id,mobileViewLabelText:subMenus[i].linkText});return subMenus[i];}var found=this._getFromSubMenu(subMenus[i]);if(found){return found;}}}return null;}},{key:\"_createMenuItemList\",value:function _createMenuItemList(menuItemData){if(menuItemData&&menuItemData.subMenu&&menuItemData.subMenu.length>0){if(this.props.isMobileView&&this.state.activeMenu!==undefined){return this._renderSubMenu(menuItemData.subMenu,menuItemData.id);}else{return/*#__PURE__*/React.createElement(React.Fragment,null,this._renderButtonMenuItem(menuItemData),this._renderSubMenu(menuItemData.subMenu,menuItemData.id));}}else if(menuItemData&&menuItemData.linkText&&menuItemData.linkURL&&menuItemData.linkURL.length>0){return this._renderLinkMenuItem(menuItemData);}else if(menuItemData&&menuItemData.linkText&&!menuItemData.linkURL){return this._renderSpanMenuItem(menuItemData);}return null;}},{key:\"_renderSubMenu\",value:function _renderSubMenu(subMenus,activeMenu){var _this5=this;var _this$props4=this.props,isMobileView=_this$props4.isMobileView,ListItem=_this$props4.ListItem;if(activeMenu&&this.state.activeMenu!==activeMenu){return null;}if(!subMenus||subMenus.length===0){return null;}var levelClassName='';var menuOptions=subMenus&&subMenus.map(function(option,idx){var hasOptions=option.subMenu&&option.subMenu.length>0;var menuItem;if(hasOptions&&isMobileView){menuItem=_this5._renderButtonMenuItem(option,activeMenu,idx);}else{menuItem=option.linkURL?_this5._renderLinkMenuItem(option,idx):_this5._renderSpanMenuItem(option);}var subMenu;if(hasOptions){_this5.currentLevel++;if(_this5.currentLevel<=_this5.supportedLevel-1){levelClassName=\"level-\".concat(_this5.currentLevel.toString());subMenu=_this5._renderSubMenu(option.subMenu,isMobileView?option.id:undefined);}}return/*#__PURE__*/React.createElement(Node,Object.assign({},ListItem,{key:option.id}),menuItem,subMenu);});return this._renderMenu(levelClassName,menuOptions,activeMenu);}},{key:\"_renderButtonMenuItem\",value:function _renderButtonMenuItem(option,activeMenu,index){var Button=this.props.Button;return/*#__PURE__*/React.createElement(Node,Object.assign({key:index},Button,{onClick:this._handleDropdownToggle(option,activeMenu),onFocus:this._closeSubmenu,\"aria-haspopup\":true,\"aria-expanded\":this.state.activeMenu&&this.state.activeMenu===option.id?true:false,\"data-parent\":activeMenu}),option.linkText);}},{key:\"_renderLinkMenuItem\",value:function _renderLinkMenuItem(option,index){var Link=this.props.Link;var linkText=option.linkText?option.linkText:'';var imagesource=option.imageSource?option.imageSource:'';this.payLoad.contentAction.etext=linkText;var attributes=getTelemetryAttributes(this.telemetryContent,this.payLoad);return/*#__PURE__*/React.createElement(Node,Object.assign({},Link,{key:index,onMouseOver:this._updateCategoryImage(imagesource),href:option.linkURL},attributes,{onClick:onTelemetryClick(this.telemetryContent,this.payLoad,linkText)}),option.linkText);}},{key:\"_renderSpanMenuItem\",value:function _renderSpanMenuItem(option,index){var Span=this.props.Span;return/*#__PURE__*/React.createElement(Node,Object.assign({key:index},Span),option.linkText);}},{key:\"_renderMenu\",value:function _renderMenu(level,menuOptions,currentItem){var _this$props5=this.props,DivContainer=_this$props5.DivContainer,MenuList=_this$props5.MenuList,ImageDivContainer=_this$props5.ImageDivContainer,showCategoryImage=_this$props5.showCategoryImage;this.currentLevel=1;if(showCategoryImage){return/*#__PURE__*/React.createElement(Node,Object.assign({},DivContainer,{className:DivContainer.className}),/*#__PURE__*/React.createElement(Node,Object.assign({},MenuList,{className:classnames(MenuList.className,level)}),menuOptions),/*#__PURE__*/React.createElement(Node,Object.assign({},ImageDivContainer,{className:ImageDivContainer.className}),this.state.categoryImage!==undefined&&this.state.categoryImage!==null&&this._getCategoryImage(this.state.categoryImage)));}return/*#__PURE__*/React.createElement(Node,Object.assign({},MenuList,{className:classnames(MenuList.className,level)}),menuOptions);}},{key:\"_closeSubmenu\",value:function _closeSubmenu(){if(!this.props.isMobileView){this.setState({activeMenu:undefined,mobileViewLabelText:''});}}}]);return NavigationMenuView;}(React.PureComponent);export default NavigationMenuView;","map":{"version":3,"sources":["modules/fabrikam/views/navigation-menu.view.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { IMenuItemData, INavigationMenuViewProps } from '@msdyn365-commerce-modules/navigation-menu';\nimport { generateImageUrl } from '@msdyn365-commerce-modules/retail-actions';\nimport { Drawer, getPayloadObject, getTelemetryAttributes, getTelemetryObject, IPayLoad, ITelemetryContent, Module, Node, onTelemetryClick } from '@msdyn365-commerce-modules/utilities';\nimport { IImageData, IImageSettings, Image} from '@msdyn365-commerce/core';\nimport classnames from 'classnames';\nimport * as React from 'react';\n\ninterface INavigationState {\n  parentMenu?: number;\n  activeMenu?: number;\n  categoryImage?:string|null;\n  mobileViewLabelText?: string;\n}\n\n/**\n *\n * NavigationMenuView component\n * @extends {React.PureComponent<INavigationMenuViewProps>}\n */\nexport class NavigationMenuView extends React.PureComponent<INavigationMenuViewProps, INavigationState> {\n  private supportedLevel: number = 2;\n  private currentLevel: number = 0;\n  private escapeKey:number = 27;\n  private menuNode: React.RefObject<HTMLUListElement>;\n  private telemetryContent: ITelemetryContent;\n  private payLoad: IPayLoad;\n  constructor(props: INavigationMenuViewProps) {\n      super(props);\n      this.menuNode = React.createRef();\n      this.state = {activeMenu: undefined, mobileViewLabelText: '', parentMenu: undefined};\n      this._closeSubmenu  =this._closeSubmenu.bind(this);\n      this._escFunction = this._escFunction.bind(this);\n      this.telemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!,\n                                                 this.props.friendlyName,\n                                                 this.props.telemetry);\n      this.payLoad = getPayloadObject('click', this.telemetryContent, '', '');\n  }\n\n  public componentDidMount(): void {\n    document.body && document.addEventListener('keydown', (this._escFunction as unknown) as EventListener, false);\n    document.body && document.body.addEventListener('mousedown',  this._handleClickOutside);\n  }\n\n  public componentWillUnmount(): void {\n    document.body && document.removeEventListener('keydown', (this._escFunction as unknown) as EventListener, false);\n    document.body && document.body.removeEventListener('mousedown', this._handleClickOutside, false);\n  }\n\n  public render(): JSX.Element | null {\n    const { isMobileView} = this.props;\n\n    this.currentLevel = 1;\n    return(\n      <React.Fragment>\n         {isMobileView\n         ? this._renderMobileMenu()\n         : this._renderDesktopMenu()\n        }\n      </React.Fragment>\n    );\n  }\n\n  private _renderMobileMenu(): JSX.Element {\n    const {isMobileView, menuItemData, Navigation}= this.props;\n    return(\n      <Module {...Navigation} className={classnames(Navigation.className, isMobileView? 'mobile-view': 'desktop-view')}>\n          {menuItemData.map((menuItem: IMenuItemData) => {\n            return this._renderDrawerMenu(menuItem);\n          })}\n      </Module>\n    );\n  }\n  private _renderDesktopMenu(): JSX.Element {\n    const { MenuList, Navigation} = this.props;\n    return (\n      <Module {...Navigation} className={classnames(Navigation.className)}>\n        <Node { ...MenuList } ref={this.menuNode} tabIndex='-1'>\n          {this._renderDisplay()}\n        </Node>\n       </Module>\n    );\n  }\n\n  private _renderDrawerMenu(menuItem: IMenuItemData): JSX.Element | null {\n    if (menuItem && menuItem.subMenu && menuItem.subMenu.length > 0) {\n      return (this._renderDrawer(menuItem));\n    } else {\n      return (this._renderLinkMenuItem(menuItem));\n    }\n  }\n\n  private _renderDrawer(menuItem: IMenuItemData): JSX.Element | null {\n    const toggleButtonText= menuItem.linkText;\n    return (\n      <Drawer key={menuItem.id} className={'ms-nav__drawer'} openGlyph='ms-nav__drawer-open' closeGlyph= 'ms-nav__drawer-close' glyphPlacement='end' toggleButtonText={this._renderLinkText(toggleButtonText)}>\n          <div>\n            {menuItem.subMenu!.map((menuSubItem: IMenuItemData) => {\n              return this._renderDrawerLink(menuSubItem);\n            })}\n          </div>\n      </Drawer>\n    );\n  }\n\n  private _renderLinkText(linkText: string | undefined): JSX.Element {\n    return (\n        <React.Fragment>\n            {linkText}\n        </React.Fragment>\n    );\n  }\n\n  private _renderDrawerLink(item: IMenuItemData): JSX.Element | null {\n    if (item && item.linkText && item.linkURL && item.linkURL.length > 0) {\n      return (\n        this._renderLinkMenuItem(item)\n      );\n    } else if (item && item.linkText && !item.linkURL) {\n      return (\n        this._renderSpanMenuItem(item)\n      );\n    }\n    return null;\n  }\n\n  private _renderDisplay(): JSX.Element[] {\n    const { ListItem, menuItemData, isMobileView} = this.props;\n    const {activeMenu} = this.state;\n    const menuItemList: JSX.Element[] = [];\n\n    if (isMobileView &&  activeMenu !== undefined && menuItemData.length > 0) {\n      let menuItem: IMenuItemData = {};\n      for(let i = 0; i < menuItemData.length; i++) {\n        if (menuItemData[i] && menuItemData[i].id === activeMenu) {\n          menuItem = menuItemData[i];\n          this.setState({parentMenu: undefined, mobileViewLabelText: menuItemData[i].linkText});\n          break;\n        }\n        menuItem = this._getFromSubMenu(menuItemData[i]) as IMenuItemData;\n        if (menuItem && menuItem.id === activeMenu) {\n          break;\n        }\n      }\n\n      menuItem && menuItemList.push (\n        <Node key={menuItem.id} { ...ListItem}> {this._createMenuItemList(menuItem)} </Node>\n      );\n    } else {\n      menuItemData.forEach((item: IMenuItemData, index: number) => {\n        menuItemList.push (\n          <Node key={index} { ...ListItem}>\n              {this._createMenuItemList(item)}\n          </Node>\n        );\n      });\n    }\n\n    return menuItemList;\n  }\n\n  private _getFromSubMenu(item?: IMenuItemData): IMenuItemData | null {\n    const subMenus = item && item.subMenu;\n    if (subMenus && subMenus.length > 0) {\n      for(let i = 0; i <= subMenus.length-1; i++) {\n        if (subMenus[i].id === this.state.activeMenu) {\n            this.setState({parentMenu: item && item.id, mobileViewLabelText: subMenus[i].linkText});\n            return subMenus[i];\n        }\n        const found = this._getFromSubMenu(subMenus[i]);\n        if (found) {\n          return found;\n        }\n      }\n    }\n    return null;\n  }\n\n  private _createMenuItemList(menuItemData: IMenuItemData): JSX.Element | null {\n    if (menuItemData && menuItemData.subMenu && menuItemData.subMenu.length > 0) {\n      if (this.props.isMobileView && this.state.activeMenu !== undefined) {\n        return (this._renderSubMenu(menuItemData.subMenu, menuItemData.id));\n      } else {\n        return (\n          <React.Fragment>\n            {this._renderButtonMenuItem(menuItemData)}\n            {this._renderSubMenu(menuItemData.subMenu, menuItemData.id)}\n          </React.Fragment>\n        );\n      }\n    } else if (menuItemData && menuItemData.linkText && menuItemData.linkURL && menuItemData.linkURL.length > 0) {\n      return (this._renderLinkMenuItem(menuItemData));\n    } else if (menuItemData && menuItemData.linkText && !menuItemData.linkURL) {\n      return (this._renderSpanMenuItem(menuItemData));\n    }\n\n    return null;\n  }\n\n  private _renderSubMenu(subMenus?: IMenuItemData[], activeMenu?: number): JSX.Element | null {\n    const {isMobileView, ListItem} = this.props;\n    if (activeMenu && this.state.activeMenu !== activeMenu) {\n      return null;\n    }\n\n    if (!subMenus || subMenus.length === 0) {\n      return null;\n    }\n\n    let levelClassName: string = '';\n    const menuOptions = subMenus && subMenus.map((option: IMenuItemData, idx: number)  => {\n      const hasOptions = (option.subMenu && option.subMenu.length > 0);\n      let menuItem: JSX.Element | null;\n      if (hasOptions && isMobileView) {\n        menuItem = this._renderButtonMenuItem(option, activeMenu, idx);\n      } else {\n        menuItem = (option.linkURL\n          ? this._renderLinkMenuItem(option, idx)\n          : this._renderSpanMenuItem(option)\n        );\n      }\n\n      let subMenu;\n\n      if (hasOptions) {\n        this.currentLevel++;\n        if (this.currentLevel <= this.supportedLevel-1) {\n          levelClassName = `level-${this.currentLevel.toString()}`;\n          subMenu = this._renderSubMenu(option.subMenu, isMobileView ? option.id : undefined);\n        }\n      }\n\n      return (\n      <Node {...ListItem} key={ option.id }>\n          { menuItem }\n          { subMenu }\n      </Node>\n      );\n    });\n\n    return (this._renderMenu(levelClassName, menuOptions, activeMenu));\n  }\n\n  private _renderButtonMenuItem(option: IMenuItemData, activeMenu?: number, index?: number): JSX.Element | null {\n    const {Button} = this.props;\n    return (\n          <Node\n            key={index}\n            {...Button}\n            onClick={this._handleDropdownToggle(option, activeMenu)}\n            onFocus={this._closeSubmenu}\n            aria-haspopup={true}\n            aria-expanded={this.state.activeMenu && this.state.activeMenu === option.id ? true : false}\n            data-parent={activeMenu}\n          >\n            { option.linkText }\n          </Node>\n      );\n  }\n\n  private _renderLinkMenuItem(option: IMenuItemData, index?: number): JSX.Element | null {\n    const {Link} = this.props;\n    const linkText = option.linkText ? option.linkText : '';\n    const imagesource= option.imageSource ? option.imageSource :'';\n    this.payLoad.contentAction.etext = linkText;\n    const attributes = getTelemetryAttributes(this.telemetryContent, this.payLoad);\n    return (\n      <Node {...Link} key={index} onMouseOver={this._updateCategoryImage(imagesource)} href={ option.linkURL } {...attributes} onClick={onTelemetryClick(this.telemetryContent, this.payLoad, linkText)}>\n        { option.linkText }\n      </Node>\n    );\n  }\n\n  private _renderSpanMenuItem(option: IMenuItemData, index?: number): JSX.Element | null {\n    const {Span} = this.props;\n    return (\n      <Node key={index} {...Span}>{ option.linkText }</Node>\n    );\n  }\n\n  private _renderMenu(level: string, menuOptions: JSX.Element[], currentItem?: number): JSX.Element | null {\n    const {DivContainer, MenuList,ImageDivContainer,showCategoryImage} = this.props;\n    this.currentLevel = 1;\n    if(showCategoryImage) {\n      return (\n        <Node {...DivContainer} className={DivContainer!.className}>\n        <Node {...MenuList} className={classnames(MenuList.className, level)}>\n          { menuOptions }\n          </Node>\n        <Node {...ImageDivContainer}  className={ImageDivContainer!.className}>\n          {this.state.categoryImage !==undefined && this.state.categoryImage !==null && this._getCategoryImage(this.state.categoryImage)}\n        </Node>\n        </Node>\n      );\n    }\n    return (\n     <Node {...MenuList} className={classnames(MenuList.className, level)}>\n     { menuOptions }\n       </Node>\n    );\n\n  }\n  private _updateCategoryImage=(categoryImage:string) => ()=> {\n    this.setState({\n      categoryImage: categoryImage !==''? categoryImage :'empty'\n     });\n }\n  private _handleDropdownToggle = (data: IMenuItemData, parentId?: number) => () => {\n    if (!this.props.isMobileView) {\n      this.setState({\n        activeMenu: (this.state.activeMenu && this.state.activeMenu === data.id!) ? undefined : data.id!,\n        parentMenu: parentId\n      });\n      if(this.props.showCategoryImage) {\n        this._updateCategoryImage(data.imageSource!)();\n      }\n    } else {\n      this.setState({\n        activeMenu: data.id,\n        mobileViewLabelText: data.linkText!,\n        parentMenu: parentId\n      });\n    }\n\n    this._resetFocus();\n  };\n\n  private _resetFocus = () => {\n    if (this.props.isMobileView) {\n      setTimeout(() => {\n        this.menuNode && this.menuNode.current && this.menuNode.current.focus();\n      },         0);\n    }\n  }\n\n  // tslint:disable-next-line:no-any\n  private _handleClickOutside = (event: any) => {\n    if (this.menuNode.current && !this.menuNode.current.contains(event.target)) {\n      this.setState({activeMenu:undefined, mobileViewLabelText: ''});\n    }\n  };\n\n  private _closeSubmenu():void {\n    if (!this.props.isMobileView) {\n      this.setState({activeMenu:undefined, mobileViewLabelText: ''});\n    }\n  }\n  private _escFunction = (event:React.KeyboardEvent) => {\n\n    if (event.keyCode === this.escapeKey) {\n      this._closeSubmenu();\n    }\n  }\n  private _getCategoryImage=(categoryImage:string):React.ReactNode|null => {\n\n    const categoryImageUrl = generateImageUrl(`${categoryImage}`, this.props.context.actionContext.requestContext.apiSettings);\n    const defaultImageSettings: IImageSettings = {\n        viewports: {\n            xs: { q: 'w=300&h=250&m=8', w: 0, h: 0 },\n            sm: { q: 'w=300&h=250&m=8', w: 0, h: 0 },\n            md: { q: 'w=300&h=250&m=8', w: 0, h: 0 },\n            lg: { q: 'w=300&h=250&m=8', w: 0, h: 0 }\n        },\n        lazyload: true\n    };\n    if(categoryImageUrl !== undefined) {\n        const ImageData:IImageData = {src:categoryImageUrl};\n        return (\n            <Image\n                className='ms-nav-image__item'\n                {...ImageData}\n                gridSettings={this.props.context.request.gridSettings!}\n                imageSettings={this.props.config.categoryImageSettings || defaultImageSettings}\n                loadFailureBehavior='hide'\n                role='tabpanel'\n                id={`${categoryImage}__categoryImage`}\n            />\n        );\n    }\n    return null;\n  }\n}\n\nexport default NavigationMenuView;"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}