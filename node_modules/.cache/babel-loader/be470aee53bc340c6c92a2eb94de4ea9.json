{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _inherits from\"@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/esm/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import{__decorate}from\"tslib\";import classname from'classnames';import{observer}from'mobx-react';import*as React from'react';import{issueLoyalty,IssueLoyaltyInput}from'@msdyn365-commerce-modules/retail-actions';import{Button,getPayloadObject,getTelemetryAttributes,getTelemetryObject,TelemetryConstant}from'@msdyn365-commerce-modules/utilities';import*as Msdyn365 from'@msdyn365-commerce/core';import{SignUpText}from'./components/loyalty-sign-up-small-components';var LoyaltySignUp=/*#__PURE__*/function(_React$Component){_inherits(LoyaltySignUp,_React$Component);var _super=_createSuper(LoyaltySignUp);function LoyaltySignUp(props){var _this;_classCallCheck(this,LoyaltySignUp);_this=_super.call(this,props);_this.handleHeadingChange=function(event){return _this.props.config.heading.text=event.target.value;};_this.handleMemberHeadingChange=function(event){return _this.props.config.memberHeading.text=event.target.value;};_this._issueLoyalty=function(){if(_this.props.context.request.user.isAuthenticated&&!_this.state.clicked){_this.setState({clicked:true});var input=new IssueLoyaltyInput(_this.props.context.request.apiSettings);issueLoyalty(input,_this.props.context.actionContext).then(function(){window.location.assign(Msdyn365.getUrlSync('loyalty',_this.props.context.actionContext)||'');})[\"catch\"](function(error){_this.setState({clicked:false});_this.props.telemetry.error(error.message);_this.props.telemetry.debug('Unable to issue loyalty card');});}};_this.state={clicked:false};_this.telemetryContent=getTelemetryObject(_this.props.context.request.telemetryPageName,_this.props.friendlyName,_this.props.telemetry);var payLoad=getPayloadObject('click',_this.telemetryContent,TelemetryConstant.SignIn);_this.loyaltySignInAttributes=getTelemetryAttributes(_this.telemetryContent,payLoad);payLoad.contentAction.etext=TelemetryConstant.SignUp;_this.loyaltySignUpAttributes=getTelemetryAttributes(_this.telemetryContent,payLoad);payLoad.contentAction.etext=TelemetryConstant.LoyaltyDetailLink;_this.loyaltyDetailsLinkAttributes=getTelemetryAttributes(_this.telemetryContent,payLoad);payLoad.contentAction.etext=TelemetryConstant.LoyaltyTermsLink;_this.loyaltyTermsLinkAttributes=getTelemetryAttributes(_this.telemetryContent,payLoad);return _this;}_createClass(LoyaltySignUp,[{key:\"render\",value:function render(){var _this$props=this.props,_this$props$config=_this$props.config,className=_this$props$config.className,heading=_this$props$config.heading,memberHeading=_this$props$config.memberHeading,resources=_this$props.resources,_this$props$context=_this$props.context,actionContext=_this$props$context.actionContext,_this$props$context$r=_this$props$context.request.user,signInUrl=_this$props$context$r.signInUrl,isAuthenticated=_this$props$context$r.isAuthenticated,loyaltyCard=_this$props.data.loyaltyCard;var termsUrl=Msdyn365.getUrlSync('loyaltyTerms',actionContext);var loyaltyJoinUrl=\"\".concat(Msdyn365.getUrlSync('loyaltyJoin',actionContext),\"?joiningLoyalty=true\");if(window){loyaltyJoinUrl=\"\".concat(window.location.origin).concat(loyaltyJoinUrl);}var signInurl=\"\".concat(signInUrl,\"?ru=\").concat(loyaltyJoinUrl);var completeClass=classname('ms-loyalty-signup',className);var hasLoyaltyAccount=loyaltyCard.result&&loyaltyCard.result.CardTenderTypeValue!==undefined;var viewProps=_objectSpread(_objectSpread({},this.props),{},{className:completeClass,LoyaltySignUp:{moduleProps:this.props,className:completeClass},loading:loyaltyCard.status==='LOADING',heading:!hasLoyaltyAccount&&heading&&heading.text&&/*#__PURE__*/React.createElement(Msdyn365.Text,{className:'ms-loyalty-signup__heading',tag:heading.tag,text:heading.text,editProps:{onEdit:this.handleHeadingChange,requestContext:this.props.context.request}}),memberHeading:hasLoyaltyAccount&&memberHeading&&memberHeading.text&&/*#__PURE__*/React.createElement(Msdyn365.Text,{className:'ms-loyalty-signup__heading',tag:memberHeading.tag,text:memberHeading.text,editProps:{onEdit:this.handleMemberHeadingChange,requestContext:this.props.context.request}}),signInLink:!isAuthenticated&&/*#__PURE__*/React.createElement(Button,Object.assign({className:'ms-loyalty-signup__signin',href:signInurl},this.loyaltySignInAttributes),this.props.resources.joinLoyaltyButtonText),signUpText:!hasLoyaltyAccount&&/*#__PURE__*/React.createElement(SignUpText,{text:resources.loyaltyProgramText}),signUpButton:!hasLoyaltyAccount&&isAuthenticated&&/*#__PURE__*/React.createElement(Button,Object.assign({className:'ms-loyalty-signup__btn',onClick:this._issueLoyalty},this.loyaltySignUpAttributes),this.props.resources.joinLoyaltyButtonText),detailsLink:hasLoyaltyAccount&&/*#__PURE__*/React.createElement(Button,Object.assign({className:'ms-loyalty-signup__details',href:Msdyn365.getUrlSync('loyalty',this.props.context.actionContext)},this.loyaltyDetailsLinkAttributes),this.props.resources.viewLoyaltyPageText),termsLink:!hasLoyaltyAccount&&/*#__PURE__*/React.createElement(Button,Object.assign({className:'ms-loyalty-signup__terms',href:termsUrl},this.loyaltyTermsLinkAttributes),this.props.resources.loyaltyTermsLinkText)});return this.props.renderView(viewProps);}}]);return LoyaltySignUp;}(React.Component);LoyaltySignUp=__decorate([observer],LoyaltySignUp);export default LoyaltySignUp;","map":{"version":3,"sources":["modules/loyalty-sign-up/loyalty-sign-up.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport classname from 'classnames';\nimport { observer } from 'mobx-react';\nimport * as React from 'react';\n\nimport { issueLoyalty, IssueLoyaltyInput } from '@msdyn365-commerce-modules/retail-actions';\nimport { Button, getPayloadObject, getTelemetryAttributes, getTelemetryObject, IModuleProps, ITelemetryContent, TelemetryConstant } from '@msdyn365-commerce-modules/utilities';\nimport * as Msdyn365 from '@msdyn365-commerce/core';\nimport {SignUpText} from './components/loyalty-sign-up-small-components';\nimport { ILoyaltySignUpData } from './loyalty-sign-up.data';\nimport { ILoyaltySignUpProps } from './loyalty-sign-up.props.autogenerated';\n\nexport interface IAccountLoyaltyJoinState {\n    clicked: boolean;\n}\nexport interface ILoyaltySignUpViewProps extends ILoyaltySignUpProps<ILoyaltySignUpData> {\n    LoyaltySignUp: IModuleProps;\n    heading: React.ReactNode;\n    memberHeading: React.ReactNode;\n    signInLink: React.ReactElement;\n    signUpText: React.ReactElement;\n    signUpButton: React.ReactElement;\n    detailsLink: React.ReactElement;\n    termsLink: React.ReactElement;\n    loading: boolean;\n}\n\n/**\n *\n * LoyaltySignUp component\n * @extends {React.Component<ILoyaltySignUpProps<ILoyaltySignUpData>>}\n */\n@observer\nclass LoyaltySignUp extends React.Component<ILoyaltySignUpProps<ILoyaltySignUpData>, IAccountLoyaltyJoinState> {\n    private telemetryContent?: ITelemetryContent;\n    private loyaltySignInAttributes: Msdyn365.IDictionary<string> | undefined;\n    private loyaltySignUpAttributes: Msdyn365.IDictionary<string> | undefined;\n    private loyaltyDetailsLinkAttributes: Msdyn365.IDictionary<string> | undefined;\n    private loyaltyTermsLinkAttributes: Msdyn365.IDictionary<string> | undefined;\n\n    constructor(props: ILoyaltySignUpProps<ILoyaltySignUpData>) {\n        super(props);\n        this.state = { clicked: false };\n        this.telemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!, this.props.friendlyName, this.props.telemetry);\n        const payLoad = getPayloadObject('click', this.telemetryContent, TelemetryConstant.SignIn);\n        this.loyaltySignInAttributes = getTelemetryAttributes(this.telemetryContent, payLoad);\n        payLoad.contentAction.etext = TelemetryConstant.SignUp;\n        this.loyaltySignUpAttributes = getTelemetryAttributes(this.telemetryContent, payLoad);\n        payLoad.contentAction.etext = TelemetryConstant.LoyaltyDetailLink;\n        this.loyaltyDetailsLinkAttributes = getTelemetryAttributes(this.telemetryContent, payLoad);\n        payLoad.contentAction.etext = TelemetryConstant.LoyaltyTermsLink;\n        this.loyaltyTermsLinkAttributes = getTelemetryAttributes(this.telemetryContent, payLoad);\n    }\n\n    public render(): JSX.Element | null {\n        const {\n            config: {className, heading, memberHeading},\n            resources,\n            context: {\n                actionContext,\n                request: {\n                    user: {\n                        signInUrl,\n                        isAuthenticated\n                    }\n                }\n            },\n            data: { loyaltyCard }\n        } = this.props;\n\n        const termsUrl = Msdyn365.getUrlSync('loyaltyTerms', actionContext);\n        let loyaltyJoinUrl = `${Msdyn365.getUrlSync('loyaltyJoin', actionContext)}?joiningLoyalty=true`;\n        if (window) {\n            loyaltyJoinUrl = `${window.location.origin}${loyaltyJoinUrl}`;\n        }\n        const signInurl = `${signInUrl}?ru=${loyaltyJoinUrl}`;\n        const completeClass = classname('ms-loyalty-signup', className);\n\n        const hasLoyaltyAccount = loyaltyCard.result && loyaltyCard.result.CardTenderTypeValue !== undefined;\n\n        const viewProps = {\n            ...this.props,\n            className: completeClass,\n            LoyaltySignUp: {\n                moduleProps: this.props,\n                className: completeClass\n            },\n            loading: loyaltyCard.status === 'LOADING',\n            heading: !hasLoyaltyAccount && heading && heading.text && (\n            <Msdyn365.Text\n                className='ms-loyalty-signup__heading'\n                tag={heading.tag}\n                text={heading.text}\n                editProps = {{onEdit: this.handleHeadingChange, requestContext: this.props.context.request}}\n            />\n            ),\n            memberHeading: hasLoyaltyAccount && memberHeading && memberHeading.text && (\n            <Msdyn365.Text\n                className='ms-loyalty-signup__heading'\n                tag={memberHeading.tag}\n                text={memberHeading.text}\n                editProps = {{onEdit: this.handleMemberHeadingChange, requestContext: this.props.context.request}}\n            />\n            ),\n            signInLink: !isAuthenticated && <Button className='ms-loyalty-signup__signin' href={signInurl} {...this.loyaltySignInAttributes}>{this.props.resources.joinLoyaltyButtonText}</Button>,\n            signUpText: !hasLoyaltyAccount && <SignUpText text={resources.loyaltyProgramText}/>,\n            signUpButton: !hasLoyaltyAccount &&  isAuthenticated && <Button className='ms-loyalty-signup__btn' onClick={this._issueLoyalty} {...this.loyaltySignUpAttributes} >{this.props.resources.joinLoyaltyButtonText}</Button>,\n            detailsLink: hasLoyaltyAccount &&\n                <Button className='ms-loyalty-signup__details' href={Msdyn365.getUrlSync('loyalty', this.props.context.actionContext)} {...this.loyaltyDetailsLinkAttributes} >{this.props.resources.viewLoyaltyPageText}</Button>,\n            termsLink: !hasLoyaltyAccount && <Button className='ms-loyalty-signup__terms' href={termsUrl} {...this.loyaltyTermsLinkAttributes} >{this.props.resources.loyaltyTermsLinkText}</Button>\n        };\n\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n\n    public handleHeadingChange = (event: Msdyn365.ContentEditableEvent) => this.props.config.heading!.text= event.target.value;\n    public handleMemberHeadingChange = (event: Msdyn365.ContentEditableEvent) => this.props.config.memberHeading!.text= event.target.value;\n\n    private _issueLoyalty = () => {\n        if (this.props.context.request.user.isAuthenticated && !this.state.clicked) {\n            this.setState({ clicked: true });\n            const input = new IssueLoyaltyInput(this.props.context.request.apiSettings);\n\n            issueLoyalty(input, this.props.context.actionContext)\n                .then(() => {\n                    window.location.assign(Msdyn365.getUrlSync('loyalty', this.props.context.actionContext) || '');\n                })\n                .catch((error: Error) => {\n                    this.setState({ clicked: false });\n                    this.props.telemetry.error(error.message);\n                    this.props.telemetry.debug('Unable to issue loyalty card');\n                });\n        }\n    }\n}\n\nexport default LoyaltySignUp;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}