{"ast":null,"code":"import\"core-js/modules/es.object.assign.js\";import\"core-js/modules/es.promise.js\";import\"core-js/modules/web.dom-collections.iterator.js\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import{__decorate}from\"tslib\";import classname from'classnames';import{observable}from'mobx';import{observer}from'mobx-react';import*as React from'react';import{Button,getPayloadObject,getTelemetryAttributes,getTelemetryObject,TelemetryConstant}from'@msdyn365-commerce-modules/utilities';import*as Msdyn365 from'@msdyn365-commerce/core';import LabelComponent from'../../common/label';import{getSalesOrderHistoryWithHydrationsAction,GetSalesOrderHistoryWithHydrationsInput}from'./actions/get-order-shipment-history';import{getSalesOrder}from'./components/get-sales-order';export*from'../../common/get-groups';export*from'../../common/get-order-information';export*from'../../common/get-sales-line';export*from'../../common/get-sales-lines';export*from'../../common/utilities';export*from'./components/get-sales-order';export*from'../../common/get-order-information';export*from'./components/get-sales-order';let OrderHistory=class OrderHistory extends React.Component{constructor(props){super(props);this.handleOrderHistoryHeadingChange=event=>this.props.config.heading.text=event.target.value;this.onMoreButtonClick=()=>{this.getOrderHistory();};this.getOrderHistory=async()=>{const actionContext=this.props.context.actionContext;const input=new GetSalesOrderHistoryWithHydrationsInput(this.paging,this.props.context.request.apiSettings);try{this.viewState.isLoading=true;const response=await getSalesOrderHistoryWithHydrationsAction(input,actionContext);if(response){const{products,salesOrders}=response;this.orderHistory.products.push(...products);this.orderHistory.salesOrders.push(...salesOrders);this.viewState.isShowMoreButton=this.viewState.isShowMoreButton&&response.salesOrders.length>0&&response.salesOrders.length===this.pageSize;this.paging.skip+=this.pageSize;}this.viewState.isLoading=false;return Promise.resolve();}catch(error){return Promise.reject();}};this.orderHistory={salesOrders:[],products:[]};this.viewState={isDataReady:false,hasError:false,isShowMoreButton:(this.props.config.pageSize||0)>0,isLoading:false};this.pageSize=this.props.config.pageSize||10;this.paging={top:this.pageSize,skip:0};this.telemetryContent=getTelemetryObject(this.props.context.request.telemetryPageName,this.props.friendlyName,this.props.telemetry);this.payLoad=getPayloadObject('click',this.telemetryContent,'');}componentDidMount(){this.getOrderHistory().then(()=>{this.viewState.isDataReady=true;}).catch(ex=>{this.viewState.hasError=true;});}render(){const{config:{heading,className,showChannelInfo},resources:{genericErrorMessage,noOrderHistoryLable,moreButtonText,backToShopping,orderCountLabel,ordersCountLabel,loadingLabel}}=this.props;const{salesOrders,products}=this.orderHistory;const{isDataReady,hasError,isShowMoreButton,isLoading}=this.viewState;const backToShoppingUrl=Msdyn365.getUrlSync('home',this.props.context.actionContext)||'';const channelIdentities=this.props.data.channels.result&&this.props.data.channels.result.channelIdentities;const orgUnitLocations=this.props.data.orgUnitLocations.result&&this.props.data.orgUnitLocations.result.orgUnitLocations;let viewProps=_objectSpread(_objectSpread({},this.props),{},{orderHistory:this.orderHistory,viewState:this.viewState,orderHistoryProps:{moduleProps:this.props,className:classname('ms-order-history',className)},header:{headerProps:{className:'ms-order-history__header'},heading:heading&&heading.text&&/*#__PURE__*/React.createElement(Msdyn365.Text,Object.assign({},heading,{className:'ms-order-history__heading',text:heading.text,tag:heading.tag||'h2',editProps:{onEdit:this.handleOrderHistoryHeadingChange,requestContext:this.props.context.request}}))},backToShoppingLink:backToShoppingUrl&&/*#__PURE__*/React.createElement(Button,{className:'ms-order-history__btn-keep-shopping',href:backToShoppingUrl},backToShopping)});if(hasError){viewProps=_objectSpread(_objectSpread({},viewProps),{},{alert:/*#__PURE__*/React.createElement(LabelComponent,{className:'ms-order-history__alert',label:genericErrorMessage})});return this.props.renderView(viewProps);}if(!isDataReady){viewProps=_objectSpread(_objectSpread({},viewProps),{},{loading:/*#__PURE__*/React.createElement(LabelComponent,{className:'ms-order-history__loading',label:loadingLabel})});return this.props.renderView(viewProps);}if(!salesOrders||salesOrders.length===0){viewProps=_objectSpread(_objectSpread({},viewProps),{},{emptyMessage:/*#__PURE__*/React.createElement(\"p\",{className:'ms-order-history__empty-message'},noOrderHistoryLable)});return this.props.renderView(viewProps);}const _orderCountLabel=salesOrders.length===1?orderCountLabel:ordersCountLabel;this.payLoad.contentAction.etext=TelemetryConstant.ViewMore;const viewMoreAttributes=getTelemetryAttributes(this.telemetryContent,this.payLoad);viewProps=_objectSpread(_objectSpread({},viewProps),{},{header:_objectSpread(_objectSpread({},viewProps.header),{},{orderCountLabel:/*#__PURE__*/React.createElement(\"span\",{className:'ms-order-history__order-count'},\"(\".concat(salesOrders.length,\" \").concat(_orderCountLabel,\")\"))}),list:{listProps:{className:'ms-order-history__sales-order-list'},salesOrders:salesOrders.map(salesOrder=>getSalesOrder(_objectSpread(_objectSpread({},this.props),{},{products,salesOrder,channelIdentities,orgUnitLocations,showChannelInfo,telemetryContent:this.telemetryContent})))},moreButton:isShowMoreButton&&/*#__PURE__*/React.createElement(Button,Object.assign({className:\"ms-order-history__btn-more \".concat(isLoading?'is-busy':'')},viewMoreAttributes,{disabled:isLoading,onClick:this.onMoreButtonClick}),moreButtonText)});return this.props.renderView(viewProps);}};__decorate([observable],OrderHistory.prototype,\"orderHistory\",void 0);__decorate([observable],OrderHistory.prototype,\"viewState\",void 0);OrderHistory=__decorate([observer],OrderHistory);export default OrderHistory;","map":{"version":3,"sources":["modules/order-history/order-history.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport classname from 'classnames';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport * as React from 'react';\n\nimport { Button, getPayloadObject, getTelemetryAttributes, getTelemetryObject, IModuleProps, INodeProps, IPayLoad, ITelemetryContent, TelemetryConstant } from '@msdyn365-commerce-modules/utilities';\nimport * as Msdyn365 from '@msdyn365-commerce/core';\n\nimport LabelComponent from '../../common/label';\nimport {\n    getSalesOrderHistoryWithHydrationsAction, GetSalesOrderHistoryWithHydrationsInput,\n    IOrderHistory, IPaging\n} from './actions/get-order-shipment-history';\nimport { getSalesOrder, ISalesOrder } from './components/get-sales-order';\nimport { IOrderHistoryData } from './order-history.data';\nimport { IOrderHistoryProps } from './order-history.props.autogenerated';\n\nexport * from '../../common/get-groups';\nexport * from '../../common/get-order-information';\nexport * from '../../common/get-sales-line';\nexport * from '../../common/get-sales-lines';\nexport * from '../../common/utilities';\nexport * from './components/get-sales-order';\n\nexport * from '../../common/get-order-information';\nexport * from './components/get-sales-order';\n\nexport interface IHeader {\n    headerProps: INodeProps;\n    heading: React.ReactNode;\n    orderCountLabel?: React.ReactNode;\n}\n\nexport interface IList {\n    listProps: INodeProps;\n    salesOrders: ISalesOrder[];\n}\n\nexport interface IOrderHistoryViewState {\n    isDataReady: boolean;\n    hasError: boolean;\n    isLoading: boolean;\n    isShowMoreButton: boolean;\n}\n\nexport interface IOrderHistoryViewProps extends IOrderHistoryProps<IOrderHistoryData> {\n    orderHistory: IOrderHistory;\n    orderHistoryProps: IModuleProps;\n    alert?: React.ReactNode;\n    loading?: React.ReactNode;\n    emptyMessage?: React.ReactNode;\n    header: IHeader;\n    backToShoppingLink?: React.ReactNode;\n    list?: IList;\n    moreButton?: React.ReactNode;\n    viewState: IOrderHistoryViewState;\n}\n\n/**\n *\n * OrderHistory component\n * @extends {React.Component<IOrderHistoryProps<IOrderHistoryData>>}\n */\n@observer\nclass OrderHistory extends React.Component<IOrderHistoryProps<IOrderHistoryData>> {\n    @observable private orderHistory: IOrderHistory;\n    @observable private viewState: IOrderHistoryViewState;\n    private pageSize: number;\n    private paging: IPaging;\n    private telemetryContent?: ITelemetryContent;\n    private payLoad: IPayLoad;\n\n    constructor(props: IOrderHistoryProps<IOrderHistoryData>) {\n        super(props);\n        this.orderHistory = {\n            salesOrders: [],\n            products: []\n        };\n        this.viewState = {\n            isDataReady: false,\n            hasError: false,\n            isShowMoreButton: (this.props.config.pageSize || 0) > 0,\n            isLoading: false\n        };\n        this.pageSize = this.props.config.pageSize || 10;\n        this.paging = {\n            top: this.pageSize,\n            skip: 0\n        };\n        this.telemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!, this.props.friendlyName, this.props.telemetry);\n        this.payLoad = getPayloadObject('click', this.telemetryContent, '');\n    }\n\n    public componentDidMount(): void {\n        this.getOrderHistory()\n            .then(() => {\n                this.viewState.isDataReady = true;\n            })\n            .catch(ex => {\n                this.viewState.hasError = true;\n            });\n    }\n\n    public render(): JSX.Element {\n        const {\n            config: { heading, className, showChannelInfo },\n            resources: { genericErrorMessage, noOrderHistoryLable, moreButtonText, backToShopping, orderCountLabel, ordersCountLabel, loadingLabel }\n        } = this.props;\n        const { salesOrders, products } = this.orderHistory;\n        const { isDataReady, hasError, isShowMoreButton, isLoading } = this.viewState;\n        const backToShoppingUrl = Msdyn365.getUrlSync('home', this.props.context.actionContext) || '';\n        const channelIdentities = this.props.data.channels.result && this.props.data.channels.result.channelIdentities;\n        const orgUnitLocations = this.props.data.orgUnitLocations.result && this.props.data.orgUnitLocations.result.orgUnitLocations;\n\n        let viewProps: IOrderHistoryViewProps = {\n            ...this.props,\n            orderHistory: this.orderHistory,\n            viewState: this.viewState,\n            orderHistoryProps: {\n                moduleProps: this.props,\n                className: classname('ms-order-history', className)\n            },\n            header: {\n                headerProps: { className: 'ms-order-history__header' },\n                heading: heading && heading.text && (\n                <Msdyn365.Text\n                    {...heading}\n                    className='ms-order-history__heading'\n                    text={heading.text}\n                    tag={heading.tag || 'h2'}\n                    editProps={{ onEdit: this.handleOrderHistoryHeadingChange, requestContext: this.props.context.request }}\n                />\n                )\n            },\n            backToShoppingLink: backToShoppingUrl && (\n                <Button className='ms-order-history__btn-keep-shopping' href={backToShoppingUrl}>\n                    {backToShopping}\n                </Button>\n            )\n        };\n\n        if (hasError) {\n            viewProps = {\n                ...viewProps,\n                alert: <LabelComponent className='ms-order-history__alert' label={genericErrorMessage} />\n            };\n            return this.props.renderView(viewProps) as React.ReactElement;\n        }\n\n        if (!isDataReady) {\n            viewProps = {\n                ...viewProps,\n                loading: <LabelComponent className='ms-order-history__loading' label={loadingLabel} />\n            };\n            return this.props.renderView(viewProps) as React.ReactElement;\n        }\n\n        if (!salesOrders || salesOrders.length === 0) {\n            viewProps = {\n                ...viewProps,\n                emptyMessage: <p className='ms-order-history__empty-message'>{noOrderHistoryLable}</p>\n            };\n\n            return this.props.renderView(viewProps) as React.ReactElement;\n        }\n\n        const _orderCountLabel = salesOrders.length === 1 ? orderCountLabel : ordersCountLabel;\n        this.payLoad.contentAction.etext = TelemetryConstant.ViewMore;\n        const viewMoreAttributes = getTelemetryAttributes(this.telemetryContent!,this.payLoad);\n\n        viewProps = {\n            ...viewProps,\n            header: {\n                ...viewProps.header,\n                orderCountLabel: <span className='ms-order-history__order-count'>{`(${salesOrders.length} ${_orderCountLabel})`}</span>\n            },\n            list: {\n                listProps: { className: 'ms-order-history__sales-order-list' },\n                salesOrders: salesOrders.map(salesOrder =>\n                    getSalesOrder({\n                        ...this.props,\n                        products,\n                        salesOrder,\n                        channelIdentities,\n                        orgUnitLocations,\n                        showChannelInfo,\n                        telemetryContent: this.telemetryContent\n                    })\n                )\n            },\n            moreButton: isShowMoreButton && (\n                <Button className={`ms-order-history__btn-more ${isLoading ? 'is-busy' : ''}`} {...viewMoreAttributes} disabled={isLoading} onClick={this.onMoreButtonClick}>\n                    {moreButtonText}\n                </Button>\n            )\n        };\n\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n\n    public handleOrderHistoryHeadingChange = (event: Msdyn365.ContentEditableEvent) => this.props.config.heading!.text = event.target.value;\n\n    private onMoreButtonClick = () => {\n        // tslint:disable-next-line:no-floating-promises\n        this.getOrderHistory();\n    }\n\n    private getOrderHistory = async (): Promise<void> => {\n        const actionContext = this.props.context.actionContext;\n        const input = new GetSalesOrderHistoryWithHydrationsInput(this.paging, this.props.context.request.apiSettings);\n\n        try {\n            this.viewState.isLoading = true;\n            const response = await getSalesOrderHistoryWithHydrationsAction(input, actionContext);\n            if (response) {\n                const { products, salesOrders } = response;\n                this.orderHistory.products.push(...products);\n                this.orderHistory.salesOrders.push(...salesOrders);\n                this.viewState.isShowMoreButton = this.viewState.isShowMoreButton && response.salesOrders.length > 0 && response.salesOrders.length === this.pageSize;\n                this.paging.skip += this.pageSize;\n            }\n            this.viewState.isLoading = false;\n            return Promise.resolve();\n        } catch (error) {\n            return Promise.reject();\n        }\n    }\n}\n\nexport default OrderHistory;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}