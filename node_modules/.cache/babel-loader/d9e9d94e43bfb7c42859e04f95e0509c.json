{"ast":null,"code":"import\"core-js/modules/es.object.assign.js\";import\"core-js/modules/es.string.match.js\";import\"core-js/modules/web.dom-collections.for-each.js\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import*as React from'react';import{getTelemetryObject,Heading}from'@msdyn365-commerce-modules/utilities';import{getUrlSync,RichTextComponent}from'@msdyn365-commerce/core';import{createProspectAsync}from'@msdyn365-commerce/retail-proxy/dist/DataActions/BusinessPartnersDataActions.g';import classnames from'classnames';import{SignUpButton,SignUpError,SignUpInput,SignUpLabel}from'./components';export var InputType;(function(InputType){InputType[\"Text\"]=\"text\";InputType[\"Address\"]=\"address\";InputType[\"Email\"]=\"email\";InputType[\"TextArea\"]=\"textarea\";})(InputType||(InputType={}));export var InputID;(function(InputID){InputID[\"FirstName\"]=\"FirstName\";InputID[\"LastName\"]=\"LastName\";InputID[\"Email\"]=\"CompanyEmail\";InputID[\"CompanyName\"]=\"CompanyName\";InputID[\"Address\"]=\"CompanyAddress\";InputID[\"JobTitle\"]=\"JobTitle\";InputID[\"Size\"]=\"CompanySize\";InputID[\"Department\"]=\"Department\";InputID[\"Comment\"]=\"Comment\";})(InputID||(InputID={}));export const renderInputSection=(inputs,className,needToReset,onInputChange,showErrors,addressForm,updateAddress)=>{return inputs.map((element,index)=>{const{id,type,label,maxChars,isRequired,pattern,customClass,value}=element;const baseSignUpItem={wrapper:{className:classnames(className,\"\".concat(className,\"-\").concat(id),customClass)},id:id,label:/*#__PURE__*/React.createElement(SignUpLabel,Object.assign({},{id,forId:id,className,text:label})),errorMessage:/*#__PURE__*/React.createElement(SignUpError,Object.assign({},{className:className,type:'item'}))};if(type===InputType.Address){if(addressForm){baseSignUpItem.isAddressInput=true;baseSignUpItem.input=/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.cloneElement(addressForm,{updateForm:updateAddress,hasError:showErrors,isRequired:isRequired===undefined?false:isRequired,resetAddress:needToReset}));}else{inputs.splice(index,1);}}else{baseSignUpItem.input=/*#__PURE__*/React.createElement(SignUpInput,Object.assign({},{id:id,type:type,value:value,maxLength:maxChars,pattern:pattern,className:className,isRequired:isRequired===undefined?false:isRequired,onChange:onInputChange}));}return baseSignUpItem;});};class BusinessSignUp extends React.Component{constructor(props){var _this;super(props);_this=this;this.BusinessSignUpDefaultInputs=[{id:InputID.FirstName,type:InputType.Text,label:this.props.resources.firstNameLabel,value:'',isRequired:true,customClass:'width-25'},{id:InputID.LastName,type:InputType.Text,label:this.props.resources.lastNameLabel,value:'',isRequired:true,customClass:'width-25'},{id:InputID.Email,type:InputType.Email,label:this.props.resources.emailAddressLabel,value:'',isRequired:true,pattern:'^[a-zA-Z0-9.!#$%&\\'^_`{}~-]+@[a-zA-Z0-9-]+(?:\\\\.[a-zA-Z0-9-]+)*$',customClass:'width-50'},{id:InputID.CompanyName,type:InputType.Text,label:this.props.resources.companyLabel,value:'',isRequired:true,customClass:'width-50'},{id:InputID.Department,type:InputType.Text,label:this.props.resources.departmentLabel,value:'',isRequired:false,customClass:'width-50'},{id:InputID.JobTitle,type:InputType.Text,label:this.props.resources.jobTitleLabel,value:'',isRequired:false,customClass:'width-50'},{id:InputID.Size,type:InputType.Text,label:this.props.resources.companySizeLabel,value:'',isRequired:false,customClass:'width-50'},{id:InputID.Address,type:InputType.Address,label:this.props.resources.companyAddressLabel,value:'',isRequired:false,customClass:'width-100'},{id:InputID.Comment,type:InputType.TextArea,label:this.props.resources.commentLabel,value:'',isRequired:false,customClass:'width-100'}];this.moduleClassName='ms-business-sign-up';this.needsToReset=false;this._onInputChange=event=>{const newForm=this.state.formItems;newForm.forEach(item=>{if(item.id===event.target.id){item.value=event.target.value;}});this.setState({isReady:this._isFormReady(),formItems:newForm,hasSubmitErrors:false});};this._onAddressChange=(errors,currentAddress)=>{const newForm=this.state.formItems;const addressItem=newForm.find(item=>{return item.type===InputType.Address;});if(addressItem){addressItem.address=currentAddress;this.setState({isReady:this._isFormReady(),formItems:newForm,addressHasErrors:errors,showAddressErrors:false});}};this._isFormReady=()=>{const{formItems}=this.state;for(let i=0;i<formItems.length;i++){const currentInput=formItems[i];if(currentInput.isRequired){if(currentInput.type===InputType.Address){if(this.state.addressHasErrors){return false;}}else{if(currentInput.value===undefined||currentInput.value===''){return false;}}}if(currentInput.pattern!==undefined&&currentInput.value.match(formItems[i].pattern)===null){return false;}}return true;};this._onSubmit=event=>{if(this.state.addressHasErrors){this.setState({showAddressErrors:true});event.preventDefault();return;}const{context}=this.props;const firstName=this._getItem(InputID.FirstName);const lastName=this._getItem(InputID.LastName);const companyName=this._getItem(InputID.CompanyName);const companyEmail=this._getItem(InputID.Email);const companyAddress=this._getItem(InputID.Address,true);const jobTitle=this._getItem(InputID.JobTitle);const department=this._getItem(InputID.Department);const companySize=this._getItem(InputID.Size);const comments=this._getItem(InputID.Comment);if(companyEmail&&companyEmail.value&&companyAddress&&companyAddress.address){companyAddress.address.Email=companyEmail.value;}const newPartner={FirstName:firstName&&firstName.value,LastName:lastName&&lastName.value,CompanyName:companyName&&companyName.value,Address:companyAddress&&companyAddress.address&&companyAddress.address,JobTitle:jobTitle&&jobTitle.value,Department:department&&department.value,CompanySize:companySize&&parseInt(companySize.value,10)||0,Comments:comments&&comments.value};createProspectAsync({callerContext:context.actionContext},newPartner).catch(()=>{this.setState({hasSubmitErrors:true,isReady:false});});};this._onCancel=()=>{const cleanForm=this.state.formItems;cleanForm.forEach(input=>{input.value='';});this.needsToReset=true;this.setState({isReady:false,formItems:cleanForm,addressHasErrors:true,showAddressErrors:false,hasSubmitErrors:false});};this._getItem=function(id){let isAddress=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(isAddress){return _this.state.formItems.find(item=>{return item.id===id&&item.address;});}return _this.state.formItems.find(item=>{return item.id===id&&item.value!=='';});};this.state={isReady:false,formItems:this.props.formItems||this.BusinessSignUpDefaultInputs,addressHasErrors:false,showAddressErrors:false,hasSubmitErrors:false};this.telemetryContent=getTelemetryObject(this.props.context.request.telemetryPageName,this.props.friendlyName,this.props.telemetry);}render(){const{config}=this.props;const{formItems}=this.state;const{className,heading}=config;const viewProps=_objectSpread(_objectSpread({},this.props),{},{businessSignUp:{moduleProps:this.props,className:classnames(this.moduleClassName,className)},ContainerWrapper:{className:\"\".concat(this.moduleClassName,\"__container\")},heading:/*#__PURE__*/React.createElement(Heading,Object.assign({className:\"\".concat(this.moduleClassName,\"__heading\")},heading)),businessSignUpForm:this._renderForm(),formItems:formItems});return this.props.renderView(viewProps);}_renderForm(){const{config,resources,slots}=this.props;const{showAddressErrors,hasSubmitErrors,isReady,formItems}=this.state;const{signUpButtonArialabel,signUpButtonText,cancelButtonArialabel,cancelButtonText,errorMessage,partialAddressErrorMessage}=resources;const addressForm=slots&&slots.addressSlot&&slots.addressSlot.length>0&&slots.addressSlot[0]||undefined;const successPageURL=config.confirmationLink&&config.confirmationLink.linkUrl&&config.confirmationLink.linkUrl.destinationUrl||getUrlSync('home',this.props.context.actionContext);const form={FormWrapper:{className:\"\".concat(this.moduleClassName,\"__form \")},items:renderInputSection(formItems,\"\".concat(this.moduleClassName,\"__form-item\"),this.needsToReset,this._onInputChange,showAddressErrors,addressForm,this._onAddressChange),buttons:[/*#__PURE__*/React.createElement(SignUpButton,{key:'continue',id:'continue',className:\"\".concat(this.moduleClassName,\"__create-button\"),link:successPageURL,ariaLabel:signUpButtonArialabel,text:signUpButtonText,disabled:!isReady,onClick:this._onSubmit,telemetryContent:this.telemetryContent}),/*#__PURE__*/React.createElement(SignUpButton,{key:'cancel',id:'cancel',className:\"\".concat(this.moduleClassName,\"__cancel-button\"),ariaLabel:cancelButtonArialabel,text:cancelButtonText,onClick:this._onCancel,telemetryContent:this.telemetryContent})],errorMessage:[hasSubmitErrors&&/*#__PURE__*/React.createElement(SignUpError,{key:'error',id:'error',className:this.moduleClassName,message:errorMessage}),showAddressErrors&&/*#__PURE__*/React.createElement(SignUpError,{key:'error',id:'error',className:this.moduleClassName,message:partialAddressErrorMessage})],disclaimer:config.disclaimer&&/*#__PURE__*/React.createElement(RichTextComponent,{className:\"\".concat(this.moduleClassName,\"__disclaimer\"),text:config.disclaimer})};if(this.needsToReset){this.needsToReset=false;}return form;}}export default BusinessSignUp;","map":{"version":3,"sources":["modules/business-sign-up/business-sign-up.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as React from 'react';\n\nimport { getTelemetryObject, Heading, IModuleProps, INodeProps, ITelemetryContent } from '@msdyn365-commerce-modules/utilities';\nimport { getUrlSync, RichTextComponent } from '@msdyn365-commerce/core';\nimport { Address, BusinessPartnerProspect } from '@msdyn365-commerce/retail-proxy';\nimport { createProspectAsync } from '@msdyn365-commerce/retail-proxy/dist/DataActions/BusinessPartnersDataActions.g';\nimport classnames from 'classnames';\nimport { IBusinessSignUpConfig, IBusinessSignUpProps } from './business-sign-up.props.autogenerated';\nimport { SignUpButton, SignUpError, SignUpInput, SignUpLabel } from './components';\n\nexport interface IBusinessSignUpExtendedProps extends IBusinessSignUpProps<IBusinessSignUpConfig> {\n    formItems?: IFormItem[];\n}\n\nexport interface IBusinessSignUpItem {\n    wrapper: INodeProps;\n    isAddressInput?: boolean;\n    id: string;\n    label: React.ReactNode;\n    errorMessage: React.ReactNode;\n    input?: React.ReactNode;\n}\n\nexport interface IBusinessState {\n    isReady: boolean;\n    formItems: IFormItem[];\n    addressHasErrors: boolean;\n    showAddressErrors: boolean;\n    hasSubmitErrors: boolean;\n}\n\nexport interface IBusinessSignUpLocalAccount {\n    FormWrapper: INodeProps;\n    items: IBusinessSignUpItem[];\n    buttons: React.ReactNode[];\n    errorMessage: React.ReactNode[];\n    disclaimer: React.ReactNode;\n}\n\nexport interface IBusinessSignUpViewProps {\n    className: string;\n    businessSignUp: IModuleProps;\n    ContainerWrapper: INodeProps;\n    heading: React.ReactNode;\n    businessSignUpForm: IBusinessSignUpLocalAccount;\n    formItems: IFormItem[];\n}\n\nexport interface IFormItem {\n    id: string;\n    type: InputType;\n    label: string;\n    value: string;\n    maxChars?: string;\n    isRequired: boolean;\n    pattern?: string;\n    address?: Address;\n    customClass?: string;\n}\n\nexport enum InputType {\n    Text = 'text',\n    Address = 'address',\n    Email = 'email',\n    TextArea = 'textarea'\n}\n\nexport enum InputID {\n    FirstName = 'FirstName',\n    LastName = 'LastName',\n    Email = 'CompanyEmail',\n    CompanyName = 'CompanyName',\n    Address = 'CompanyAddress',\n    JobTitle = 'JobTitle',\n    Size = 'CompanySize',\n    Department = 'Department',\n    Comment = 'Comment'\n}\n\nexport const renderInputSection = (inputs: IFormItem[], className: string, needToReset: boolean, onInputChange: (event: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => void,\n                                   showErrors: boolean, addressForm?: React.ReactNode, updateAddress?: (errors: boolean, currAddress?: Address) => void): IBusinessSignUpItem[] => {\n    return inputs.map((element, index) => {\n        const { id, type, label, maxChars, isRequired, pattern, customClass, value } = element;\n\n        const baseSignUpItem: IBusinessSignUpItem = {\n            wrapper: {\n                className: classnames(className, `${className}-${id}`, customClass)\n            },\n            id: id,\n            label: <SignUpLabel { ...{ id, forId: id, className, text: label }} />,\n            errorMessage: <SignUpError { ...{ className: className, type: 'item' }} />,\n        };\n\n        if (type === InputType.Address) {\n            if (addressForm) {\n                baseSignUpItem.isAddressInput = true;\n                baseSignUpItem.input = (\n                    <React.Fragment>\n                        {React.cloneElement(addressForm as React.ReactElement, { updateForm: updateAddress, hasError: showErrors, isRequired: isRequired === undefined ? false : isRequired, resetAddress: needToReset })}\n                    </React.Fragment>\n                );\n            } else {\n                // if the address slot is not filled, remove this input from the form\n                inputs.splice(index, 1);\n            }\n        } else {\n            baseSignUpItem.input = (\n                <SignUpInput\n                    {\n                    ...{\n                            id: id,\n                            type: type,\n                            value: value,\n                            maxLength: maxChars,\n                            pattern: pattern,\n                            className: className,\n                            isRequired: isRequired === undefined ? false : isRequired,\n                            onChange: onInputChange\n                        }\n                    }\n                />\n            );\n        }\n\n        return baseSignUpItem;\n    });\n};\n\n/**\n *\n * Business Request Form Modules\n * Form that a business can use to submit a request to become a partner with Microsoft.\n * @extends {React.Component<IBusinessSignUpProps<IBusinessSignUpConfig>>}\n */\nclass BusinessSignUp extends React.Component<IBusinessSignUpExtendedProps, IBusinessState> {\n    // used as default data\n    public BusinessSignUpDefaultInputs: IFormItem[] = [\n        {\n            id: InputID.FirstName,\n            type: InputType.Text,\n            label: this.props.resources.firstNameLabel,\n            value: '',\n            isRequired: true,\n            customClass: 'width-25'\n        },\n        {\n            id: InputID.LastName,\n            type: InputType.Text,\n            label: this.props.resources.lastNameLabel,\n            value: '',\n            isRequired: true,\n            customClass: 'width-25'\n        },\n        {\n            id: InputID.Email,\n            type: InputType.Email,\n            label: this.props.resources.emailAddressLabel,\n            value: '',\n            isRequired: true,\n            pattern: '^[a-zA-Z0-9.!#$%&\\'^_`{}~-]+@[a-zA-Z0-9-]+(?:\\\\.[a-zA-Z0-9-]+)*$',\n            customClass: 'width-50'\n        },\n        {\n            id: InputID.CompanyName,\n            type: InputType.Text,\n            label: this.props.resources.companyLabel,\n            value: '',\n            isRequired: true,\n            customClass: 'width-50'\n        },\n        {\n            id: InputID.Department,\n            type: InputType.Text,\n            label: this.props.resources.departmentLabel,\n            value: '',\n            isRequired: false,\n            customClass: 'width-50'\n        },\n        {\n            id: InputID.JobTitle,\n            type: InputType.Text,\n            label: this.props.resources.jobTitleLabel,\n            value: '',\n            isRequired: false,\n            customClass: 'width-50'\n        },\n        {\n            id: InputID.Size,\n            type: InputType.Text,\n            label: this.props.resources.companySizeLabel,\n            value: '',\n            isRequired: false,\n            customClass: 'width-50'\n        },\n        {\n            id: InputID.Address,\n            type: InputType.Address,\n            label: this.props.resources.companyAddressLabel,\n            value: '',\n            isRequired: false,\n            customClass: 'width-100'\n        },\n        {\n            id: InputID.Comment,\n            type: InputType.TextArea,\n            label: this.props.resources.commentLabel,\n            value: '',\n            isRequired: false,\n            customClass: 'width-100'\n        }\n    ];\n\n    private moduleClassName: string = 'ms-business-sign-up';\n    private needsToReset: boolean = false;\n    private telemetryContent: ITelemetryContent;\n\n    constructor(props: IBusinessSignUpExtendedProps) {\n        super(props);\n\n        this.state = {\n            isReady: false,\n            formItems: this.props.formItems || this.BusinessSignUpDefaultInputs,\n            addressHasErrors: false,\n            showAddressErrors: false,\n            hasSubmitErrors: false\n        };\n        this.telemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!, this.props.friendlyName, this.props.telemetry);\n    }\n\n    public render(): JSX.Element {\n        const { config } = this.props;\n        const { formItems } = this.state;\n        const { className, heading } = config;\n\n        const viewProps = {\n            ...this.props,\n            businessSignUp: {\n                moduleProps: this.props,\n                className: classnames(this.moduleClassName, className)\n            },\n            ContainerWrapper: {\n                className: `${this.moduleClassName}__container`\n            },\n            heading: <Heading className={`${this.moduleClassName}__heading`} {...heading} />,\n            businessSignUpForm: this._renderForm(),\n            formItems: formItems\n        };\n\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n\n    private _renderForm(): IBusinessSignUpLocalAccount {\n        const { config, resources, slots } = this.props;\n        const { showAddressErrors, hasSubmitErrors, isReady, formItems } = this.state;\n        const { signUpButtonArialabel, signUpButtonText, cancelButtonArialabel, cancelButtonText, errorMessage, partialAddressErrorMessage } = resources;\n        const addressForm = slots && slots.addressSlot && slots.addressSlot.length > 0 && slots.addressSlot[0] || undefined;\n        const successPageURL = config.confirmationLink && config.confirmationLink.linkUrl && config.confirmationLink.linkUrl.destinationUrl || getUrlSync('home', this.props.context.actionContext);\n\n        const form = {\n            FormWrapper: {\n                className: `${this.moduleClassName}__form `\n            },\n            items: renderInputSection(formItems, `${this.moduleClassName}__form-item`, this.needsToReset, this._onInputChange, showAddressErrors, addressForm, this._onAddressChange),\n            buttons: [\n                // tslint:disable-next-line:max-line-length\n                <SignUpButton key='continue' id='continue' className={`${this.moduleClassName}__create-button`} link={successPageURL} ariaLabel={signUpButtonArialabel} text={signUpButtonText} disabled={!isReady} onClick={this._onSubmit} telemetryContent={this.telemetryContent}/>,\n                <SignUpButton key='cancel' id='cancel' className={`${this.moduleClassName}__cancel-button`} ariaLabel={cancelButtonArialabel} text={cancelButtonText} onClick={this._onCancel} telemetryContent={this.telemetryContent}/>\n            ],\n            errorMessage: [\n                hasSubmitErrors && <SignUpError key='error' id='error' className={this.moduleClassName} message={errorMessage} />,\n                showAddressErrors && <SignUpError key='error' id='error' className={this.moduleClassName} message={partialAddressErrorMessage} />\n            ],\n            disclaimer: config.disclaimer && <RichTextComponent className={`${this.moduleClassName}__disclaimer`} text={config.disclaimer} />,\n        };\n\n        if (this.needsToReset) {\n            this.needsToReset = false;\n        }\n\n        return form;\n    }\n\n    private _onInputChange = (event: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>): void => {\n        const newForm = this.state.formItems;\n        newForm.forEach(item => {\n            if (item.id === event.target.id) {\n                item.value = event.target.value;\n            }\n        });\n\n        // check if form is ready, update state object with latest values, values have changed so reset hasSubmitErrros\n        this.setState({\n            isReady: this._isFormReady(),\n            formItems: newForm,\n            hasSubmitErrors: false\n        });\n    }\n\n    private _onAddressChange = (errors: boolean, currentAddress?: Address): void => {\n        // find address item\n        const newForm = this.state.formItems;\n        const addressItem = newForm.find((item) => {\n            return item.type === InputType.Address;\n        });\n\n        // if found --> set to currentAddress\n        if (addressItem) {\n            addressItem.address = currentAddress;\n\n            // update state with new values and set errors to false if address is not required field\n            this.setState({\n                isReady: this._isFormReady(),\n                formItems: newForm,\n                addressHasErrors: errors,\n                showAddressErrors: false\n            });\n        }\n    }\n\n    private _isFormReady = (): boolean => {\n        const { formItems } = this.state;\n\n        for (let i = 0; i < formItems.length; i++) {\n            // will return FALSE if:\n            //  - input field is required\n            //      IF is address AND addressHasErrors === true\n            //      ELSE value is undefined OR empty\n            //  OR\n            //  - pattern provided and value does not match pattern\n            const currentInput = formItems[i];\n\n            if (currentInput.isRequired) {\n                if (currentInput.type === InputType.Address) {\n                    if (this.state.addressHasErrors) {\n                        return false;\n                    }\n                } else {\n                    if (currentInput.value === undefined || currentInput.value === '') {\n                        return false;\n                    }\n                }\n            }\n            if (currentInput.pattern !== undefined && currentInput.value.match(formItems[i].pattern as string) === null) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    private _onSubmit = (event: React.MouseEvent<HTMLElement, MouseEvent>) => {\n        if (this.state.addressHasErrors) {\n            this.setState({\n                showAddressErrors: true\n            });\n\n            event.preventDefault();\n            return;\n        }\n\n        const { context } = this.props;\n\n        // check for matching id and if not empty\n        const firstName = this._getItem(InputID.FirstName);\n        const lastName =  this._getItem(InputID.LastName);\n        const companyName =  this._getItem(InputID.CompanyName);\n        const companyEmail =  this._getItem(InputID.Email);\n        const companyAddress = this._getItem(InputID.Address, true);\n        const jobTitle =  this._getItem(InputID.JobTitle);\n        const department =  this._getItem(InputID.Department);\n        const companySize =  this._getItem(InputID.Size);\n        const comments =  this._getItem(InputID.Comment);\n\n        // API gets email as part of the address object, but I do not use the email input from the address component, thus we need to copy it over\n        if (companyEmail && companyEmail.value && companyAddress && companyAddress.address) {\n            companyAddress.address.Email = companyEmail.value;\n        }\n\n        const newPartner: BusinessPartnerProspect = {\n            FirstName: firstName && firstName.value,\n            LastName: lastName && lastName.value,\n            CompanyName: companyName && companyName.value,\n            Address: companyAddress && companyAddress.address && companyAddress.address,\n            JobTitle: jobTitle && jobTitle.value,\n            Department: department && department.value,\n            CompanySize: companySize && parseInt(companySize.value, 10) || 0,\n            Comments: comments && comments.value,\n        };\n\n        // create business partner request\n        createProspectAsync({ callerContext: context.actionContext }, newPartner)\n            .catch(() => {\n                this.setState({\n                    hasSubmitErrors: true,\n                    isReady: false\n                });\n            });\n    }\n\n    private _onCancel = () => {\n        // reset values of the form\n        const cleanForm = this.state.formItems;\n        cleanForm.forEach(input => {input.value = '';});\n\n        // set reset flag so address input will get reset on next renderInputSection() call\n        this.needsToReset = true;\n\n        this.setState({\n            isReady: false,\n            formItems: cleanForm,\n            addressHasErrors: true,\n            showAddressErrors: false,\n            hasSubmitErrors: false\n        });\n    }\n\n    private _getItem = (id: string, isAddress: boolean = false) => {\n        if (isAddress) {\n            return this.state.formItems.find((item) => { return item.id === id && item.address;});\n        }\n        return this.state.formItems.find((item) => { return item.id === id && item.value !== '';});\n    }\n}\n\nexport default BusinessSignUp;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}