{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/esm/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import{Image}from'@msdyn365-commerce/core';import classnames from'classnames';import React from'react';var SitePicker=/*#__PURE__*/function(_React$PureComponent){_inherits(SitePicker,_React$PureComponent);var _super=_createSuper(SitePicker);function SitePicker(props){var _this;_classCallCheck(this,SitePicker);_this=_super.call(this,props);_this._cookieName='_msdyn365___site_';_this._cookieExpirationInSeconds=5184000;_this._escFunction=function(event){var key=event.keyCode;if(_this.state.expandSiteOptions){switch(key){case 27:{setTimeout(function(){var _this$_sitePickerMenu,_this$_sitePickerMenu2,_this$_sitePickerMenu3,_this$_sitePickerMenu4;var nextFocus=document&&document.activeElement;if((_this$_sitePickerMenu=_this._sitePickerMenuButton)!==null&&_this$_sitePickerMenu!==void 0&&(_this$_sitePickerMenu2=_this$_sitePickerMenu.current)!==null&&_this$_sitePickerMenu2!==void 0&&_this$_sitePickerMenu2.contains(nextFocus)||(_this$_sitePickerMenu3=_this._sitePickerMenuNode)!==null&&_this$_sitePickerMenu3!==void 0&&(_this$_sitePickerMenu4=_this$_sitePickerMenu3.current)!==null&&_this$_sitePickerMenu4!==void 0&&_this$_sitePickerMenu4.contains(nextFocus)){var _this$_sitePickerMenu5,_this$_sitePickerMenu6;_this._resetSiteOptionsState();(_this$_sitePickerMenu5=_this._sitePickerMenuButton)===null||_this$_sitePickerMenu5===void 0?void 0:(_this$_sitePickerMenu6=_this$_sitePickerMenu5.current)===null||_this$_sitePickerMenu6===void 0?void 0:_this$_sitePickerMenu6.focus();}},50);break;}case 9:{setTimeout(function(){var _this$_sitePickerMenu7,_this$_sitePickerMenu8,_this$_sitePickerMenu9,_this$_sitePickerMenu10;var nextFocus=document&&document.activeElement;if(!((_this$_sitePickerMenu7=_this._sitePickerMenuButton)!==null&&_this$_sitePickerMenu7!==void 0&&(_this$_sitePickerMenu8=_this$_sitePickerMenu7.current)!==null&&_this$_sitePickerMenu8!==void 0&&_this$_sitePickerMenu8.contains(nextFocus))&&!((_this$_sitePickerMenu9=_this._sitePickerMenuNode)!==null&&_this$_sitePickerMenu9!==void 0&&(_this$_sitePickerMenu10=_this$_sitePickerMenu9.current)!==null&&_this$_sitePickerMenu10!==void 0&&_this$_sitePickerMenu10.contains(nextFocus))){_this._resetSiteOptionsState();}},50);break;}default:return;}}};_this._handleOutsideClick=function(event){var _this$_sitePickerMenu11,_this$_sitePickerMenu12;if((_this$_sitePickerMenu11=_this._sitePickerMenuButton.current)!==null&&_this$_sitePickerMenu11!==void 0&&_this$_sitePickerMenu11.contains(event.target)&&_this.state.expandSiteOptions||(_this$_sitePickerMenu12=_this._sitePickerMenuNode.current)!==null&&_this$_sitePickerMenu12!==void 0&&_this$_sitePickerMenu12.contains(event.target)&&_this.state.expandSiteOptions){return;}else{_this._resetSiteOptionsState();}};_this._handleChange=_this._handleChange.bind(_assertThisInitialized(_this));_this._sitePickerMenuNode=/*#__PURE__*/React.createRef();_this._sitePickerMenuButton=/*#__PURE__*/React.createRef();_this._renderSiteOptions=_this._renderSiteOptions.bind(_assertThisInitialized(_this));_this._resetSiteOptionsState=_this._resetSiteOptionsState.bind(_assertThisInitialized(_this));_this._escFunction=_this._escFunction.bind(_assertThisInitialized(_this));_this._handleOutsideClick=_this._handleOutsideClick.bind(_assertThisInitialized(_this));_this.state={expandSiteOptions:false};return _this;}_createClass(SitePicker,[{key:\"componentDidMount\",value:function componentDidMount(){var _document,_document2,_document2$body;(_document=document)===null||_document===void 0?void 0:_document.addEventListener('keydown',this._escFunction,false);(_document2=document)===null||_document2===void 0?void 0:(_document2$body=_document2.body)===null||_document2$body===void 0?void 0:_document2$body.addEventListener('mousedown',this._handleOutsideClick);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){var _document3,_document4,_document4$body;(_document3=document)===null||_document3===void 0?void 0:_document3.removeEventListener('keydown',this._escFunction,false);(_document4=document)===null||_document4===void 0?void 0:(_document4$body=_document4.body)===null||_document4$body===void 0?void 0:_document4$body.removeEventListener('mousedown',this._handleOutsideClick,false);}},{key:\"render\",value:function render(){var _this$props$config$he;var viewProps=_objectSpread(_objectSpread({},this.props),{},{SitePicker:{moduleProps:this.props,className:classnames('ms-site-picker',this.props.config.className),tag:'div'},SitePickerMenu:{tag:'button',className:'ms-site-picker__button','aria-label':(_this$props$config$he=this.props.config.heading)===null||_this$props$config$he===void 0?void 0:_this$props$config$he.text,'aria-expanded':this.state.expandSiteOptions?true:false,onClick:this.props,ref:this._sitePickerMenuButton},SitePickerMenuSpan:{className:'ms-site-picker__span',tag:'span'},SitePickerMenuList:{className:'ms-site-picker__list',role:'menu',tag:'ul',ref:this._sitePickerMenuNode},SitePickerMenuListItem:{className:'ms-site-picker__list__item',role:'presentation',tag:'li'},SitePickerMenuListItemArray:this._renderSitePickerImage(),renderSiteOptions:this._renderSiteOptions,resetSiteOptionsState:this._resetSiteOptionsState,siteOptionsState:this.state.expandSiteOptions});return this.props.renderView(viewProps);}},{key:\"_renderSiteOptions\",value:function _renderSiteOptions(){var expandSiteOptionsState=this.state.expandSiteOptions;this.setState({expandSiteOptions:!expandSiteOptionsState});}},{key:\"_resetSiteOptionsState\",value:function _resetSiteOptionsState(){this.setState({expandSiteOptions:false});}},{key:\"_handleChange\",value:function _handleChange(e){e.preventDefault();if(e.currentTarget.href&&e.currentTarget.href.length>0&&window){if(this.props.context.request.cookies.isConsentGiven()){var cookieConfig={maxAge:this._cookieExpirationInSeconds};this.props.context.request.cookies.set(this._cookieName,e.currentTarget.href,cookieConfig);}window.location.assign(e.currentTarget.href);}}},{key:\"_renderSitePickerImage\",value:function _renderSitePickerImage(){var _this2=this;var defaultImageSettings={viewports:{xs:{q:\"w=48&h=48&m=6\",w:0,h:0},lg:{q:\"w=48&h=48&m=6\",w:0,h:0},xl:{q:\"w=48&h=48&m=6\",w:0,h:0}},lazyload:true};var siteOptions=this.props.config.siteOptions&&this.props.config.siteOptions;return siteOptions&&siteOptions.map(function(item,index){var _item$siteRedirectUrl;var image=item===null||item===void 0?void 0:item.siteImage;var imageProps={gridSettings:_this2.props.context.request.gridSettings,imageSettings:(image===null||image===void 0?void 0:image.imageSettings)||defaultImageSettings};return/*#__PURE__*/React.createElement(\"a\",{key:index,className:'ms-site-picker__list__item__link',tabIndex:0,href:item===null||item===void 0?void 0:(_item$siteRedirectUrl=item.siteRedirectUrl)===null||_item$siteRedirectUrl===void 0?void 0:_item$siteRedirectUrl.destinationUrl,\"aria-label\":item===null||item===void 0?void 0:item.siteName,onClick:_this2._handleChange,role:'menuitem'},/*#__PURE__*/React.createElement(\"span\",{className:'ms-site-picker__list__item__text'},item===null||item===void 0?void 0:item.siteName),/*#__PURE__*/React.createElement(Image,{className:'ms-site-picker__list__item__img',key:index,src:(image===null||image===void 0?void 0:image.src)||'',gridSettings:imageProps.gridSettings,imageSettings:imageProps.imageSettings,altText:image===null||image===void 0?void 0:image.altText,loadFailureBehavior:'hide'}));});}}]);return SitePicker;}(React.PureComponent);export default SitePicker;","map":{"version":3,"sources":["modules/site-picker/site-picker.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { IModuleProps, INodeProps, KeyCodes, NodeTag } from '@msdyn365-commerce-modules/utilities';\nimport { IImageSettings, Image } from '@msdyn365-commerce/core';\nimport classnames from 'classnames';\nimport React from 'react';\nimport { ISitePickerConfig,ISitePickerProps } from './site-picker.props.autogenerated';\n\nexport interface ISitePickerViewProps extends ISitePickerProps<ISitePickerConfig> {\n    SitePicker:IModuleProps;\n    SitePickerMenu:INodeProps;\n    SitePickerMenuSpan:INodeProps;\n    SitePickerMenuList:INodeProps;\n    SitePickerMenuListItem:INodeProps;\n    SitePickerMenuListItemArray:React.ReactNode[] | undefined;\n    siteOptionsState:boolean;\n    renderSiteOptions():void;\n    resetSiteOptionsState():void;\n}\ninterface ISitePickerState {\n    expandSiteOptions: boolean;\n}\n\n/**\n *\n * SitePicker component\n * @extends {React.PureComponent<ISitePickerProps<ISitePickerConfig>>}\n */\nclass SitePicker extends React.PureComponent<ISitePickerProps<ISitePickerConfig>,ISitePickerState> {\n    private _cookieName: string = '_msdyn365___site_';\n    private _cookieExpirationInSeconds: number = 5184000;\n    private _sitePickerMenuNode: React.RefObject<HTMLUListElement>;\n    private _sitePickerMenuButton: React.RefObject<HTMLButtonElement>;\n\n    public constructor(props:ISitePickerViewProps) {\n        super(props);\n        this._handleChange = this._handleChange.bind(this);\n        this._sitePickerMenuNode = React.createRef();\n        this._sitePickerMenuButton = React.createRef();\n        this._renderSiteOptions=this._renderSiteOptions.bind(this);\n        this._resetSiteOptionsState=this._resetSiteOptionsState.bind(this);\n        this._escFunction=this._escFunction.bind(this);\n        this._handleOutsideClick=this._handleOutsideClick.bind(this);\n        this.state= {\n            expandSiteOptions:false\n        };\n    }\n    public componentDidMount(): void {\n        document?.addEventListener('keydown', (this._escFunction as unknown) as EventListener, false);\n        document?.body?.addEventListener('mousedown',  this._handleOutsideClick);\n    }\n    public componentWillUnmount(): void {\n        document?.removeEventListener('keydown', (this._escFunction as unknown) as EventListener, false);\n        document?.body?.removeEventListener('mousedown', this._handleOutsideClick, false);\n    }\n    public render(): JSX.Element | null {\n        const viewProps: ISitePickerViewProps = {\n                ...this.props as ISitePickerProps<ISitePickerConfig>,\n                SitePicker:{\n                    moduleProps: this.props,\n                    className: classnames('ms-site-picker',this.props.config.className),\n                    tag:'div'\n                },\n                SitePickerMenu:{\n                    tag: 'button' as NodeTag,\n                className: 'ms-site-picker__button',\n                'aria-label': this.props.config.heading?.text,\n                'aria-expanded' : this.state.expandSiteOptions ? true : false,\n                onClick:this.props,\n                ref :this._sitePickerMenuButton\n                },\n                SitePickerMenuSpan:{\n                    className:'ms-site-picker__span',\n                    tag:'span'\n                },\n                SitePickerMenuList: {\n                    className:'ms-site-picker__list',\n                    role:'menu',\n                    tag:'ul',\n                    ref:this._sitePickerMenuNode\n                },\n                SitePickerMenuListItem: {\n                    className:'ms-site-picker__list__item',\n                    role:'presentation',\n                    tag:'li',\n                },\n                SitePickerMenuListItemArray:this._renderSitePickerImage(),\n                renderSiteOptions:this._renderSiteOptions,\n                resetSiteOptionsState:this._resetSiteOptionsState,\n                siteOptionsState:this.state.expandSiteOptions,\n                };\n        return this.props.renderView(viewProps);\n    }\n    private _renderSiteOptions():void {\n        const expandSiteOptionsState=this.state.expandSiteOptions;\n        this.setState({\n            expandSiteOptions: !expandSiteOptionsState\n          });\n    }\n    private _resetSiteOptionsState():void {\n        this.setState({\n            expandSiteOptions: false\n          });\n    }\n    // tslint:disable-next-line: no-any\n    private _escFunction = (event: any) => {\n        const key = event.keyCode;\n        if(this.state.expandSiteOptions) {\n            switch (key) {\n                case KeyCodes.Escape: {\n                    setTimeout(() => {\n                        const nextFocus = document && document.activeElement;\n                        if ((this._sitePickerMenuButton?.current?.contains(nextFocus) || this._sitePickerMenuNode?.current?.contains(nextFocus))) {\n                            this._resetSiteOptionsState();\n                            this._sitePickerMenuButton?.current?.focus();\n                        }\n                    },         50);\n                    break;\n                }\n                case KeyCodes.Tab: {\n                    setTimeout(() => {\n                    const nextFocus = document && document.activeElement;\n                    if ((!this._sitePickerMenuButton?.current?.contains(nextFocus) && !this._sitePickerMenuNode?.current?.contains(nextFocus))) {\n                        this._resetSiteOptionsState();\n                    }\n                },             50);\n                    break;\n                }\n                default:\n                    return;\n            }\n        }\n    }\n\n    // tslint:disable-next-line: no-any\n    private _handleOutsideClick = (event:any) => {\n        if((this._sitePickerMenuButton.current?.contains(event.target) && this.state.expandSiteOptions) ||\n            (this._sitePickerMenuNode.current?.contains(event.target) && this.state.expandSiteOptions)) {\n        return;\n        } else {\n            this._resetSiteOptionsState();\n        }\n    };\n    private _handleChange(e: React.MouseEvent<HTMLAnchorElement, MouseEvent>): void {\n       e.preventDefault();\n       if(e.currentTarget.href && e.currentTarget.href.length > 0 && window) {\n           if (this.props.context.request.cookies.isConsentGiven()) {\n            const cookieConfig =  {maxAge:this._cookieExpirationInSeconds};\n            this.props.context.request.cookies.set(this._cookieName,e.currentTarget.href,cookieConfig);\n           }\n           window.location.assign(e.currentTarget.href);\n       }\n    }\n    private  _renderSitePickerImage():React.ReactNode[] | undefined {\n        const defaultImageSettings: IImageSettings = {\n            viewports: {\n                xs: { q: `w=48&h=48&m=6`, w: 0, h: 0 },\n                lg: { q: `w=48&h=48&m=6`, w: 0, h: 0 },\n                xl: { q: `w=48&h=48&m=6`, w: 0, h: 0 }\n            },\n            lazyload: true\n        };\n        const siteOptions=this.props.config.siteOptions && this.props.config.siteOptions ;\n        return siteOptions && siteOptions.map((item, index) => {\n            const image = item?.siteImage;\n            const imageProps = {\n            gridSettings: this.props.context.request.gridSettings!,\n            imageSettings: image?.imageSettings || defaultImageSettings\n        };\n            return (\n        <a\n            key={index}\n            className='ms-site-picker__list__item__link'\n            tabIndex={0}\n            href={item?.siteRedirectUrl?.destinationUrl}\n            aria-label={item?.siteName}\n            onClick={this._handleChange}\n            role='menuitem'\n        >\n            <span className='ms-site-picker__list__item__text'>\n                {item?.siteName}\n            </span>\n            <Image\n                className='ms-site-picker__list__item__img'\n\n                key={index}\n                src={image?.src || ''}\n                gridSettings={imageProps.gridSettings}\n                imageSettings={imageProps.imageSettings}\n                altText={image?.altText}\n                loadFailureBehavior='hide'\n            />\n        </a>\n        );\n        }\n        );\n    }\n}\n\nexport default SitePicker;"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}