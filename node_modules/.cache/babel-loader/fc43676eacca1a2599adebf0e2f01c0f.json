{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _asyncToGenerator from\"@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import{getFallbackImageUrl}from'@msdyn365-commerce-modules/retail-actions';import{Button}from'@msdyn365-commerce-modules/utilities';import{Image}from'@msdyn365-commerce/core';import classnames from'classnames';import React,{useState}from'react';export var ProductList=function ProductList(props){var products=props.products,_props$context=props.context,apiSettings=_props$context.actionContext.requestContext.apiSettings,gridSettings=_props$context.request.gridSettings,_props$context$cultur=_props$context.cultureFormatter,formatCurrency=_props$context$cultur.formatCurrency,currencyCode=_props$context$cultur.currencyCode,clickHandler=props.clickHandler,highlightSearchTerm=props.highlightSearchTerm,_props$resources=props.resources,searchResultsCountVerbage=_props$resources.searchResultsCountVerbage,searchResultsCountSubject=_props$resources.searchResultsCountSubject,selectProductButtonText=_props$resources.selectProductButtonText,imageSettings=props.imageSettings;var resultCount=searchResultsCountVerbage.replace('{count}',products.length.toString()).replace('{subject}',\"\".concat(searchResultsCountSubject).concat(products.length>1?'s':''));return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"p\",{className:'msc-add-line-to-template__search-result-count'},resultCount),/*#__PURE__*/React.createElement(\"div\",{className:'msc-add-line-to-template__product-list-container'},products.map(function(product,index){var Price=product.Price,ItemId=product.ItemId,Name=product.Name,PrimaryImageUrl=product.PrimaryImageUrl,RecordId=product.RecordId;var price=formatCurrency(Price.toFixed(2),currencyCode);var fallBackImg=getFallbackImageUrl(ItemId,apiSettings)||'';return/*#__PURE__*/React.createElement(\"div\",{key:\"product-\".concat(index),className:'msc-add-line-to-template__product'},/*#__PURE__*/React.createElement(Image,{src:PrimaryImageUrl||'',fallBackSrc:fallBackImg,className:'thumbnail',gridSettings:gridSettings,imageSettings:imageSettings,loadFailureBehavior:'empty'}),/*#__PURE__*/React.createElement(\"div\",{className:'msc-add-line-to-template__product__attributes'},/*#__PURE__*/React.createElement(\"div\",{className:'msc-add-line-to-template__product__id'},RecordId),highlightSearchTerm(Name||'')),/*#__PURE__*/React.createElement(\"div\",{className:'msc-add-line-to-template__product-price-container'},/*#__PURE__*/React.createElement(\"span\",null,price),/*#__PURE__*/React.createElement(ProductSelectButton,{product:product,buttonText:selectProductButtonText,clickHandler:clickHandler})));})));};export var ProductSelectButton=function ProductSelectButton(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isBusy=_useState2[0],setBusy=_useState2[1];var product=props.product,buttonText=props.buttonText,clickHandler=props.clickHandler;var getClickHandler=function getClickHandler(){return/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setBusy(!isBusy);_context.next=3;return clickHandler(product);case 3:setBusy(!isBusy);case 4:case\"end\":return _context.stop();}}},_callee);}));};return/*#__PURE__*/React.createElement(Button,{className:classnames('msc-add-line-to-template__product__select-button',{'is-busy':isBusy}),\"aria-label\":buttonText,onClick:getClickHandler()},buttonText);};","map":{"version":3,"sources":["modules/order-template/components/add-line/product-list.tsx"],"names":[],"mappings":"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","sourcesContent":["import { getFallbackImageUrl } from '@msdyn365-commerce-modules/retail-actions';\nimport { Button } from '@msdyn365-commerce-modules/utilities';\nimport { IImageSettings, Image } from '@msdyn365-commerce/core';\nimport { ProductSearchResult } from '@msdyn365-commerce/retail-proxy';\nimport classnames from 'classnames';\nimport React, { useState } from 'react';\nimport { IAddLineToTemplateProps } from '.';\n\nexport interface IProductListProps extends IAddLineToTemplateProps {\n    products: ProductSearchResult[];\n    imageSettings: IImageSettings;\n    clickHandler(product: ProductSearchResult): Promise<void>;\n    highlightSearchTerm(name: string): React.ReactNode;\n}\n\nexport const ProductList = (props: IProductListProps) => {\n    const {\n        products,\n        context: {\n            actionContext: {\n                requestContext: { apiSettings }\n            },\n            request: {\n                gridSettings\n            },\n            cultureFormatter: {\n                formatCurrency,\n                // @ts-ignore\n                currencyCode\n            }\n        },\n        clickHandler,\n        highlightSearchTerm,\n        resources: { searchResultsCountVerbage, searchResultsCountSubject, selectProductButtonText },\n        imageSettings\n    } = props;\n    const resultCount = searchResultsCountVerbage\n        .replace('{count}', products.length.toString())\n        .replace('{subject}', `${searchResultsCountSubject}${(products.length > 1 ? 's' : '')}`);\n\n    return (\n        <>\n            <p className='msc-add-line-to-template__search-result-count'>{resultCount}</p>\n            <div className='msc-add-line-to-template__product-list-container'>\n                {products.map((product: ProductSearchResult, index: number) => {\n                    const { Price, ItemId, Name, PrimaryImageUrl, RecordId } = product;\n                    const price = formatCurrency(Price.toFixed(2), currencyCode);\n                    const fallBackImg = getFallbackImageUrl(ItemId, apiSettings) || '';\n\n                    return (\n                        <div key={`product-${index}`} className='msc-add-line-to-template__product'>\n                            <Image\n                                src={PrimaryImageUrl || ''}\n                                fallBackSrc={fallBackImg}\n                                className={'thumbnail'}\n                                gridSettings={gridSettings!}\n                                imageSettings={imageSettings}\n                                loadFailureBehavior='empty'\n                            />\n                            <div className='msc-add-line-to-template__product__attributes'>\n                                <div className='msc-add-line-to-template__product__id'>{RecordId}</div>\n                                {highlightSearchTerm(Name || '')}\n                            </div>\n                            <div className='msc-add-line-to-template__product-price-container'>\n                                <span>{price}</span>\n                                <ProductSelectButton product={product} buttonText={selectProductButtonText} clickHandler={clickHandler}/>\n                            </div>\n                        </div>\n                    );\n                })}\n            </div>\n        </>\n    );\n};\n\ninterface IProductSelectButton {\n    product: ProductSearchResult;\n    buttonText: string;\n    clickHandler(product: ProductSearchResult): Promise<void>;\n}\n\nexport const ProductSelectButton = (props: IProductSelectButton) => {\n    const [isBusy, setBusy] = useState(false);\n    const { product, buttonText, clickHandler } = props;\n    const getClickHandler = () => async () => {\n        setBusy(!isBusy);\n        await clickHandler(product);\n        setBusy(!isBusy);\n    };\n\n    return (\n        <Button\n            className={classnames('msc-add-line-to-template__product__select-button', { 'is-busy': isBusy })}\n            aria-label={buttonText}\n            onClick={getClickHandler()}\n        >\n            {buttonText}\n        </Button>\n    );\n};"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}