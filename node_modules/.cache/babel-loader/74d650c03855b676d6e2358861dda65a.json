{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/esm/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import{__decorate}from\"tslib\";import{Slider}from'@msdyn365-commerce-modules/utilities';import debounce from'lodash/debounce';import{computed}from'mobx';import{observer}from'mobx-react';import*as React from'react';import{formatPrice}from'./utilities';var RangeRefineItem=/*#__PURE__*/function(_React$Component){_inherits(RangeRefineItem,_React$Component);var _super=_createSuper(RangeRefineItem);function RangeRefineItem(props){var _this;_classCallCheck(this,RangeRefineItem);_this=_super.call(this,props);_this._formattedPriceReverseLookup=new Map();_this._onRangeUpdate=_this._onRangeUpdate.bind(_assertThisInitialized(_this));_this._onRangeUpdateEnd=_this._onRangeUpdateEnd.bind(_assertThisInitialized(_this));_this._handleRangeTooltipText=_this._handleRangeTooltipText.bind(_assertThisInitialized(_this));_this._changeMin=_this._changeMin.bind(_assertThisInitialized(_this));_this._changeMax=_this._changeMax.bind(_assertThisInitialized(_this));_this._finishChangeMin=_this._finishChangeMin.bind(_assertThisInitialized(_this));_this._finishChangeMax=_this._finishChangeMax.bind(_assertThisInitialized(_this));_this.minInput=/*#__PURE__*/React.createRef();_this.maxInput=/*#__PURE__*/React.createRef();var selectedRefinementCriterion=_this.props.selectedRefinementCriterion;var initialMin=selectedRefinementCriterion&&selectedRefinementCriterion.LeftValueBoundString||'0';var initialMax=selectedRefinementCriterion&&selectedRefinementCriterion.RightValueBoundString||undefined;_this.state={isChecked:false,validationErrorMin:undefined,validationErrorMax:undefined,selectedMin:initialMin,selectedMax:initialMax,touchedMin:false,touchedMax:false};return _this;}_createClass(RangeRefineItem,[{key:\"render\",value:function render(){var _this$props=this.props,productRefinerValue=_this$props.productRefinerValue,parentProductRefinerHierarchy=_this$props.parentProductRefinerHierarchy,refineItemCommonProps=_this$props.refineItemCommonProps;if(!productRefinerValue||!parentProductRefinerHierarchy){refineItemCommonProps.telemetry.error('Cannot render refine value range without productRefinerValue and parentProductRefinerHierarchy');return undefined;}if(this.props.rangeType==='input'){return this._renderInputFields();}return this._renderSlider();}},{key:\"_renderInputFields\",value:function _renderInputFields(){var _this$props2=this.props,isDisabled=_this$props2.isDisabled,parentProductRefinerHierarchy=_this$props2.parentProductRefinerHierarchy,refineItemCommonProps=_this$props2.refineItemCommonProps;var _this$state=this.state,selectedMin=_this$state.selectedMin,selectedMax=_this$state.selectedMax,touchedMin=_this$state.touchedMin,touchedMax=_this$state.touchedMax,validationErrorMin=_this$state.validationErrorMin,validationErrorMax=_this$state.validationErrorMax;var rangeAriaLabel=(refineItemCommonProps.rangeNameFormat||'{0}').replace('{0}',parentProductRefinerHierarchy.KeyName||'');var formAttrs={'aria-label':rangeAriaLabel,'aria-disabled':isDisabled};var minInputClassName=\"ms-refine-submenu__input-range refine-submenu__input-range-min \".concat(validationErrorMin?'refine-submenu__input-range--error':'');var maxInputClassName=\"ms-refine-submenu__input-range refine-submenu__input-range-max \".concat(validationErrorMax?'refine-submenu__input-range--error':'');var minLabelClassName='ms-refine-submenu__input-range-label refine-submenu__input-range-label-min';var maxLabelClassName='ms-refine-submenu__input-range-label refine-submenu__input-range-label-max';var formattedSelectedMin=this._getFormattedSelectedValue(selectedMin,touchedMin,validationErrorMin);var formattedSelectedMax=this._getFormattedSelectedValue(selectedMax,touchedMax,validationErrorMax);return/*#__PURE__*/React.createElement(\"form\",Object.assign({className:'ms-refine-submenu__input-range-refiner'},formAttrs),/*#__PURE__*/React.createElement(\"label\",{className:minLabelClassName},refineItemCommonProps.minLabel,/*#__PURE__*/React.createElement(\"input\",{className:minInputClassName,onChange:this._changeMin,onFocus:this._changeMin,onBlur:this._finishChangeMin,value:formattedSelectedMin,ref:this.minInput})),/*#__PURE__*/React.createElement(\"label\",{className:maxLabelClassName},refineItemCommonProps.maxLabel,/*#__PURE__*/React.createElement(\"input\",{className:maxInputClassName,placeholder:formattedSelectedMax?undefined:refineItemCommonProps.placeholderTextMax,onChange:this._changeMax,onFocus:this._changeMax,onBlur:this._finishChangeMax,value:formattedSelectedMax,ref:this.maxInput})),validationErrorMin&&/*#__PURE__*/React.createElement(\"span\",{className:'ms-refine-submenu__input-range-error-text refine-submenu__input-range-min-error-text'},validationErrorMin),validationErrorMax&&validationErrorMin!==validationErrorMax&&/*#__PURE__*/React.createElement(\"span\",{className:'ms-refine-submenu__input-range-error-text refine-submenu__input-range-max-error-text'},validationErrorMax));}},{key:\"_renderSlider\",value:function _renderSlider(){var _this$props3=this.props,isDisabled=_this$props3.isDisabled,productRefinerValue=_this$props3.productRefinerValue,parentProductRefinerHierarchy=_this$props3.parentProductRefinerHierarchy,selectedRefinementCriterion=_this$props3.selectedRefinementCriterion;var min=productRefinerValue.LeftValueBoundString;var max=productRefinerValue.RightValueBoundString;var selectedMin=selectedRefinementCriterion&&selectedRefinementCriterion.LeftValueBoundString||productRefinerValue.LeftValueBoundString||'0';var selectedMax=selectedRefinementCriterion&&selectedRefinementCriterion.RightValueBoundString||productRefinerValue.RightValueBoundString||max;var sliderId=\"slider_\".concat(parentProductRefinerHierarchy.RecordId,\"_\").concat(productRefinerValue.RefinerRecordId);var ariaAttributes={'aria-disabled':isDisabled};var minPrice=this._formatPrice(min);var maxPrice=this._formatPrice(max);var selectedMinPrice=this._formatPrice(selectedMin);var selectedMaxPrice=this._formatPrice(selectedMax);return/*#__PURE__*/React.createElement(Slider,Object.assign({className:'ms-refine-submenu__range-refiner',key:sliderId,id:sliderId,inForm:false,min:min&&Number(min)||undefined,max:max&&Number(max)||undefined,step:1,orientation:'horizontal',labels:[{labelId:\"\".concat(sliderId,\"_start\"),labelString:\"\".concat(minPrice),labelPositioning:'start'},{labelId:\"\".concat(sliderId,\"_end\"),labelString:\"\".concat(maxPrice),labelPositioning:'end'}],showLabels:true,showTooltip:true,sliderThumbs:[{id:\"\".concat(sliderId,\"_slider_thumb_start\"),value:selectedMin&&Number(selectedMin)||0,ariaLabel:\"\".concat(this.props.minValueSliderThumbAriaLabel,\" \").concat(this.currencyCode),ariaValueText:\"\".concat(selectedMinPrice)},{id:\"\".concat(sliderId,\"_slider_thumb_end\"),value:Number(selectedMax)||Number(maxPrice),ariaLabel:\"\".concat(this.props.maxValueSliderThumbAriaLabel,\" \").concat(this.currencyCode),ariaValueText:\"\".concat(selectedMaxPrice)}],onChangeEnd:this._onRangeUpdateEnd,onChange:debounce(this._onRangeUpdate,500),handleTooltipText:this._handleRangeTooltipText},ariaAttributes));}},{key:\"_changeMin\",value:function _changeMin(event){this._changeValue(event,'Min');}},{key:\"_changeMax\",value:function _changeMax(event){this._changeValue(event,'Max');}},{key:\"_changeValue\",value:function _changeValue(event,inputType){var _this$setState;var selectedKey=\"selected\".concat(inputType);var touchedKey=\"touched\".concat(inputType);this.setState((_this$setState={},_defineProperty(_this$setState,selectedKey,this._getInputWithoutFormatting(event.currentTarget.value)),_defineProperty(_this$setState,touchedKey,true),_this$setState));}},{key:\"_finishChangeMin\",value:function _finishChangeMin(event){var selectedMinValue=this._getInputWithoutFormatting(event.currentTarget.value);this.setState({selectedMin:selectedMinValue,minTouched:false});var minInput=Number(selectedMinValue);var _this$props4=this.props,onToggle=_this$props4.onToggle,parentProductRefinerHierarchy=_this$props4.parentProductRefinerHierarchy,productRefinerValue=_this$props4.productRefinerValue,refineItemCommonProps=_this$props4.refineItemCommonProps,selectedRefinementCriterion=_this$props4.selectedRefinementCriterion;var max=selectedRefinementCriterion&&selectedRefinementCriterion.RightValueBoundString||undefined;var maxNum=max?Number(max):undefined;if(isNaN(minInput)){this.setState({validationErrorMin:refineItemCommonProps.validationErrorNaN});this._focus('Min');return false;}if(this._validateRange(minInput,maxNum)){onToggle({parentProductRefinerHierarchy:parentProductRefinerHierarchy,productRefinerValue:productRefinerValue,isSelecting:true,rangeStart:minInput,rangeEnd:maxNum});return true;}else{this._focus('Min');}return false;}},{key:\"_finishChangeMax\",value:function _finishChangeMax(event){var selectedMaxValue=this._getInputWithoutFormatting(event.currentTarget.value);this.setState({selectedMax:selectedMaxValue,maxTouched:false});var maxInput=Number(selectedMaxValue);var _this$props5=this.props,onToggle=_this$props5.onToggle,parentProductRefinerHierarchy=_this$props5.parentProductRefinerHierarchy,productRefinerValue=_this$props5.productRefinerValue,refineItemCommonProps=_this$props5.refineItemCommonProps,selectedRefinementCriterion=_this$props5.selectedRefinementCriterion;var min=selectedRefinementCriterion&&selectedRefinementCriterion.LeftValueBoundString||'0';var minNum=Number(min);if(isNaN(maxInput)){this.setState({validationErrorMax:refineItemCommonProps.validationErrorNaN});this._focus('Max');return false;}if(this._validateRange(minNum,maxInput)){if(productRefinerValue){onToggle({parentProductRefinerHierarchy:parentProductRefinerHierarchy,productRefinerValue:productRefinerValue,isSelecting:true,rangeStart:minNum,rangeEnd:maxInput});}else{this._focus('Max');}return true;}return false;}},{key:\"_focus\",value:function _focus(inputType){var ref=inputType==='Max'?this.maxInput:this.minInput;setTimeout(function(){if(ref&&ref.current){ref.current.focus();}},50);}},{key:\"_getFormattedSelectedValue\",value:function _getFormattedSelectedValue(selected,touched,validationError){if(touched||validationError||selected===undefined){return selected;}return this._formatPrice(selected);}},{key:\"_validateRange\",value:function _validateRange(min,max){var refineItemCommonProps=this.props.refineItemCommonProps;if(max===undefined){return true;}if(min>max){this.setState({validationErrorMin:refineItemCommonProps.validationErrorRange,validationErrorMax:refineItemCommonProps.validationErrorRange});return false;}return true;}},{key:\"_formatPrice\",value:function _formatPrice(amount){var locale=this.props.refineItemCommonProps.locale;var result=formatPrice(amount,this.currencyCode,locale,this.props.refineItemCommonProps.telemetry);if(amount!==undefined&&!this._formattedPriceReverseLookup.has(result)){this._formattedPriceReverseLookup.set(result,amount);}return result;}},{key:\"_getInputWithoutFormatting\",value:function _getInputWithoutFormatting(input){var inputAsNum=Number(input);if(!isNaN(inputAsNum)){return input;}var reverseLookupResult=this._formattedPriceReverseLookup.get(input);return reverseLookupResult||input;}},{key:\"_onRangeUpdate\",value:function _onRangeUpdate(sliderChangeNotification){if(sliderChangeNotification.eventType!=='mousemove'){var _this$props6=this.props,onToggle=_this$props6.onToggle,parentProductRefinerHierarchy=_this$props6.parentProductRefinerHierarchy,productRefinerValue=_this$props6.productRefinerValue;if(productRefinerValue&&sliderChangeNotification){onToggle({parentProductRefinerHierarchy:parentProductRefinerHierarchy,productRefinerValue:productRefinerValue,isSelecting:true,rangeStart:sliderChangeNotification.firstThumbValue,rangeEnd:sliderChangeNotification.secondThumbValue});this._focusOnSliderThumb(sliderChangeNotification);}}}},{key:\"_onRangeUpdateEnd\",value:function _onRangeUpdateEnd(sliderChangeNotification){var _this$props7=this.props,onToggle=_this$props7.onToggle,parentProductRefinerHierarchy=_this$props7.parentProductRefinerHierarchy,productRefinerValue=_this$props7.productRefinerValue;if(productRefinerValue&&sliderChangeNotification){onToggle({parentProductRefinerHierarchy:parentProductRefinerHierarchy,productRefinerValue:productRefinerValue,isSelecting:true,rangeStart:sliderChangeNotification.firstThumbValue,rangeEnd:sliderChangeNotification.secondThumbValue});this._focusOnSliderThumb(sliderChangeNotification);}}},{key:\"_focusOnSliderThumb\",value:function _focusOnSliderThumb(sliderChangeNotification){if(sliderChangeNotification.id){var element=document.getElementById(\"\".concat(sliderChangeNotification.id,\"range\"));if(!!element){setTimeout(function(){element.focus();},0);}}}},{key:\"_handleRangeTooltipText\",value:function _handleRangeTooltipText(tooltip){return this._formatPrice(\"\".concat(tooltip));}},{key:\"currencyCode\",get:function get(){return this.props.productRefinerValue.UnitText||'';}}]);return RangeRefineItem;}(React.Component);__decorate([computed],RangeRefineItem.prototype,\"currencyCode\",null);RangeRefineItem=__decorate([observer],RangeRefineItem);export default RangeRefineItem;","map":{"version":3,"sources":["modules/search-result-container/components/range-refine-item.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Slider } from '@msdyn365-commerce-modules/utilities';\nimport debounce from 'lodash/debounce';\nimport { computed } from 'mobx';\nimport { observer } from 'mobx-react';\nimport * as React from 'react';\nimport { formatPrice } from './utilities';\n\ntype InputType = 'Min' | 'Max';\n\nimport { IRefineItemProps, IRefineItemState } from './refine-item';\n\nexport type RangeRefineItemType = 'slider' | 'input';\n\n/**\n * Range refine item properties\n */\nexport interface IRangeRefineItemProps extends IRefineItemProps {\n    rangeType: RangeRefineItemType;\n    minValueSliderThumbAriaLabel?: string;\n    maxValueSliderThumbAriaLabel?: string;\n}\n\n/**\n * Range refine item state\n */\nexport interface IRangeRefineItemState extends IRefineItemState {\n    validationErrorMin: string | undefined;\n    validationErrorMax: string | undefined;\n    selectedMin: string | undefined;\n    selectedMax: string | undefined;\n    touchedMin: boolean;\n    touchedMax: boolean;\n}\n\n/**\n * RangeRefineItem component (controlled by RefineSubmenu)\n */\n@observer\nexport default class RangeRefineItem extends React.Component<IRangeRefineItemProps, IRangeRefineItemState> {\n    private _formattedPriceReverseLookup: Map<string, string> = new Map();\n\n    private minInput: React.RefObject<HTMLInputElement>;\n    private maxInput: React.RefObject<HTMLInputElement>;\n\n    @computed get currencyCode(): string {\n        return this.props.productRefinerValue.UnitText || '';\n    }\n\n    constructor(props: IRangeRefineItemProps) {\n        super(props);\n        this._onRangeUpdate = this._onRangeUpdate.bind(this);\n        this._onRangeUpdateEnd = this._onRangeUpdateEnd.bind(this);\n        this._handleRangeTooltipText = this._handleRangeTooltipText.bind(this);\n        this._changeMin = this._changeMin.bind(this);\n        this._changeMax = this._changeMax.bind(this);\n        this._finishChangeMin = this._finishChangeMin.bind(this);\n        this._finishChangeMax = this._finishChangeMax.bind(this);\n\n        this.minInput = React.createRef<HTMLInputElement>();\n        this.maxInput = React.createRef<HTMLInputElement>();\n\n        const { selectedRefinementCriterion } = this.props;\n        const initialMin = selectedRefinementCriterion && selectedRefinementCriterion.LeftValueBoundString || '0';\n        const initialMax = selectedRefinementCriterion && selectedRefinementCriterion.RightValueBoundString || undefined;\n        this.state = {\n            isChecked: false,\n            validationErrorMin: undefined,\n            validationErrorMax: undefined,\n            selectedMin: initialMin,\n            selectedMax: initialMax,\n            touchedMin: false,\n            touchedMax: false\n        };\n    }\n\n    public render(): JSX.Element | undefined {\n        const { productRefinerValue, parentProductRefinerHierarchy, refineItemCommonProps } = this.props;\n\n        if (!productRefinerValue || !parentProductRefinerHierarchy) {\n            refineItemCommonProps.telemetry.error('Cannot render refine value range without productRefinerValue and parentProductRefinerHierarchy');\n            return undefined;\n        }\n\n        if (this.props.rangeType === 'input') {\n            return this._renderInputFields();\n        }\n\n        return this._renderSlider();\n    }\n\n    private _renderInputFields(): JSX.Element | undefined {\n        const { isDisabled, parentProductRefinerHierarchy, refineItemCommonProps } = this.props;\n        const { selectedMin, selectedMax, touchedMin, touchedMax, validationErrorMin, validationErrorMax } = this.state;\n\n        const rangeAriaLabel = (refineItemCommonProps.rangeNameFormat || '{0}').replace('{0}', (parentProductRefinerHierarchy.KeyName || ''));\n        const formAttrs = {\n            'aria-label': rangeAriaLabel,\n            'aria-disabled': isDisabled\n        };\n\n        // To enable price formatting of selected fields, this is the approach:\n        // initial value: min=0 formatted as price, max=undefined\n        // onFocus/onChange: convert to number (unformat) and mark as touched to indicate value is being edited\n        // onBlur: validate and format entered value as price\n        const minInputClassName = `ms-refine-submenu__input-range refine-submenu__input-range-min ${validationErrorMin ? 'refine-submenu__input-range--error' : ''}`;\n        const maxInputClassName = `ms-refine-submenu__input-range refine-submenu__input-range-max ${validationErrorMax ? 'refine-submenu__input-range--error' : ''}`;\n        const minLabelClassName = 'ms-refine-submenu__input-range-label refine-submenu__input-range-label-min';\n        const maxLabelClassName = 'ms-refine-submenu__input-range-label refine-submenu__input-range-label-max';\n        const formattedSelectedMin = this._getFormattedSelectedValue(selectedMin, touchedMin, validationErrorMin);\n        const formattedSelectedMax = this._getFormattedSelectedValue(selectedMax, touchedMax, validationErrorMax);\n        return (\n            <form className='ms-refine-submenu__input-range-refiner' {...formAttrs}>\n                <label className={minLabelClassName}>\n                    {refineItemCommonProps.minLabel}\n                    <input\n                        className={minInputClassName}\n                        onChange={this._changeMin}\n                        onFocus={this._changeMin}\n                        onBlur={this._finishChangeMin}\n                        value={formattedSelectedMin}\n                        ref={this.minInput}\n                    />\n                </label>\n                <label className={maxLabelClassName}>\n                    {refineItemCommonProps.maxLabel}\n                    <input\n                        className={maxInputClassName}\n                        placeholder={formattedSelectedMax ? undefined : refineItemCommonProps.placeholderTextMax}\n                        onChange={this._changeMax}\n                        onFocus={this._changeMax}\n                        onBlur={this._finishChangeMax}\n                        value={formattedSelectedMax}\n                        ref={this.maxInput}\n                    />\n                </label>\n                {validationErrorMin &&\n                    <span className='ms-refine-submenu__input-range-error-text refine-submenu__input-range-min-error-text'>{validationErrorMin}</span>\n                }\n                {validationErrorMax && validationErrorMin !== validationErrorMax &&\n                    <span className='ms-refine-submenu__input-range-error-text refine-submenu__input-range-max-error-text'>{validationErrorMax}</span>\n                }\n            </form>\n        );\n    }\n\n    private _renderSlider(): JSX.Element | undefined {\n        const { isDisabled, productRefinerValue, parentProductRefinerHierarchy, selectedRefinementCriterion } = this.props;\n        const min = productRefinerValue.LeftValueBoundString;\n        const max = productRefinerValue.RightValueBoundString;\n        const selectedMin = selectedRefinementCriterion && selectedRefinementCriterion.LeftValueBoundString || productRefinerValue.LeftValueBoundString || '0';\n        const selectedMax = selectedRefinementCriterion && selectedRefinementCriterion.RightValueBoundString || productRefinerValue.RightValueBoundString || max;\n        const sliderId = `slider_${parentProductRefinerHierarchy.RecordId}_${productRefinerValue.RefinerRecordId}`;\n        const ariaAttributes = {\n            'aria-disabled': isDisabled\n        };\n\n        const minPrice = this._formatPrice(min);\n        const maxPrice = this._formatPrice(max);\n        const selectedMinPrice =this._formatPrice(selectedMin);\n        const selectedMaxPrice =this._formatPrice(selectedMax);\n\n        return (\n            <Slider\n                className={'ms-refine-submenu__range-refiner'}\n                key={sliderId}\n                id={sliderId}\n                inForm={false}\n                min={min && Number(min) || undefined}\n                max={max && Number(max) || undefined}\n                step={1}\n                orientation={'horizontal'}\n                labels={[\n                    {\n                        labelId: `${sliderId}_start`,\n                        labelString: `${minPrice}`,\n                        labelPositioning: 'start'\n                    },\n                    {\n                        labelId: `${sliderId}_end`,\n                        labelString: `${maxPrice}`,\n                        labelPositioning: 'end'\n                    }\n                ]}\n                showLabels={true}\n                showTooltip={true}\n                sliderThumbs={[\n                    {\n                        id: `${sliderId}_slider_thumb_start`,\n                        value: selectedMin && Number(selectedMin) || 0,\n                        ariaLabel: `${this.props.minValueSliderThumbAriaLabel} ${this.currencyCode}`,\n                        ariaValueText: `${selectedMinPrice}`\n                    },\n                    {\n                        id: `${sliderId}_slider_thumb_end`,\n                        value: Number(selectedMax) || Number(maxPrice),\n                        ariaLabel: `${this.props.maxValueSliderThumbAriaLabel} ${this.currencyCode}`,\n                        ariaValueText: `${selectedMaxPrice}`\n                    }\n                ]}\n                onChangeEnd={this._onRangeUpdateEnd}\n                onChange={debounce(this._onRangeUpdate, 500)}\n                handleTooltipText={this._handleRangeTooltipText}\n                {...ariaAttributes}\n            />\n        );\n    }\n\n    private _changeMin(event: React.FocusEvent<HTMLInputElement>): void {\n        this._changeValue(event, 'Min');\n    }\n\n    private _changeMax(event: React.FocusEvent<HTMLInputElement>): void {\n        this._changeValue(event, 'Max');\n    }\n\n    private _changeValue(event: React.FocusEvent<HTMLInputElement>, inputType: InputType): void {\n        const selectedKey = `selected${inputType}`;\n        const touchedKey = `touched${inputType}`;\n        this.setState({\n            [selectedKey]: this._getInputWithoutFormatting(event.currentTarget.value),\n            [touchedKey]: true\n        });\n    }\n\n    private _finishChangeMin(event: React.FocusEvent<HTMLInputElement>): boolean {\n        const selectedMinValue = this._getInputWithoutFormatting(event.currentTarget.value);\n        this.setState({\n            selectedMin: selectedMinValue,\n            minTouched: false\n        });\n        const minInput = Number(selectedMinValue);\n        const { onToggle, parentProductRefinerHierarchy, productRefinerValue, refineItemCommonProps, selectedRefinementCriterion } = this.props;\n        const max = selectedRefinementCriterion && selectedRefinementCriterion.RightValueBoundString || undefined;\n\n        const maxNum = max ? Number(max) : undefined;\n\n        if (isNaN(minInput)) {\n            this.setState({validationErrorMin: refineItemCommonProps.validationErrorNaN});\n            this._focus('Min');\n            return false;\n        }\n\n        if (this._validateRange(minInput, maxNum)) {\n            onToggle({\n                parentProductRefinerHierarchy: parentProductRefinerHierarchy,\n                productRefinerValue: productRefinerValue,\n                isSelecting: true,\n                rangeStart: minInput,\n                rangeEnd: maxNum\n            });\n            return true;\n        } else {\n            this._focus('Min');\n        }\n\n        return false;\n    }\n\n    private _finishChangeMax(event: React.FocusEvent<HTMLInputElement>): boolean {\n        const selectedMaxValue = this._getInputWithoutFormatting(event.currentTarget.value);\n        this.setState({\n            selectedMax: selectedMaxValue,\n            maxTouched: false\n        });\n        const maxInput = Number(selectedMaxValue);\n        const { onToggle, parentProductRefinerHierarchy, productRefinerValue, refineItemCommonProps, selectedRefinementCriterion } = this.props;\n        const min = selectedRefinementCriterion && selectedRefinementCriterion.LeftValueBoundString || '0';\n\n        const minNum = Number(min);\n\n        if (isNaN(maxInput)) {\n            this.setState({validationErrorMax: refineItemCommonProps.validationErrorNaN});\n            this._focus('Max');\n            return false;\n        }\n\n        if (this._validateRange(minNum, maxInput)) {\n            if (productRefinerValue) {\n                onToggle({\n                    parentProductRefinerHierarchy: parentProductRefinerHierarchy,\n                    productRefinerValue: productRefinerValue,\n                    isSelecting: true,\n                    rangeStart: minNum,\n                    rangeEnd: maxInput\n                });\n            } else {\n                this._focus('Max');\n            }\n            return true;\n        }\n\n        return false;\n    }\n\n    private _focus(inputType: InputType): void {\n        const ref = inputType === 'Max' ? this.maxInput : this.minInput;\n\n        setTimeout(() => {\n            if (ref && ref.current) {\n                ref.current.focus();\n            }\n        },         50);\n    }\n\n    private _getFormattedSelectedValue(selected: string | undefined, touched: boolean, validationError: string | undefined): string | undefined {\n        if (touched || validationError || selected === undefined) {\n            return selected;\n        }\n        return this._formatPrice(selected);\n    }\n\n    private _validateRange(min: number, max: number | undefined): boolean {\n        const { refineItemCommonProps } = this.props;\n        if (max === undefined) {\n            return true;\n        }\n\n        if (min > max) {\n            this.setState({\n                validationErrorMin: refineItemCommonProps.validationErrorRange,\n                validationErrorMax: refineItemCommonProps.validationErrorRange\n            });\n            return false;\n        }\n\n        return true;\n    }\n\n    private _formatPrice(amount: string | undefined): string {\n        const locale = this.props.refineItemCommonProps.locale;\n        const result = formatPrice(amount, this.currencyCode, locale, this.props.refineItemCommonProps.telemetry);\n\n        if (amount !== undefined && !this._formattedPriceReverseLookup.has(result)) {\n            this._formattedPriceReverseLookup.set(result, amount);\n        }\n\n        return result;\n    }\n\n    private _getInputWithoutFormatting(input: string): string {\n        // First try to cast raw input to a number\n        const inputAsNum = Number(input);\n        if (!isNaN(inputAsNum)) {\n            return input;\n        }\n\n        // Otherwise try a reverse lookup and fall back to the raw input if all else fails\n        const reverseLookupResult = this._formattedPriceReverseLookup.get(input);\n        return reverseLookupResult || input;\n    }\n\n    // NOTE: Fix types once Shared Components build pipeline bug fixed\n    // tslint:disable-next-line:no-any\n    private _onRangeUpdate(sliderChangeNotification: any): void {\n        // Need to filter out mousemove events as these cause errors after the menu updates and slider re-renders\n        if (sliderChangeNotification.eventType !== 'mousemove') {\n            const { onToggle, parentProductRefinerHierarchy, productRefinerValue } = this.props;\n            if (productRefinerValue && sliderChangeNotification) {\n                onToggle({\n                    parentProductRefinerHierarchy: parentProductRefinerHierarchy,\n                    productRefinerValue: productRefinerValue,\n                    isSelecting: true,\n                    rangeStart: sliderChangeNotification.firstThumbValue,\n                    rangeEnd: sliderChangeNotification.secondThumbValue\n                });\n\n                this._focusOnSliderThumb(sliderChangeNotification);\n            }\n        }\n    }\n\n    // tslint:disable-next-line\n    private _onRangeUpdateEnd(sliderChangeNotification: any): void {\n        const { onToggle, parentProductRefinerHierarchy, productRefinerValue } = this.props;\n        if (productRefinerValue && sliderChangeNotification) {\n            onToggle({\n                parentProductRefinerHierarchy: parentProductRefinerHierarchy,\n                productRefinerValue: productRefinerValue,\n                isSelecting: true,\n                rangeStart: sliderChangeNotification.firstThumbValue,\n                rangeEnd: sliderChangeNotification.secondThumbValue\n            });\n\n            this._focusOnSliderThumb(sliderChangeNotification);\n        }\n    }\n\n    // tslint:disable-next-line\n    private _focusOnSliderThumb(sliderChangeNotification: any): void {\n        if (sliderChangeNotification.id) {\n            const element = document.getElementById(`${sliderChangeNotification.id}range`);\n            if (!!element) {\n                setTimeout(\n                    () => {\n                        element.focus();\n                },  0);\n            }\n        }\n    }\n\n    private _handleRangeTooltipText(tooltip: number): string {\n        return this._formatPrice(`${tooltip}`);\n    }\n}"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}