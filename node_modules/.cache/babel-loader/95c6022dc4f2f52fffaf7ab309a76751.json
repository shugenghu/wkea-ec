{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _asyncToGenerator from\"@babel/runtime/helpers/esm/asyncToGenerator\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol===\"undefined\"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length===\"number\"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};},e:function e(_e){throw _e;},f:F};}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]();},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e2){didErr=true;err=_e2;},f:function f(){try{if(!normalCompletion&&it[\"return\"]!=null)it[\"return\"]();}finally{if(didErr)throw err;}}};}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}import classnames from'classnames';import React,{useState}from'react';import{buildWishlistLine,getCustomer,GetCustomerInput}from'@msdyn365-commerce-modules/retail-actions';import{Alert,UncontrolledTooltip}from'@msdyn365-commerce-modules/utilities';import{msdyn365Commerce}from'@msdyn365-commerce/core';import{AsyncResult}from'@msdyn365-commerce/retail-proxy';import{addLinesAsync,createCommerceListAsync,createGetByCustomerInput,removeLinesAsync}from'@msdyn365-commerce/retail-proxy/dist/DataActions/CommerceListsDataActions.g';var onClick=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_event,props,state){var user,product;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:user=props.context.request.user;product=props.data.product;if(!state.waiting){_context.next=4;break;}return _context.abrupt(\"return\");case 4:if(!(!user.isAuthenticated&&user.signInUrl&&window)){_context.next=7;break;}window.location.assign(user.signInUrl);return _context.abrupt(\"return\");case 7:state.setWaiting(true);if(props.getSelectedProduct===undefined){_context.next=15;break;}_context.next=11;return props.getSelectedProduct;case 11:_context.t0=_context.sent;if(_context.t0){_context.next=14;break;}_context.t0=props.data.product;case 14:product=_context.t0;case 15:_context.next=17;return doesProductExistInWishlist(product,props)?removeFromWishlist(product,props,state):addToWishlist(product,props,state);case 17:state.setWaiting(false);case 18:case\"end\":return _context.stop();}}},_callee);}));return function onClick(_x,_x2,_x3){return _ref.apply(this,arguments);};}();var onDismiss=function onDismiss(state){state.setContent({color:'success',showAlert:false});};var AddToWishlistComponentActions={onClick:onClick,onDismiss:onDismiss};var AddToWishlist=function AddToWishlist(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),waiting=_useState2[0],setWaiting=_useState2[1];var _useState3=useState(doesProductExistInWishlist(props.data.product,props)),_useState4=_slicedToArray(_useState3,2),canRemove=_useState4[0],setCanRemove=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),content=_useState6[0],setContent=_useState6[1];var state={waiting:waiting,canRemove:canRemove,content:content,setWaiting:setWaiting,setCanRemove:setCanRemove,setContent:setContent};React.useEffect(function(){setCanRemove(doesProductExistInWishlist(props.data.product,props));},[props]);var removeFromWishlistButtonText=props.removeFromWishlistButtonText,addToWishlistButtonText=props.addToWishlistButtonText,showStatusMessage=props.showStatusMessage,showRemoveButton=props.showRemoveButton,showButtonText=props.showButtonText,className=props.className,disabled=props.disabled,showButtonTooltip=props.showButtonTooltip,tooltipPosition=props.tooltipPosition;var onClickHandler=function onClickHandler(event){return AddToWishlistComponentActions.onClick(event,props,state);};var onDismissHandler=function onDismissHandler(){return AddToWishlistComponentActions.onDismiss(state);};var ariaLabel=state.canRemove?removeFromWishlistButtonText:addToWishlistButtonText;var addToWishlistRef=/*#__PURE__*/React.createRef();var removeFromWishlistRef=/*#__PURE__*/React.createRef();var showMessage=showStatusMessage!==undefined?showStatusMessage:true;var showButton=showRemoveButton!==undefined?showRemoveButton:true;var showTooltip=showButtonTooltip!==undefined?showButtonTooltip:true;var tooltipPos=showButtonTooltip!==undefined?tooltipPosition:'right';if(state.canRemove&&!showButton){return null;}return/*#__PURE__*/React.createElement(React.Fragment,null,showButtonText?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"button\",{className:classnames('msc-add-to-wishlist',className,state.waiting?'msc-add-to-wishlist__waiting':'',state.canRemove?'msc-add-to-wishlist__removing':''),\"aria-label\":ariaLabel,onClick:onClickHandler,disabled:disabled,ref:addToWishlistRef},ariaLabel),showTooltip&&/*#__PURE__*/React.createElement(UncontrolledTooltip,{placement:tooltipPos,trigger:'hover focus',target:addToWishlistRef},ariaLabel)):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"button\",{className:classnames('msc-add-to-wishlist',className,state.waiting?'msc-add-to-wishlist__waiting':'',state.canRemove?'msc-add-to-wishlist__removing':''),\"aria-label\":ariaLabel,onClick:onClickHandler,disabled:disabled,ref:removeFromWishlistRef}),showTooltip&&/*#__PURE__*/React.createElement(UncontrolledTooltip,{placement:tooltipPos,trigger:'hover focus',target:addToWishlistRef},ariaLabel)),state.content.showAlert&&showMessage?/*#__PURE__*/React.createElement(\"div\",{className:'ms-wishlist-items__product-status'},/*#__PURE__*/React.createElement(Alert,{color:state.content.color,isOpen:state.content.showAlert,toggle:onDismissHandler},state.content.wishlistTextMessage)):'');};var doesProductExistInWishlist=function doesProductExistInWishlist(product,props){var wishlists=props.data.wishlists;if(!wishlists||!wishlists[0]){return false;}var CommerceListLines=wishlists[0].CommerceListLines;if(!CommerceListLines||CommerceListLines.length===0){return false;}var _iterator=_createForOfIteratorHelper(CommerceListLines),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var wishlistItem=_step.value;if(wishlistItem.ProductId===product.RecordId){return true;}}}catch(err){_iterator.e(err);}finally{_iterator.f();}return false;};var propogateSuccess=function propogateSuccess(props,result){var onSuccess=props.onSuccess,cartline=props.cartline;if(onSuccess){cartline?onSuccess(result,props.cartline):onSuccess(result);}};var propogateError=function propogateError(props,result){var onError=props.onError;if(onError){onError(result);}};var addToWishlist=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(product,props,state){var canAddMasterProduct,context,missingDimensions,wishlistName,customer,listData,commerceList;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:canAddMasterProduct=props.canAddMasterProduct,context=props.context;if(!(product.Dimensions&&!canAddMasterProduct)){_context2.next=6;break;}missingDimensions=product.Dimensions.filter(function(dimension){return!(dimension.DimensionValue&&dimension.DimensionValue.Value);});if(!(missingDimensions.length>0)){_context2.next=6;break;}propogateError(props,{status:'MISSINGDIMENSION',missingDimensions:missingDimensions});return _context2.abrupt(\"return\",AsyncResult.resolve());case 6:if(!context.request.user.isAuthenticated){_context2.next=31;break;}if(!(!props.data.wishlists||props.data.wishlists.length===0)){_context2.next=30;break;}wishlistName=props.nameOfWishlist;_context2.next=11;return getCustomerAccount(props);case 11:customer=_context2.sent;if(!(customer&&customer.AccountNumber)){_context2.next=27;break;}listData={CustomerId:customer.AccountNumber,Name:wishlistName,CommerceListTypeValue:1,Id:0};_context2.prev=14;_context2.next=17;return createCommerceListAsync({callerContext:context.actionContext},listData);case 17:commerceList=_context2.sent;return _context2.abrupt(\"return\",callAddWishlistLine(props,state,commerceList.Id,product.RecordId));case 21:_context2.prev=21;_context2.t0=_context2[\"catch\"](14);if(context.telemetry){context.telemetry.warning(_context2.t0);context.telemetry.debug('Unable to create a wishlist');}propogateError(props,{status:'FAILED'});case 25:_context2.next=28;break;case 27:context.telemetry.debug('Customer account number missing');case 28:_context2.next=31;break;case 30:return _context2.abrupt(\"return\",callAddWishlistLine(props,state,props.data.wishlists[0].Id,product.RecordId));case 31:return _context2.abrupt(\"return\",AsyncResult.resolve());case 32:case\"end\":return _context2.stop();}}},_callee2,null,[[14,21]]);}));return function addToWishlist(_x4,_x5,_x6){return _ref2.apply(this,arguments);};}();var callAddWishlistLine=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(props,state,wishlistId,productId){var context,customer,createdCommerceList;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:context=props.context;_context3.prev=1;_context3.next=4;return getCustomerAccount(props);case 4:customer=_context3.sent;if(!(customer&&customer.AccountNumber)){_context3.next=16;break;}_context3.next=8;return addLinesAsync({callerContext:context.actionContext},wishlistId,[buildWishlistLine(productId,customer.AccountNumber,wishlistId)]);case 8:createdCommerceList=_context3.sent;context.actionContext.update(createGetByCustomerInput({},null),[createdCommerceList]);if(context.telemetry){context.telemetry.debug(\"Added item to the wishlist \".concat(createdCommerceList));}state.setCanRemove(true);state.setContent({color:'success',showAlert:true,wishlistTextMessage:props.addToWishlistMessage?props.addToWishlistMessage:'Added to your wishlist'});propogateSuccess(props,{status:'ADDED'});_context3.next=17;break;case 16:context.telemetry.debug(\"Customer Account number missing\");case 17:_context3.next=24;break;case 19:_context3.prev=19;_context3.t0=_context3[\"catch\"](1);if(context.telemetry){context.telemetry.warning(_context3.t0);context.telemetry.debug(\"Unable to add item to wishlist \".concat(_context3.t0));}state.setContent({color:'danger',showAlert:true,wishlistTextMessage:props.addItemToWishlistError});propogateError(props,{status:'FAILED'});case 24:case\"end\":return _context3.stop();}}},_callee3,null,[[1,19]]);}));return function callAddWishlistLine(_x7,_x8,_x9,_x10){return _ref3.apply(this,arguments);};}();var removeFromWishlist=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(product,props,state){var context,data,removedFromWishlistMessage,removeItemFromWishlistError,wishlists,actionContext,telemetry,wishlistLine,customer,commerceList;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:context=props.context,data=props.data,removedFromWishlistMessage=props.removedFromWishlistMessage,removeItemFromWishlistError=props.removeItemFromWishlistError;wishlists=data.wishlists;actionContext=context.actionContext,telemetry=context.telemetry;if(!context.request.user.isAuthenticated){_context4.next=29;break;}if(!(wishlists&&wishlists[0])){_context4.next=28;break;}wishlistLine=wishlists[0].CommerceListLines.find(function(line){return line.ProductId===product.RecordId;});if(!wishlistLine){_context4.next=26;break;}_context4.prev=7;_context4.next=10;return getCustomerAccount(props);case 10:customer=_context4.sent;_context4.next=13;return removeLinesAsync({callerContext:actionContext},wishlists[0].Id,[wishlistLine]);case 13:commerceList=_context4.sent;if(customer){context.actionContext.update(createGetByCustomerInput({},null),[commerceList]);}else{telemetry.debug('Customer Account Number missing');}if(telemetry){telemetry.debug(\"[WishlistButton] \".concat(product.RecordId,\" removed from Wishlist \").concat(commerceList.Id));}state.setCanRemove(false);state.setContent({color:'success',showAlert:true,wishlistTextMessage:removedFromWishlistMessage?removedFromWishlistMessage:\"Removed item from the wishlist\"});propogateSuccess(props,{status:'REMOVED'});_context4.next=26;break;case 21:_context4.prev=21;_context4.t0=_context4[\"catch\"](7);if(telemetry){telemetry.warning(_context4.t0);telemetry.debug('[WishlistButton] Error removing item from the wishlist');}state.setContent({color:'danger',wishlistTextMessage:removeItemFromWishlistError});propogateError(props,{status:'FAILED'});case 26:_context4.next=29;break;case 28:if(telemetry){telemetry.debug('[WishlistButton] Can\\'t remove from wishlist since no wishlist exisits OR there is no product data');}case 29:return _context4.abrupt(\"return\",AsyncResult.resolve());case 30:case\"end\":return _context4.stop();}}},_callee4,null,[[7,21]]);}));return function removeFromWishlist(_x11,_x12,_x13){return _ref4.apply(this,arguments);};}();var getCustomerAccount=function getCustomerAccount(props){var context=props.context;var customerInput=new GetCustomerInput(context.actionContext.requestContext.apiSettings);return getCustomer(customerInput,context.actionContext);};export var AddToWishlistComponent=msdyn365Commerce.createComponent('AddToWishlist',_objectSpread({component:AddToWishlist},AddToWishlistComponentActions));","map":{"version":3,"sources":["add-to-wishlist/add-to-wishlist.component.tsx"],"names":[],"mappings":"65EAAA,MAAO,CAAA,UAAP,KAAuB,YAAvB,CAEA,MAAO,CAAA,KAAP,EAAgB,QAAhB,KAAgC,OAAhC,CAEA,OAAS,iBAAT,CAA4B,WAA5B,CAAyC,gBAAzC,KAAiE,2CAAjE,CACA,OAAS,KAAT,CAAgB,mBAAhB,KAA2C,sCAA3C,CACA,OAAsC,gBAAtC,KAA8D,yBAA9D,CACA,OAAS,WAAT,KAA+F,iCAA/F,CACA,OACI,aADJ,CACmB,uBADnB,CAC4C,wBAD5C,CACsE,gBADtE,KAEO,6EAFP,CAiEA,GAAM,CAAA,OAAO,0FAAG,iBAAO,MAAP,CAA8C,KAA9C,CAAmF,KAAnF,mIACJ,IADI,CACK,KAAK,CAAC,OAAN,CAAc,OADnB,CACJ,IADI,CAEN,OAFM,CAEM,KAAK,CAAC,IAFZ,CAEN,OAFM,KAIR,KAAK,CAAC,OAJE,sEAQR,CAAC,IAAI,CAAC,eAAN,EAAyB,IAAI,CAAC,SAA9B,EAA2C,MARnC,0BASR,MAAM,CAAC,QAAP,CAAgB,MAAhB,CAAuB,IAAI,CAAC,SAA5B,EATQ,wCAcZ,KAAK,CAAC,UAAN,CAAiB,IAAjB,EAdY,GAeP,KAAK,CAAC,kBAAN,GAA6B,SAftB,iDAgBS,CAAA,KAAK,CAAC,kBAhBf,uFAgBsC,KAAK,CAAC,IAAN,CAAW,OAhBjD,SAgBR,OAhBQ,4CAmBL,CAAA,0BAA0B,CAAC,OAAD,CAAU,KAAV,CAA1B,CAA6C,kBAAkB,CAAC,OAAD,CAAU,KAAV,CAAiB,KAAjB,CAA/D,CAAyF,aAAa,CAAC,OAAD,CAAU,KAAV,CAAiB,KAAjB,CAnBjG,SAoBZ,KAAK,CAAC,UAAN,CAAiB,KAAjB,EApBY,uDAAH,kBAAP,CAAA,OAAO,oDAAb,CAuBA,GAAM,CAAA,SAAS,CAAG,QAAZ,CAAA,SAAY,CAAC,KAAD,CAA4C,CAC1D,KAAK,CAAC,UAAN,CAAiB,CAAE,KAAK,CAAC,SAAR,CAAmB,SAAS,CAAE,KAA9B,CAAjB,EACH,CAFD,CAIA,GAAM,CAAA,6BAA6B,CAAG,CAClC,OAAO,CAAE,OADyB,CAElC,SAAS,CAAE,SAFuB,CAAtC,CAKA,GAAM,CAAA,aAAa,CAA2C,QAAxD,CAAA,aAAwD,CAAC,KAAD,CAAwC,eACpE,QAAQ,CAAC,KAAD,CAD4D,wCAC3F,OAD2F,eAClF,UADkF,8BAEhE,QAAQ,CAAC,0BAA0B,CAAC,KAAK,CAAC,IAAN,CAAW,OAAZ,CAAqB,KAArB,CAA3B,CAFwD,yCAE3F,SAF2F,eAEhF,YAFgF,8BAGpE,QAAQ,CAAC,EAAD,CAH4D,yCAG3F,OAH2F,eAGlF,UAHkF,eAIlG,GAAM,CAAA,KAAK,CAA+B,CACtC,OAAO,CAAP,OADsC,CAEtC,SAAS,CAAT,SAFsC,CAGtC,OAAO,CAAP,OAHsC,CAKtC,UAAU,CAAV,UALsC,CAMtC,YAAY,CAAZ,YANsC,CAOtC,UAAU,CAAV,UAPsC,CAA1C,CAUA,KAAK,CAAC,SAAN,CACI,UAAK,CACD,YAAY,CAAC,0BAA0B,CAAC,KAAK,CAAC,IAAN,CAAW,OAAZ,CAAqB,KAArB,CAA3B,CAAZ,CACH,CAHL,CAII,CAAC,KAAD,CAJJ,EAdkG,GAqB1F,CAAA,4BArB0F,CAqB8E,KArB9E,CAqB1F,4BArB0F,CAqB5D,uBArB4D,CAqB8E,KArB9E,CAqB5D,uBArB4D,CAqBnC,iBArBmC,CAqB8E,KArB9E,CAqBnC,iBArBmC,CAqBhB,gBArBgB,CAqB8E,KArB9E,CAqBhB,gBArBgB,CAqBE,cArBF,CAqB8E,KArB9E,CAqBE,cArBF,CAqBkB,SArBlB,CAqB8E,KArB9E,CAqBkB,SArBlB,CAqB6B,QArB7B,CAqB8E,KArB9E,CAqB6B,QArB7B,CAqBuC,iBArBvC,CAqB8E,KArB9E,CAqBuC,iBArBvC,CAqB0D,eArB1D,CAqB8E,KArB9E,CAqB0D,eArB1D,CAuBlG,GAAM,CAAA,cAAc,CAAG,QAAjB,CAAA,cAAiB,CAAC,KAAD,CAAyC,CAAG,MAAO,CAAA,6BAA6B,CAAC,OAA9B,CAAsC,KAAtC,CAA6C,KAA7C,CAAoD,KAApD,CAAP,CAAoE,CAAvI,CACA,GAAM,CAAA,gBAAgB,CAAG,QAAnB,CAAA,gBAAmB,EAAK,CAAG,MAAO,CAAA,6BAA6B,CAAC,SAA9B,CAAwC,KAAxC,CAAP,CAAwD,CAAzF,CACA,GAAM,CAAA,SAAS,CAAG,KAAK,CAAC,SAAN,CAAkB,4BAAlB,CAAiD,uBAAnE,CACA,GAAM,CAAA,gBAAgB,cAAuC,KAAK,CAAC,SAAN,EAA7D,CACA,GAAM,CAAA,qBAAqB,cAAuC,KAAK,CAAC,SAAN,EAAlE,CACA,GAAM,CAAA,WAAW,CAAG,iBAAiB,GAAK,SAAtB,CAAkC,iBAAlC,CAAqD,IAAzE,CACA,GAAM,CAAA,UAAU,CAAG,gBAAgB,GAAK,SAArB,CAAiC,gBAAjC,CAAmD,IAAtE,CACA,GAAM,CAAA,WAAW,CAAG,iBAAiB,GAAK,SAAtB,CAAkC,iBAAlC,CAAqD,IAAzE,CACA,GAAM,CAAA,UAAU,CAAG,iBAAiB,GAAK,SAAtB,CAAkC,eAAlC,CAAmD,OAAtE,CAEA,GAAI,KAAK,CAAC,SAAN,EAAmB,CAAC,UAAxB,CAAoC,CAChC,MAAO,KAAP,CACH,CAED,mBACI,KAAA,CAAA,aAAA,CAAC,KAAK,CAAC,QAAP,CAAe,IAAf,CAEQ,cAAc,cACV,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,QAAA,CAAA,IAAA,cACI,KAAA,CAAA,aAAA,CAAA,QAAA,CAAA,CACI,SAAS,CAAE,UAAU,CAAC,qBAAD,CAAwB,SAAxB,CAAmC,KAAK,CAAC,OAAN,CAAgB,8BAAhB,CAAiD,EAApF,CAAwF,KAAK,CAAC,SAAN,CAAkB,+BAAlB,CAAoD,EAA5I,CADzB,CACwK,aACxJ,SAFhB,CAGI,OAAO,CAAE,cAHb,CAII,QAAQ,CAAE,QAJd,CAKI,GAAG,CAAE,gBALT,CAAA,CAOK,SAPL,CADJ,CAWQ,WAAW,eAAI,KAAA,CAAA,aAAA,CAAC,mBAAD,CAAoB,CAAC,SAAS,CAAE,UAAZ,CAAwB,OAAO,CAAE,aAAjC,CAAgD,MAAM,CAAE,gBAAxD,CAApB,CAA+F,SAA/F,CAXvB,CADU,cAgBV,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,QAAA,CAAA,IAAA,cACI,KAAA,CAAA,aAAA,CAAA,QAAA,CAAA,CACI,SAAS,CAAE,UAAU,CAAC,qBAAD,CAAwB,SAAxB,CAAmC,KAAK,CAAC,OAAN,CAAgB,8BAAhB,CAAiD,EAApF,CAAwF,KAAK,CAAC,SAAN,CAAkB,+BAAlB,CAAoD,EAA5I,CADzB,CACwK,aACxJ,SAFhB,CAGI,OAAO,CAAE,cAHb,CAII,QAAQ,CAAE,QAJd,CAKI,GAAG,CAAE,qBALT,CAAA,CADJ,CASQ,WAAW,eAAI,KAAA,CAAA,aAAA,CAAC,mBAAD,CAAoB,CAAC,SAAS,CAAE,UAAZ,CAAwB,OAAO,CAAE,aAAjC,CAAgD,MAAM,CAAE,gBAAxD,CAApB,CAA+F,SAA/F,CATvB,CAlBZ,CAiCQ,KAAK,CAAC,OAAN,CAAc,SAAd,EAA2B,WAA3B,cACA,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,CAAK,SAAS,CAAC,mCAAf,CAAA,cACI,KAAA,CAAA,aAAA,CAAC,KAAD,CAAM,CAAC,KAAK,CAAG,KAAK,CAAC,OAAN,CAAc,KAAvB,CAA+B,MAAM,CAAG,KAAK,CAAC,OAAN,CAAc,SAAtD,CAAkE,MAAM,CAAG,gBAA3E,CAAN,CACM,KAAK,CAAC,OAAN,CAAc,mBADpB,CADJ,CADA,CAMA,EAvCR,CADJ,CA4CH,CAjFD,CAmFA,GAAM,CAAA,0BAA0B,CAAG,QAA7B,CAAA,0BAA6B,CAAC,OAAD,CAAyB,KAAzB,CAAyE,IAChG,CAAA,SADgG,CAClF,KAAK,CAAC,IAD4E,CAChG,SADgG,CAGxG,GAAI,CAAC,SAAD,EAAc,CAAC,SAAS,CAAC,CAAD,CAA5B,CAAiC,CAC7B,MAAO,MAAP,CACH,CALuG,GAOhG,CAAA,iBAPgG,CAO1E,SAAS,CAAC,CAAD,CAPiE,CAOhG,iBAPgG,CASxG,GAAI,CAAC,iBAAD,EAAsB,iBAAiB,CAAC,MAAlB,GAA6B,CAAvD,CAA0D,CACtD,MAAO,MAAP,CACH,CAXuG,yCAa7E,iBAb6E,YAaxG,+CAA8C,IAAnC,CAAA,YAAmC,aAC1C,GAAI,YAAY,CAAC,SAAb,GAA2B,OAAO,CAAC,QAAvC,CAAiD,CAC7C,MAAO,KAAP,CACH,CACJ,CAjBuG,qDAmBxG,MAAO,MAAP,CACH,CApBD,CAsBA,GAAM,CAAA,gBAAgB,CAAG,QAAnB,CAAA,gBAAmB,CAAC,KAAD,CAAsC,MAAtC,CAAoF,IACjG,CAAA,SADiG,CACzE,KADyE,CACjG,SADiG,CACtF,QADsF,CACzE,KADyE,CACtF,QADsF,CAGzG,GAAI,SAAJ,CAAe,CACX,QAAQ,CAAG,SAAS,CAAC,MAAD,CAAS,KAAK,CAAC,QAAf,CAAZ,CAAuC,SAAS,CAAC,MAAD,CAAxD,CACH,CACJ,CAND,CAQA,GAAM,CAAA,cAAc,CAAG,QAAjB,CAAA,cAAiB,CAAC,KAAD,CAAsC,MAAtC,CAAkF,IAC7F,CAAA,OAD6F,CACjF,KADiF,CAC7F,OAD6F,CAGrG,GAAI,OAAJ,CAAa,CACT,OAAO,CAAC,MAAD,CAAP,CACH,CACJ,CAND,CAQA,GAAM,CAAA,aAAa,2FAAG,kBAAO,OAAP,CAA+B,KAA/B,CAAoE,KAApE,oNACV,mBADU,CACuB,KADvB,CACV,mBADU,CACW,OADX,CACuB,KADvB,CACW,OADX,MAGd,OAAO,CAAC,UAAR,EAAsB,CAAC,mBAHT,2BAIR,iBAJQ,CAIY,OAAO,CAAC,UAAR,CAAmB,MAAnB,CAA0B,SAAA,SAAS,QAAI,EAAE,SAAS,CAAC,cAAV,EAA4B,SAAS,CAAC,cAAV,CAAyB,KAAvD,CAAJ,EAAnC,CAJZ,MAMV,iBAAiB,CAAC,MAAlB,CAA2B,CANjB,2BAQV,cAAc,CAAC,KAAD,CAAQ,CAAE,MAAM,CAAE,kBAAV,CAA8B,iBAAiB,CAAE,iBAAjD,CAAR,CAAd,CARU,iCAUH,WAAW,CAAC,OAAZ,EAVG,aAcf,OAAO,CAAC,OAAR,CAAgB,IAAhB,CAAqB,eAdN,gCAeV,CAAC,KAAK,CAAC,IAAN,CAAW,SAAZ,EAAyB,KAAK,CAAC,IAAN,CAAW,SAAX,CAAqB,MAArB,GAAgC,CAf/C,4BAgBJ,YAhBI,CAgBW,KAAK,CAAC,cAhBjB,yBAiBa,CAAA,kBAAkB,CAAC,KAAD,CAjB/B,SAiBJ,QAjBI,qBAkBN,QAAQ,EAAI,QAAQ,CAAC,aAlBf,4BAmBJ,QAnBI,CAmBqB,CAC3B,UAAU,CAAE,QAAQ,CAAC,aADM,CAE3B,IAAI,CAAE,YAFqB,CAI3B,qBAAqB,CAAE,CAJI,CAK3B,EAAE,CAAE,CALuB,CAnBrB,2CA4BqB,CAAA,uBAAuB,CAAC,CAAE,aAAa,CAAE,OAAO,CAAC,aAAzB,CAAD,CAA2C,QAA3C,CA5B5C,SA4BA,YA5BA,iDA6BC,mBAAmB,CAAC,KAAD,CAAQ,KAAR,CAAe,YAAY,CAAC,EAA5B,CAAgC,OAAO,CAAC,QAAxC,CA7BpB,gEA+BN,GAAI,OAAO,CAAC,SAAZ,CAAuB,CACnB,OAAO,CAAC,SAAR,CAAkB,OAAlB,eACA,OAAO,CAAC,SAAR,CAAkB,KAAlB,CAAwB,6BAAxB,EACH,CACD,cAAc,CAAC,KAAD,CAAQ,CAAE,MAAM,CAAE,QAAV,CAAR,CAAd,CAnCM,wCAsCV,OAAO,CAAC,SAAR,CAAkB,KAAlB,CAAwB,iCAAxB,EAtCU,yEAyCH,mBAAmB,CAAC,KAAD,CAAQ,KAAR,CAAe,KAAK,CAAC,IAAN,CAAW,SAAX,CAAqB,CAArB,EAAwB,EAAvC,CAA2C,OAAO,CAAC,QAAnD,CAzChB,2CA6CX,WAAW,CAAC,OAAZ,EA7CW,0EAAH,kBAAb,CAAA,aAAa,sDAAnB,CAgDA,GAAM,CAAA,mBAAmB,2FAAG,kBAAO,KAAP,CAA4C,KAA5C,CAA+E,UAA/E,CAAmG,SAAnG,+JAChB,OADgB,CACJ,KADI,CAChB,OADgB,yCAIG,CAAA,kBAAkB,CAAC,KAAD,CAJrB,QAId,QAJc,qBAKhB,QAAQ,EAAI,QAAQ,CAAC,aALL,mDAMc,CAAA,aAAa,CAAC,CAAE,aAAa,CAAE,OAAO,CAAC,aAAzB,CAAD,CAA2C,UAA3C,CAAuD,CAAC,iBAAiB,CAAC,SAAD,CAAY,QAAQ,CAAC,aAArB,CAAoC,UAApC,CAAlB,CAAvD,CAN3B,QAMd,mBANc,gBAOpB,OAAO,CAAC,aAAR,CAAsB,MAAtB,CAA6B,wBAAwB,CAAC,EAAD,CAAK,IAAL,CAArD,CAAiE,CAAC,mBAAD,CAAjE,EACA,GAAI,OAAO,CAAC,SAAZ,CAAuB,CACnB,OAAO,CAAC,SAAR,CAAkB,KAAlB,sCAAsD,mBAAtD,GACH,CACD,KAAK,CAAC,YAAN,CAAmB,IAAnB,EACA,KAAK,CAAC,UAAN,CAAiB,CACb,KAAK,CAAE,SADM,CAEb,SAAS,CAAE,IAFE,CAEI,mBAAmB,CAAE,KAAK,CAAC,oBAAN,CAA6B,KAAK,CAAC,oBAAnC,CAA0D,wBAFnF,CAAjB,EAIA,gBAAgB,CAAC,KAAD,CAAQ,CAAE,MAAM,CAAE,OAAV,CAAR,CAAhB,CAhBoB,gCAkBhB,OAAO,CAAC,SAAR,CAAkB,KAAlB,oCAlBgB,6FAqBpB,GAAI,OAAO,CAAC,SAAZ,CAAuB,CACnB,OAAO,CAAC,SAAR,CAAkB,OAAlB,eACA,OAAO,CAAC,SAAR,CAAkB,KAAlB,yDACH,CAED,KAAK,CAAC,UAAN,CAAiB,CACb,KAAK,CAAE,QADM,CAEb,SAAS,CAAE,IAFE,CAEI,mBAAmB,CAAE,KAAK,CAAC,sBAF/B,CAAjB,EAIA,cAAc,CAAC,KAAD,CAAQ,CAAE,MAAM,CAAE,QAAV,CAAR,CAAd,CA9BoB,uEAAH,kBAAnB,CAAA,mBAAmB,2DAAzB,CAkCA,GAAM,CAAA,kBAAkB,2FAAG,kBAAO,OAAP,CAA+B,KAA/B,CAAoE,KAApE,mQACf,OADe,CAC4D,KAD5D,CACf,OADe,CACN,IADM,CAC4D,KAD5D,CACN,IADM,CACA,0BADA,CAC4D,KAD5D,CACA,0BADA,CAC4B,2BAD5B,CAC4D,KAD5D,CAC4B,2BAD5B,CAEf,SAFe,CAED,IAFC,CAEf,SAFe,CAGf,aAHe,CAGc,OAHd,CAGf,aAHe,CAGA,SAHA,CAGc,OAHd,CAGA,SAHA,KAKpB,OAAO,CAAC,OAAR,CAAgB,IAAhB,CAAqB,eALD,gCAMf,SAAS,EAAI,SAAS,CAAC,CAAD,CANP,4BAOT,YAPS,CAOM,SAAS,CAAC,CAAD,CAAT,CAAa,iBAAb,CAAgC,IAAhC,CAAqC,SAAA,IAAI,QAAI,CAAA,IAAI,CAAC,SAAL,GAAmB,OAAO,CAAC,QAA/B,EAAzC,CAPN,KASX,YATW,oEAWgB,CAAA,kBAAkB,CAAC,KAAD,CAXlC,SAWD,QAXC,wCAYoB,CAAA,gBAAgB,CAAC,CAAE,aAAa,CAAE,aAAjB,CAAD,CAAmC,SAAS,CAAC,CAAD,CAAT,CAAa,EAAhD,CAAoD,CAAC,YAAD,CAApD,CAZpC,SAYD,YAZC,gBAaP,GAAI,QAAJ,CAAc,CACV,OAAO,CAAC,aAAR,CAAsB,MAAtB,CAA6B,wBAAwB,CAAC,EAAD,CAAK,IAAL,CAArD,CAAiE,CAAC,YAAD,CAAjE,EACH,CAFD,IAEO,CACH,SAAS,CAAC,KAAV,CAAgB,iCAAhB,EACH,CAED,GAAI,SAAJ,CAAe,CACX,SAAS,CAAC,KAAV,4BAAoC,OAAO,CAAC,QAA5C,mCAA8E,YAAY,CAAC,EAA3F,GACH,CACD,KAAK,CAAC,YAAN,CAAmB,KAAnB,EACA,KAAK,CAAC,UAAN,CAAiB,CACb,KAAK,CAAE,SADM,CAEb,SAAS,CAAE,IAFE,CAEI,mBAAmB,CAAE,0BAA0B,CAAG,0BAAH,iCAFnD,CAAjB,EAIA,gBAAgB,CAAC,KAAD,CAAQ,CAAE,MAAM,CAAE,SAAV,CAAR,CAAhB,CA3BO,qFA6BP,GAAI,SAAJ,CAAe,CACX,SAAS,CAAC,OAAV,eACA,SAAS,CAAC,KAAV,CAAgB,wDAAhB,EACH,CAED,KAAK,CAAC,UAAN,CAAiB,CACb,KAAK,CAAE,QADM,CAEb,mBAAmB,CAAE,2BAFR,CAAjB,EAIA,cAAc,CAAC,KAAD,CAAQ,CAAE,MAAM,CAAE,QAAV,CAAR,CAAd,CAtCO,wCA0Cf,GAAI,SAAJ,CAAe,CACX,SAAS,CAAC,KAAV,CAAgB,oGAAhB,EACH,CA5Cc,yCAgDhB,WAAW,CAAC,OAAZ,EAhDgB,yEAAH,kBAAlB,CAAA,kBAAkB,yDAAxB,CAmDA,GAAM,CAAA,kBAAkB,CAAG,QAArB,CAAA,kBAAqB,CAAC,KAAD,CAA8D,IAC7E,CAAA,OAD6E,CACjE,KADiE,CAC7E,OAD6E,CAErF,GAAM,CAAA,aAAa,CAAG,GAAI,CAAA,gBAAJ,CAAqB,OAAO,CAAC,aAAR,CAAsB,cAAtB,CAAqC,WAA1D,CAAtB,CACA,MAAO,CAAA,WAAW,CAAC,aAAD,CAAgB,OAAO,CAAC,aAAxB,CAAlB,CACH,CAJD,CAOA,MAAO,IAAM,CAAA,sBAAsB,CAA0D,gBAAgB,CAAC,eAAjB,CACzF,eADyF,gBAEvF,SAAS,CAAE,aAF4E,EAE1D,6BAF0D,EAAtF","sourcesContent":["import classnames from 'classnames';\nimport * as Popper from 'popper.js';\nimport React, { useState } from 'react';\n\nimport { buildWishlistLine, getCustomer, GetCustomerInput } from '@msdyn365-commerce-modules/retail-actions';\nimport { Alert, UncontrolledTooltip } from '@msdyn365-commerce-modules/utilities';\nimport { IComponent, IComponentProps, msdyn365Commerce } from '@msdyn365-commerce/core';\nimport { AsyncResult, CartLine, CommerceList, Customer, ProductDimension, SimpleProduct } from '@msdyn365-commerce/retail-proxy';\nimport {\n    addLinesAsync, createCommerceListAsync, createGetByCustomerInput, removeLinesAsync\n} from '@msdyn365-commerce/retail-proxy/dist/DataActions/CommerceListsDataActions.g';\n\nexport interface IAddToWishlistComponentProps extends IComponentProps<IAddtoWishlistData> {\n    className?: string;\n    addToWishlistButtonText: string;\n    removeFromWishlistButtonText: string;\n    nameOfWishlist: string;\n\n    addToWishlistMessage?: string;\n    removedFromWishlistMessage?: string;\n    addItemToWishlistError?: string;\n    removeItemFromWishlistError?: string;\n\n    showButtonText?: boolean;\n    showButtonTooltip?: boolean;\n    tooltipPosition?: Popper.Placement;\n    showStatusMessage?: boolean;\n    showRemoveButton?: boolean;\n    disabled?: boolean;\n    cartline?: CartLine;\n    canAddMasterProduct?: boolean;\n\n    getSelectedProduct?: Promise<SimpleProduct | null>;\n\n    onSuccess?(result: IWishlistActionSuccessResult, cartline?: CartLine): void;\n    onError?(result: IWishlistActionErrorResult): void;\n}\n\nexport interface IWishlistActionSuccessResult {\n    status: 'ADDED' | 'REMOVED';\n}\n\nexport interface IWishlistActionErrorResult {\n    status: 'FAILED' | 'MISSINGDIMENSION';\n\n    missingDimensions?: ProductDimension[];\n}\n\ninterface IAddToWishlistStateManager {\n    waiting: boolean;\n    canRemove: boolean;\n    content: IAddtoWishlistContentState;\n\n    setWaiting(newWaiting: boolean): void;\n    setContent(newContent: IAddtoWishlistContentState): void;\n    setCanRemove(newCanRemove: boolean): void;\n}\n\ninterface IAddtoWishlistContentState {\n    showAlert?: boolean;\n    wishlistTextMessage?: string;\n    color?: string;\n}\n\ninterface IAddtoWishlistData {\n    wishlists?: CommerceList[];\n    product: SimpleProduct;\n}\n\nexport interface IAddtoWishlistComponent extends IComponent<IAddToWishlistComponentProps> {\n    onClick(): (event: React.MouseEvent<HTMLElement>, props: IAddToWishlistComponentProps, state: IAddToWishlistStateManager) => void;\n}\n\nconst onClick = async (_event: React.MouseEvent<HTMLElement>, props: IAddToWishlistComponentProps, state: IAddToWishlistStateManager): Promise<void> => {\n    const { user } = props.context.request;\n    let { product } = props.data;\n\n    if (state.waiting) {\n        return;\n    }\n\n    if (!user.isAuthenticated && user.signInUrl && window) {\n        window.location.assign(user.signInUrl);\n\n        return;\n    }\n\n    state.setWaiting(true);\n    if(!(props.getSelectedProduct === undefined)) {\n        product = (await props.getSelectedProduct) || props.data.product;\n    }\n\n    await (doesProductExistInWishlist(product, props) ? removeFromWishlist(product, props, state) : addToWishlist(product, props, state));\n    state.setWaiting(false);\n};\n\nconst onDismiss = (state: IAddToWishlistStateManager): void => {\n    state.setContent({ color:'success', showAlert: false });\n};\n\nconst AddToWishlistComponentActions = {\n    onClick: onClick,\n    onDismiss: onDismiss\n};\n\nconst AddToWishlist: React.FC<IAddToWishlistComponentProps> = (props: IAddToWishlistComponentProps) => {\n    const [waiting, setWaiting] = useState(false);\n    const [canRemove, setCanRemove] = useState(doesProductExistInWishlist(props.data.product, props));\n    const [content, setContent] = useState({});\n    const state: IAddToWishlistStateManager = {\n        waiting,\n        canRemove,\n        content,\n\n        setWaiting,\n        setCanRemove,\n        setContent\n    };\n\n    React.useEffect(\n        () => {\n            setCanRemove(doesProductExistInWishlist(props.data.product, props));\n        },\n        [props]\n    );\n\n    const { removeFromWishlistButtonText, addToWishlistButtonText, showStatusMessage, showRemoveButton, showButtonText, className, disabled, showButtonTooltip, tooltipPosition } = props;\n\n    const onClickHandler = (event: React.MouseEvent<HTMLElement>) => { return AddToWishlistComponentActions.onClick(event, props, state); };\n    const onDismissHandler = () => { return AddToWishlistComponentActions.onDismiss(state); };\n    const ariaLabel = state.canRemove ? removeFromWishlistButtonText : addToWishlistButtonText;\n    const addToWishlistRef: React.RefObject<HTMLButtonElement> = React.createRef();\n    const removeFromWishlistRef: React.RefObject<HTMLButtonElement> = React.createRef();\n    const showMessage = showStatusMessage !== undefined ? showStatusMessage: true;\n    const showButton = showRemoveButton !== undefined ? showRemoveButton: true;\n    const showTooltip = showButtonTooltip !== undefined ? showButtonTooltip: true;\n    const tooltipPos = showButtonTooltip !== undefined ? tooltipPosition: 'right';\n\n    if (state.canRemove && !showButton) {\n        return null;\n    }\n\n    return (\n        <React.Fragment>\n            {\n                showButtonText ? (\n                    <>\n                        <button\n                            className={classnames('msc-add-to-wishlist', className, state.waiting ? 'msc-add-to-wishlist__waiting' : '', state.canRemove ? 'msc-add-to-wishlist__removing' : '')}\n                            aria-label={ariaLabel}\n                            onClick={onClickHandler}\n                            disabled={disabled}\n                            ref={addToWishlistRef}\n                        >\n                            {ariaLabel}\n                        </button>\n                        {\n                            showTooltip && <UncontrolledTooltip placement={tooltipPos} trigger={'hover focus'} target={addToWishlistRef}>{ariaLabel}</UncontrolledTooltip>\n                        }\n                    </>\n                ):(\n                    <>\n                        <button\n                            className={classnames('msc-add-to-wishlist', className, state.waiting ? 'msc-add-to-wishlist__waiting' : '', state.canRemove ? 'msc-add-to-wishlist__removing' : '')}\n                            aria-label={ariaLabel}\n                            onClick={onClickHandler}\n                            disabled={disabled}\n                            ref={removeFromWishlistRef}\n                        />\n                        {\n                            showTooltip && <UncontrolledTooltip placement={tooltipPos} trigger={'hover focus'} target={addToWishlistRef}>{ariaLabel}</UncontrolledTooltip>\n                        }\n                    </>\n                )\n            }\n            {\n                state.content.showAlert && showMessage ?\n                <div className='ms-wishlist-items__product-status'>\n                    <Alert color={ state.content.color } isOpen={ state.content.showAlert } toggle={ onDismissHandler }>\n                        { state.content.wishlistTextMessage }\n                    </Alert>\n                </div> :\n                ''\n            }\n        </React.Fragment>\n    );\n};\n\nconst doesProductExistInWishlist = (product: SimpleProduct, props: IAddToWishlistComponentProps): boolean => {\n    const { wishlists } = props.data;\n\n    if (!wishlists || !wishlists[0]) {\n        return false;\n    }\n\n    const { CommerceListLines } = wishlists[0];\n\n    if (!CommerceListLines || CommerceListLines.length === 0) {\n        return false;\n    }\n\n    for (const wishlistItem of CommerceListLines) {\n        if (wishlistItem.ProductId === product.RecordId) {\n            return true;\n        }\n    }\n\n    return false;\n};\n\nconst propogateSuccess = (props: IAddToWishlistComponentProps, result: IWishlistActionSuccessResult): void => {\n    const { onSuccess, cartline } = props;\n\n    if (onSuccess) {\n        cartline ? onSuccess(result, props.cartline) : onSuccess(result);\n    }\n};\n\nconst propogateError = (props: IAddToWishlistComponentProps, result: IWishlistActionErrorResult): void => {\n    const { onError } = props;\n\n    if (onError) {\n        onError(result);\n    }\n};\n\nconst addToWishlist = async (product: SimpleProduct, props: IAddToWishlistComponentProps, state: IAddToWishlistStateManager): Promise<void> => {\n    const { canAddMasterProduct, context } = props;\n\n    if (product.Dimensions && !canAddMasterProduct) {\n        const missingDimensions = product.Dimensions.filter(dimension => !(dimension.DimensionValue && dimension.DimensionValue.Value));\n\n        if (missingDimensions.length > 0) {\n            // At least one dimension with no value exists on the product, won't be able to add to cart\n            propogateError(props, { status: 'MISSINGDIMENSION', missingDimensions: missingDimensions });\n\n            return AsyncResult.resolve();\n        }\n    }\n\n    if(context.request.user.isAuthenticated) {\n        if (!props.data.wishlists || props.data.wishlists.length === 0) {\n            const wishlistName = props.nameOfWishlist;\n            const customer = await getCustomerAccount(props);\n            if (customer && customer.AccountNumber) {\n            const listData: CommerceList = {\n                CustomerId: customer.AccountNumber,\n                Name: wishlistName,\n                // This is the type value specifically for a wishlist\n                CommerceListTypeValue: 1,\n                Id: 0\n            };\n\n            try {\n                const commerceList = await createCommerceListAsync({ callerContext: context.actionContext }, listData);\n                return callAddWishlistLine(props, state, commerceList.Id, product.RecordId);\n            } catch (error) {\n                if (context.telemetry) {\n                    context.telemetry.warning(error);\n                    context.telemetry.debug('Unable to create a wishlist');\n                }\n                propogateError(props, { status: 'FAILED' });\n            }\n        } else {\n            context.telemetry.debug('Customer account number missing');\n        }\n        } else {\n            return callAddWishlistLine(props, state, props.data.wishlists[0].Id, product.RecordId);\n        }\n    }\n\n    return AsyncResult.resolve();\n};\n\nconst callAddWishlistLine = async (props: IAddToWishlistComponentProps, state: IAddToWishlistStateManager, wishlistId: number, productId: number): Promise<void> => {\n    const { context } = props;\n\n    try {\n        const customer = await getCustomerAccount(props);\n        if (customer && customer.AccountNumber) {\n        const createdCommerceList = await addLinesAsync({ callerContext: context.actionContext }, wishlistId, [buildWishlistLine(productId, customer.AccountNumber, wishlistId)]);\n        context.actionContext.update(createGetByCustomerInput({}, null), [createdCommerceList]);\n        if (context.telemetry) {\n            context.telemetry.debug(`Added item to the wishlist ${createdCommerceList}`);\n        }\n        state.setCanRemove(true);\n        state.setContent({\n            color: 'success',\n            showAlert: true, wishlistTextMessage: props.addToWishlistMessage ? props.addToWishlistMessage : 'Added to your wishlist'\n        });\n        propogateSuccess(props, { status: 'ADDED' });\n        } else {\n            context.telemetry.debug(`Customer Account number missing`);\n        }\n    } catch (error) {\n        if (context.telemetry) {\n            context.telemetry.warning(error);\n            context.telemetry.debug(`Unable to add item to wishlist ${error}`);\n        }\n\n        state.setContent({\n            color: 'danger',\n            showAlert: true, wishlistTextMessage: props.addItemToWishlistError\n        });\n        propogateError(props, { status: 'FAILED' });\n    }\n};\n\nconst removeFromWishlist = async (product: SimpleProduct, props: IAddToWishlistComponentProps, state: IAddToWishlistStateManager): Promise<void> => {\n    const { context, data, removedFromWishlistMessage, removeItemFromWishlistError } = props;\n    const { wishlists } = data;\n    const { actionContext, telemetry } = context;\n    // TODO Please fix customeraccount number null once Bug https://msdyneng.visualstudio.com/FinOps/_workitems/edit/481375 gets fixed.\n    if(context.request.user.isAuthenticated) {\n        if (wishlists && wishlists[0]) {\n            const wishlistLine = wishlists[0].CommerceListLines!.find(line => line.ProductId === product.RecordId);\n\n            if (wishlistLine) {\n                try {\n                    const customer = await getCustomerAccount(props);\n                    const commerceList = await removeLinesAsync({ callerContext: actionContext }, wishlists[0].Id, [wishlistLine]);\n                    if (customer) {\n                        context.actionContext.update(createGetByCustomerInput({}, null), [commerceList]);\n                    } else {\n                        telemetry.debug('Customer Account Number missing');\n                    }\n\n                    if (telemetry) {\n                        telemetry.debug(`[WishlistButton] ${product.RecordId} removed from Wishlist ${commerceList.Id}`);\n                    }\n                    state.setCanRemove(false);\n                    state.setContent({\n                        color: 'success',\n                        showAlert: true, wishlistTextMessage: removedFromWishlistMessage ? removedFromWishlistMessage : `Removed item from the wishlist`\n                    });\n                    propogateSuccess(props, { status: 'REMOVED' });\n                } catch (error) {\n                    if (telemetry) {\n                        telemetry.warning(error);\n                        telemetry.debug('[WishlistButton] Error removing item from the wishlist');\n                    }\n\n                    state.setContent({\n                        color: 'danger',\n                        wishlistTextMessage: removeItemFromWishlistError\n                    });\n                    propogateError(props, { status: 'FAILED' });\n                }\n            }\n        } else {\n            if (telemetry) {\n                telemetry.debug('[WishlistButton] Can\\'t remove from wishlist since no wishlist exisits OR there is no product data');\n            }\n        }\n}\n\n    return AsyncResult.resolve();\n};\n\nconst getCustomerAccount = (props: IAddToWishlistComponentProps):AsyncResult<Customer> => {\n    const { context } = props;\n    const customerInput = new GetCustomerInput(context.actionContext.requestContext.apiSettings);\n    return getCustomer(customerInput, context.actionContext);\n};\n\n// @ts-ignore\nexport const AddToWishlistComponent: React.FunctionComponent<IAddToWishlistComponentProps> = msdyn365Commerce.createComponent<IAddtoWishlistComponent>(\n    'AddToWishlist',\n    { component: AddToWishlist, ...AddToWishlistComponentActions }\n);"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}