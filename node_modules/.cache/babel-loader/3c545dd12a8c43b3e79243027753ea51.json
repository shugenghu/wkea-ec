{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/esm/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}var SearchResultContainer_1;import{__decorate}from\"tslib\";import{getTelemetryObject,LabeledDropdown,UncontrolledPagination}from'@msdyn365-commerce-modules/utilities';import MsDyn365 from'@msdyn365-commerce/core';import{format}from'@msdyn365-commerce/retail-proxy';import classnames from'classnames';import{computed,observable,reaction,transaction}from'mobx';import{observer}from'mobx-react';import*as React from'react';import{buildListPageUrl,getCollectionProducts,getCurrentUrl,GetFullProductsByCollectionInput,parseQueryParam,sortOptions}from'./actions';import{ErrorMessage,FeatureSearchResultItem,getUpdatedRefinementCriteria,isMatchingRefinementCriterion,Link,ModalToggle,ProductSearchResultItems,SearchResultModal,Separator,Title}from'./components';import ChoiceSummary from'./components/choice-summary';import RefineSubmenu from'./components/refine-submenu';var SearchResultContainer=SearchResultContainer_1=/*#__PURE__*/function(_React$PureComponent){_inherits(SearchResultContainer,_React$PureComponent);var _super=_createSuper(SearchResultContainer);function SearchResultContainer(props,state){var _this$props$context$r2;var _this;_classCallCheck(this,SearchResultContainer);_this=_super.call(this,props);_this.sortByDropdownOptions=[{key:sortOptions.sortByOptionRelevanceDesc,value:_this.props.resources.sortByOptionRelevanceDesc},{key:sortOptions.sortByOptionNameAsc,value:_this.props.resources.sortByOptionNameAsc},{key:sortOptions.sortByOptionNameDesc,value:_this.props.resources.sortByOptionNameDesc},{key:sortOptions.sortByOptionPriceAsc,value:_this.props.resources.sortByOptionPriceAsc},{key:sortOptions.sortByOptionPriceDesc,value:_this.props.resources.sortByOptionPriceDesc},{key:sortOptions.sortByOptionRatingDesc,value:_this.props.resources.sortByOptionRatingDesc}];_this._pageType=_this.props.context.request.urlTokens.pageType;_this.expandrefinerCount=0;_this._getSearchResultModal=function(){var resources=_this.props.resources;return SearchResultModal({resources:{modalCloseButtonText:resources.modalCloseButtonText,modalTitle:resources.modalTitle},isOpen:_this.state.modalIsOpen,returnRef:_this._modalToggleRef,onModalToggle:_this._toggleModal});};_this._getCollectionTitle=function(){var _this$props=_this.props,data=_this$props.data,context=_this$props.context,resources=_this$props.resources;var collectionTitle='';if(context&&context.request&&context.request.query&&context.request.query.q){collectionTitle=\"\\\"\".concat(context.request.query.q,\"\\\"\");}else{collectionTitle=data.category.result&&SearchResultContainer_1.getFriendlyName(context.request.locale,data.category.result.NameTranslations)||data.category.result&&data.category.result.Name;}var productCountText='';var productCountNumber;if(data.listPageState&&data.listPageState.result&&data.listPageState.result.totalProductCount!==undefined){productCountNumber=data.listPageState.result.totalProductCount;}else if(data.products&&data.products.result){productCountNumber=data.products.result.count;}if(productCountNumber&&productCountNumber!==0){productCountText=productCountNumber!==1?format(_this.props.resources.numberOfProducts,productCountNumber):_this.props.resources.oneProduct;}else{productCountText=format(_this.props.resources.numberOfProducts,0);}var titlePrefix=/*#__PURE__*/React.createElement(Title,{className:'ms-search-result__collection-title-prefix',text:resources.searchTextPrefix});var titleText=collectionTitle&&/*#__PURE__*/React.createElement(Title,{className:'ms-search-result__collection-title-text',text:collectionTitle});var titleCount=/*#__PURE__*/React.createElement(Title,{className:'ms-search-result__collection-title-count',text:productCountText});return{TitleContainer:{className:'ms-search-result-container__title'},title:{titlePrefix:titlePrefix,titleText:titleText,titleCount:titleCount}};};_this._getCategoryHierarchy=function(){var data=_this.props.data;var categoryHierarchy=data.categoryHierarchy.result;var categoryLinks=categoryHierarchy&&categoryHierarchy.map(function(value,index){return/*#__PURE__*/React.createElement(Link,{key:index,text:value.Name,ariaLabel:\"\".concat(_this.props.resources.categoryLinkAriaLabel,\" \").concat(value.Name),href:value.Url});});var categoryLinkSeparator=/*#__PURE__*/React.createElement(Separator,{separator:'/'});return{CategoryHierarchyContainer:{tag:'nav',className:'ms-search-result-container__category-hierarchy'},categoryHierarchyList:categoryLinks,categoryHierarchySeparator:categoryLinkSeparator};};_this._getSortingDropDown=function(){var resources=_this.props.resources;var activeDropdown=_this._getCurrentlySelectedOption()||_this.state.sortingState.selectedSortByOption;var dropdown=/*#__PURE__*/React.createElement(LabeledDropdown,{labelClassname:'reviews-list-sort-by',labelText:resources.sortByDropdownLabel,dropdownId:'categorySortByDropdown',dropdownClassname:'reviews-list-dropdown',toggleColor:'link',dropdownOptions:_this.sortByDropdownOptions,selectedOption:activeDropdown,onSelectOption:_this._updateSortByDropdown,ref:_this._sortAndFilterContainerRef});return{SortingContainer:{className:'ms-search-result-container__Sort-by-category'},sortByDropDown:dropdown};};_this._getPagination=function(){var _this$props2=_this.props,config=_this$props2.config,context=_this$props2.context,data=_this$props2.data,resources=_this$props2.resources;var listPageState=data&&data.listPageState&&data.listPageState.result;var fullUrl=getCurrentUrl(context.request);var itemsPerPage=config.itemsPerPage||10;var skipCount=listPageState&&listPageState.currentPageNumber!==null?listPageState.currentPageNumber*(_this.props.config.itemsPerPage||10):_this.props.context.request.query&&+_this.props.context.request.query.skip||0;var totalItems=listPageState&&listPageState.totalProductCount||0;var previousText=resources.flipperPrevious;var nextText=resources.flipperNext;if(totalItems<=itemsPerPage){return null;}return/*#__PURE__*/React.createElement(UncontrolledPagination,{className:'ms-search-result-container__pagination',role:'navigation',\"aria-label\":resources.paginationAriaLabel,url:fullUrl.href,qsp:'skip',items:totalItems,itemsPerPage:itemsPerPage,startingItem:skipCount,previousText:/*#__PURE__*/React.createElement(\"div\",{className:'msc-pagination__prev'},/*#__PURE__*/React.createElement(\"span\",{className:'ms-search-result__pagination-left',\"aria-hidden\":'true'}),/*#__PURE__*/React.createElement(\"span\",{className:'prev-text'},previousText)),nextText:/*#__PURE__*/React.createElement(\"div\",{className:'msc-pagination__next'},/*#__PURE__*/React.createElement(\"span\",{className:'next-text'},nextText),/*#__PURE__*/React.createElement(\"span\",{className:'ms-search-result__pagination-right',\"aria-hidden\":'true'})),previousAriaLabel:previousText,nextAriaLabel:nextText,telemetryContent:_this.telemetryContent});};_this._getRefineMenu=function(){var _this$props3=_this.props,data=_this$props3.data,context=_this$props3.context,config=_this$props3.config;var tempRangeTypeTODO=context.request.query&&context.request.query.inputRange?'input':'slider';var validRefiners=data.refiners.result&&data.refiners.result.filter(function(refiner){return refiner.Values.length>0;});var activeRefiners=data.listPageState.result&&data.listPageState.result.activeFilters||[];_this._getexpandRefinerCount(config.expandRefinersCount);var refinelist=_this.expandrefinerCount===undefined?0:_this.expandrefinerCount;var expandedRefiners=refinelist===0?validRefiners&&validRefiners.length:refinelist;var subMenus=validRefiners&&validRefiners.map(function(productRefinerHierarchy,index){return data.listPageState.result.totalProductCount!==0?/*#__PURE__*/React.createElement(RefineSubmenu,{productRefinerHierarchy:productRefinerHierarchy,selectedRefinerValues:activeRefiners,refineItemCommonProps:_this._refineItemCommonProps,minValueSliderThumbAriaLabel:_this.props.resources.minValueSliderThumbAriaLabel,maxValueSliderThumbAriaLabel:_this.props.resources.maxValueSliderThumbAriaLabel,key:index,onUpdateRefiners:_this._onUpdateRefiners,urlBuilder:_this._buildRefinerUrl,isDisabled:false,isExpandedOnInitialLoad:expandedRefiners&&expandedRefiners>index?true:false,tempRangeTypeTODO:tempRangeTypeTODO,context:context,moduleId:_this.props.id,moduleTypeName:_this.props.typeName,telemetryContent:_this.telemetryContent}):null;});return{RefineMenuContainer:{className:'ms-search-result-container__refine-menu'},RefinerSectionContainer:{className:'ms-search-result-container__refiner-section'},refiners:subMenus};};_this._getChoiceSummary=function(){var _this$props4=_this.props,resources=_this$props4.resources,data=_this$props4.data,telemetry=_this$props4.telemetry;var selectedRefiners=data.listPageState.result&&data.listPageState.result.activeFilters||[];return/*#__PURE__*/React.createElement(ChoiceSummary,{classNames:'ms-choice-summary-by-category',clearAllText:resources.clearAllText,label:resources.choiceSummaryLabel,selectedChoices:selectedRefiners,refinerHierarchy:data.refiners.result,choiceFormat:resources.choiceFormat,choiceRangeValueFormat:resources.choiceRangeValueFormat,telemetry:telemetry,onChoiceClicked:_this._onChoiceClicked,urlBuilder:_this._buildRefinerUrlForChoiceSummary,choiceAriaLabel:resources.choiceAriaLabel,telemetryContent:_this.telemetryContent});};_this._updateSortByDropdown=function(notification){var context=_this.props.context;var requestContext=context&&context.request;var actionContext=context&&context.actionContext;if(!requestContext||!actionContext||!_this.props.data.listPageState.result){var error=\"[sort-by-category] cannot sort without context: \".concat(!requestContext?'requestContext ':'',\" \").concat(!actionContext?'actionContext ':'',\" could not be found\");_this.props.telemetry.warning(error);}window.history.pushState({},'',buildListPageUrl(getCurrentUrl(_this.props.context.request),undefined,[_this._getSortColumnFromSelectedOption(notification.selectedOption)],undefined));transaction(function(){_this.props.data.listPageState.result.currentPageNumber=0;_this.props.data.listPageState.result.sortingCritera={Columns:[_this._getSortColumnFromSelectedOption(notification.selectedOption)]};});};_this._getSortColumnFromSelectedOption=function(option){var data=_this.props.data;if(!data.searchConfiguration.result){return{};}var mappedConfiguration=data.searchConfiguration.result.find(function(searchConfiguration){return searchConfiguration.key===option.key;});if(mappedConfiguration){return mappedConfiguration.sortColumn;}return{};};_this._getCurrentlySelectedOption=function(){var data=_this.props.data;var sortCriteria=data.listPageState.result&&data.listPageState.result.sortingCritera;var activeSortColumn=sortCriteria&&sortCriteria.Columns&&sortCriteria.Columns[0]||(parseQueryParam('sorting',_this.props.context.request)||[])[0];if(activeSortColumn&&data.searchConfiguration.result){var activeMappedConfig=data.searchConfiguration.result.find(function(mappedSearchConfig){return mappedSearchConfig.sortColumn.ColumnName===activeSortColumn.ColumnName&&mappedSearchConfig.sortColumn.IsDescending===activeSortColumn.IsDescending;});if(activeMappedConfig){return _this.sortByDropdownOptions.find(function(dropdownOption){return dropdownOption.key===activeMappedConfig.key;});}}return;};_this._onUpdateRefiners=function(itemToggleNotification){var context=_this.props.context;var requestContext=context&&context.request;var actionContext=context&&context.actionContext;if(!requestContext||!actionContext||!_this.props.data.listPageState.result){var error=\"Refine menu cannot refine search criteria: \".concat(!requestContext?'requestContext ':'',\" \").concat(!actionContext?'actionContext ':'',\" could not be found\");_this.props.telemetry.warning(error);}var updatedRefinementCriteria=getUpdatedRefinementCriteria(itemToggleNotification,_this.props.data.listPageState.result&&_this.props.data.listPageState.result.activeFilters||[]);window.history.pushState({},'',buildListPageUrl(getCurrentUrl(_this.props.context.request),updatedRefinementCriteria));transaction(function(){_this.props.data.listPageState.result.currentPageNumber=0;_this.props.data.listPageState.result.activeFilters=updatedRefinementCriteria;});};_this._buildRefinerUrl=function(itemToggleNotification){if(_this.props.data.listPageState.result){var newRefinementCriteria=getUpdatedRefinementCriteria(itemToggleNotification,_this.props.data.listPageState.result.activeFilters||[]);return buildListPageUrl(getCurrentUrl(_this.props.context.request),newRefinementCriteria);}else{_this.props.telemetry.warning(\"[buildRefinerQueryString]List Page State Not available, unable to build refiner URL\");return'';}};_this._onChoiceClicked=function(notification){var _this$props5=_this.props,data=_this$props5.data,telemetry=_this$props5.telemetry;if(!data.listPageState.result){telemetry.warning('[choice-summary-by-category._onChoiceClicked]ListPageState unavailable, unable to update refiners.');return;}var currentRefinementCriteria=data.listPageState.result&&data.listPageState.result.activeFilters||[];if(!notification.clearAll){var selectedChoice=notification.choiceClicked;if(!selectedChoice){telemetry.warning('[choice-summary-by-category._onChoiceClicked] Choice could not be determined');return;}currentRefinementCriteria=currentRefinementCriteria.filter(function(selectedCriterion){return!isMatchingRefinementCriterion(selectedChoice,selectedCriterion);});}else{currentRefinementCriteria=[];var dropdownElementId=_this._sortAndFilterContainerRef.current&&_this._sortAndFilterContainerRef.current.props.dropdownId;var dropdownElement=dropdownElementId&&document.getElementById(dropdownElementId);setTimeout(function(){dropdownElement&&dropdownElement.focus();},50);}var fullUrl=getCurrentUrl(_this.props.context.request);window.history.pushState({},'',buildListPageUrl(fullUrl,currentRefinementCriteria));data.listPageState.result.currentPageNumber=0;data.listPageState.result.activeFilters=currentRefinementCriteria;};_this._buildRefinerUrlForChoiceSummary=function(selectedRefiner,isClearAll){var _this$props6=_this.props,data=_this$props6.data,telemetry=_this$props6.telemetry;var fullUrl=getCurrentUrl(_this.props.context.request);if(!data.listPageState.result){telemetry.warning('[choice-summary-by-category._buildRefinerUrl]ListPageState unavailable, unable to create refiner URL.');return fullUrl.href;}var currentRefinementCriteria=data.listPageState.result&&data.listPageState.result.activeFilters||[];if(!isClearAll){if(!selectedRefiner){telemetry.warning('[choice-summary-by-category._buildRefinerUrl] URL for Choice could not be determined');return fullUrl.href;}currentRefinementCriteria=currentRefinementCriteria.filter(function(selectedCriterion){return!isMatchingRefinementCriterion(selectedRefiner,selectedCriterion);});}else{currentRefinementCriteria=[];}return buildListPageUrl(fullUrl,currentRefinementCriteria);};_this._getexpandRefinerCount=function(refinerCount){switch(refinerCount){case\"all\":_this.expandrefinerCount=0;break;case\"one\":_this.expandrefinerCount=1;break;case\"two\":_this.expandrefinerCount=2;break;case\"three\":_this.expandrefinerCount=3;break;case\"four\":_this.expandrefinerCount=4;break;default:_this.expandrefinerCount=0;}};_this._viewport=props.context.request&&props.context.request.device&&props.context.request.device.Type==='Mobile'?'xs':'lg';_this._modalToggleRef=/*#__PURE__*/React.createRef();_this._sortAndFilterContainerRef=/*#__PURE__*/React.createRef();_this._toggleModal=_this._toggleModal.bind(_assertThisInitialized(_this));_this._updateViewport=_this._updateViewport.bind(_assertThisInitialized(_this));_this.state={sortingState:{pending:false,selectedSortByOption:_this.sortByDropdownOptions[0]},modalIsOpen:false};var _this$props$resources=_this.props.resources,placeholderTextMax=_this$props$resources.placeholderTextMax,minLabel=_this$props$resources.minLabel,maxLabel=_this$props$resources.maxLabel,rangeNameFormat=_this$props$resources.rangeNameFormat;var locale=_this.props.context.request.locale;var telemetry=_this.props.telemetry;var validationErrorNaN=_this.props.resources.validationErrorNotNumber;var validationErrorRange=_this.props.resources.validationErrorNotRange;_this._refineItemCommonProps={telemetry:telemetry,locale:locale,placeholderTextMax:placeholderTextMax,minLabel:minLabel,maxLabel:maxLabel,rangeNameFormat:rangeNameFormat,validationErrorNaN:validationErrorNaN,validationErrorRange:validationErrorRange};_this.telemetryContent=getTelemetryObject(_this.props.context.request.telemetryPageName,_this.props.friendlyName,_this.props.telemetry);_this.props.data.products.then(function(products){_this.props.data.listPageState.then(function(listPageState){if(_this._pageType==='Category'){listPageState.pageType='Category';}else{listPageState.pageType='Search';}var querySorting=[];if(_this.props.context.request.query&&_this.props.context.request.query.sorting){querySorting=JSON.parse(decodeURIComponent(_this.props.context.request.query.sorting));}listPageState.currentPageNumber=_this.props.context.request.query&&+_this.props.context.request.query.skip/(_this.props.config.itemsPerPage||10)||0;listPageState.sortingCritera={Columns:querySorting};listPageState.pageSize=_this.props.config.itemsPerPage||10;listPageState.activeProducts=products.products;listPageState.totalProductCount=products.count;reaction(function(){return[listPageState.activeFilters&&listPageState.activeFilters.length,listPageState.currentPageNumber,listPageState.sortingCritera&&listPageState.sortingCritera.Columns&&listPageState.sortingCritera.Columns.length];},function(){var _this$props$context$r;var input=new GetFullProductsByCollectionInput(listPageState.pageType,_this.props.context.request.apiSettings,{Paging:{Top:_this.props.config.itemsPerPage,Skip:Math.max(listPageState.pageSize*(listPageState.currentPageNumber||0),0)},count:true,Sorting:listPageState.sortingCritera||{}},listPageState.activeFilters||[],+(_this.props.context.request.urlTokens.itemId||0),_this.props.context.request.query&&_this.props.context.request.query.q?_this.props.context.request.query.q:(_this$props$context$r=_this.props.context.request.query)===null||_this$props$context$r===void 0?void 0:_this$props$context$r.productId,_this.props&&_this.props.config&&_this.props.config.includeAttributes!==undefined&&_this.props.config.includeAttributes===true?true:false,_this.props.context.request.locale);getCollectionProducts(input,_this.props.context.actionContext).then(function(productResults){listPageState.activeProducts=productResults.products;listPageState.totalProductCount=productResults.count;});});});});if((_this$props$context$r2=_this.props.context.request.query)!==null&&_this$props$context$r2!==void 0&&_this$props$context$r2.productId){_this.props.data.featureProduct.then(function(products){_this.props.data.listPageState.then(function(listPageStateFeature){listPageStateFeature.featureProduct=products;});});}_this._updateViewport();return _this;}_createClass(SearchResultContainer,[{key:\"componentDidMount\",value:function componentDidMount(){if(MsDyn365.isBrowser&&window.addEventListener){window.addEventListener('resize',this._updateViewport);this._updateViewport();}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(MsDyn365.isBrowser&&window.removeEventListener){window.removeEventListener('resize',this._updateViewport);}}},{key:\"render\",value:function render(){var _this$props$config=this.props.config,imageSettings=_this$props$config.imageSettings,className=_this$props$config.className,allowBackNavigation=_this$props$config.allowBackNavigation;var resources=this.props.resources;var products=this.props.data.listPageState.result&&this.props.data.listPageState.result.activeProducts||[];var searchProduct=this.props.data.listPageState.result&&this.props.data.listPageState.result.featureProduct||null;var errorText='';var breaCrumbType=this.props.context.app.config.breadcrumbType;var allowBack=allowBackNavigation&&(breaCrumbType==='back'||breaCrumbType==='categoryAndBack');if(!products||products.length===0){errorText=this._pageType==='Category'?resources.resultCategoryNotFoundText:resources.resultSearchNotFoundText;}var productsComponent=/*#__PURE__*/React.createElement(ProductSearchResultItems,{products:products,context:this.props.context,imageSettings:imageSettings,resources:resources,moduleType:this.props.typeName,moduleId:this.props.id,allowBackNavigation:allowBack,telemetryContent:this.telemetryContent});var featureComponent=/*#__PURE__*/React.createElement(FeatureSearchResultItem,{product:searchProduct,context:this.props.context,imageSettings:imageSettings,resources:resources,moduleType:this.props.typeName,moduleId:this.props.id,telemetryContent:this.telemetryContent});var searchResultContainerViewProps=_objectSpread(_objectSpread({},this.props),{},{products:productsComponent,TitleViewProps:this._getCollectionTitle(),categoryHierarchy:!this.props.config.disableHierarchy&&this._getCategoryHierarchy(),refineMenu:this._getRefineMenu(),className:classnames('ms-search-result-container',className),SearchResultContainer:{moduleProps:this.props,className:classnames('ms-search-result-container',className)},sortByOptions:this.props.data.listPageState.result&&this.props.data.listPageState.result.totalProductCount!==0?this._getSortingDropDown():null,pagination:this._getPagination(),ProductsContainer:{className:'ms-search-result-container__Products'},ProductSectionContainer:{className:'ms-search-result-container__product-section'},CategoryNavContainer:{className:'ms-search-result-container__category-nav-section'},RefineAndProductSectionContainer:{className:'ms-search-result-container__refine-product-section'},choiceSummary:this._getChoiceSummary(),modalToggle:this.props.data.listPageState.result&&this.props.data.listPageState.result.totalProductCount!==0?/*#__PURE__*/React.createElement(ModalToggle,{text:resources.modalTitle,ariaLabel:resources.modalTitle,innerRef:this._modalToggleRef,onClick:this._toggleModal,id:'search-result-modal'}):null,searchResultModal:this._getSearchResultModal(),isMobile:this.isMobile,errorMessage:errorText&&/*#__PURE__*/React.createElement(ErrorMessage,{text:errorText}),FeatureSearchContainer:{className:'ms-feature-search-result'},similarLookProduct:this.props.data.listPageState.result&&this.props.data.listPageState.result.featureProduct!==null&&this.props.data.listPageState.result.featureProduct!==undefined?featureComponent:null});return this.props.renderView(searchResultContainerViewProps);}},{key:\"_getViewport\",value:function _getViewport(){var context=this.props.context;if(context.request&&context.request.device&&context.request.device.Type==='Mobile'){return'xs';}if(MsDyn365.isBrowser&&window.innerWidth){var gridSettings=context.request.gridSettings;if(gridSettings){if(gridSettings.xs&&window.innerWidth<=gridSettings.xs.w){return'xs';}else if(gridSettings.sm&&window.innerWidth<=gridSettings.sm.w){return'sm';}else if(gridSettings.md&&window.innerWidth<=gridSettings.md.w){return'md';}else if(gridSettings.lg&&window.innerWidth<=gridSettings.lg.w){return'lg';}else{return'xl';}}}return'lg';}},{key:\"_toggleModal\",value:function _toggleModal(){this.setState({modalIsOpen:!this.state.modalIsOpen});}},{key:\"_updateViewport\",value:function _updateViewport(){this._viewport=this._getViewport();if(this.state.modalIsOpen&&!this.isMobile){this._toggleModal();}}},{key:\"isMobile\",get:function get(){return this._viewport==='xs'||this._viewport==='sm';}}],[{key:\"getFriendlyName\",value:function getFriendlyName(locale,nameTranslations){var nameTranslation;if(locale&&nameTranslations&&nameTranslations.length>0){nameTranslation=nameTranslations.find(function(item){return item.Language.toLowerCase()===locale.toLowerCase();});}return nameTranslation&&nameTranslation.Text;}}]);return SearchResultContainer;}(React.PureComponent);__decorate([computed],SearchResultContainer.prototype,\"isMobile\",null);__decorate([observable],SearchResultContainer.prototype,\"_viewport\",void 0);SearchResultContainer=SearchResultContainer_1=__decorate([observer],SearchResultContainer);export default SearchResultContainer;","map":{"version":3,"sources":["modules/search-result-container/search-result-container.tsx"],"names":[],"mappings":"sgEAIA,OAAS,kBAAT,CAAwI,eAAxI,CAAyJ,sBAAzJ,KAAuL,sCAAvL,CAEA,MAAO,CAAA,QAAP,KAAqB,yBAArB,CACA,OAAS,MAAT,KAA8E,iCAA9E,CACA,MAAO,CAAA,UAAP,KAAuB,YAAvB,CACA,OAAS,QAAT,CAAmB,UAAnB,CAA+B,QAA/B,CAAyC,WAAzC,KAA4D,MAA5D,CACA,OAAS,QAAT,KAAyB,YAAzB,CACA,MAAO,GAAK,CAAA,KAAZ,KAAuB,OAAvB,CACA,OAAS,gBAAT,CAA2B,qBAA3B,CAAkD,aAAlD,CAAiE,gCAAjE,CAAmG,eAAnG,CAAoH,WAApH,KAAwI,WAAxI,CACA,OAAS,YAAT,CAAuB,uBAAvB,CAAgD,4BAAhD,CACyF,6BADzF,CACwH,IADxH,CAC8H,WAD9H,CAC2I,wBAD3I,CACqK,iBADrK,CACwL,SADxL,CACmM,KADnM,KACgN,cADhN,CAEA,MAAO,CAAA,aAAP,KAA0B,6BAA1B,CACA,MAAO,CAAA,aAAP,KAA0B,6BAA1B,CA2EA,GAAqB,CAAA,qBAAqB,CAAA,uBAA1C,kJAiCI,+BAAY,KAAZ,CAA4E,KAA5E,CAA8G,kFAC1G,uBAAM,KAAN,EA5BI,MAAA,qBAAA,CAAkD,CACtD,CAAE,GAAG,CAAE,WAAW,CAAC,yBAAnB,CAA8C,KAAK,CAAE,MAAK,KAAL,CAAW,SAAX,CAAqB,yBAA1E,CADsD,CAEtD,CAAE,GAAG,CAAE,WAAW,CAAC,mBAAnB,CAAwC,KAAK,CAAE,MAAK,KAAL,CAAW,SAAX,CAAqB,mBAApE,CAFsD,CAGtD,CAAE,GAAG,CAAE,WAAW,CAAC,oBAAnB,CAAyC,KAAK,CAAE,MAAK,KAAL,CAAW,SAAX,CAAqB,oBAArE,CAHsD,CAItD,CAAE,GAAG,CAAE,WAAW,CAAC,oBAAnB,CAAyC,KAAK,CAAE,MAAK,KAAL,CAAW,SAAX,CAAqB,oBAArE,CAJsD,CAKtD,CAAE,GAAG,CAAE,WAAW,CAAC,qBAAnB,CAA0C,KAAK,CAAE,MAAK,KAAL,CAAW,SAAX,CAAqB,qBAAtE,CALsD,CAMtD,CAAE,GAAG,CAAE,WAAW,CAAC,sBAAnB,CAA2C,KAAK,CAAE,MAAK,KAAL,CAAW,SAAX,CAAqB,sBAAvE,CANsD,CAAlD,CASA,MAAA,SAAA,CAAgC,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,SAA3B,CAAqC,QAArE,CAMA,MAAA,kBAAA,CAA6B,CAA7B,CAuMA,MAAA,qBAAA,CAAwB,UAAkC,IACvD,CAAA,SADuD,CAC1C,MAAK,KADqC,CACvD,SADuD,CAE9D,MAAO,CAAA,iBAAiB,CACpB,CACD,SAAS,CAAC,CACN,oBAAoB,CAAE,SAAS,CAAC,oBAD1B,CAEN,UAAU,CAAE,SAAS,CAAC,UAFhB,CADT,CAKD,MAAM,CAAC,MAAK,KAAL,CAAW,WALjB,CAMD,SAAS,CAAE,MAAK,eANf,CAOD,aAAa,CAAE,MAAK,YAPnB,CADoB,CAAxB,CAUH,CAZO,CAcA,MAAA,mBAAA,CAAsB,UAAsB,iBACX,MAAK,KADM,CACxC,IADwC,aACxC,IADwC,CAClC,OADkC,aAClC,OADkC,CACzB,SADyB,aACzB,SADyB,CAGhD,GAAI,CAAA,eAAe,CAAuB,EAA1C,CACA,GAAI,OAAO,EAAI,OAAO,CAAC,OAAnB,EAA8B,OAAO,CAAC,OAAR,CAAgB,KAA9C,EAAuD,OAAO,CAAC,OAAR,CAAgB,KAAhB,CAAsB,CAAjF,CAAoF,CAChF,eAAe,aAAO,OAAO,CAAC,OAAR,CAAgB,KAAhB,CAAsB,CAA7B,MAAf,CACH,CAFD,IAEO,CACH,eAAe,CAAI,IAAI,CAAC,QAAL,CAAc,MAAd,EAAwB,uBAAqB,CAAC,eAAtB,CAAsC,OAAO,CAAC,OAAR,CAAgB,MAAtD,CAA8D,IAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,gBAAnF,CAAzB,EACb,IAAI,CAAC,QAAL,CAAc,MAAd,EAAwB,IAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,IADlD,CAEH,CACD,GAAI,CAAA,gBAAgB,CAAG,EAAvB,CACA,GAAI,CAAA,kBAAJ,CACA,GAAI,IAAI,CAAC,aAAL,EAAsB,IAAI,CAAC,aAAL,CAAmB,MAAzC,EAAmD,IAAI,CAAC,aAAL,CAAmB,MAAnB,CAA0B,iBAA1B,GAAgD,SAAvG,CAAkH,CAC9G,kBAAkB,CAAG,IAAI,CAAC,aAAL,CAAmB,MAAnB,CAA0B,iBAA/C,CACH,CAFD,IAEO,IAAI,IAAI,CAAC,QAAL,EAAiB,IAAI,CAAC,QAAL,CAAc,MAAnC,CAA2C,CAC9C,kBAAkB,CAAG,IAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,KAA1C,CACH,CAED,GAAI,kBAAkB,EAAI,kBAAkB,GAAK,CAAjD,CAAoD,CAChD,gBAAgB,CAAG,kBAAkB,GAAK,CAAvB,CAA2B,MAAM,CAAC,MAAK,KAAL,CAAW,SAAX,CAAqB,gBAAtB,CAAwC,kBAAxC,CAAjC,CAA+F,MAAK,KAAL,CAAW,SAAX,CAAqB,UAAvI,CACH,CAFD,IAEO,CACH,gBAAgB,CAAG,MAAM,CAAC,MAAK,KAAL,CAAW,SAAX,CAAqB,gBAAtB,CAAwC,CAAxC,CAAzB,CACH,CACD,GAAM,CAAA,WAAW,cAAG,KAAA,CAAA,aAAA,CAAC,KAAD,CAAM,CAAC,SAAS,CAAC,2CAAX,CAAuD,IAAI,CAAE,SAAS,CAAC,gBAAvE,CAAN,CAApB,CACA,GAAM,CAAA,SAAS,CAAG,eAAe,eAAI,KAAA,CAAA,aAAA,CAAC,KAAD,CAAM,CAAC,SAAS,CAAC,yCAAX,CAAqD,IAAI,CAAE,eAA3D,CAAN,CAArC,CACA,GAAM,CAAA,UAAU,cAAG,KAAA,CAAA,aAAA,CAAC,KAAD,CAAM,CAAC,SAAS,CAAC,0CAAX,CAAsD,IAAI,CAAE,gBAA5D,CAAN,CAAnB,CAEA,MAAO,CACH,cAAc,CAAE,CAAE,SAAS,CAAE,mCAAb,CADb,CAEH,KAAK,CAAC,CACN,WAAW,CAAE,WADP,CAEN,SAAS,CAAE,SAFL,CAGN,UAAU,CAAE,UAHN,CAFH,CAAP,CASH,CApCO,CAqCA,MAAA,qBAAA,CAAwB,UAAkC,IACtD,CAAA,IADsD,CAC7C,MAAK,KADwC,CACtD,IADsD,CAE9D,GAAM,CAAA,iBAAiB,CAAG,IAAI,CAAC,iBAAL,CAAuB,MAAjD,CACA,GAAM,CAAA,aAAa,CACf,iBAAiB,EAAI,iBAAiB,CAAC,GAAlB,CAAsB,SAAC,KAAD,CAA+B,KAA/B,CAAgD,CAEvF,mBACI,KAAA,CAAA,aAAA,CAAC,IAAD,CAAK,CACD,GAAG,CAAE,KADJ,CAED,IAAI,CAAE,KAAK,CAAC,IAFX,CAGD,SAAS,WAAK,MAAK,KAAL,CAAW,SAAX,CAAqB,qBAA1B,aAAmD,KAAK,CAAC,IAAzD,CAHR,CAID,IAAI,CAAE,KAAK,CAAC,GAJX,CAAL,CADJ,CAQH,CAVoB,CADzB,CAYA,GAAM,CAAA,qBAAqB,cAAG,KAAA,CAAA,aAAA,CAAC,SAAD,CAAU,CAAC,SAAS,CAAC,GAAX,CAAV,CAA9B,CAEA,MAAO,CACH,0BAA0B,CAAE,CAAE,GAAG,CAAE,KAAP,CAAc,SAAS,CAAE,gDAAzB,CADzB,CAEH,qBAAqB,CAAE,aAFpB,CAGH,0BAA0B,CAAE,qBAHzB,CAAP,CAMH,CAvBO,CAyBA,MAAA,mBAAA,CAAsB,UAAuB,IACzC,CAAA,SADyC,CAC3B,MAAK,KADsB,CACzC,SADyC,CAEjD,GAAM,CAAA,cAAc,CAAG,MAAK,2BAAL,IAAsC,MAAK,KAAL,CAAW,YAAX,CAAwB,oBAArF,CACA,GAAM,CAAA,QAAQ,cACd,KAAA,CAAA,aAAA,CAAC,eAAD,CAAgB,CACZ,cAAc,CAAC,sBADH,CAEZ,SAAS,CAAE,SAAS,CAAC,mBAFT,CAGZ,UAAU,CAAC,wBAHC,CAIZ,iBAAiB,CAAC,uBAJN,CAKZ,WAAW,CAAC,MALA,CAMZ,eAAe,CAAE,MAAK,qBANV,CAOZ,cAAc,CAAE,cAPJ,CAQZ,cAAc,CAAE,MAAK,qBART,CASZ,GAAG,CAAE,MAAK,0BATE,CAAhB,CADA,CAYA,MAAO,CACH,gBAAgB,CAAE,CAAE,SAAS,CAAE,8CAAb,CADf,CAEH,cAAc,CAAC,QAFZ,CAAP,CAIH,CAnBO,CAqBA,MAAA,cAAA,CAAiB,UAAsB,kBACE,MAAK,KADP,CACnC,MADmC,cACnC,MADmC,CAC3B,OAD2B,cAC3B,OAD2B,CAClB,IADkB,cAClB,IADkB,CACZ,SADY,cACZ,SADY,CAE3C,GAAM,CAAA,aAAa,CAAG,IAAI,EAAI,IAAI,CAAC,aAAb,EAA8B,IAAI,CAAC,aAAL,CAAmB,MAAvE,CACA,GAAM,CAAA,OAAO,CAAG,aAAa,CAAC,OAAO,CAAC,OAAT,CAA7B,CACA,GAAM,CAAA,YAAY,CAAG,MAAM,CAAC,YAAP,EAAuB,EAA5C,CACA,GAAM,CAAA,SAAS,CAAG,aAAa,EAAI,aAAa,CAAC,iBAAd,GAAoC,IAArD,CACb,aAAa,CAAC,iBAAd,EAAmC,MAAK,KAAL,CAAW,MAAX,CAAkB,YAAlB,EAAkC,EAArE,CADa,CAEZ,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,KAA3B,EAAoC,CAAC,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,KAA3B,CAAiC,IAAvE,EAAgF,CAFrF,CAGA,GAAM,CAAA,UAAU,CAAG,aAAa,EAAI,aAAa,CAAC,iBAA/B,EAAoD,CAAvE,CACA,GAAM,CAAA,YAAY,CAAG,SAAS,CAAC,eAA/B,CACA,GAAM,CAAA,QAAQ,CAAG,SAAS,CAAC,WAA3B,CACA,GAAI,UAAU,EAAI,YAAlB,CAAgC,CAC5B,MAAO,KAAP,CACH,CACD,mBACA,KAAA,CAAA,aAAA,CAAC,sBAAD,CAAuB,CACnB,SAAS,CAAC,wCADS,CAEnB,IAAI,CAAC,YAFc,CAEF,aACL,SAAS,CAAC,mBAHH,CAInB,GAAG,CAAE,OAAO,CAAC,IAJM,CAKnB,GAAG,CAAE,MALc,CAMnB,KAAK,CAAE,UANY,CAOnB,YAAY,CAAE,YAPK,CAQnB,YAAY,CAAE,SARK,CASnB,YAAY,cAAE,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,CAAK,SAAS,CAAC,sBAAf,CAAA,cAAsC,KAAA,CAAA,aAAA,CAAA,MAAA,CAAA,CAAM,SAAS,CAAC,mCAAhB,CAAmD,cAAa,MAAhE,CAAA,CAAtC,cAA8G,KAAA,CAAA,aAAA,CAAA,MAAA,CAAA,CAAM,SAAS,CAAC,WAAhB,CAAA,CAA6B,YAA7B,CAA9G,CATK,CAUnB,QAAQ,cAAE,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,CAAK,SAAS,CAAC,sBAAf,CAAA,cAAsC,KAAA,CAAA,aAAA,CAAA,MAAA,CAAA,CAAM,SAAS,CAAC,WAAhB,CAAA,CAA6B,QAA7B,CAAtC,cAAmF,KAAA,CAAA,aAAA,CAAA,MAAA,CAAA,CAAM,SAAS,CAAC,oCAAhB,CAAoD,cAAa,MAAjE,CAAA,CAAnF,CAVS,CAWnB,iBAAiB,CAAE,YAXA,CAYnB,aAAa,CAAE,QAZI,CAanB,gBAAgB,CAAE,MAAK,gBAbJ,CAAvB,CADA,CAgBH,CA9BO,CAgCA,MAAA,cAAA,CAAiB,UAA2B,kBACd,MAAK,KADS,CACxC,IADwC,cACxC,IADwC,CAClC,OADkC,cAClC,OADkC,CACzB,MADyB,cACzB,MADyB,CAEhD,GAAM,CAAA,iBAAiB,CAAG,OAAO,CAAC,OAAR,CAAgB,KAAhB,EAAyB,OAAO,CAAC,OAAR,CAAgB,KAAhB,CAAsB,UAA/C,CAA4D,OAA5D,CAAsE,QAAhG,CACA,GAAM,CAAA,aAAa,CAAG,IAAI,CAAC,QAAL,CAAc,MAAd,EAAwB,IAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,MAArB,CAA4B,SAAA,OAAO,CAAG,CAChF,MAAO,CAAA,OAAO,CAAC,MAAR,CAAe,MAAf,CAAwB,CAA/B,CACH,CAF6C,CAA9C,CAIA,GAAM,CAAA,cAAc,CAAI,IAAI,CAAC,aAAL,CAAmB,MAAnB,EAA6B,IAAI,CAAC,aAAL,CAAmB,MAAnB,CAA0B,aAAxD,EAA0E,EAAjG,CAEA,MAAK,sBAAL,CAA4B,MAAM,CAAC,mBAAnC,EACA,GAAM,CAAA,UAAU,CAAG,MAAK,kBAAL,GAA4B,SAA5B,CAAwC,CAAxC,CAA6C,MAAK,kBAArE,CACA,GAAM,CAAA,gBAAgB,CAAG,UAAU,GAAK,CAAf,CAAmB,aAAa,EAAI,aAAa,CAAC,MAAlD,CAA0D,UAAnF,CACA,GAAM,CAAA,QAAQ,CAAG,aAAa,EAAI,aAAa,CAAC,GAAd,CAAkB,SAAC,uBAAD,CAAoD,KAApD,CAAqE,CACrH,MAAQ,CAAA,IAAI,CAAC,aAAL,CAAmB,MAAnB,CAA2B,iBAA3B,GAAiD,CAAjD,cAEJ,KAAA,CAAA,aAAA,CAAC,aAAD,CAAc,CACV,uBAAuB,CAAE,uBADf,CAEV,qBAAqB,CAAE,cAFb,CAGV,qBAAqB,CAAE,MAAK,sBAHlB,CAIV,4BAA4B,CAAE,MAAK,KAAL,CAAW,SAAX,CAAqB,4BAJzC,CAKV,4BAA4B,CAAE,MAAK,KAAL,CAAW,SAAX,CAAqB,4BALzC,CAMV,GAAG,CAAE,KANK,CAOV,gBAAgB,CAAE,MAAK,iBAPb,CAQV,UAAU,CAAE,MAAK,gBARP,CASV,UAAU,CAAE,KATF,CAUV,uBAAuB,CAAE,gBAAgB,EAAI,gBAAgB,CAAG,KAAvC,CAA+C,IAA/C,CAAsD,KAVrE,CAWV,iBAAiB,CAAE,iBAXT,CAYV,OAAO,CAAI,OAZD,CAaV,QAAQ,CAAE,MAAK,KAAL,CAAW,EAbX,CAcV,cAAc,CAAE,MAAK,KAAL,CAAW,QAdjB,CAeV,gBAAgB,CAAE,MAAK,gBAfb,CAAd,CAFI,CAkBE,IAlBV,CAoBH,CArBiC,CAAlC,CAuBA,MAAO,CACH,mBAAmB,CAAC,CAAC,SAAS,CAAE,yCAAZ,CADjB,CAEH,uBAAuB,CAAC,CAAC,SAAS,CAAE,6CAAZ,CAFrB,CAGH,QAAQ,CAAE,QAHP,CAAP,CAMH,CAzCO,CA2CA,MAAA,iBAAA,CAAoB,UAAsB,kBACP,MAAK,KADE,CACtC,SADsC,cACtC,SADsC,CAC3B,IAD2B,cAC3B,IAD2B,CACrB,SADqB,cACrB,SADqB,CAE9C,GAAM,CAAA,gBAAgB,CAAI,IAAI,CAAC,aAAL,CAAmB,MAAnB,EAA6B,IAAI,CAAC,aAAL,CAAmB,MAAnB,CAA0B,aAAxD,EAA0E,EAAnG,CACA,mBACI,KAAA,CAAA,aAAA,CAAC,aAAD,CAAc,CACV,UAAU,CAAC,+BADD,CAEV,YAAY,CAAE,SAAS,CAAC,YAFd,CAGV,KAAK,CAAE,SAAS,CAAC,kBAHP,CAIV,eAAe,CAAE,gBAJP,CAMV,gBAAgB,CAAE,IAAI,CAAC,QAAL,CAAc,MANtB,CAOV,YAAY,CAAE,SAAS,CAAC,YAPd,CAQV,sBAAsB,CAAE,SAAS,CAAC,sBARxB,CASV,SAAS,CAAE,SATD,CAUV,eAAe,CAAE,MAAK,gBAVZ,CAWV,UAAU,CAAE,MAAK,gCAXP,CAYV,eAAe,CAAE,SAAS,CAAC,eAZjB,CAaV,gBAAgB,CAAE,MAAK,gBAbb,CAAd,CADJ,CAkBH,CArBO,CAuBA,MAAA,qBAAA,CAAwB,SAAC,YAAD,CAA6D,IACjF,CAAA,OADiF,CACrE,MAAK,KADgE,CACjF,OADiF,CAEzF,GAAM,CAAA,cAAc,CAAG,OAAO,EAAI,OAAO,CAAC,OAA1C,CACA,GAAM,CAAA,aAAa,CAAG,OAAO,EAAI,OAAO,CAAC,aAAzC,CAEA,GAAI,CAAC,cAAD,EAAmB,CAAC,aAApB,EAAqC,CAAC,MAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAAxE,CAAgF,CAC5E,GAAM,CAAA,KAAK,2DAAsD,CAAC,cAAD,CAAkB,iBAAlB,CAAsC,EAA5F,aAAkG,CAAC,aAAD,CAAiB,gBAAjB,CAAoC,EAAtI,uBAAX,CACA,MAAK,KAAL,CAAW,SAAX,CAAqB,OAArB,CAA6B,KAA7B,EACH,CAED,MAAM,CAAC,OAAP,CAAe,SAAf,CAAyB,EAAzB,CAA6B,EAA7B,CAAiC,gBAAgB,CAAC,aAAa,CAAC,MAAK,KAAL,CAAW,OAAX,CAAmB,OAApB,CAAd,CAA4C,SAA5C,CAAuD,CAAC,MAAK,gCAAL,CAAsC,YAAY,CAAC,cAAnD,CAAD,CAAvD,CAA6H,SAA7H,CAAjD,EACA,WAAW,CAAC,UAAK,CACb,MAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,CAAsC,iBAAtC,CAA0D,CAA1D,CACA,MAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,CAAsC,cAAtC,CAAuD,CAAE,OAAO,CAAE,CAAC,MAAK,gCAAL,CAAsC,YAAY,CAAC,cAAnD,CAAD,CAAX,CAAvD,CACH,CAHU,CAAX,CAIH,CAfO,CAiBA,MAAA,gCAAA,CAAmC,SAAC,MAAD,CAA+C,IAC9E,CAAA,IAD8E,CACrE,MAAK,KADgE,CAC9E,IAD8E,CAGtF,GAAI,CAAC,IAAI,CAAC,mBAAL,CAAyB,MAA9B,CAAsC,CAClC,MAAO,EAAP,CACH,CAED,GAAM,CAAA,mBAAmB,CAAG,IAAI,CAAC,mBAAL,CAAyB,MAAzB,CAAgC,IAAhC,CAAqC,SAAC,mBAAD,CAAwB,CAAG,MAAO,CAAA,mBAAmB,CAAC,GAApB,GAA4B,MAAM,CAAC,GAA1C,CAAgD,CAAhH,CAA5B,CAEA,GAAI,mBAAJ,CAAyB,CACrB,MAAO,CAAA,mBAAmB,CAAC,UAA3B,CACH,CAED,MAAO,EAAP,CACH,CAdO,CAgBA,MAAA,2BAAA,CAA8B,UAAyC,IACnE,CAAA,IADmE,CAC1D,MAAK,KADqD,CACnE,IADmE,CAE3E,GAAM,CAAA,YAAY,CAAG,IAAI,CAAC,aAAL,CAAmB,MAAnB,EAA6B,IAAI,CAAC,aAAL,CAAmB,MAAnB,CAA0B,cAA5E,CAEA,GAAM,CAAA,gBAAgB,CACjB,YAAY,EAAI,YAAY,CAAC,OAA7B,EAAwC,YAAY,CAAC,OAAb,CAAqB,CAArB,CAAzC,EACA,CAAC,eAAe,CAAe,SAAf,CAA0B,MAAK,KAAL,CAAW,OAAX,CAAmB,OAA7C,CAAf,EAAwE,EAAzE,EAA6E,CAA7E,CAFJ,CAIA,GAAI,gBAAgB,EAAI,IAAI,CAAC,mBAAL,CAAyB,MAAjD,CAAyD,CACrD,GAAM,CAAA,kBAAkB,CAAG,IAAI,CAAC,mBAAL,CAAyB,MAAzB,CAAgC,IAAhC,CAAqC,SAAC,kBAAD,CAAuB,CACnF,MAAQ,CAAA,kBAAkB,CAAC,UAAnB,CAA8B,UAA9B,GAA6C,gBAAgB,CAAC,UAA/D,EACF,kBAAkB,CAAC,UAAnB,CAA8B,YAA9B,GAA+C,gBAAgB,CAAC,YADrE,CAEH,CAH0B,CAA3B,CAIA,GAAI,kBAAJ,CAAwB,CACpB,MAAO,OAAK,qBAAL,CAA2B,IAA3B,CAAgC,SAAC,cAAD,QAAoB,CAAA,cAAc,CAAC,GAAf,GAAuB,kBAAkB,CAAC,GAA9D,EAAhC,CAAP,CACH,CACJ,CAED,OACH,CAnBO,CAqBA,MAAA,iBAAA,CAAoB,SAAC,sBAAD,CAAgE,IAChF,CAAA,OADgF,CACpE,MAAK,KAD+D,CAChF,OADgF,CAExF,GAAM,CAAA,cAAc,CAAG,OAAO,EAAI,OAAO,CAAC,OAA1C,CACA,GAAM,CAAA,aAAa,CAAG,OAAO,EAAI,OAAO,CAAC,aAAzC,CAEA,GAAI,CAAC,cAAD,EAAmB,CAAC,aAApB,EAAqC,CAAC,MAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAAxE,CAAgF,CAC5E,GAAM,CAAA,KAAK,sDAAiD,CAAC,cAAD,CAAkB,iBAAlB,CAAsC,EAAvF,aAA6F,CAAC,aAAD,CAAiB,gBAAjB,CAAoC,EAAjI,uBAAX,CACA,MAAK,KAAL,CAAW,SAAX,CAAqB,OAArB,CAA6B,KAA7B,EACH,CAED,GAAM,CAAA,yBAAyB,CAAG,4BAA4B,CAAC,sBAAD,CAAyB,MAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,EAAwC,MAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,CAAqC,aAA7E,EAA8F,EAAvH,CAA9D,CAEA,MAAM,CAAC,OAAP,CAAe,SAAf,CAAyB,EAAzB,CAA6B,EAA7B,CAAiC,gBAAgB,CAAC,aAAa,CAAC,MAAK,KAAL,CAAW,OAAX,CAAmB,OAApB,CAAd,CAA4C,yBAA5C,CAAjD,EACA,WAAW,CAAC,UAAK,CACb,MAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,CAAsC,iBAAtC,CAA0D,CAA1D,CACA,MAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,CAAsC,aAAtC,CAAsD,yBAAtD,CACH,CAHU,CAAX,CAIH,CAjBO,CAmBA,MAAA,gBAAA,CAAmB,SAAC,sBAAD,CAAkE,CACzF,GAAI,MAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAAlC,CAA0C,CACtC,GAAM,CAAA,qBAAqB,CAAG,4BAA4B,CAAC,sBAAD,CAAyB,MAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,CAAqC,aAArC,EAAsD,EAA/E,CAA1D,CAEA,MAAO,CAAA,gBAAgB,CAAC,aAAa,CAAC,MAAK,KAAL,CAAW,OAAX,CAAmB,OAApB,CAAd,CAA4C,qBAA5C,CAAvB,CACH,CAJD,IAIO,CACH,MAAK,KAAL,CAAW,SAAX,CAAqB,OAArB,wFACA,MAAO,EAAP,CACH,CACJ,CATO,CAWA,MAAA,gBAAA,CAAmB,SAAC,YAAD,CAAwD,kBACnD,MAAK,KAD8C,CACvE,IADuE,cACvE,IADuE,CACjE,SADiE,cACjE,SADiE,CAG/E,GAAI,CAAC,IAAI,CAAC,aAAL,CAAmB,MAAxB,CAAgC,CAC5B,SAAS,CAAC,OAAV,CAAkB,oGAAlB,EACA,OACH,CAED,GAAI,CAAA,yBAAyB,CAAI,IAAI,CAAC,aAAL,CAAmB,MAAnB,EAA6B,IAAI,CAAC,aAAL,CAAmB,MAAnB,CAA0B,aAAxD,EAA0E,EAA1G,CAEA,GAAI,CAAC,YAAY,CAAC,QAAlB,CAA4B,CACxB,GAAM,CAAA,cAAc,CAAG,YAAY,CAAC,aAApC,CACA,GAAI,CAAC,cAAL,CAAqB,CACjB,SAAS,CAAC,OAAV,CAAkB,8EAAlB,EACA,OACH,CACD,yBAAyB,CAAG,yBAAyB,CAAC,MAA1B,CACxB,SAAC,iBAAD,QAA4C,CAAC,6BAA6B,CAAC,cAAD,CAAiB,iBAAjB,CAA1E,EADwB,CAA5B,CAGH,CATD,IASO,CACH,yBAAyB,CAAG,EAA5B,CAGA,GAAM,CAAA,iBAAiB,CAAG,MAAK,0BAAL,CAAgC,OAAhC,EAA2C,MAAK,0BAAL,CAAgC,OAAhC,CAAwC,KAAxC,CAA8C,UAAnH,CACA,GAAM,CAAA,eAAe,CAAG,iBAAiB,EAAI,QAAQ,CAAC,cAAT,CAAwB,iBAAxB,CAA7C,CACA,UAAU,CAAC,UAAK,CACZ,eAAe,EAAI,eAAe,CAAC,KAAhB,EAAnB,CACH,CAFS,CAGC,EAHD,CAAV,CAIH,CAED,GAAM,CAAA,OAAO,CAAG,aAAa,CAAC,MAAK,KAAL,CAAW,OAAX,CAAmB,OAApB,CAA7B,CACA,MAAM,CAAC,OAAP,CAAe,SAAf,CAAyB,EAAzB,CAA6B,EAA7B,CAAiC,gBAAgB,CAAC,OAAD,CAAU,yBAAV,CAAjD,EACA,IAAI,CAAC,aAAL,CAAmB,MAAnB,CAA0B,iBAA1B,CAA8C,CAA9C,CACA,IAAI,CAAC,aAAL,CAAmB,MAAnB,CAA0B,aAA1B,CAA0C,yBAA1C,CACH,CAnCO,CAqCA,MAAA,gCAAA,CAAmC,SAAC,eAAD,CAAuC,UAAvC,CAAsE,kBACjF,MAAK,KAD4E,CACrG,IADqG,cACrG,IADqG,CAC/F,SAD+F,cAC/F,SAD+F,CAE7G,GAAM,CAAA,OAAO,CAAG,aAAa,CAAC,MAAK,KAAL,CAAW,OAAX,CAAmB,OAApB,CAA7B,CAEA,GAAI,CAAC,IAAI,CAAC,aAAL,CAAmB,MAAxB,CAAgC,CAC5B,SAAS,CAAC,OAAV,CAAkB,uGAAlB,EACA,MAAO,CAAA,OAAO,CAAC,IAAf,CACH,CAED,GAAI,CAAA,yBAAyB,CAAI,IAAI,CAAC,aAAL,CAAmB,MAAnB,EAA6B,IAAI,CAAC,aAAL,CAAmB,MAAnB,CAA0B,aAAxD,EAA0E,EAA1G,CAEA,GAAI,CAAC,UAAL,CAAiB,CACb,GAAI,CAAC,eAAL,CAAsB,CAClB,SAAS,CAAC,OAAV,CAAkB,sFAAlB,EACA,MAAO,CAAA,OAAO,CAAC,IAAf,CACH,CACD,yBAAyB,CAAG,yBAAyB,CAAC,MAA1B,CACxB,SAAC,iBAAD,QAA4C,CAAC,6BAA6B,CAAC,eAAD,CAAkB,iBAAlB,CAA1E,EADwB,CAA5B,CAGH,CARD,IAQO,CACH,yBAAyB,CAAG,EAA5B,CACH,CAED,MAAO,CAAA,gBAAgB,CAAC,OAAD,CAAU,yBAAV,CAAvB,CACH,CAxBO,CAoEA,MAAA,sBAAA,CAAyB,SAAC,YAAD,CAA6C,CAC1E,OAAO,YAAP,EACI,IAAA,KAAA,CACI,MAAK,kBAAL,CAA0B,CAA1B,CACA,MACJ,IAAA,KAAA,CACI,MAAK,kBAAL,CAA0B,CAA1B,CACA,MACJ,IAAA,KAAA,CACG,MAAK,kBAAL,CAA0B,CAA1B,CACA,MACH,IAAA,OAAA,CACI,MAAK,kBAAL,CAA0B,CAA1B,CACA,MACJ,IAAA,MAAA,CACI,MAAK,kBAAL,CAA0B,CAA1B,CACA,MACJ,QACI,MAAK,kBAAL,CAA0B,CAA1B,CAjBR,CAmBH,CApBO,CAzjBJ,MAAK,SAAL,CAAiB,KAAK,CAAC,OAAN,CAAc,OAAd,EAAyB,KAAK,CAAC,OAAN,CAAc,OAAd,CAAsB,MAA/C,EAAyD,KAAK,CAAC,OAAN,CAAc,OAAd,CAAsB,MAAtB,CAA6B,IAA7B,GAAsC,QAA/F,CAA0G,IAA1G,CAAiH,IAAlI,CACA,MAAK,eAAL,cAAuB,KAAK,CAAC,SAAN,EAAvB,CACA,MAAK,0BAAL,cAAkC,KAAK,CAAC,SAAN,EAAlC,CACA,MAAK,YAAL,CAAoB,MAAK,YAAL,CAAkB,IAAlB,+BAApB,CACA,MAAK,eAAL,CAAuB,MAAK,eAAL,CAAqB,IAArB,+BAAvB,CACA,MAAK,KAAL,CAAa,CACT,YAAY,CAAE,CACV,OAAO,CAAE,KADC,CAEV,oBAAoB,CAAE,MAAK,qBAAL,CAA2B,CAA3B,CAFZ,CADL,CAKT,WAAW,CAAE,KALJ,CAAb,CAP0G,0BAmBtG,MAAK,KAAL,CAAW,SAnB2F,CAetG,kBAfsG,uBAetG,kBAfsG,CAgBtG,QAhBsG,uBAgBtG,QAhBsG,CAiBtG,QAjBsG,uBAiBtG,QAjBsG,CAkBtG,eAlBsG,uBAkBtG,eAlBsG,CAqB1G,GAAM,CAAA,MAAM,CAAG,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,MAA1C,CACA,GAAM,CAAA,SAAS,CAAG,MAAK,KAAL,CAAW,SAA7B,CACA,GAAM,CAAA,kBAAkB,CAAG,MAAK,KAAL,CAAW,SAAX,CAAqB,wBAAhD,CACA,GAAM,CAAA,oBAAoB,CAAG,MAAK,KAAL,CAAW,SAAX,CAAqB,uBAAlD,CACA,MAAK,sBAAL,CAA8B,CAC1B,SAAS,CAAT,SAD0B,CAE1B,MAAM,CAAN,MAF0B,CAG1B,kBAAkB,CAAlB,kBAH0B,CAI1B,QAAQ,CAAR,QAJ0B,CAK1B,QAAQ,CAAR,QAL0B,CAM1B,eAAe,CAAf,eAN0B,CAO1B,kBAAkB,CAAlB,kBAP0B,CAQ1B,oBAAoB,CAApB,oBAR0B,CAA9B,CAUA,MAAK,gBAAL,CAAwB,kBAAkB,CAAC,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,iBAA5B,CACC,MAAK,KAAL,CAAW,YADZ,CAEC,MAAK,KAAL,CAAW,SAFZ,CAA1C,CAKA,MAAK,KAAL,CAAW,IAAX,CAAgB,QAAhB,CAAyB,IAAzB,CAA8B,SAAC,QAAD,CAAa,CACvC,MAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,IAA9B,CAAmC,SAAC,aAAD,CAAkB,CACjD,GAAI,MAAK,SAAL,GAAmB,UAAvB,CAAmC,CAC/B,aAAa,CAAC,QAAd,CAAyB,UAAzB,CACH,CAFD,IAEO,CACH,aAAa,CAAC,QAAd,CAAyB,QAAzB,CACH,CAED,GAAI,CAAA,YAAY,CAAiB,EAAjC,CAEA,GAAI,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,KAA3B,EAAoC,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,KAA3B,CAAiC,OAAzE,CAAkF,CAC9E,YAAY,CAAG,IAAI,CAAC,KAAL,CAAW,kBAAkB,CAAC,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,KAA3B,CAAiC,OAAlC,CAA7B,CAAf,CACH,CAED,aAAa,CAAC,iBAAd,CAAkC,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,KAA3B,EAAqC,CAAC,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,KAA3B,CAAiC,IAAlC,EAA0C,MAAK,KAAL,CAAW,MAAX,CAAkB,YAAlB,EAAkC,EAA5E,CAArC,EAAyH,CAA3J,CACA,aAAa,CAAC,cAAd,CAA+B,CAAE,OAAO,CAAE,YAAX,CAA/B,CACA,aAAa,CAAC,QAAd,CAAyB,MAAK,KAAL,CAAW,MAAX,CAAkB,YAAlB,EAAkC,EAA3D,CACA,aAAa,CAAC,cAAd,CAA+B,QAAQ,CAAC,QAAxC,CACA,aAAa,CAAC,iBAAd,CAAkC,QAAQ,CAAC,KAA3C,CAGA,QAAQ,CACJ,UAAK,CACD,MAAO,CAAC,aAAa,CAAC,aAAd,EAA+B,aAAa,CAAC,aAAd,CAA4B,MAA5D,CAAoE,aAAa,CAAC,iBAAlF,CAAqG,aAAa,CAAC,cAAd,EAAgC,aAAa,CAAC,cAAd,CAA6B,OAA7D,EAAwE,aAAa,CAAC,cAAd,CAA6B,OAA7B,CAAqC,MAAlN,CAAP,CACH,CAHG,CAIJ,UAAK,2BACD,GAAM,CAAA,KAAK,CAAG,GAAI,CAAA,gCAAJ,CACV,aAAa,CAAC,QADJ,CAEV,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,WAFjB,CAGV,CAAE,MAAM,CAAE,CAAE,GAAG,CAAE,MAAK,KAAL,CAAW,MAAX,CAAkB,YAAzB,CAAuC,IAAI,CAAE,IAAI,CAAC,GAAL,CAAU,aAAa,CAAC,QAAd,EAA0B,aAAa,CAAC,iBAAd,EAAmC,CAA7D,CAAV,CAA4E,CAA5E,CAA7C,CAAV,CAAyI,KAAK,CAAE,IAAhJ,CAAsJ,OAAO,CAAE,aAAa,CAAC,cAAd,EAAgC,EAA/L,CAHU,CAIV,aAAa,CAAC,aAAd,EAA+B,EAJrB,CAKV,EAAE,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,SAA3B,CAAqC,MAArC,EAA+C,CAAjD,CALU,CAMV,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,KAA3B,EAAoC,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,KAA3B,CAAiC,CAArE,CAAyE,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,KAA3B,CAAiC,CAA1G,wBAA8G,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,KAAzI,gDAA8G,sBAAkC,SANtI,CAOV,MAAK,KAAL,EAAc,MAAK,KAAL,CAAW,MAAzB,EAAmC,MAAK,KAAL,CAAW,MAAX,CAAkB,iBAAlB,GAAwC,SAA3E,EAAwF,MAAK,KAAL,CAAW,MAAX,CAAkB,iBAAlB,GAAwC,IAAhI,CAAuI,IAAvI,CAA8I,KAPpI,CAQV,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,MARjB,CAAd,CAWA,qBAAqB,CAAC,KAAD,CAAQ,MAAK,KAAL,CAAW,OAAX,CAAmB,aAA3B,CAArB,CAA+D,IAA/D,CAAoE,SAAA,cAAc,CAAG,CACjF,aAAa,CAAC,cAAd,CAA+B,cAAc,CAAC,QAA9C,CACA,aAAa,CAAC,iBAAd,CAAkC,cAAc,CAAC,KAAjD,CACH,CAHD,EAIH,CApBG,CAAR,CAuBH,CA3CD,EA4CH,CA7CD,EA+CA,2BAAI,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAA2B,KAA/B,2CAAI,uBAAkC,SAAtC,CAAiD,CAC7C,MAAK,KAAL,CAAW,IAAX,CAAgB,cAAhB,CAA+B,IAA/B,CAAoC,SAAC,QAAD,CAAa,CAC7C,MAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,IAA9B,CAAmC,SAAC,oBAAD,CAAyB,CACxD,oBAAoB,CAAC,cAArB,CAAsC,QAAtC,CAEH,CAHD,EAIH,CALD,EAMP,CACG,MAAK,eAAL,GA/F0G,aAgG7G,CAjIL,+FAmI4B,CACpB,GAAI,QAAQ,CAAC,SAAT,EAAsB,MAAM,CAAC,gBAAjC,CAAmD,CAC/C,MAAM,CAAC,gBAAP,CAAwB,QAAxB,CAAkC,KAAK,eAAvC,EACA,KAAK,eAAL,GACH,CACJ,CAxIL,mEA0I+B,CACvB,GAAI,QAAQ,CAAC,SAAT,EAAsB,MAAM,CAAC,mBAAjC,CAAsD,CAClD,MAAM,CAAC,mBAAP,CAA2B,QAA3B,CAAqC,KAAK,eAA1C,EACH,CACJ,CA9IL,uCAgJiB,wBACiD,KAAK,KAAL,CAAW,MAD5D,CACD,aADC,oBACD,aADC,CACc,SADd,oBACc,SADd,CACyB,mBADzB,oBACyB,mBADzB,IAED,CAAA,SAFC,CAEa,KAAK,KAFlB,CAED,SAFC,CAGT,GAAM,CAAA,QAAQ,CAAI,KAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,EAAwC,KAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,CAAqC,cAA9E,EAAiG,EAAlH,CACA,GAAM,CAAA,aAAa,CAAI,KAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,EAAwC,KAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,CAAqC,cAA9E,EAAiG,IAAvH,CACA,GAAI,CAAA,SAAS,CAAG,EAAhB,CACA,GAAM,CAAA,aAAa,CAAG,KAAK,KAAL,CAAW,OAAX,CAAmB,GAAnB,CAAuB,MAAvB,CAA8B,cAApD,CACA,GAAM,CAAA,SAAS,CAAG,mBAAmB,GAAK,aAAa,GAAK,MAAlB,EAA4B,aAAa,GAAK,iBAAnD,CAArC,CACA,GAAG,CAAC,QAAD,EAAa,QAAQ,CAAC,MAAT,GAAoB,CAApC,CAAuC,CACnC,SAAS,CAAG,KAAK,SAAL,GAAmB,UAAnB,CAA+B,SAAS,CAAC,0BAAzC,CAAsE,SAAS,CAAC,wBAA5F,CAEH,CACD,GAAM,CAAA,iBAAiB,cACnB,KAAA,CAAA,aAAA,CAAC,wBAAD,CAAyB,CACrB,QAAQ,CAAE,QADW,CAErB,OAAO,CAAE,KAAK,KAAL,CAAW,OAFC,CAGrB,aAAa,CAAE,aAHM,CAIrB,SAAS,CAAE,SAJU,CAKrB,UAAU,CAAE,KAAK,KAAL,CAAW,QALF,CAMrB,QAAQ,CAAE,KAAK,KAAL,CAAW,EANA,CAOrB,mBAAmB,CAAI,SAPF,CAQrB,gBAAgB,CAAE,KAAK,gBARF,CAAzB,CADJ,CAaA,GAAM,CAAA,gBAAgB,cAClB,KAAA,CAAA,aAAA,CAAC,uBAAD,CAAwB,CACpB,OAAO,CAAE,aADW,CAEpB,OAAO,CAAE,KAAK,KAAL,CAAW,OAFA,CAGpB,aAAa,CAAE,aAHK,CAIpB,SAAS,CAAE,SAJS,CAKpB,UAAU,CAAE,KAAK,KAAL,CAAW,QALH,CAMpB,QAAQ,CAAE,KAAK,KAAL,CAAW,EAND,CAOpB,gBAAgB,CAAE,KAAK,gBAPH,CAAxB,CADJ,CAYA,GAAM,CAAA,8BAA8B,gCAC7B,KAAK,KADwB,MAEhC,QAAQ,CAAE,iBAFsB,CAGhC,cAAc,CAAE,KAAK,mBAAL,EAHgB,CAIhC,iBAAiB,CAAE,CAAC,KAAK,KAAL,CAAW,MAAX,CAAkB,gBAAnB,EAAuC,KAAK,qBAAL,EAJ1B,CAKhC,UAAU,CAAE,KAAK,cAAL,EALoB,CAMhC,SAAS,CAAE,UAAU,CAAC,4BAAD,CAA+B,SAA/B,CANW,CAOhC,qBAAqB,CAAE,CACnB,WAAW,CAAE,KAAK,KADC,CAEnB,SAAS,CAAE,UAAU,CAAC,4BAAD,CAA+B,SAA/B,CAFF,CAPS,CAWhC,aAAa,CAAE,KAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,EAAwC,KAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,CAAqC,iBAArC,GAA2D,CAAnG,CAAuG,KAAK,mBAAL,EAAvG,CAAmI,IAXlH,CAYhC,UAAU,CAAE,KAAK,cAAL,EAZoB,CAahC,iBAAiB,CAAE,CAAE,SAAS,CAAE,sCAAb,CAba,CAchC,uBAAuB,CAAE,CAAC,SAAS,CAAE,6CAAZ,CAdO,CAehC,oBAAoB,CAAE,CAAC,SAAS,CAAE,kDAAZ,CAfU,CAgBhC,gCAAgC,CAAE,CAAC,SAAS,CAAE,oDAAZ,CAhBF,CAiBhC,aAAa,CAAE,KAAK,iBAAL,EAjBiB,CAkBhC,WAAW,CAAE,KAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,EAAwC,KAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,CAAqC,iBAArC,GAA2D,CAAnG,cAEL,KAAA,CAAA,aAAA,CAAC,WAAD,CAAY,CACR,IAAI,CAAE,SAAS,CAAC,UADR,CAER,SAAS,CAAE,SAAS,CAAC,UAFb,CAGR,QAAQ,CAAE,KAAK,eAHP,CAIR,OAAO,CAAE,KAAK,YAJN,CAKR,EAAE,CAAC,qBALK,CAAZ,CAFK,CASL,IA3BwB,CA4B/B,iBAAiB,CAAE,KAAK,qBAAL,EA5BY,CA6B/B,QAAQ,CAAE,KAAK,QA7BgB,CA8B/B,YAAY,CAAE,SAAS,eACnB,KAAA,CAAA,aAAA,CAAC,YAAD,CAAa,CAAC,IAAI,CAAE,SAAP,CAAb,CA/B2B,CAiC/B,sBAAsB,CAAE,CAAE,SAAS,CAAE,0BAAb,CAjCO,CAkC/B,kBAAkB,CAAE,KAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,EAAyC,KAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,CAAqC,cAArC,GAAwD,IAAxD,EAAgE,KAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAA8B,MAA9B,CAAqC,cAArC,GAAwD,SAAjK,CAA8K,gBAA9K,CAAiM,IAlCtL,EAApC,CAoCA,MAAO,MAAK,KAAL,CAAW,UAAX,CAAsB,8BAAtB,CAAP,CACH,CA1NL,mDAkjBwB,IACR,CAAA,OADQ,CACI,KAAK,KADT,CACR,OADQ,CAIhB,GAAI,OAAO,CAAC,OAAR,EAAmB,OAAO,CAAC,OAAR,CAAgB,MAAnC,EAA6C,OAAO,CAAC,OAAR,CAAgB,MAAhB,CAAuB,IAAvB,GAAgC,QAAjF,CAA2F,CACvF,MAAO,IAAP,CACH,CAED,GAAI,QAAQ,CAAC,SAAT,EAAsB,MAAM,CAAC,UAAjC,CAA6C,CACzC,GAAM,CAAA,YAAY,CAAG,OAAO,CAAC,OAAR,CAAgB,YAArC,CACA,GAAI,YAAJ,CAAkB,CACd,GAAI,YAAY,CAAC,EAAb,EAAmB,MAAM,CAAC,UAAP,EAAqB,YAAY,CAAC,EAAb,CAAgB,CAA5D,CAA+D,CAC3D,MAAO,IAAP,CACH,CAFD,IAEO,IAAI,YAAY,CAAC,EAAb,EAAmB,MAAM,CAAC,UAAP,EAAqB,YAAY,CAAC,EAAb,CAAgB,CAA5D,CAA+D,CAClE,MAAO,IAAP,CACH,CAFM,IAEA,IAAI,YAAY,CAAC,EAAb,EAAmB,MAAM,CAAC,UAAP,EAAqB,YAAY,CAAC,EAAb,CAAgB,CAA5D,CAA+D,CAClE,MAAO,IAAP,CACH,CAFM,IAEA,IAAI,YAAY,CAAC,EAAb,EAAmB,MAAM,CAAC,UAAP,EAAqB,YAAY,CAAC,EAAb,CAAgB,CAA5D,CAA+D,CAClE,MAAO,IAAP,CACH,CAFM,IAEA,CACH,MAAO,IAAP,CACH,CACJ,CACJ,CAED,MAAO,IAAP,CACH,CA5kBL,mDA8kBwB,CAChB,KAAK,QAAL,CAAc,CACV,WAAW,CAAE,CAAC,KAAK,KAAL,CAAW,WADf,CAAd,EAGH,CAllBL,yDAolB2B,CACnB,KAAK,SAAL,CAAiB,KAAK,YAAL,EAAjB,CAEA,GAAI,KAAK,KAAL,CAAW,WAAX,EAA0B,CAAC,KAAK,QAApC,CAA8C,CAC1C,KAAK,YAAL,GACH,CACJ,CA1lBL,oCAE0B,CAClB,MAAQ,MAAK,SAAL,GAAmB,IAAnB,EAA2B,KAAK,SAAL,GAAmB,IAAtD,CACH,CAJL,0DAwBkC,MAxBlC,CAwBkD,gBAxBlD,CAwB2F,CACnF,GAAI,CAAA,eAAJ,CACA,GAAI,MAAM,EAAI,gBAAV,EAA8B,gBAAgB,CAAC,MAAjB,CAA0B,CAA5D,CAA+D,CAC3D,eAAe,CAAG,gBAAgB,CAAC,IAAjB,CAAsB,SAAA,IAAI,QAAI,CAAA,IAAI,CAAC,QAAL,CAAe,WAAf,KAAiC,MAAM,CAAC,WAAP,EAArC,EAA1B,CAAlB,CACH,CAED,MAAO,CAAA,eAAe,EAAI,eAAe,CAAC,IAA1C,CACH,CA/BL,mCAAmD,KAAK,CAAC,aAAzD,CAAA,CAEc,UAAA,CAAA,CAAT,QAAS,CAAA,C,+BAAA,C,UAAA,CAET,IAFS,CAAA,CAeV,UAAA,CAAA,CADC,UACD,CAAA,C,+BAAA,C,WAAA,C,IAA4B,EAA5B,CAAA,CAjBiB,qBAAqB,CAAA,uBAAA,CAAA,UAAA,CAAA,CADzC,QACyC,CAAA,CAArB,qBAAqB,CAArB,C,cAAA,CAAA,qB","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { getTelemetryObject, ILabeledDropdownOnChangeNotification, ILabeledDropdownOption, IModuleProps, INodeProps, ITelemetryContent, LabeledDropdown, UncontrolledPagination } from '@msdyn365-commerce-modules/utilities';\nimport { CategoryHierarchy as CategoryHierarchyData, IProductRefinerHierarchy } from '@msdyn365-commerce/commerce-entities';\nimport MsDyn365 from '@msdyn365-commerce/core';\nimport { format, ProductRefinerValue, SortColumn, TextValueTranslation } from '@msdyn365-commerce/retail-proxy';\nimport classnames from 'classnames';\nimport { computed, observable, reaction, transaction } from 'mobx';\nimport { observer } from 'mobx-react';\nimport * as React from 'react';\nimport { buildListPageUrl, getCollectionProducts, getCurrentUrl, GetFullProductsByCollectionInput, parseQueryParam, sortOptions, } from './actions';\nimport { ErrorMessage, FeatureSearchResultItem, getUpdatedRefinementCriteria, IChoiceSummaryClickNotification,\n     IRefineItemCommonProps, IRefineItemToggleNotification, ISearchResultModalViewProps, isMatchingRefinementCriterion, Link, ModalToggle, ProductSearchResultItems, SearchResultModal, Separator, Title } from './components';\nimport ChoiceSummary from './components/choice-summary';\nimport RefineSubmenu from './components/refine-submenu';\nimport { ISearchResultContainerData } from './search-result-container.data';\nimport { expandRefinersCount, ISearchResultContainerProps } from './search-result-container.props.autogenerated';\n\nexport interface ISearchResultContainerViewProps extends ISearchResultContainerProps<ISearchResultContainerData> {\n    products?: React.ReactNode;\n    className?: string;\n    SearchResultContainer: IModuleProps;\n    TitleViewProps: ITitleViewProps;\n    categoryHierarchy: ICategoryHierarchyViewProps;\n    pagination?: React.ReactNode;\n    ProductsContainer: INodeProps;\n    ProductSectionContainer: INodeProps;\n    refineMenu: IRefineMenuViewProps;\n    sortByOptions: ISortByViewProps;\n    choiceSummary?: React.ReactNode;\n    modalToggle: React.ReactNode;\n    searchResultModal: ISearchResultModalViewProps;\n    isMobile: boolean;\n    CategoryNavContainer: INodeProps;\n    RefineAndProductSectionContainer: INodeProps;\n    errorMessage: React.ReactNode;\n    FeatureSearchContainer: INodeProps;\n    similarLookProduct?: React.ReactNode;\n}\n\nexport interface ITitleViewProps {\n    TitleContainer: INodeProps;\n    title:ISearchResultTitle;\n}\n\nexport interface IRefineMenuViewProps {\n    RefineMenuContainer: INodeProps;\n    RefinerSectionContainer: INodeProps;\n    refiners?: React.ReactNode[];\n}\n\nexport interface ICategoryHierarchyViewProps {\n    categoryHierarchyList?: React.ReactNode[];\n    categoryHierarchySeparator?: React.ReactNode;\n    CategoryHierarchyContainer: INodeProps;\n}\n\nexport interface ISortByViewProps {\n    SortingContainer: INodeProps;\n    sortByDropDown?:React.ReactNode;\n}\n\nexport type GridSize = 'xs' | 'sm' | 'md' | 'lg' | 'xl';\n\n/**\n * Title component for search result container\n */\nexport interface ISearchResultTitle {\n    titlePrefix?: React.ReactNode;\n    titleText?: React.ReactNode;\n    titleCount?: React.ReactNode;\n}\n\nexport interface ISearchResultContainerState {\n    sortingState: ISortByCollectionState;\n    modalIsOpen: boolean;\n}\n\ninterface ISortByCollectionState {\n    selectedSortByOption: ILabeledDropdownOption;\n    pending: boolean;\n}\n\n/**\n *\n * SearchResultContainer component\n * @extends {React.PureComponent<ISearchResultContainerProps<ISearchResultContainerData>>}\n */\n@observer\nexport default class SearchResultContainer extends React.PureComponent<ISearchResultContainerProps<ISearchResultContainerData>, ISearchResultContainerState> {\n\n    @computed get isMobile(): boolean {\n        return (this._viewport === 'xs' || this._viewport === 'sm');\n    }\n\n    private sortByDropdownOptions: ILabeledDropdownOption[] = [\n        { key: sortOptions.sortByOptionRelevanceDesc, value: this.props.resources.sortByOptionRelevanceDesc },\n        { key: sortOptions.sortByOptionNameAsc, value: this.props.resources.sortByOptionNameAsc },\n        { key: sortOptions.sortByOptionNameDesc, value: this.props.resources.sortByOptionNameDesc },\n        { key: sortOptions.sortByOptionPriceAsc, value: this.props.resources.sortByOptionPriceAsc },\n        { key: sortOptions.sortByOptionPriceDesc, value: this.props.resources.sortByOptionPriceDesc },\n        { key: sortOptions.sortByOptionRatingDesc, value: this.props.resources.sortByOptionRatingDesc },\n    ];\n    private _refineItemCommonProps: IRefineItemCommonProps;\n    private _pageType: string | undefined = this.props.context.request.urlTokens.pageType;\n    @observable\n    private _viewport: GridSize;\n\n    private _modalToggleRef: React.RefObject<HTMLButtonElement>;\n    private _sortAndFilterContainerRef: React.RefObject<LabeledDropdown>;\n    private expandrefinerCount: number = 0;\n    private telemetryContent: ITelemetryContent;\n\n    public static getFriendlyName(locale: string, nameTranslations?: TextValueTranslation[]): string | undefined {\n        let nameTranslation: TextValueTranslation | undefined;\n        if (locale && nameTranslations && nameTranslations.length > 0) {\n            nameTranslation = nameTranslations.find(item => item.Language!.toLowerCase() === locale.toLowerCase());\n        }\n\n        return nameTranslation && nameTranslation.Text;\n    }\n\n    constructor(props: ISearchResultContainerProps<ISearchResultContainerData>, state: ISearchResultContainerState) {\n        super(props);\n        this._viewport = props.context.request && props.context.request.device && props.context.request.device.Type === 'Mobile' ? 'xs' : 'lg';\n        this._modalToggleRef = React.createRef<HTMLButtonElement>();\n        this._sortAndFilterContainerRef = React.createRef<LabeledDropdown>();\n        this._toggleModal = this._toggleModal.bind(this);\n        this._updateViewport = this._updateViewport.bind(this);\n        this.state = {\n            sortingState: {\n                pending: false,\n                selectedSortByOption: this.sortByDropdownOptions[0]\n            },\n            modalIsOpen: false\n        };\n        const {\n            placeholderTextMax,\n            minLabel,\n            maxLabel,\n            rangeNameFormat\n        } = this.props.resources;\n\n        const locale = this.props.context.request.locale;\n        const telemetry = this.props.telemetry;\n        const validationErrorNaN = this.props.resources.validationErrorNotNumber;\n        const validationErrorRange = this.props.resources.validationErrorNotRange;\n        this._refineItemCommonProps = {\n            telemetry,\n            locale,\n            placeholderTextMax,\n            minLabel,\n            maxLabel,\n            rangeNameFormat,\n            validationErrorNaN,\n            validationErrorRange\n        };\n        this.telemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!,\n                                                   this.props.friendlyName,\n                                                   this.props.telemetry);\n\n        // Initalization of list page\n        this.props.data.products.then((products) => {\n            this.props.data.listPageState.then((listPageState) => {\n                if (this._pageType === 'Category') {\n                    listPageState.pageType = 'Category';\n                } else {\n                    listPageState.pageType = 'Search';\n                }\n\n                let querySorting: SortColumn[] = [];\n\n                if (this.props.context.request.query && this.props.context.request.query.sorting) {\n                    querySorting = JSON.parse(decodeURIComponent(this.props.context.request.query.sorting)) as SortColumn[];\n                }\n\n                listPageState.currentPageNumber = this.props.context.request.query && (+this.props.context.request.query.skip / (this.props.config.itemsPerPage || 10)) || 0;\n                listPageState.sortingCritera = { Columns: querySorting };\n                listPageState.pageSize = this.props.config.itemsPerPage || 10;\n                listPageState.activeProducts = products.products;\n                listPageState.totalProductCount = products.count;\n\n                // Initialize reaction based on listPageState properties\n                reaction(\n                    () => {\n                        return [listPageState.activeFilters && listPageState.activeFilters.length, listPageState.currentPageNumber, listPageState.sortingCritera && listPageState.sortingCritera.Columns && listPageState.sortingCritera.Columns.length];\n                    },\n                    () => {\n                        const input = new GetFullProductsByCollectionInput(\n                            listPageState.pageType,\n                            this.props.context.request.apiSettings,\n                            { Paging: { Top: this.props.config.itemsPerPage, Skip: Math.max((listPageState.pageSize * (listPageState.currentPageNumber || 0)), 0) }, count: true, Sorting: listPageState.sortingCritera || {} },\n                            listPageState.activeFilters || [],\n                            +(this.props.context.request.urlTokens.itemId || 0),\n                            this.props.context.request.query && this.props.context.request.query.q ? this.props.context.request.query.q : this.props.context.request.query?.productId,\n                            this.props && this.props.config && this.props.config.includeAttributes !== undefined && this.props.config.includeAttributes === true ? true : false,\n                            this.props.context.request.locale\n                            );\n\n                        getCollectionProducts(input, this.props.context.actionContext).then(productResults => {\n                            listPageState.activeProducts = productResults.products;\n                            listPageState.totalProductCount = productResults.count;\n                        });\n                    }\n                );\n\n            });\n        });\n\n        if (this.props.context.request.query?.productId) {\n            this.props.data.featureProduct.then((products) => {\n                this.props.data.listPageState.then((listPageStateFeature) => {\n                    listPageStateFeature.featureProduct = products;\n\n                });\n            });\n    }\n        this._updateViewport();\n    }\n\n    public componentDidMount(): void {\n        if (MsDyn365.isBrowser && window.addEventListener) {\n            window.addEventListener('resize', this._updateViewport);\n            this._updateViewport();\n        }\n    }\n\n    public componentWillUnmount(): void {\n        if (MsDyn365.isBrowser && window.removeEventListener) {\n            window.removeEventListener('resize', this._updateViewport);\n        }\n    }\n\n    public render(): JSX.Element {\n        const { imageSettings, className, allowBackNavigation } = this.props.config;\n        const { resources } = this.props;\n        const products = (this.props.data.listPageState.result && this.props.data.listPageState.result.activeProducts) || [];\n        const searchProduct = (this.props.data.listPageState.result && this.props.data.listPageState.result.featureProduct) || null;\n        let errorText = '';\n        const breaCrumbType = this.props.context.app.config.breadcrumbType;\n        const allowBack = allowBackNavigation && (breaCrumbType === 'back' || breaCrumbType === 'categoryAndBack');\n        if(!products || products.length === 0) {\n            errorText = this._pageType === 'Category'? resources.resultCategoryNotFoundText : resources.resultSearchNotFoundText;\n\n        }\n        const productsComponent = (\n            <ProductSearchResultItems\n                products={products}\n                context={this.props.context}\n                imageSettings={imageSettings}\n                resources={resources}\n                moduleType={this.props.typeName}\n                moduleId={this.props.id}\n                allowBackNavigation = {allowBack}\n                telemetryContent={this.telemetryContent}\n            />\n        );\n\n        const featureComponent = (\n            <FeatureSearchResultItem\n                product={searchProduct}\n                context={this.props.context}\n                imageSettings={imageSettings}\n                resources={resources}\n                moduleType={this.props.typeName}\n                moduleId={this.props.id}\n                telemetryContent={this.telemetryContent}\n            />\n        );\n\n        const searchResultContainerViewProps = {\n            ...this.props,\n            products: productsComponent,\n            TitleViewProps: this._getCollectionTitle(),\n            categoryHierarchy: !this.props.config.disableHierarchy && this._getCategoryHierarchy(),\n            refineMenu: this._getRefineMenu(),\n            className: classnames('ms-search-result-container', className),\n            SearchResultContainer: {\n                moduleProps: this.props,\n                className: classnames('ms-search-result-container', className)\n            },\n            sortByOptions: this.props.data.listPageState.result && this.props.data.listPageState.result.totalProductCount !== 0 ? this._getSortingDropDown(): null,\n            pagination: this._getPagination(),\n            ProductsContainer: { className: 'ms-search-result-container__Products' },\n            ProductSectionContainer: {className: 'ms-search-result-container__product-section'},\n            CategoryNavContainer: {className: 'ms-search-result-container__category-nav-section'},\n            RefineAndProductSectionContainer: {className: 'ms-search-result-container__refine-product-section'},\n            choiceSummary: this._getChoiceSummary(),\n            modalToggle: this.props.data.listPageState.result && this.props.data.listPageState.result.totalProductCount !== 0 ?\n                (\n                    <ModalToggle\n                        text={resources.modalTitle}\n                        ariaLabel={resources.modalTitle}\n                        innerRef={this._modalToggleRef}\n                        onClick={this._toggleModal}\n                        id='search-result-modal'\n                    />\n                ) : null,\n             searchResultModal: this._getSearchResultModal(),\n             isMobile: this.isMobile,\n             errorMessage: errorText && (\n                 <ErrorMessage text={errorText} />\n             ),\n             FeatureSearchContainer: { className: 'ms-feature-search-result' },\n             similarLookProduct: this.props.data.listPageState.result && (this.props.data.listPageState.result.featureProduct !== null && this.props.data.listPageState.result.featureProduct !== undefined) ? featureComponent : null\n        };\n        return this.props.renderView(searchResultContainerViewProps) as React.ReactElement;\n    }\n\n    private _getSearchResultModal = (): ISearchResultModalViewProps => {\n        const {resources} = this.props;\n        return SearchResultModal(\n            {\n           resources:{\n               modalCloseButtonText: resources.modalCloseButtonText,\n               modalTitle: resources.modalTitle\n           },\n           isOpen:this.state.modalIsOpen,\n           returnRef: this._modalToggleRef,\n           onModalToggle: this._toggleModal\n        });\n    }\n\n    private _getCollectionTitle = (): ITitleViewProps => {\n        const { data, context, resources } = this.props;\n\n        let collectionTitle: string | undefined = '';\n        if (context && context.request && context.request.query && context.request.query.q) {\n            collectionTitle = `\"${context.request.query.q}\"`;\n        } else {\n            collectionTitle = (data.category.result && SearchResultContainer.getFriendlyName(context.request.locale, data.category.result.NameTranslations)) ||\n                (data.category.result && data.category.result.Name);\n        }\n        let productCountText = '';\n        let productCountNumber: number | undefined;\n        if (data.listPageState && data.listPageState.result && data.listPageState.result.totalProductCount !== undefined) {\n            productCountNumber = data.listPageState.result.totalProductCount;\n        } else if (data.products && data.products.result) {\n            productCountNumber = data.products.result.count;\n        }\n\n        if (productCountNumber && productCountNumber !== 0) {\n            productCountText = productCountNumber !== 1 ? format(this.props.resources.numberOfProducts, productCountNumber) : this.props.resources.oneProduct;\n        } else {\n            productCountText = format(this.props.resources.numberOfProducts, 0);\n        }\n        const titlePrefix = <Title className='ms-search-result__collection-title-prefix' text={resources.searchTextPrefix} />;\n        const titleText = collectionTitle && <Title className='ms-search-result__collection-title-text' text={collectionTitle} />;\n        const titleCount = <Title className='ms-search-result__collection-title-count' text={productCountText} />;\n\n        return {\n            TitleContainer: { className: 'ms-search-result-container__title' },\n            title:{\n            titlePrefix: titlePrefix,\n            titleText: titleText,\n            titleCount: titleCount\n            }\n        };\n\n    }\n    private _getCategoryHierarchy = (): ICategoryHierarchyViewProps => {\n        const { data } = this.props;\n        const categoryHierarchy = data.categoryHierarchy.result;\n        const categoryLinks =\n            categoryHierarchy && categoryHierarchy.map((value: CategoryHierarchyData, index: number) => {\n\n                return (\n                    <Link\n                        key={index}\n                        text={value.Name}\n                        ariaLabel={`${this.props.resources.categoryLinkAriaLabel} ${value.Name}`}\n                        href={value.Url}\n                    />\n                );\n            });\n        const categoryLinkSeparator = <Separator separator='/' />;\n\n        return {\n            CategoryHierarchyContainer: { tag: 'nav', className: 'ms-search-result-container__category-hierarchy' },\n            categoryHierarchyList: categoryLinks,\n            categoryHierarchySeparator: categoryLinkSeparator\n        };\n\n    }\n\n    private _getSortingDropDown = (): ISortByViewProps => {\n        const { resources } = this.props;\n        const activeDropdown = this._getCurrentlySelectedOption() || this.state.sortingState.selectedSortByOption;\n        const dropdown = (\n        <LabeledDropdown\n            labelClassname='reviews-list-sort-by'\n            labelText={resources.sortByDropdownLabel}\n            dropdownId='categorySortByDropdown'\n            dropdownClassname='reviews-list-dropdown'\n            toggleColor='link'\n            dropdownOptions={this.sortByDropdownOptions}\n            selectedOption={activeDropdown}\n            onSelectOption={this._updateSortByDropdown}\n            ref={this._sortAndFilterContainerRef}\n        />);\n        return {\n            SortingContainer: { className: 'ms-search-result-container__Sort-by-category' },\n            sortByDropDown:dropdown\n        };\n    }\n\n    private _getPagination = (): React.ReactNode => {\n        const { config, context, data, resources } = this.props;\n        const listPageState = data && data.listPageState && data.listPageState.result;\n        const fullUrl = getCurrentUrl(context.request);\n        const itemsPerPage = config.itemsPerPage || 10;\n        const skipCount = listPageState && listPageState.currentPageNumber !== null ?\n            (listPageState.currentPageNumber * (this.props.config.itemsPerPage || 10)) :\n            ((this.props.context.request.query && +this.props.context.request.query.skip) || 0);\n        const totalItems = listPageState && listPageState.totalProductCount || 0;\n        const previousText = resources.flipperPrevious;\n        const nextText = resources.flipperNext;\n        if (totalItems <= itemsPerPage) {\n            return null;\n        }\n        return (\n        <UncontrolledPagination\n            className='ms-search-result-container__pagination'\n            role='navigation'\n            aria-label={resources.paginationAriaLabel}\n            url={fullUrl.href}\n            qsp={'skip'}\n            items={totalItems}\n            itemsPerPage={itemsPerPage}\n            startingItem={skipCount}\n            previousText={<div className='msc-pagination__prev'><span className='ms-search-result__pagination-left' aria-hidden='true'/><span className='prev-text'>{previousText}</span></div>}\n            nextText={<div className='msc-pagination__next'><span className='next-text'>{nextText}</span><span className='ms-search-result__pagination-right' aria-hidden='true'/></div>}\n            previousAriaLabel={previousText}\n            nextAriaLabel={nextText}\n            telemetryContent={this.telemetryContent}\n        />);\n    }\n\n    private _getRefineMenu = (): IRefineMenuViewProps => {\n        const { data, context, config } = this.props;\n        const tempRangeTypeTODO = context.request.query && context.request.query.inputRange ? 'input' : 'slider';\n        const validRefiners = data.refiners.result && data.refiners.result.filter(refiner => {\n            return refiner.Values.length > 0;\n        });\n\n        const activeRefiners = (data.listPageState.result && data.listPageState.result.activeFilters) || [];\n\n        this._getexpandRefinerCount(config.expandRefinersCount);\n        const refinelist = this.expandrefinerCount === undefined ? 0 :  this.expandrefinerCount;\n        const expandedRefiners = refinelist === 0 ? validRefiners && validRefiners.length: refinelist;\n        const subMenus = validRefiners && validRefiners.map((productRefinerHierarchy: IProductRefinerHierarchy, index: number) => {\n            return (data.listPageState.result!.totalProductCount !== 0 ?\n                (\n                <RefineSubmenu\n                    productRefinerHierarchy={productRefinerHierarchy}\n                    selectedRefinerValues={activeRefiners}\n                    refineItemCommonProps={this._refineItemCommonProps}\n                    minValueSliderThumbAriaLabel={this.props.resources.minValueSliderThumbAriaLabel}\n                    maxValueSliderThumbAriaLabel={this.props.resources.maxValueSliderThumbAriaLabel}\n                    key={index}\n                    onUpdateRefiners={this._onUpdateRefiners}\n                    urlBuilder={this._buildRefinerUrl}\n                    isDisabled={false}\n                    isExpandedOnInitialLoad={expandedRefiners && expandedRefiners > index ? true : false}\n                    tempRangeTypeTODO={tempRangeTypeTODO}\n                    context = {context}\n                    moduleId={this.props.id}\n                    moduleTypeName={this.props.typeName}\n                    telemetryContent={this.telemetryContent}\n                />) : null\n            );\n        });\n\n        return {\n            RefineMenuContainer:{className: 'ms-search-result-container__refine-menu' },\n            RefinerSectionContainer:{className: 'ms-search-result-container__refiner-section'},\n            refiners: subMenus\n        };\n\n    }\n\n    private _getChoiceSummary = (): React.ReactNode => {\n        const { resources, data, telemetry } = this.props;\n        const selectedRefiners = (data.listPageState.result && data.listPageState.result.activeFilters) || [];\n        return (\n            <ChoiceSummary\n                classNames='ms-choice-summary-by-category'\n                clearAllText={resources.clearAllText}\n                label={resources.choiceSummaryLabel}\n                selectedChoices={selectedRefiners}\n                // @ts-ignore: NOTE Type-unsafe line below, null refinersByCategoryHierarchy case not handled\n                refinerHierarchy={data.refiners.result}\n                choiceFormat={resources.choiceFormat}\n                choiceRangeValueFormat={resources.choiceRangeValueFormat}\n                telemetry={telemetry}\n                onChoiceClicked={this._onChoiceClicked}\n                urlBuilder={this._buildRefinerUrlForChoiceSummary}\n                choiceAriaLabel={resources.choiceAriaLabel}\n                telemetryContent={this.telemetryContent}\n            />\n        );\n\n    }\n\n    private _updateSortByDropdown = (notification: ILabeledDropdownOnChangeNotification): void => {\n        const { context } = this.props;\n        const requestContext = context && context.request;\n        const actionContext = context && context.actionContext;\n\n        if (!requestContext || !actionContext || !this.props.data.listPageState.result) {\n            const error = `[sort-by-category] cannot sort without context: ${!requestContext ? 'requestContext ' : ''} ${!actionContext ? 'actionContext ' : ''} could not be found`;\n            this.props.telemetry.warning(error);\n        }\n\n        window.history.pushState({}, '', buildListPageUrl(getCurrentUrl(this.props.context.request), undefined, [this._getSortColumnFromSelectedOption(notification.selectedOption)], undefined));\n        transaction(() => {\n            this.props.data.listPageState.result!.currentPageNumber = 0;\n            this.props.data.listPageState.result!.sortingCritera = { Columns: [this._getSortColumnFromSelectedOption(notification.selectedOption)] };\n        });\n    }\n\n    private _getSortColumnFromSelectedOption = (option: ILabeledDropdownOption): SortColumn => {\n        const { data } = this.props;\n\n        if (!data.searchConfiguration.result) {\n            return {};\n        }\n\n        const mappedConfiguration = data.searchConfiguration.result.find((searchConfiguration) => { return searchConfiguration.key === option.key; });\n\n        if (mappedConfiguration) {\n            return mappedConfiguration.sortColumn;\n        }\n\n        return {};\n    }\n\n    private _getCurrentlySelectedOption = (): ILabeledDropdownOption | undefined => {\n        const { data } = this.props;\n        const sortCriteria = data.listPageState.result && data.listPageState.result.sortingCritera;\n\n        const activeSortColumn =\n            (sortCriteria && sortCriteria.Columns && sortCriteria.Columns[0]) ||\n            (parseQueryParam<SortColumn[]>('sorting', this.props.context.request) || [])[0];\n\n        if (activeSortColumn && data.searchConfiguration.result) {\n            const activeMappedConfig = data.searchConfiguration.result.find((mappedSearchConfig) => {\n                return (mappedSearchConfig.sortColumn.ColumnName === activeSortColumn.ColumnName) &&\n                    (mappedSearchConfig.sortColumn.IsDescending === activeSortColumn.IsDescending);\n            });\n            if (activeMappedConfig) {\n                return this.sortByDropdownOptions.find((dropdownOption) => dropdownOption.key === activeMappedConfig.key);\n            }\n        }\n\n        return;\n    }\n\n    private _onUpdateRefiners = (itemToggleNotification: IRefineItemToggleNotification): void => {\n        const { context } = this.props;\n        const requestContext = context && context.request;\n        const actionContext = context && context.actionContext;\n\n        if (!requestContext || !actionContext || !this.props.data.listPageState.result) {\n            const error = `Refine menu cannot refine search criteria: ${!requestContext ? 'requestContext ' : ''} ${!actionContext ? 'actionContext ' : ''} could not be found`;\n            this.props.telemetry.warning(error);\n        }\n\n        const updatedRefinementCriteria = getUpdatedRefinementCriteria(itemToggleNotification, this.props.data.listPageState.result && this.props.data.listPageState.result.activeFilters || []);\n\n        window.history.pushState({}, '', buildListPageUrl(getCurrentUrl(this.props.context.request), updatedRefinementCriteria));\n        transaction(() => {\n            this.props.data.listPageState.result!.currentPageNumber = 0;\n            this.props.data.listPageState.result!.activeFilters = updatedRefinementCriteria;\n        });\n    }\n\n    private _buildRefinerUrl = (itemToggleNotification: IRefineItemToggleNotification): string => {\n        if (this.props.data.listPageState.result) {\n            const newRefinementCriteria = getUpdatedRefinementCriteria(itemToggleNotification, this.props.data.listPageState.result.activeFilters || []);\n\n            return buildListPageUrl(getCurrentUrl(this.props.context.request), newRefinementCriteria);\n        } else {\n            this.props.telemetry.warning(`[buildRefinerQueryString]List Page State Not available, unable to build refiner URL`);\n            return '';\n        }\n    }\n\n    private _onChoiceClicked = (notification: IChoiceSummaryClickNotification): void => {\n        const { data, telemetry } = this.props;\n\n        if (!data.listPageState.result) {\n            telemetry.warning('[choice-summary-by-category._onChoiceClicked]ListPageState unavailable, unable to update refiners.');\n            return;\n        }\n\n        let currentRefinementCriteria = (data.listPageState.result && data.listPageState.result.activeFilters) || [];\n\n        if (!notification.clearAll) {\n            const selectedChoice = notification.choiceClicked;\n            if (!selectedChoice) {\n                telemetry.warning('[choice-summary-by-category._onChoiceClicked] Choice could not be determined');\n                return;\n            }\n            currentRefinementCriteria = currentRefinementCriteria.filter(\n                (selectedCriterion: ProductRefinerValue) => !isMatchingRefinementCriterion(selectedChoice, selectedCriterion)\n            );\n        } else {\n            currentRefinementCriteria = [];\n\n            // set focus to sort and filter\n            const dropdownElementId = this._sortAndFilterContainerRef.current && this._sortAndFilterContainerRef.current.props.dropdownId;\n            const dropdownElement = dropdownElementId && document.getElementById(dropdownElementId);\n            setTimeout(() => {\n                dropdownElement && dropdownElement.focus();\n            },\n                       50);\n        }\n\n        const fullUrl = getCurrentUrl(this.props.context.request);\n        window.history.pushState({}, '', buildListPageUrl(fullUrl, currentRefinementCriteria));\n        data.listPageState.result.currentPageNumber = 0;\n        data.listPageState.result.activeFilters = currentRefinementCriteria;\n    }\n\n    private _buildRefinerUrlForChoiceSummary = (selectedRefiner: ProductRefinerValue, isClearAll: boolean): string => {\n        const { data, telemetry } = this.props;\n        const fullUrl = getCurrentUrl(this.props.context.request);\n\n        if (!data.listPageState.result) {\n            telemetry.warning('[choice-summary-by-category._buildRefinerUrl]ListPageState unavailable, unable to create refiner URL.');\n            return fullUrl.href;\n        }\n\n        let currentRefinementCriteria = (data.listPageState.result && data.listPageState.result.activeFilters) || [];\n\n        if (!isClearAll) {\n            if (!selectedRefiner) {\n                telemetry.warning('[choice-summary-by-category._buildRefinerUrl] URL for Choice could not be determined');\n                return fullUrl.href;\n            }\n            currentRefinementCriteria = currentRefinementCriteria.filter(\n                (selectedCriterion: ProductRefinerValue) => !isMatchingRefinementCriterion(selectedRefiner, selectedCriterion)\n            );\n        } else {\n            currentRefinementCriteria = [];\n        }\n\n        return buildListPageUrl(fullUrl, currentRefinementCriteria);\n    }\n\n    private _getViewport(): GridSize {\n        const { context } = this.props;\n\n        // always render in mobile viewport on a mobile device\n        if (context.request && context.request.device && context.request.device.Type === 'Mobile') {\n            return 'xs';\n        }\n\n        if (MsDyn365.isBrowser && window.innerWidth) {\n            const gridSettings = context.request.gridSettings;\n            if (gridSettings) {\n                if (gridSettings.xs && window.innerWidth <= gridSettings.xs.w) {\n                    return 'xs';\n                } else if (gridSettings.sm && window.innerWidth <= gridSettings.sm.w) {\n                    return 'sm';\n                } else if (gridSettings.md && window.innerWidth <= gridSettings.md.w) {\n                    return 'md';\n                } else if (gridSettings.lg && window.innerWidth <= gridSettings.lg.w) {\n                    return 'lg';\n                } else {\n                    return 'xl';\n                }\n            }\n        }\n\n        return 'lg';\n    }\n\n    private _toggleModal(): void {\n        this.setState({\n            modalIsOpen: !this.state.modalIsOpen\n        });\n    }\n\n    private _updateViewport(): void {\n        this._viewport = this._getViewport();\n\n        if (this.state.modalIsOpen && !this.isMobile) {\n            this._toggleModal();\n        }\n    }\n\n    private _getexpandRefinerCount = (refinerCount?: expandRefinersCount): void => {\n        switch(refinerCount) {\n            case expandRefinersCount.all:\n                this.expandrefinerCount = 0;\n                break;\n            case expandRefinersCount.one:\n                this.expandrefinerCount = 1;\n                break;\n            case expandRefinersCount.two:\n               this.expandrefinerCount = 2;\n               break;\n            case expandRefinersCount.three:\n                this.expandrefinerCount = 3;\n                break;\n            case expandRefinersCount.four:\n                this.expandrefinerCount = 4;\n                break;\n            default:\n                this.expandrefinerCount = 0;\n        }\n    }\n\n}\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}