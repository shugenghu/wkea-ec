{"ast":null,"code":"import*as React from'react';import{getPayloadObject,getTelemetryAttributes}from'@msdyn365-commerce-modules/utilities';import{getRichTextHtml}from'@msdyn365-commerce/core';var payLoad;export var KeywordSuggestionsComponent=function KeywordSuggestionsComponent(props){var suggestions=props.suggestions,hitPrefix=props.hitPrefix,hitSuffix=props.hitSuffix;if(!suggestions){return undefined;}payLoad=getPayloadObject('click',props.telemetryContent,'');var reactNodes=[];suggestions.map(function(item){reactNodes.push(_assembleNode(item,hitPrefix,hitSuffix,props));});return{text:reactNodes};};var _assembleNode=function _assembleNode(item,hitPrefix,hitSuffix,props){var ariaLabel=item.Value&&item.Value.replace(new RegExp(\"[\".concat(hitPrefix,\"]\"),'gi'),'').replace(new RegExp(\"[\".concat(hitSuffix,\"]\"),'gi'),'');payLoad.contentAction.etext=ariaLabel;var attribute=getTelemetryAttributes(props.telemetryContent,payLoad);return/*#__PURE__*/React.createElement(\"li\",{className:'msc-autoSuggest__keywordResults-item',key:item.Id},/*#__PURE__*/React.createElement(\"a\",Object.assign({\"aria-label\":ariaLabel,href:_generateLink(item,hitPrefix,hitSuffix,props)},attribute),_generateLink(item,hitPrefix,hitSuffix,props)&&_getHighlightedText(item.Value?item.Value:'',hitPrefix,hitSuffix)));};var _generateLink=function _generateLink(suggestion,hitPrefix,hitSuffix,props){var searchPageURL=props.searchPageURL,searchQsp=props.searchQsp;var formattedLink=suggestion.Value.replace(new RegExp(\"[\".concat(hitPrefix,\"]\"),'gi'),'').replace(new RegExp(\"[\".concat(hitSuffix,\"]\"),'gi'),'');var route=searchPageURL||'';return formattedLink&&formattedLink.length>0?\"\".concat(route).concat(route.indexOf('?')===-1?'?':'&').concat(searchQsp,\"=\").concat(formattedLink):route;};var _getHighlightedText=function _getHighlightedText(suggestion,hitPrefix,hitSuffix){var formattedText=suggestion.replace(new RegExp(\"[\".concat(hitPrefix,\"]\"),'gi'),'<strong>').replace(new RegExp(\"[\".concat(hitSuffix,\"]\"),'gi'),'</strong>');return/*#__PURE__*/React.createElement(\"span\",{dangerouslySetInnerHTML:getRichTextHtml(formattedText)});};","map":{"version":3,"sources":["modules/search/components/search.keywordsuggest.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as React from 'react';\n\nimport { getPayloadObject, getTelemetryAttributes, IPayLoad, ITelemetryContent } from '@msdyn365-commerce-modules/utilities';\nimport { getRichTextHtml } from '@msdyn365-commerce/core';\nimport { SearchSuggestion } from '@msdyn365-commerce/retail-proxy';\n\nimport { ISearchData } from '../search.data';\nimport { ISearchProps } from '../search.props.autogenerated';\n\nexport interface ISearchKeywordSuggestProps {\n    searchKeywordSuggestClass: string;\n    searchPageURL: string;\n    searchQsp: string | undefined;\n    hitPrefix: string;\n    hitSuffix: string;\n    autoSuggestProps: ISearchProps<ISearchData>;\n    searchText: string;\n    suggestions: SearchSuggestion[] | undefined;\n    telemetryContent?: ITelemetryContent;\n}\n\nexport interface ISearchKeywordViewProps {\n    text: React.ReactNode[];\n}\n\nlet payLoad: IPayLoad;\n\n/**\n *\n * KeywordSuggestionsComponent\n */\nexport const KeywordSuggestionsComponent = (props: ISearchKeywordSuggestProps): ISearchKeywordViewProps | undefined => {\n    const {\n        suggestions,\n        hitPrefix,\n        hitSuffix\n    } = props;\n\n    if (!suggestions) {\n        return undefined;\n    }\n\n    payLoad = getPayloadObject('click', props.telemetryContent!, '');\n\n    const reactNodes: React.ReactNode[] = [];\n\n    suggestions.map(item => {\n        reactNodes.push(_assembleNode(item, hitPrefix, hitSuffix, props));\n    });\n\n    return { text: reactNodes };\n};\n\nconst _assembleNode = (item: SearchSuggestion, hitPrefix: string, hitSuffix: string, props: ISearchKeywordSuggestProps) => {\n    const ariaLabel = item.Value &&\n    (item.Value).replace(new RegExp(`[${hitPrefix}]`, 'gi'), '').replace(new RegExp(`[${hitSuffix}]`, 'gi'), '');\n    payLoad.contentAction.etext = ariaLabel;\n    const attribute = getTelemetryAttributes(props.telemetryContent!, payLoad);\n    return (\n        <li className='msc-autoSuggest__keywordResults-item' key={item.Id}>\n            <a\n                aria-label={ariaLabel}\n                href={_generateLink(item, hitPrefix, hitSuffix, props)}\n                {...attribute}\n            >\n                {_generateLink(item, hitPrefix, hitSuffix, props) &&\n                    _getHighlightedText(item.Value ? item.Value : '', hitPrefix, hitSuffix)}\n            </a>\n        </li>\n    );\n};\n\nconst _generateLink = (suggestion: SearchSuggestion, hitPrefix: string, hitSuffix: string, props: ISearchKeywordSuggestProps): string => {\n    const { searchPageURL, searchQsp } = props;\n\n    const formattedLink = (suggestion.Value as string)\n        .replace(new RegExp(`[${hitPrefix}]`, 'gi'), '')\n        .replace(new RegExp(`[${hitSuffix}]`, 'gi'), '');\n    const route = searchPageURL || '';\n    return formattedLink && formattedLink.length > 0\n        ? `${route}${route.indexOf('?') === -1 ? '?' : '&'}${searchQsp}=${formattedLink}`\n        : route;\n};\n\nconst _getHighlightedText = (suggestion: string, hitPrefix: string, hitSuffix: string): JSX.Element => {\n    const formattedText = suggestion\n        .replace(new RegExp(`[${hitPrefix}]`, 'gi'), '<strong>')\n        .replace(new RegExp(`[${hitSuffix}]`, 'gi'), '</strong>');\n\n    // tslint:disable:react-no-dangerous-html\n    return <span dangerouslySetInnerHTML={getRichTextHtml(formattedText)} />;\n};\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}