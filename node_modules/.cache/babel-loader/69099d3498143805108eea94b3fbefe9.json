{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _inherits from\"@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/esm/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import{__decorate}from\"tslib\";import get from'lodash/get';import{observer}from'mobx-react';import*as React from'react';import GuidedCard from'../components/guided-card';var CheckoutGuidedForm=/*#__PURE__*/function(_React$Component){_inherits(CheckoutGuidedForm,_React$Component);var _super=_createSuper(CheckoutGuidedForm);function CheckoutGuidedForm(){var _this;_classCallCheck(this,CheckoutGuidedForm);_this=_super.apply(this,arguments);_this.state={currentStep:0};_this.getEnabledModules=function(){var _this$props$moduleSta=_this.props.moduleState,childIds=_this$props$moduleSta.childIds,getModule=_this$props$moduleSta.getModule;return childIds.filter(function(childId){var state=getModule(childId);return!!state&&!state.isDisabled;});};_this.getStep=function(id){return _this.getEnabledModules().indexOf(id);};_this.getId=function(item){return get(item,'props.id')||'';};_this.getHeading=function(item){return get(item,'props.config.heading')||'';};_this.isExpanded=function(step){if(_this.props.isEditor){return true;}return step>-1&&step<=_this.state.currentStep;};_this.isActive=function(step){return step===_this.state.currentStep;};_this.isVisted=function(step){return step>-1&&step<_this.state.currentStep;};_this.onNext=function(){_this.setState({currentStep:_this.state.currentStep+1});};return _this;}_createClass(CheckoutGuidedForm,[{key:\"componentDidMount\",value:function componentDidMount(){var childIds=this.props.items.map(function(item){return get(item,'props.id');});this.props.moduleState.init({childIds:childIds});}},{key:\"render\",value:function render(){var _this2=this;var _this$props=this.props,moduleState=_this$props.moduleState,items=_this$props.items,resource=_this$props.resource;if(!items||!moduleState){return null;}return/*#__PURE__*/React.createElement(\"div\",{className:'ms-checkout__guided-form'},items.map(function(item){var childId=_this2.getId(item);var step=_this2.getStep(childId);var title=_this2.getHeading(item);var state=_this2.props.moduleState.getModule(childId);var _ref=state||{},isReady=_ref.isReady,isPending=_ref.isPending,isUpdating=_ref.isUpdating,isDisabled=_ref.isDisabled,isCancelAllowed=_ref.isCancelAllowed,onEdit=_ref.onEdit,onCancel=_ref.onCancel,onSubmit=_ref.onSubmit,hasModuleState=_ref.hasModuleState,hasInitialized=_ref.hasInitialized;return/*#__PURE__*/React.createElement(GuidedCard,{key:childId,step:step,title:title,resource:resource,disabled:!hasModuleState||isDisabled,isActive:_this2.isActive(step),isVisted:_this2.isVisted(step),isExpanded:_this2.isExpanded(step),isSubmitting:isPending,isMobile:_this2.props.isMobile,isPending:isPending,isUpdating:isUpdating,hasInitialized:hasInitialized,isReady:isReady,isCancelAllowed:isCancelAllowed,onSubmit:onSubmit,onCancel:onCancel,onEdit:onEdit,onNext:_this2.onNext,hasControlGroup:!_this2.props.disableGuidedCheckoutFlow&&hasInitialized,telemetryContent:_this2.props.telemetryContent},/*#__PURE__*/React.cloneElement(item,{enableControl:true}));}));}}]);return CheckoutGuidedForm;}(React.Component);CheckoutGuidedForm=__decorate([observer],CheckoutGuidedForm);export default CheckoutGuidedForm;","map":{"version":3,"sources":["modules/checkout/components/guided-form.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/ //\nimport { IModuleStateManager } from '@msdyn365-commerce-modules/checkout-utilities';\nimport { Heading } from '@msdyn365-commerce-modules/data-types';\nimport { ITelemetryContent } from '@msdyn365-commerce-modules/utilities';\nimport get from 'lodash/get';\nimport { observer } from 'mobx-react';\nimport * as React from 'react';\nimport GuidedCard from '../components/guided-card';\n\nexport interface ICheckoutGuidedFormProps {\n    items: React.ReactNode[];\n    moduleState: IModuleStateManager;\n    disableGuidedCheckoutFlow?: boolean;\n    isMobile?: boolean;\n    isEditor?: boolean;\n    resource: {\n        checkoutStepTitleFormat: string;\n        saveBtnLabel: string;\n        changeBtnLabel: string;\n        cancelBtnLabel: string;\n        saveAndContinueBtnLabel: string;\n    };\n    telemetryContent?: ITelemetryContent;\n}\n\ninterface ICheckoutGuidedFormState {\n    currentStep: number;\n}\n\n/**\n *\n * CheckoutGuidedForm component\n * @extends {React.Component<ICheckoutGuidedFormProps>}\n */\n@observer\nclass CheckoutGuidedForm extends React.Component<ICheckoutGuidedFormProps> {\n    public state: ICheckoutGuidedFormState = {\n        currentStep: 0\n    };\n\n    public componentDidMount(): void {\n        /**\n         * Append child modules\n         */\n        const childIds = this.props.items.map((item: React.ReactNode) => get(item, 'props.id'));\n        this.props.moduleState.init({ childIds });\n    }\n\n    public render(): JSX.Element | null {\n        const { moduleState, items, resource } = this.props;\n        if (!items || !moduleState) {\n            return null;\n        }\n\n        return (\n            <div className='ms-checkout__guided-form'>\n                {items.map((item: React.ReactNode) => {\n                    const childId = this.getId(item);\n                    const step = this.getStep(childId);\n                    const title = this.getHeading(item);\n                    const state = this.props.moduleState.getModule(childId);\n                    const { isReady, isPending, isUpdating, isDisabled, isCancelAllowed, onEdit, onCancel, onSubmit, hasModuleState, hasInitialized } =\n                        state || ({} as IModuleStateManager);\n                    return (\n\n                        <GuidedCard\n                            key={childId}\n                            step={step}\n                            title={title}\n                            resource={resource}\n                            disabled={!hasModuleState || isDisabled}\n                            isActive={this.isActive(step)}\n                            isVisted={this.isVisted(step)}\n                            isExpanded={this.isExpanded(step)}\n                            isSubmitting={isPending}\n                            isMobile={this.props.isMobile}\n                            isPending={isPending}\n                            isUpdating={isUpdating}\n                            hasInitialized={hasInitialized}\n                            isReady={isReady}\n                            isCancelAllowed={isCancelAllowed}\n                            onSubmit={onSubmit}\n                            onCancel={onCancel}\n                            onEdit={onEdit}\n                            onNext={this.onNext}\n                            hasControlGroup={!this.props.disableGuidedCheckoutFlow && hasInitialized}\n                            telemetryContent= {this.props.telemetryContent}\n                        >\n                            {React.cloneElement(item as React.ReactElement, { enableControl: true })}\n                        </GuidedCard>\n                    );\n                })}\n            </div>\n        );\n    }\n\n    private getEnabledModules = (): string[] => {\n        const {\n            moduleState: { childIds, getModule }\n        } = this.props;\n        return childIds.filter((childId: string) => {\n            const state = getModule(childId);\n            return !!state && !state.isDisabled;\n        });\n    };\n\n    private getStep = (id: string): number => {\n        return this.getEnabledModules().indexOf(id);\n    };\n\n    private getId = (item: React.ReactNode): string => {\n        return get(item, 'props.id') || '';\n    };\n\n    private getHeading = (item: React.ReactNode): Heading => {\n        return get(item, 'props.config.heading') || '';\n    };\n\n    private isExpanded = (step: number): boolean => {\n        if (this.props.isEditor) {\n            // Editorial mode: Expand all the drawers\n            return true;\n        }\n        return step > -1 && step <= this.state.currentStep;\n    };\n\n    private isActive = (step: number): boolean => {\n        return step === this.state.currentStep;\n    };\n\n    private isVisted = (step: number): boolean => {\n        return step > -1 && step < this.state.currentStep;\n    };\n\n    private onNext = (): void => {\n        this.setState({\n            currentStep: this.state.currentStep + 1\n        });\n    };\n}\n\nexport default CheckoutGuidedForm;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}