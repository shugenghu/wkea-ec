{"ast":null,"code":"import\"core-js/modules/es.object.assign.js\";import\"core-js/modules/es.promise.js\";import\"core-js/modules/es.string.replace.js\";import\"core-js/modules/es.string.split.js\";import\"core-js/modules/web.dom-collections.for-each.js\";import\"core-js/modules/web.dom-collections.iterator.js\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import{__decorate}from\"tslib\";import{updateCustomerAttributes,updateCustomerAttributesInput}from'@msdyn365-commerce-modules/retail-actions';import{Button,format,getPayloadObject,getTelemetryAttributes,getTelemetryObject,isNullOrWhiteSpace}from'@msdyn365-commerce-modules/utilities';import MsDyn365,{Text}from'@msdyn365-commerce/core';import classnames from'classnames';import{observable,reaction}from'mobx';import{observer}from'mobx-react';import*as React from'react';import TextComponent from'./account-profile-text';let AccountProfileAttributes=class AccountProfileAttributes extends React.Component{constructor(props){super(props);this.isUpdatingAttributes=false;this.gotException=false;this.hasError=false;this.attributeClassName='ms-account-profile__attributes-element';this.maxIntegerLimit=2100000000;this.minIntegerLimit=-2100000000;this.maxDecimalLimit=7900000000000;this.minDecimalLimit=-7900000000000;this.maxStringLength=1000;this.maxVATNumberLength=20;this.maxPhoneLength=25;this._renderAttributes=()=>{const{config,data,resources}=this.props.accountProfileProps;const attributeDefinitions=data.attributeDefinitions.result||[];const additionalInformationSectionHeading=config.additionalInformationSectionHeading&&config.additionalInformationSectionHeading.text||'';const showAttributes=config.showAttributes||'';const attributes=showAttributes.split(',');const elements=attributes.map(att=>{const attributeDefinition=attributeDefinitions.find(attribute=>attribute.IsHidden===false&&attribute.Name.toLocaleLowerCase()===att.toLocaleLowerCase())||{RecordId:0};return this._renderAttribute(attributeDefinition);});const edit=this.state&&this.state.editAttributes||false;this.payLoad.contentAction.etext=\"\".concat(resources.attributesEditButtonText,\" \").concat(additionalInformationSectionHeading);const editAttributes=getTelemetryAttributes(this.telemetryContent,this.payLoad);this.payLoad.contentAction.etext=\"\".concat(resources.attributesSaveButtonText,\" \").concat(additionalInformationSectionHeading);const saveAttributes=getTelemetryAttributes(this.telemetryContent,this.payLoad);this.payLoad.contentAction.etext=\"\".concat(resources.attributesCancelButtonText,\" \").concat(additionalInformationSectionHeading);const cancelAttributes=getTelemetryAttributes(this.telemetryContent,this.payLoad);return/*#__PURE__*/React.createElement(\"div\",{ref:this.attributesContainerRef,className:classnames('ms-account-profile__attributes',{'ms-account-profile__attributes-updating':this.isUpdatingAttributes})},config.additionalInformationSectionHeading&&/*#__PURE__*/React.createElement(Text,{className:'ms-account-profile__attributes-tile__heading',tag:config.additionalInformationSectionHeading.tag||'h2',text:additionalInformationSectionHeading}),config.showPhone&&this._renderPhone(),config.showVatNumber&&this._renderVatNumber(),elements,this.gotException&&/*#__PURE__*/React.createElement(\"div\",{className:'ms-account-profile__attributes-error'},/*#__PURE__*/React.createElement(\"label\",{className:'ms-account-profile__attributes-error-label'},this.props.accountProfileProps.resources.attributesSaveExceptionMessage)),!edit&&/*#__PURE__*/React.createElement(Button,Object.assign({className:classnames('ms-account-profile__attributes-edit-button'),\"aria-label\":\"\".concat(resources.attributesEditButtonText,\" \").concat(additionalInformationSectionHeading),onClick:this._enableAttributes,innerRef:this.editRef,title:resources.attributesEditButtonText},editAttributes),resources.attributesEditButtonText),edit&&/*#__PURE__*/React.createElement(Button,Object.assign({className:classnames('ms-account-profile__attributes-save-button'),\"aria-label\":resources.attributesSaveButtonText,onClick:this._saveAttributes,title:resources.attributesSaveButtonText},saveAttributes),resources.attributesSaveButtonText),edit&&/*#__PURE__*/React.createElement(Button,Object.assign({className:classnames('ms-account-profile__attributes-cancel-button'),\"aria-label\":resources.attributesCancelButtonText,onClick:this._disableAttributes,title:resources.attributesCancelButtonText},cancelAttributes),resources.attributesCancelButtonText));};this._renderPhone=()=>{const{phoneSectionHeading}=this.props.accountProfileProps.config;const heading=phoneSectionHeading&&phoneSectionHeading.text||'';const className=heading&&heading.replace(/ /g,'_')||'';const editAttributes=this.state&&this.state.editAttributes||false;return/*#__PURE__*/React.createElement(\"div\",{className:classnames('ms-account-profile__attributes__section',\"ms-account-profile__attributes-\".concat(className))},phoneSectionHeading&&/*#__PURE__*/React.createElement(Text,{className:\"ms-account-profile__attributes__section-heading\",tag:'h3',text:heading}),/*#__PURE__*/React.createElement(\"input\",{type:'text',\"aria-label\":heading,className:classnames(this.attributeClassName,'ms-account-profile__attributes_input',\"ms-account-profile__attributes_input-edit-\".concat(editAttributes),\"ms-account-profile__\".concat(className,\"-input\")),onChange:this._onPhoneChange,value:this.state.phone||'',disabled:!editAttributes}),this._renderError('Phone'));};this._renderVatNumber=()=>{const{vatNumberSectionHeading}=this.props.accountProfileProps.config;const heading=vatNumberSectionHeading&&vatNumberSectionHeading.text||'';const className=heading&&heading.replace(/ /g,'_')||'';const editAttributes=this.state&&this.state.editAttributes||false;return/*#__PURE__*/React.createElement(\"div\",{className:classnames('ms-account-profile__attributes__section',\"ms-account-profile__attributes-\".concat(className))},vatNumberSectionHeading&&/*#__PURE__*/React.createElement(Text,{className:\"ms-account-profile__attributes__section-heading\",tag:'h3',text:heading}),/*#__PURE__*/React.createElement(\"input\",{type:'text',\"aria-label\":heading,className:classnames(this.attributeClassName,'ms-account-profile__attributes_input',\"ms-account-profile__attributes_input-edit-\".concat(editAttributes),\"ms-account-profile__\".concat(className,\"-input\")),onChange:this._onVatNumberChange,value:this.state.vatNumber||'',disabled:!editAttributes}),this._renderError('VATNumber'));};this._renderAttribute=customAttribute=>{const editAttributes=this.state&&this.state.editAttributes||false;const className=customAttribute.Name&&customAttribute.Name.replace(/ /g,'_')||'';switch(customAttribute.ExtDataType&&customAttribute.ExtDataType.Value){case 4:case 3:return this._renderIntegerDecimalInput(customAttribute,className,editAttributes);case 5:return this._renderTextInputOrSelect(customAttribute,className,editAttributes);case 6:return this._renderBoolean(customAttribute,className,editAttributes);default:return null;}};this._renderIntegerDecimalInput=(customAttribute,className,editAttributes)=>{const edit=this.state&&this.state.editAttributes||false;const attributeProps=this._getAttributeProps(customAttribute.Name||'');const displayName=(attributeProps===null||attributeProps===void 0?void 0:attributeProps.Name)||'';return/*#__PURE__*/React.createElement(\"div\",{className:classnames('ms-account-profile__attributes__section',\"ms-account-profile__attributes-\".concat(className))},/*#__PURE__*/React.createElement(Text,{className:\"ms-account-profile__attributes__section-heading\",tag:'h3',text:displayName}),/*#__PURE__*/React.createElement(\"input\",{type:'text',\"aria-label\":customAttribute.Name,className:classnames(this.attributeClassName,'ms-account-profile__attributes_input',\"ms-account-profile__attributes_input-edit-\".concat(edit),\"ms-account-profile__\".concat(className,\"-input\")),onChange:this._onAttributeChange(customAttribute),value:this.state.attributes[customAttribute.Name||'']||'',disabled:!editAttributes,\"aria-required\":(attributeProps===null||attributeProps===void 0?void 0:attributeProps.IsMandatory)||false}),this._renderError(customAttribute.Name||''));};this._renderTextInputOrSelect=(customAttribute,className,editAttributes)=>{const isEnumeration=customAttribute.IsEnumeration||false;const edit=this.state&&this.state.editAttributes||false;const attributeProps=this._getAttributeProps(customAttribute.Name||'');const displayName=(attributeProps===null||attributeProps===void 0?void 0:attributeProps.Name)||'';if(isEnumeration&&customAttribute.EnumerationDetails){const value=this.state.attributes[customAttribute.Name||'']||'';const hasNoValue=value===''?true:false;return/*#__PURE__*/React.createElement(\"div\",{className:classnames('ms-account-profile__attributes__section',\"ms-account-profile__attributes-\".concat(className))},/*#__PURE__*/React.createElement(Text,{className:\"ms-account-profile__attributes__section-heading\",tag:'h3',text:displayName}),/*#__PURE__*/React.createElement(\"select\",{id:\"ms-account-profile__attributes-\".concat(className),\"aria-label\":customAttribute.Name,className:classnames(this.attributeClassName,'ms-account-profile__attributes_select',\"ms-account-profile__attributes_select-edit-\".concat(edit),\"ms-account-profile__attributes-\".concat(className,\"_select\")),onChange:this._onAttributeSelect(customAttribute),disabled:!editAttributes,\"aria-required\":(attributeProps===null||attributeProps===void 0?void 0:attributeProps.IsMandatory)||false},hasNoValue&&/*#__PURE__*/React.createElement(\"option\",{className:'ms-account-profile__attributes_select__option',key:'blank',selected:hasNoValue,\"aria-selected\":hasNoValue}),customAttribute.EnumerationDetails.map(option=>{const selected=option.EnumerationValue===this.state.attributes[customAttribute.Name||''];return/*#__PURE__*/React.createElement(\"option\",{className:'ms-account-profile__attributes_select__option',key:option.EnumerationValue,selected:selected,\"aria-selected\":selected},option.EnumerationValue);})));}else{return/*#__PURE__*/React.createElement(\"div\",{className:classnames('ms-account-profile__attributes__section',\"ms-account-profile__attributes-\".concat(className))},/*#__PURE__*/React.createElement(Text,{className:\"ms-account-profile__attributes__section-heading\",tag:'h3',text:displayName}),/*#__PURE__*/React.createElement(\"input\",{type:'text',\"aria-label\":customAttribute.Name,className:classnames(this.attributeClassName,'ms-account-profile__attributes_input',\"ms-account-profile__attributes_input-edit-\".concat(edit),\"ms-account-profile__\".concat(className,\"-input\")),onChange:this._onAttributeChange(customAttribute),value:this.state.attributes[customAttribute.Name||'']||'',disabled:!editAttributes,\"aria-required\":(attributeProps===null||attributeProps===void 0?void 0:attributeProps.IsMandatory)||false}),this._renderError(customAttribute.Name||''));}};this._renderBoolean=(customAttribute,className,editAttributes)=>{let value=this.state.attributes[customAttribute.Name||'']||'';const hasNoValue=value===''?true:false;const render=hasNoValue&&!editAttributes?false:true;value=value||'false';const toggleState=value==='true'&&'enable'||'disable';const arialabel=format(this.props.accountProfileProps.resources.attributeToggleButtonAriaLabel,customAttribute.Name);const ariaPressed=value==='true'&&true||false;const attributeProps=this._getAttributeProps(customAttribute.Name||'');const displayName=(attributeProps===null||attributeProps===void 0?void 0:attributeProps.Name)||'';let toggleValue='false';if(value==='true'){toggleValue='false';}else{toggleValue='true';}return/*#__PURE__*/React.createElement(\"div\",{className:classnames('ms-account-profile__attributes__section','ms-account-profile__attributes__section__toggle',\"ms-account-profile__attributes-\".concat(className))},/*#__PURE__*/React.createElement(Text,{className:\"ms-account-profile__attributes__section-heading\",tag:'h3',text:displayName}),render&&/*#__PURE__*/React.createElement(\"div\",{className:\"ms-account-profile__attributes__section__toggle-wrapper ms-account-profile__attributes__section__toggle-\".concat(toggleState)},/*#__PURE__*/React.createElement(TextComponent,{className:'ms-account-profile__attributes__section__toggle-disable-text',text:this.props.accountProfileProps.resources.toggleDisableText}),/*#__PURE__*/React.createElement(Button,{className:classnames(this.attributeClassName,'ms-account-profile__attributes__section__toggle-button',\"ms-account-profile__attributes__section__toggle-\".concat(toggleState,\"-button\")),\"aria-label\":\"\".concat(arialabel),\"aria-pressed\":ariaPressed,value:value,onClick:this._onAttributeCheck(customAttribute,toggleValue),disabled:!editAttributes}),/*#__PURE__*/React.createElement(TextComponent,{className:'ms-account-profile__attributes__section__toggle-enable-text',text:this.props.accountProfileProps.resources.toggleEnableText})));};this._renderError=attributeName=>{const error=this.state&&this.state.attributeError&&this.state.attributeError[attributeName]||'';const hasError=!isNullOrWhiteSpace(error);if(hasError){return/*#__PURE__*/React.createElement(\"div\",{className:'ms-account-profile__attributes-error',role:'alert',\"aria-live\":'assertive'},/*#__PURE__*/React.createElement(\"label\",{className:'ms-account-profile__attributes-error-label'},error));}return null;};this._getAttributeProps=attributeName=>{const attributePayloadData=this.attributePayloadData.filter(att=>att.name===attributeName);const isMandatory=attributePayloadData[0]&&attributePayloadData[0].isMandatory||false;return{Name:isMandatory?\"\".concat(attributeName||'',\" *\"):attributeName||'',IsMandatory:isMandatory};};this._onPhoneChange=event=>{const value=event.target.value;this.setState({phone:value});};this._onVatNumberChange=event=>{const value=event.target.value;this.setState({vatNumber:value});};this._enableAttributes=()=>{this.hasError=false;this.gotException=false;this.setState({editAttributes:true,attributeError:{}});if(MsDyn365.isBrowser){setTimeout(()=>{var _this$attributesConta;if((_this$attributesConta=this.attributesContainerRef)!==null&&_this$attributesConta!==void 0&&_this$attributesConta.current){const attributes=this.attributesContainerRef.current.getElementsByClassName(this.attributeClassName);if(attributes&&attributes.length>0){this._setFocus(attributes[0]);}}},0);}};this._disableAttributes=()=>{this.setState({editAttributes:false,attributeError:{},attributes:this.initialAttributes,phone:this.initialPhone,vatNumber:this.initialVatNumber});if(MsDyn365.isBrowser){setTimeout(()=>{this._setFocus(this.editRef.current);},0);}};this._onAttributeChange=attributeDefinition=>event=>{const value=event.target.value;const name=attributeDefinition.Name||'';this.setState({attributes:_objectSpread(_objectSpread({},this.state.attributes),{},{[name]:value})});};this._onAttributeCheck=(attributeDefinition,value)=>event=>{const name=attributeDefinition.Name||'';this.setState({attributes:_objectSpread(_objectSpread({},this.state.attributes),{},{[name]:value})});};this._onAttributeSelect=attributeDefinition=>event=>{const value=event.currentTarget.selectedOptions[0].value;const index=event.currentTarget.selectedOptions[0].index;const name=attributeDefinition.Name||'';this.setState({attributes:_objectSpread(_objectSpread({},this.state.attributes),{},{[name]:value}),selectedIndex:_objectSpread(_objectSpread({},this.state.selectedIndex),{},{[name]:index})});};this._getAttributes=()=>{const{config,data}=this.props.accountProfileProps;const showAttributes=config.showAttributes||'';const showAttributesArray=showAttributes.split(',');const customer=data.customerInformation.result;const custmerAttributes=customer&&customer.Attributes||[];const attributes={};showAttributesArray.forEach(showAttribute=>{const attributePayloadData=this.attributePayloadData.filter(att=>att.name===showAttribute);const isMandatory=attributePayloadData[0]&&attributePayloadData[0].isMandatory||false;const defaultValue=attributePayloadData[0]&&attributePayloadData[0].defaultValue;const attribute=custmerAttributes.find(att=>att.Name===showAttribute);let value='';if(attribute&&attribute.AttributeValue){const name=attribute&&attribute.Name||'';switch(attribute.DataTypeValue){case 4:if(attribute.AttributeValue.IntegerValue){value=String(attribute.AttributeValue.IntegerValue);attributes[name]=value;}break;case 3:if(attribute.AttributeValue.DecimalValue){value=String(attribute.AttributeValue.DecimalValue);attributes[name]=value;}break;case 5:if(attribute.AttributeValue.StringValue){value=attribute.AttributeValue.StringValue;attributes[name]=value;}break;case 6:if(attribute.AttributeValue.BooleanValue!==null){value=String(attribute.AttributeValue.BooleanValue);attributes[name]=value;}break;default:}}if(isNullOrWhiteSpace(value)&&isMandatory){attributes[showAttribute]='';}if(value.length===0&&defaultValue){attributes[showAttribute]=String(defaultValue);}});if(Object.keys(this.initialAttributes).length===0){this.initialAttributes=attributes;}this.setState({attributes:attributes});};this._addOrUpdateAttribute=customer=>{const{resources}=this.props.accountProfileProps;const{phone,vatNumber}=this.state;const attributeError={};let hasError=false;let hasValue=true;for(const[key,value]of Object.entries(this.state.attributes)){const payloadData=this.attributePayloadData.find(data=>data.name===key)||{};if(payloadData){switch(payloadData.dataTypeValue){case 3:const decimalValue=Number(value);if(isNaN(decimalValue)){const typeError=format(resources.attributeInputTypeErrorText,payloadData.name,'Decimal');attributeError[payloadData.name||'']=typeError;hasError=true;}else{if(payloadData.lowerBoundValue!==undefined&&payloadData.upperBoundValue!==undefined){if(decimalValue<payloadData.lowerBoundValue||decimalValue>payloadData.upperBoundValue){const rangeError=format(resources.attributeInputRangeErrorText,payloadData.name,payloadData.lowerBoundValue,payloadData.upperBoundValue);attributeError[payloadData.name||'']=rangeError;hasError=true;}}else{if(decimalValue>this.maxDecimalLimit){attributeError[payloadData.name||'']=format(resources.attributeInputValueExceedsMaximumErrorText,payloadData.name,this.maxDecimalLimit);hasError=true;}if(decimalValue<this.minDecimalLimit){attributeError[payloadData.name||'']=format(resources.attributeInputValueExceedsMinimumErrorText,payloadData.name,this.minDecimalLimit);hasError=true;}}}if(!hasError){if(isNullOrWhiteSpace(value)){hasValue=false;}else{payloadData.decimalValue=decimalValue;hasValue=true;}}break;case 4:const integerValue=Number(value);if(isNaN(integerValue)||value.indexOf('.')!==-1){const typeError=format(resources.attributeInputTypeErrorText,payloadData.name,'Integer');attributeError[payloadData.name||'']=typeError;hasError=true;}else{if(payloadData.lowerBoundValue!==undefined&&payloadData.upperBoundValue!==undefined){if(integerValue<payloadData.lowerBoundValue||integerValue>payloadData.upperBoundValue){const rangeError=format(resources.attributeInputRangeErrorText,payloadData.name,payloadData.lowerBoundValue,payloadData.upperBoundValue);attributeError[payloadData.name||'']=rangeError;hasError=true;}}else{if(integerValue>this.maxIntegerLimit){attributeError[payloadData.name||'']=format(resources.attributeInputValueExceedsMaximumErrorText,payloadData.name,this.maxIntegerLimit);hasError=true;}if(integerValue<this.minIntegerLimit){attributeError[payloadData.name||'']=format(resources.attributeInputValueExceedsMinimumErrorText,payloadData.name,this.minIntegerLimit);hasError=true;}}}if(!hasError){if(isNullOrWhiteSpace(value)){hasValue=false;}else{payloadData.integerValue=integerValue;hasValue=true;}}break;case 5:let trimValue='';if(!isNullOrWhiteSpace(value)){trimValue=value.trim();}if(trimValue.length>this.maxStringLength){attributeError[payloadData.name||'']=format(resources.attributeInputStringMaxLengthErrorText,payloadData.name,this.maxStringLength);hasError=true;}if(!hasError){payloadData.textValue=trimValue;}break;case 6:payloadData.booleanValue=value==='true'?true:false;break;default:}if(payloadData.isMandatory&&isNullOrWhiteSpace(value)){attributeError[payloadData.name||'']=format(resources.attributeInputMandatoryErrorText,payloadData.name);hasError=true;}const custmerAttributes=customer&&customer.Attributes||[];const attribute=custmerAttributes.find(att=>att.Name===key);const index=custmerAttributes.findIndex(att=>att.Name===key);if(index!==-1&&!hasValue){custmerAttributes.splice(index,1);}if(!hasError&&hasValue){if(attribute){attribute.Attribute=undefined;attribute.DataTypeValue=payloadData.dataTypeValue;attribute.Name=payloadData.name;attribute.RecordId=payloadData.recordId;attribute.Units=undefined;attribute.AttributeValue={IntegerValue:payloadData.integerValue,BooleanValue:payloadData.booleanValue,StringValue:payloadData.textValue,DecimalValue:payloadData.decimalValue};attribute.ExtensionProperties=[];attribute.NameTranslations=[];}else{custmerAttributes.push({'@odata.type':'#Microsoft.Dynamics.Commerce.Runtime.DataModel.CustomerAttribute',Attribute:undefined,DataTypeValue:payloadData.dataTypeValue,KeyName:payloadData.name,Name:payloadData.name,RecordId:payloadData.recordId,Units:undefined,AttributeValue:{'@odata.type':'#Microsoft.Dynamics.Commerce.Runtime.DataModel.CommercePropertyValue',IntegerValue:payloadData.integerValue,BooleanValue:payloadData.booleanValue,StringValue:payloadData.textValue,DecimalValue:payloadData.decimalValue},'ExtensionProperties@odata.type':'#Collection(Microsoft.Dynamics.Commerce.Runtime.DataModel.CommerceProperty)',ExtensionProperties:[],'NameTranslations@odata.type':'#Collection(Microsoft.Dynamics.Commerce.Runtime.DataModel.TextValueTranslation)',NameTranslations:[]});}}}}if(phone.trim().length>this.maxPhoneLength){attributeError[\"Phone\"]=format(resources.attributeInputStringMaxLengthErrorText,'Phone',this.maxPhoneLength);hasError=true;}else{customer.Phone=phone.trim();}if(vatNumber.trim().length>this.maxVATNumberLength){attributeError[\"VATNumber\"]=format(resources.attributeInputStringMaxLengthErrorText,'VAT Number',this.maxVATNumberLength);hasError=true;}else{customer.VatNumber=vatNumber.trim();}this.hasError=hasError;this.setState({attributeError:attributeError});};this._saveAttributes=async()=>{const{context,data}=this.props.accountProfileProps;const customer=data.customerInformation.result;if(customer&&context){this._addOrUpdateAttribute(customer);const input=new updateCustomerAttributesInput(customer.AccountNumber,customer.Attributes||[],context.request.apiSettings,customer.Phone,customer.VatNumber);this.isUpdatingAttributes=true;this.gotException=false;if(!this.hasError){this.setState({editAttributes:false});try{await updateCustomerAttributes(input,context.actionContext);}catch(error){this.gotException=true;customer.Attributes=this.initialCustomerAttributes;if(context.telemetry){context.telemetry.exception(error);context.telemetry.debug('Unable to update customer attributes');}this.setState({attributeError:{},attributes:this.initialAttributes,phone:this.initialPhone,vatNumber:this.initialVatNumber});}this.setState({editAttributes:false});if(!this.gotException){this.initialAttributes=this.state.attributes;this.initialCustomerAttributes=customer.Attributes;this.initialPhone=this.state.phone;this.initialVatNumber=this.state.vatNumber;}}this.isUpdatingAttributes=false;if(MsDyn365.isBrowser){setTimeout(()=>{this._setFocus(this.editRef.current);},0);}}};this._setFocus=element=>{element===null||element===void 0?void 0:element.focus();};this._buildPayloadData=()=>{const{data}=this.props.accountProfileProps;const attributeDefinitions=data.attributeDefinitions.result||[];const attributes={};attributeDefinitions.forEach(attributeDefinition=>{const attributePayloadData={};attributePayloadData.recordId=attributeDefinition.RecordId;attributePayloadData.name=attributeDefinition.Name;attributePayloadData.dataTypeValue=attributeDefinition.DataTypeValue;attributePayloadData.isEnumeration=attributeDefinition.IsEnumeration;attributePayloadData.isMandatory=attributeDefinition.IsMandatory;switch(attributeDefinition.DataTypeValue){case 4:const defaultIntegerValue=attributeDefinition.DefaultValue&&attributeDefinition.DefaultValue.IntegerValue;attributePayloadData.lowerBoundValue=attributeDefinition.LowerBound&&attributeDefinition.LowerBound.IntegerValue;attributePayloadData.upperBoundValue=attributeDefinition.UpperBound&&attributeDefinition.UpperBound.IntegerValue;if(attributePayloadData.name&&defaultIntegerValue){attributePayloadData.defaultValue=String(defaultIntegerValue);attributes[attributePayloadData.name]=String(defaultIntegerValue);}break;case 3:const defaultDecimalValue=attributeDefinition.DefaultValue&&attributeDefinition.DefaultValue.DecimalValue;attributePayloadData.lowerBoundValue=attributeDefinition.LowerBound&&attributeDefinition.LowerBound.DecimalValue;attributePayloadData.upperBoundValue=attributeDefinition.UpperBound&&attributeDefinition.UpperBound.DecimalValue;if(attributePayloadData.name&&defaultDecimalValue){attributePayloadData.defaultValue=String(defaultDecimalValue);attributes[attributePayloadData.name]=String(defaultDecimalValue);}break;case 5:const defaultStringValue=attributeDefinition.DefaultValue&&attributeDefinition.DefaultValue.StringValue;if(attributePayloadData.name&&defaultStringValue){attributePayloadData.defaultValue=defaultStringValue;attributes[attributePayloadData.name]=defaultStringValue;}break;case 6:const defaultBooleanValue=attributeDefinition.DefaultValue&&attributeDefinition.DefaultValue.BooleanValue||false;if(attributePayloadData.name){attributePayloadData.defaultValue=String(defaultBooleanValue);attributes[attributePayloadData.name]=String(defaultBooleanValue);}break;default:}this.attributePayloadData.push(attributePayloadData);});Object.keys(attributes).length>0&&this.setState({attributes:attributes});};this._getCustomerPhoneAndVatNumber=()=>{const customer=this.props.accountProfileProps.data.customerInformation.result;const phone=customer&&customer.Phone||'';const vatNumber=customer&&customer.VatNumber||'';this.setState({phone:phone,vatNumber:vatNumber});if(this.initialPhone.length===0){this.initialPhone=phone;}if(this.initialVatNumber.length===0){this.initialVatNumber=vatNumber;}};this.state={editAttributes:false,phone:'',vatNumber:'',attributes:{},attributeError:{}};this.initialAttributes={};this.initialCustomerAttributes=[];this.initialPhone='';this.initialVatNumber='';this.attributePayloadData=[];const telemetryPageName=this.props.accountProfileProps&&this.props.accountProfileProps.context&&this.props.accountProfileProps.context.request&&this.props.accountProfileProps.context.request.telemetryPageName||'';const friendlyName=this.props.accountProfileProps&&this.props.accountProfileProps.friendlyName||'';const telemetry=this.props.accountProfileProps&&this.props.accountProfileProps.telemetry||{};this.telemetryContent=getTelemetryObject(telemetryPageName,friendlyName,telemetry);this.payLoad=getPayloadObject('click',this.telemetryContent,'');this.editRef=/*#__PURE__*/React.createRef();this.attributesContainerRef=/*#__PURE__*/React.createRef();}componentDidMount(){this._buildPayloadData();this._getAttributes();this._getCustomerPhoneAndVatNumber();reaction(()=>this.props.accountProfileProps.data.customerInformation.result,()=>{const customerInformation=this.props.accountProfileProps.data.customerInformation.result;this.initialCustomerAttributes=customerInformation&&customerInformation.Attributes;this._getAttributes();this._getCustomerPhoneAndVatNumber();});reaction(()=>this.props.accountProfileProps.data.attributeDefinitions.result,()=>{this._buildPayloadData();});}render(){return this._renderAttributes();}};__decorate([observable],AccountProfileAttributes.prototype,\"isUpdatingAttributes\",void 0);__decorate([observable],AccountProfileAttributes.prototype,\"gotException\",void 0);AccountProfileAttributes=__decorate([observer],AccountProfileAttributes);export default AccountProfileAttributes;","map":{"version":3,"sources":["modules/account-profile/components/account-profile-attributes.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { updateCustomerAttributes, updateCustomerAttributesInput } from '@msdyn365-commerce-modules/retail-actions';\nimport { Button, format, getPayloadObject, getTelemetryAttributes, getTelemetryObject, IPayLoad, isNullOrWhiteSpace,ITelemetryContent } from '@msdyn365-commerce-modules/utilities';\nimport MsDyn365, { IDictionary, Text } from '@msdyn365-commerce/core';\nimport { AttributeDefinition, Customer, CustomerAttribute } from '@msdyn365-commerce/retail-proxy/dist/Entities/CommerceTypes.g';\nimport classnames from 'classnames';\nimport { observable, reaction } from 'mobx';\nimport { observer } from 'mobx-react';\nimport * as React from 'react';\nimport { IAccountProfileData } from '../account-profile.data';\nimport { IAccountProfileProps } from '../account-profile.props.autogenerated';\nimport TextComponent from './account-profile-text';\n\ninterface IAttributePropertiesType {\n    Name?: string;\n    IsMandatory?: boolean;\n  }\n\nexport interface IAccountProfileAttributesProps {\n    accountProfileProps: IAccountProfileProps<IAccountProfileData>;\n}\n\nexport const enum AccountAttributeDataTypeValue {\n    Decimal = 3,\n    Integer = 4,\n    Text = 5,\n    TrueFalse = 6\n}\n\nexport interface IAttributePayloadData {\n    recordId?: number;\n    name?: string;\n    dataTypeValue?: number;\n    isEnumeration?: boolean;\n    lowerBoundValue?: number;\n    upperBoundValue?: number;\n    decimalValue?: number;\n    integerValue?: number;\n    textValue?: string;\n    booleanValue?: boolean;\n    isMandatory?: boolean;\n    defaultValue?: string;\n}\n\nexport interface IAccountProfileAttributesState extends React.ComponentState {\n    editAttributes: boolean;\n    phone: string;\n    vatNumber: string;\n    attributes: IDictionary<string>;\n    attributeError: IDictionary<string>;\n}\n\n/**\n *\n * AccountProfileAttributes class\n * @extends {React.PureComponentIAccountProfileAttributesProps, IAccountProfileAttributesState>}\n */\n@observer\nclass AccountProfileAttributes extends React.Component<IAccountProfileAttributesProps, IAccountProfileAttributesState> {\n    private attributePayloadData: IAttributePayloadData[];\n    @observable private isUpdatingAttributes: boolean = false;\n    @observable private gotException: boolean = false;\n    private hasError: boolean = false;\n    private telemetryContent?: ITelemetryContent;\n    private initialAttributes: IDictionary<string>;\n    private initialCustomerAttributes?: CustomerAttribute[];\n    private initialPhone: string;\n    private initialVatNumber: string;\n    private payLoad: IPayLoad;\n    private editRef: React.RefObject<HTMLButtonElement>;\n    private readonly attributesContainerRef: React.RefObject<HTMLDivElement>;\n    private readonly attributeClassName: string = 'ms-account-profile__attributes-element';\n    private maxIntegerLimit: number = 2100000000;\n    private minIntegerLimit: number = -2100000000;\n    private maxDecimalLimit: number = 7900000000000;\n    private minDecimalLimit: number = -7900000000000;\n    private maxStringLength: number = 1000;\n    private maxVATNumberLength: number = 20;\n    private maxPhoneLength: number = 25;\n\n    constructor(props: IAccountProfileAttributesProps) {\n        super(props);\n        this.state = {\n            editAttributes: false,\n            phone: '',\n            vatNumber: '',\n            attributes: {},\n            attributeError: {}\n        };\n        this.initialAttributes = {};\n        this.initialCustomerAttributes = [];\n        this.initialPhone = '';\n        this.initialVatNumber = '';\n        this.attributePayloadData = [];\n        const telemetryPageName = this.props.accountProfileProps && this.props.accountProfileProps.context && this.props.accountProfileProps.context.request && this.props.accountProfileProps.context.request.telemetryPageName || '';\n        const friendlyName = this.props.accountProfileProps && this.props.accountProfileProps.friendlyName || '';\n        const telemetry = this.props.accountProfileProps && this.props.accountProfileProps.telemetry || {};\n        this.telemetryContent = getTelemetryObject(telemetryPageName, friendlyName, telemetry);\n        this.payLoad = getPayloadObject('click', this.telemetryContent, '');\n        this.editRef = React.createRef();\n        this.attributesContainerRef = React.createRef();\n    }\n\n    public componentDidMount(): void {\n        this._buildPayloadData();\n        this._getAttributes();\n        this._getCustomerPhoneAndVatNumber();\n        reaction(\n            () => this.props.accountProfileProps.data.customerInformation.result,\n            () => {\n                const customerInformation = this.props.accountProfileProps.data.customerInformation.result;\n                this.initialCustomerAttributes = customerInformation && customerInformation.Attributes;\n                this._getAttributes();\n                this._getCustomerPhoneAndVatNumber();\n            }\n        );\n        reaction(\n            () => this.props.accountProfileProps.data.attributeDefinitions.result,\n            () => {\n                this._buildPayloadData();\n            }\n        );\n    }\n\n    public render(): JSX.Element | null {\n        return this._renderAttributes();\n    }\n\n    private _renderAttributes = (): JSX.Element | null => {\n        const { config, data, resources } = this.props.accountProfileProps;\n        const attributeDefinitions: AttributeDefinition[] = data.attributeDefinitions.result || [];\n        const additionalInformationSectionHeading = config.additionalInformationSectionHeading && config.additionalInformationSectionHeading.text || '';\n        const showAttributes = config.showAttributes || '';\n        const attributes = showAttributes.split(',');\n        const elements = attributes.map(att => {\n            const attributeDefinition: AttributeDefinition = attributeDefinitions.find(attribute =>\n                attribute.IsHidden === false && attribute.Name!.toLocaleLowerCase() === att.toLocaleLowerCase()\n            ) || { RecordId: 0 };\n            return this._renderAttribute(attributeDefinition);\n        });\n        const edit = this.state && this.state.editAttributes || false;\n        this.payLoad.contentAction.etext = `${resources.attributesEditButtonText} ${additionalInformationSectionHeading}`;\n        const editAttributes = getTelemetryAttributes(this.telemetryContent!, this.payLoad);\n        this.payLoad.contentAction.etext = `${resources.attributesSaveButtonText} ${additionalInformationSectionHeading}`;\n        const saveAttributes = getTelemetryAttributes(this.telemetryContent!, this.payLoad);\n        this.payLoad.contentAction.etext = `${resources.attributesCancelButtonText} ${additionalInformationSectionHeading}`;\n        const cancelAttributes = getTelemetryAttributes(this.telemetryContent!, this.payLoad);\n        return (\n            <div ref={this.attributesContainerRef} className={classnames('ms-account-profile__attributes', { 'ms-account-profile__attributes-updating': this.isUpdatingAttributes })}>\n                {config.additionalInformationSectionHeading && (\n                    <Text\n                        className='ms-account-profile__attributes-tile__heading'\n                        tag={config.additionalInformationSectionHeading.tag || 'h2'}\n                        text={additionalInformationSectionHeading}\n                    />\n                )}\n                {config.showPhone && (\n                    this._renderPhone()\n                )}\n                {config.showVatNumber && (\n                    this._renderVatNumber()\n                )}\n                {elements}\n                {this.gotException && (\n                    <div className='ms-account-profile__attributes-error'>\n                        <label className='ms-account-profile__attributes-error-label'>\n                            {this.props.accountProfileProps.resources.attributesSaveExceptionMessage}\n                        </label>\n                    </div>\n                )}\n                {!edit && (\n                    <Button\n                        className={classnames('ms-account-profile__attributes-edit-button')}\n                        aria-label={`${resources.attributesEditButtonText} ${additionalInformationSectionHeading}`}\n                        onClick={this._enableAttributes}\n                        innerRef={this.editRef}\n                        title = {resources.attributesEditButtonText}\n                        {...editAttributes}\n                    >\n                        {resources.attributesEditButtonText}\n                    </Button>\n                )}\n                {edit && (\n                    <Button\n                        className={classnames('ms-account-profile__attributes-save-button')}\n                        aria-label={resources.attributesSaveButtonText}\n                        onClick={this._saveAttributes}\n                        title = {resources.attributesSaveButtonText}\n                        {...saveAttributes}\n                    >\n                        {resources.attributesSaveButtonText}\n                    </Button>\n                )}\n                {edit && (\n                    <Button\n                        className={classnames('ms-account-profile__attributes-cancel-button')}\n                        aria-label={resources.attributesCancelButtonText}\n                        onClick={this._disableAttributes}\n                        title = {resources.attributesCancelButtonText}\n                        {...cancelAttributes}\n                    >\n                        {resources.attributesCancelButtonText}\n                    </Button>\n                )}\n            </div>\n        );\n    }\n\n    private _renderPhone = (): JSX.Element | null => {\n        const { phoneSectionHeading } = this.props.accountProfileProps.config;\n        const heading = phoneSectionHeading && phoneSectionHeading.text || '';\n        const className = heading && heading.replace(/ /g, '_') || '';\n        const editAttributes = this.state && this.state.editAttributes || false;\n        return (\n            <div className={classnames('ms-account-profile__attributes__section', `ms-account-profile__attributes-${className}`)}>\n                {phoneSectionHeading && (<Text\n                    className={`ms-account-profile__attributes__section-heading`}\n                    tag='h3'\n                    text={heading}\n                />)}\n                <input\n                    type='text'\n                    aria-label={heading}\n                    className={classnames(this.attributeClassName, 'ms-account-profile__attributes_input', `ms-account-profile__attributes_input-edit-${editAttributes}`, `ms-account-profile__${className}-input`)}\n                    onChange={this._onPhoneChange}\n                    value={this.state.phone || ''}\n                    disabled={!editAttributes}\n                />\n                {this._renderError('Phone')}\n            </div>\n        );\n    }\n\n    private _renderVatNumber = (): JSX.Element | null => {\n        const { vatNumberSectionHeading } = this.props.accountProfileProps.config;\n        const heading = vatNumberSectionHeading && vatNumberSectionHeading.text || '';\n        const className = heading && heading.replace(/ /g, '_') || '';\n        const editAttributes = this.state && this.state.editAttributes || false;\n        return (\n            <div className={classnames('ms-account-profile__attributes__section', `ms-account-profile__attributes-${className}`)}>\n                {vatNumberSectionHeading && (<Text\n                    className={`ms-account-profile__attributes__section-heading`}\n                    tag='h3'\n                    text={heading}\n                />)}\n                <input\n                    type='text'\n                    aria-label={heading}\n                    className={classnames(this.attributeClassName, 'ms-account-profile__attributes_input', `ms-account-profile__attributes_input-edit-${editAttributes}`, `ms-account-profile__${className}-input`)}\n                    onChange={this._onVatNumberChange}\n                    value={this.state.vatNumber || ''}\n                    disabled={!editAttributes}\n                />\n                {this._renderError('VATNumber')}\n            </div>\n        );\n    }\n\n    private _renderAttribute = (customAttribute: AttributeDefinition): JSX.Element | null => {\n        const editAttributes = this.state && this.state.editAttributes || false;\n        const className = customAttribute.Name && customAttribute.Name.replace(/ /g, '_') || '';\n        switch (customAttribute.ExtDataType && customAttribute.ExtDataType.Value) {\n            case AccountAttributeDataTypeValue.Integer:\n            case AccountAttributeDataTypeValue.Decimal:\n                return this._renderIntegerDecimalInput(customAttribute, className, editAttributes);\n            case AccountAttributeDataTypeValue.Text:\n                return this._renderTextInputOrSelect(customAttribute, className, editAttributes);\n            case AccountAttributeDataTypeValue.TrueFalse:\n                return this._renderBoolean(customAttribute, className, editAttributes);\n            default:\n                return null;\n        }\n    }\n\n    private _renderIntegerDecimalInput = (customAttribute: AttributeDefinition, className: string, editAttributes: boolean): JSX.Element | null => {\n        const edit = this.state && this.state.editAttributes || false;\n        const attributeProps = this._getAttributeProps(customAttribute.Name || '');\n        const displayName: string = attributeProps?.Name || '';\n        return (\n            <div className={classnames('ms-account-profile__attributes__section', `ms-account-profile__attributes-${className}`)}>\n                <Text\n                    className={`ms-account-profile__attributes__section-heading`}\n                    tag='h3'\n                    text={displayName}\n                />\n                <input\n                    type='text'\n                    aria-label={customAttribute.Name}\n                    className={classnames(this.attributeClassName, 'ms-account-profile__attributes_input', `ms-account-profile__attributes_input-edit-${edit}`, `ms-account-profile__${className}-input`)}\n                    onChange={this._onAttributeChange(customAttribute)}\n                    value={this.state.attributes[customAttribute.Name || ''] || ''}\n                    disabled={!editAttributes}\n                    aria-required={attributeProps?.IsMandatory || false}\n                />\n                {this._renderError(customAttribute.Name || '')}\n            </div>\n        );\n    }\n\n    // tslint:disable-next-line: cyclomatic-complexity\n    private _renderTextInputOrSelect = (customAttribute: AttributeDefinition, className: string, editAttributes: boolean): JSX.Element | null => {\n        const isEnumeration: boolean = customAttribute.IsEnumeration || false;\n        const edit = this.state && this.state.editAttributes || false;\n        const attributeProps = this._getAttributeProps(customAttribute.Name || '');\n        const displayName: string = attributeProps?.Name || '';\n        if (isEnumeration && customAttribute.EnumerationDetails) {\n            const value = this.state.attributes[customAttribute.Name || ''] || '';\n            const hasNoValue = value === '' ? true : false;\n            return (\n                <div className={classnames('ms-account-profile__attributes__section', `ms-account-profile__attributes-${className}`)}>\n                    <Text\n                        className={`ms-account-profile__attributes__section-heading`}\n                        tag='h3'\n                        text={displayName}\n                    />\n                    <select\n                        id={`ms-account-profile__attributes-${className}`}\n                        aria-label={customAttribute.Name}\n                        className={classnames(this.attributeClassName, 'ms-account-profile__attributes_select', `ms-account-profile__attributes_select-edit-${edit}`, `ms-account-profile__attributes-${className}_select`)}\n                        onChange={this._onAttributeSelect(customAttribute)}\n                        disabled={!editAttributes}\n                        aria-required={attributeProps?.IsMandatory || false}\n                    >\n                        {hasNoValue && (<option className='ms-account-profile__attributes_select__option' key='blank' selected={hasNoValue} aria-selected={hasNoValue} />)}\n                        {customAttribute.EnumerationDetails.map((option) => {\n                            const selected = option.EnumerationValue === this.state.attributes[customAttribute.Name || ''];\n                            return <option className='ms-account-profile__attributes_select__option' key={option.EnumerationValue} selected={selected} aria-selected={selected}>{option.EnumerationValue}</option>;\n                        })}\n                    </select>\n                </div>\n            );\n        } else {\n           return (\n                <div className={classnames('ms-account-profile__attributes__section', `ms-account-profile__attributes-${className}`)}>\n                    <Text\n                        className={`ms-account-profile__attributes__section-heading`}\n                        tag='h3'\n                        text={displayName}\n                    />\n                    <input\n                        type='text'\n                        aria-label={customAttribute.Name}\n                        className={classnames(this.attributeClassName, 'ms-account-profile__attributes_input', `ms-account-profile__attributes_input-edit-${edit}`, `ms-account-profile__${className}-input`)}\n                        onChange={this._onAttributeChange(customAttribute)}\n                        value={this.state.attributes[customAttribute.Name || ''] || ''}\n                        disabled={!editAttributes}\n                        aria-required={attributeProps?.IsMandatory || false}\n                    />\n                    {this._renderError(customAttribute.Name || '')}\n                </div>\n            );\n        }\n    }\n\n    private _renderBoolean = (customAttribute: AttributeDefinition, className: string, editAttributes: boolean): JSX.Element | null => {\n        let value = this.state.attributes[customAttribute.Name || ''] || '';\n        const hasNoValue = value === '' ? true : false;\n        const render = (hasNoValue && !editAttributes) ? false : true;\n        value = value || 'false';\n        const toggleState = value === 'true' && 'enable' || 'disable';\n        const arialabel = format(this.props.accountProfileProps.resources.attributeToggleButtonAriaLabel, customAttribute.Name);\n        const ariaPressed = value === 'true' && true || false;\n        const attributeProps = this._getAttributeProps(customAttribute.Name || '');\n        const displayName: string = attributeProps?.Name || '';\n        let toggleValue = 'false';\n        if (value === 'true') {\n            toggleValue = 'false';\n        } else {\n            toggleValue = 'true';\n        }\n\n        return (\n            <div className={classnames('ms-account-profile__attributes__section', 'ms-account-profile__attributes__section__toggle', `ms-account-profile__attributes-${className}`)}>\n                <Text\n                    className={`ms-account-profile__attributes__section-heading`}\n                    tag='h3'\n                    text={displayName}\n                />\n                {render && (\n                    <div className={`ms-account-profile__attributes__section__toggle-wrapper ms-account-profile__attributes__section__toggle-${toggleState}`}>\n\n                        <TextComponent className='ms-account-profile__attributes__section__toggle-disable-text' text={this.props.accountProfileProps.resources.toggleDisableText} />\n                        <Button\n                            className={classnames(this.attributeClassName, 'ms-account-profile__attributes__section__toggle-button', `ms-account-profile__attributes__section__toggle-${toggleState}-button`)}\n                            aria-label={`${arialabel}`}\n                            aria-pressed={ariaPressed}\n                            value={value}\n                            onClick={this._onAttributeCheck(customAttribute, toggleValue)}\n                            disabled={!editAttributes}\n                        />\n                        <TextComponent className='ms-account-profile__attributes__section__toggle-enable-text' text={this.props.accountProfileProps.resources.toggleEnableText} />\n                    </div>\n                )}\n            </div>\n        );\n    }\n\n    private _renderError = (attributeName: string): JSX.Element | null => {\n        const error: string = this.state && this.state.attributeError && this.state.attributeError[attributeName] || '';\n        const hasError = !isNullOrWhiteSpace(error);\n        if (hasError) {\n            return (\n                <div className='ms-account-profile__attributes-error' role='alert' aria-live='assertive'>\n                    <label className='ms-account-profile__attributes-error-label'>\n                        {error}\n                    </label>\n                </div>\n            );\n        }\n        return null;\n    }\n\n    private _getAttributeProps = (attributeName: string): IAttributePropertiesType => {\n        const attributePayloadData = this.attributePayloadData.filter((att) => att.name === attributeName);\n        const isMandatory: boolean = attributePayloadData[0] && attributePayloadData[0].isMandatory || false;\n        return {\n            Name: isMandatory ? `${attributeName || ''} *` : attributeName || '',\n            IsMandatory: isMandatory\n        };\n    }\n\n    private _onPhoneChange = (event: React.ChangeEvent<HTMLInputElement>): void => {\n        const value = event.target.value;\n        this.setState({ phone: value });\n    }\n\n    private _onVatNumberChange = (event: React.ChangeEvent<HTMLInputElement>): void => {\n        const value = event.target.value;\n        this.setState({ vatNumber: value });\n    }\n\n    private _enableAttributes = () => {\n        this.hasError = false;\n        // To clear exception messages\n        this.gotException = false;\n        this.setState({ editAttributes: true, attributeError: {} });\n        if (MsDyn365.isBrowser) {\n            setTimeout(() => {\n                if (this.attributesContainerRef?.current) {\n                    const attributes: HTMLCollectionOf<Element> = this.attributesContainerRef.current.getElementsByClassName(this.attributeClassName);\n                    if (attributes && attributes.length > 0) {\n                        this._setFocus(attributes[0] as HTMLElement);\n                    }\n                }\n            },         0);\n        }\n    }\n\n    private _disableAttributes = () => {\n        this.setState({ editAttributes: false, attributeError: {}, attributes: this.initialAttributes, phone: this.initialPhone, vatNumber: this.initialVatNumber });\n        if (MsDyn365.isBrowser) {\n            setTimeout(() => {\n                this._setFocus(this.editRef.current);\n            },         0);\n        }\n    }\n\n    private _onAttributeChange = (attributeDefinition: AttributeDefinition) => (event: React.ChangeEvent<HTMLInputElement>) => {\n        const value = event.target.value;\n        const name = attributeDefinition.Name || '';\n        this.setState({\n            attributes: {\n                ...this.state.attributes,\n                [name]: value\n            }\n        });\n    }\n\n    private _onAttributeCheck = (attributeDefinition: AttributeDefinition, value: string) => (event: React.MouseEvent<HTMLElement>) => {\n        const name = attributeDefinition.Name || '';\n        this.setState({\n            attributes: {\n                ...this.state.attributes,\n                [name]: value\n            }\n        });\n    }\n\n    private _onAttributeSelect = (attributeDefinition: AttributeDefinition) => (event: React.ChangeEvent<HTMLSelectElement>) => {\n        const value = event.currentTarget.selectedOptions[0].value;\n        const index = event.currentTarget.selectedOptions[0].index;\n        const name = attributeDefinition.Name || '';\n        this.setState({\n            attributes: {\n                ...this.state.attributes,\n                [name]: value\n            },\n            selectedIndex: {\n                ...this.state.selectedIndex,\n                [name]: index\n            }\n        });\n    }\n\n    private _getAttributes = () => {\n        const { config, data } = this.props.accountProfileProps;\n        const showAttributes = config.showAttributes || '';\n        const showAttributesArray = showAttributes.split(',');\n        const customer = data.customerInformation.result;\n        const custmerAttributes: CustomerAttribute[] = customer && customer.Attributes || [];\n        const attributes: IDictionary<string> = {};\n        // tslint:disable-next-line: cyclomatic-complexity\n        showAttributesArray.forEach(showAttribute => {\n            const attributePayloadData = this.attributePayloadData.filter((att) => att.name === showAttribute);\n            const isMandatory: boolean = attributePayloadData[0] && attributePayloadData[0].isMandatory || false;\n            const defaultValue = attributePayloadData[0] && attributePayloadData[0].defaultValue;\n            const attribute = custmerAttributes.find((att) => att.Name === showAttribute);\n            let value: string = '';\n            if (attribute && attribute.AttributeValue) {\n                const name = attribute && attribute.Name || '';\n                switch (attribute.DataTypeValue) {\n                    case AccountAttributeDataTypeValue.Integer:\n                        if (attribute.AttributeValue.IntegerValue) {\n                            value = String(attribute.AttributeValue.IntegerValue);\n                            attributes[name] = value;\n                        }\n                        break;\n                    case AccountAttributeDataTypeValue.Decimal:\n                        if (attribute.AttributeValue.DecimalValue) {\n                            value = String(attribute.AttributeValue.DecimalValue);\n                            attributes[name] = value;\n                        }\n                        break;\n                    case AccountAttributeDataTypeValue.Text:\n                        if (attribute.AttributeValue.StringValue) {\n                            value = attribute.AttributeValue.StringValue;\n                            attributes[name] = value;\n                        }\n                        break;\n                    case AccountAttributeDataTypeValue.TrueFalse:\n                        if (attribute.AttributeValue.BooleanValue !== null) {\n                            value = String(attribute.AttributeValue.BooleanValue);\n                            attributes[name] = value;\n                        }\n                        break;\n                    default:\n                    // Do nothing\n                }\n            }\n            if (isNullOrWhiteSpace(value) && isMandatory) {\n                attributes[showAttribute] = '';\n            }\n            if (value.length === 0 && defaultValue) {\n                attributes[showAttribute] = String(defaultValue);\n            }\n        });\n        if (Object.keys(this.initialAttributes).length === 0) {\n            this.initialAttributes = attributes;\n        }\n        this.setState({ attributes: attributes });\n    }\n\n    // tslint:disable-next-line: cyclomatic-complexity max-func-body-length\n    private _addOrUpdateAttribute = (customer: Customer) => {\n        const { resources } = this.props.accountProfileProps;\n        const { phone, vatNumber } = this.state;\n        const attributeError: IDictionary<string> = {};\n        let hasError: boolean = false;\n        let hasValue: boolean = true;\n        for (const [key, value] of Object.entries(this.state.attributes)) {\n            const payloadData: IAttributePayloadData = this.attributePayloadData.find(data => data.name === key) || {};\n            if (payloadData) {\n                switch (payloadData.dataTypeValue) {\n                    case AccountAttributeDataTypeValue.Decimal:\n                        const decimalValue = Number(value);\n                        if (isNaN(decimalValue)) {\n                            const typeError = format(resources.attributeInputTypeErrorText, payloadData.name, 'Decimal');\n                            attributeError[payloadData.name || ''] = typeError;\n                            hasError = true;\n                        } else {\n                            if (payloadData.lowerBoundValue !== undefined && payloadData.upperBoundValue !== undefined) {\n                                if (decimalValue < payloadData.lowerBoundValue || decimalValue > payloadData.upperBoundValue) {\n                                    const rangeError = format(resources.attributeInputRangeErrorText, payloadData.name, payloadData.lowerBoundValue, payloadData.upperBoundValue);\n                                    attributeError[payloadData.name || ''] = rangeError;\n                                    hasError = true;\n                                }\n                            } else {\n                                if(decimalValue > this.maxDecimalLimit) {\n                                    attributeError[payloadData.name || ''] = format(resources.attributeInputValueExceedsMaximumErrorText, payloadData.name, this.maxDecimalLimit);\n                                    hasError = true;\n                                }\n\n                                if(decimalValue < this.minDecimalLimit) {\n                                    attributeError[payloadData.name || ''] = format(resources.attributeInputValueExceedsMinimumErrorText, payloadData.name, this.minDecimalLimit);\n                                    hasError = true;\n                                }\n                            }\n                        }\n\n                        if (!hasError) {\n                            if (isNullOrWhiteSpace(value)) {\n                                hasValue = false;\n                            } else {\n                                payloadData.decimalValue = decimalValue;\n                                hasValue = true;\n                            }\n                        }\n                        break;\n                    case AccountAttributeDataTypeValue.Integer:\n                        const integerValue = Number(value);\n                        if (isNaN(integerValue) || value.indexOf('.') !== -1) {\n                            const typeError = format(resources.attributeInputTypeErrorText, payloadData.name, 'Integer');\n                            attributeError[payloadData.name || ''] = typeError;\n                            hasError = true;\n                        } else {\n                            if (payloadData.lowerBoundValue !== undefined && payloadData.upperBoundValue !== undefined) {\n                                if (integerValue < payloadData.lowerBoundValue || integerValue > payloadData.upperBoundValue) {\n                                    const rangeError = format(resources.attributeInputRangeErrorText, payloadData.name, payloadData.lowerBoundValue, payloadData.upperBoundValue);\n                                    attributeError[payloadData.name || ''] = rangeError;\n                                    hasError = true;\n                                }\n                            } else {\n                                if (integerValue > this.maxIntegerLimit) {\n                                    attributeError[payloadData.name || ''] = format(resources.attributeInputValueExceedsMaximumErrorText, payloadData.name, this.maxIntegerLimit);\n                                    hasError = true;\n                                }\n\n                                if(integerValue < this.minIntegerLimit) {\n                                    attributeError[payloadData.name || ''] = format(resources.attributeInputValueExceedsMinimumErrorText, payloadData.name, this.minIntegerLimit);\n                                    hasError = true;\n                                }\n                            }\n                        }\n\n                        if (!hasError) {\n                            if (isNullOrWhiteSpace(value)) {\n                                hasValue = false;\n                            } else {\n                                payloadData.integerValue = integerValue;\n                                hasValue = true;\n                            }\n                        }\n                        break;\n                    case AccountAttributeDataTypeValue.Text:\n                        let trimValue = '';\n                        if (!isNullOrWhiteSpace(value)) {\n                            trimValue = value.trim();\n                        }\n                        if (trimValue.length > this.maxStringLength) {\n                            attributeError[payloadData.name || ''] = format(resources.attributeInputStringMaxLengthErrorText, payloadData.name, this.maxStringLength);\n                            hasError = true;\n                        }\n                        if (!hasError) {\n                            payloadData.textValue = trimValue;\n                        }\n                        break;\n                    case AccountAttributeDataTypeValue.TrueFalse:\n                        payloadData.booleanValue = value === 'true' ? true : false;\n                        break;\n                    default:\n                    // Do nothing\n                }\n\n                if (payloadData.isMandatory && isNullOrWhiteSpace(value)) {\n                    attributeError[payloadData.name || ''] = format(resources.attributeInputMandatoryErrorText, payloadData.name);\n                    hasError = true;\n                }\n\n                const custmerAttributes: CustomerAttribute[] = customer && customer.Attributes || [];\n                const attribute = custmerAttributes.find((att) => att.Name === key);\n                const index = custmerAttributes.findIndex((att) => att.Name === key);\n\n                if(index !== -1 && !hasValue) {\n                    custmerAttributes.splice(index,1);\n                }\n\n                if (!hasError && hasValue) {\n                    if (attribute) {\n                        attribute.Attribute = undefined;\n                        attribute.DataTypeValue = payloadData.dataTypeValue;\n                        attribute.Name = payloadData.name;\n                        attribute.RecordId = payloadData.recordId;\n                        attribute.Units = undefined;\n                        attribute.AttributeValue = {\n                            IntegerValue: payloadData.integerValue,\n                            BooleanValue: payloadData.booleanValue,\n                            StringValue: payloadData.textValue,\n                            DecimalValue: payloadData.decimalValue\n                        };\n                        attribute.ExtensionProperties = [];\n                        attribute.NameTranslations = [];\n                    } else {\n                        custmerAttributes.push({\n                            // @ts-ignore\n                            '@odata.type': '#Microsoft.Dynamics.Commerce.Runtime.DataModel.CustomerAttribute',\n                            Attribute: undefined,\n                            DataTypeValue: payloadData.dataTypeValue,\n                            KeyName: payloadData.name,\n                            Name: payloadData.name,\n                            RecordId: payloadData.recordId,\n                            Units: undefined,\n                            AttributeValue: {\n                                // @ts-ignore\n                                '@odata.type': '#Microsoft.Dynamics.Commerce.Runtime.DataModel.CommercePropertyValue',\n                                IntegerValue: payloadData.integerValue,\n                                BooleanValue: payloadData.booleanValue,\n                                StringValue: payloadData.textValue,\n                                DecimalValue: payloadData.decimalValue\n                            },\n                            'ExtensionProperties@odata.type': '#Collection(Microsoft.Dynamics.Commerce.Runtime.DataModel.CommerceProperty)',\n                            ExtensionProperties: [],\n                            'NameTranslations@odata.type': '#Collection(Microsoft.Dynamics.Commerce.Runtime.DataModel.TextValueTranslation)',\n                            NameTranslations: []\n                        });\n                    }\n                }\n            }\n        }\n\n        if (phone.trim().length > this.maxPhoneLength) {\n            attributeError[`Phone`] = format(resources.attributeInputStringMaxLengthErrorText, 'Phone', this.maxPhoneLength);\n            hasError = true;\n        } else {\n            customer.Phone = phone.trim();\n        }\n\n        if (vatNumber.trim().length > this.maxVATNumberLength) {\n            attributeError[`VATNumber`] = format(resources.attributeInputStringMaxLengthErrorText, 'VAT Number', this.maxVATNumberLength);\n            hasError = true;\n        } else {\n            customer.VatNumber = vatNumber.trim();\n        }\n\n        this.hasError = hasError;\n        this.setState({ attributeError: attributeError });\n\n    }\n\n    private _saveAttributes = async () => {\n        const { context, data } = this.props.accountProfileProps;\n        const customer = data.customerInformation.result;\n\n        if (customer && context) {\n            this._addOrUpdateAttribute(customer);\n            const input = new updateCustomerAttributesInput(customer.AccountNumber, customer.Attributes || [], context.request.apiSettings, customer.Phone, customer.VatNumber);\n\n            this.isUpdatingAttributes = true;\n            this.gotException = false;\n\n            if (!this.hasError) {\n                this.setState({ editAttributes: false });\n                try {\n                    await updateCustomerAttributes(input, context.actionContext);\n                } catch (error) {\n                    this.gotException = true;\n                    customer.Attributes = this.initialCustomerAttributes;\n                    if (context.telemetry) {\n                        context.telemetry.exception(error);\n                        context.telemetry.debug('Unable to update customer attributes');\n                    }\n                    this.setState({ attributeError: {}, attributes: this.initialAttributes, phone: this.initialPhone, vatNumber: this.initialVatNumber });\n                }\n                this.setState({ editAttributes: false });\n                if (!this.gotException) {\n                    this.initialAttributes = this.state.attributes;\n                    this.initialCustomerAttributes = customer.Attributes;\n                    this.initialPhone = this.state.phone;\n                    this.initialVatNumber = this.state.vatNumber;\n                }\n            }\n\n            this.isUpdatingAttributes = false;\n\n            if (MsDyn365.isBrowser) {\n                setTimeout(() => {\n                    this._setFocus(this.editRef.current);\n                },         0);\n            }\n        }\n    }\n\n    private _setFocus = (element: HTMLElement | null) => {\n        element?.focus();\n    }\n\n    private _buildPayloadData = () => {\n        const { data } = this.props.accountProfileProps;\n        const attributeDefinitions = data.attributeDefinitions.result || [];\n        const attributes: IDictionary<string> = {};\n        // tslint:disable-next-line: cyclomatic-complexity\n        attributeDefinitions.forEach(attributeDefinition => {\n            const attributePayloadData: IAttributePayloadData = {};\n            attributePayloadData.recordId = attributeDefinition.RecordId;\n            attributePayloadData.name = attributeDefinition.Name;\n            attributePayloadData.dataTypeValue = attributeDefinition.DataTypeValue;\n            attributePayloadData.isEnumeration = attributeDefinition.IsEnumeration;\n            attributePayloadData.isMandatory = attributeDefinition.IsMandatory;\n            switch (attributeDefinition.DataTypeValue) {\n                case AccountAttributeDataTypeValue.Integer:\n                    const defaultIntegerValue = attributeDefinition.DefaultValue && attributeDefinition.DefaultValue.IntegerValue;\n                    attributePayloadData.lowerBoundValue = attributeDefinition.LowerBound && attributeDefinition.LowerBound.IntegerValue;\n                    attributePayloadData.upperBoundValue = attributeDefinition.UpperBound && attributeDefinition.UpperBound.IntegerValue;\n                    if (attributePayloadData.name && defaultIntegerValue) {\n                        attributePayloadData.defaultValue =  String(defaultIntegerValue);\n                        attributes[attributePayloadData.name] = String(defaultIntegerValue);\n                    }\n                    break;\n                case AccountAttributeDataTypeValue.Decimal:\n                    const defaultDecimalValue = attributeDefinition.DefaultValue && attributeDefinition.DefaultValue.DecimalValue;\n                    attributePayloadData.lowerBoundValue = attributeDefinition.LowerBound && attributeDefinition.LowerBound.DecimalValue;\n                    attributePayloadData.upperBoundValue = attributeDefinition.UpperBound && attributeDefinition.UpperBound.DecimalValue;\n                    if (attributePayloadData.name && defaultDecimalValue) {\n                        attributePayloadData.defaultValue =  String(defaultDecimalValue);\n                        attributes[attributePayloadData.name] = String(defaultDecimalValue);\n                    }\n                    break;\n                case AccountAttributeDataTypeValue.Text:\n                    const defaultStringValue = attributeDefinition.DefaultValue && attributeDefinition.DefaultValue.StringValue;\n                    if (attributePayloadData.name && defaultStringValue) {\n                        attributePayloadData.defaultValue =  defaultStringValue;\n                        attributes[attributePayloadData.name] = defaultStringValue;\n                    }\n                    break;\n                case AccountAttributeDataTypeValue.TrueFalse:\n                    const defaultBooleanValue = attributeDefinition.DefaultValue && attributeDefinition.DefaultValue.BooleanValue || false;\n                    if (attributePayloadData.name) {\n                        attributePayloadData.defaultValue =  String(defaultBooleanValue);\n                        attributes[attributePayloadData.name] = String(defaultBooleanValue);\n                    }\n                    break;\n                default:\n                // do nothing\n            }\n            this.attributePayloadData.push(attributePayloadData);\n        });\n        Object.keys(attributes).length > 0 && this.setState({ attributes: attributes });\n    }\n\n    private _getCustomerPhoneAndVatNumber = () => {\n        const customer = this.props.accountProfileProps.data.customerInformation.result;\n        const phone = customer && customer.Phone || '';\n        const vatNumber = customer && customer.VatNumber || '';\n        this.setState({ phone: phone, vatNumber: vatNumber });\n        if (this.initialPhone.length === 0) {\n            this.initialPhone = phone;\n        }\n        if (this.initialVatNumber.length === 0) {\n            this.initialVatNumber = vatNumber;\n        }\n    }\n}\n\nexport default AccountProfileAttributes;"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}