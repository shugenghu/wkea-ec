{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _asyncToGenerator from\"@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _inherits from\"@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/esm/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import{__decorate}from\"tslib\";import{withModuleState}from'@msdyn365-commerce-modules/checkout-utilities';import classnames from'classnames';import{computed,when}from'mobx';import{observer}from'mobx-react';import*as React from'react';import getAddContactInfo from'./components/get-add-contact-info';import getShowContactInfo from'./components/get-show-contact-info';export*from'./components/get-add-contact-info';export*from'./components/get-show-contact-info';var CheckoutGuestProfile=/*#__PURE__*/function(_React$Component){_inherits(CheckoutGuestProfile,_React$Component);var _super=_createSuper(CheckoutGuestProfile);function CheckoutGuestProfile(){var _this;_classCallCheck(this,CheckoutGuestProfile);_this=_super.apply(this,arguments);_this.state={email:_this.props.context&&_this.props.context.request&&_this.props.context.request.user&&_this.props.context.request.user.isAuthenticated&&_this.props.context.request.user.emailAddress||''};_this.inputRef=/*#__PURE__*/React.createRef();_this.init=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$props$data$chec;var emailOnCart,email,isEmailValid;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:emailOnCart=(_this$props$data$chec=_this.props.data.checkout.result)===null||_this$props$data$chec===void 0?void 0:_this$props$data$chec.checkoutCart.cart.ReceiptEmail;email=emailOnCart||_this.state.email;if(!email){_context.next=5;break;}_context.next=5;return _this.updateGuestProfile(email);case 5:isEmailValid=_this.isEmailValid(email);_this.props.moduleState.init({onEdit:_this.onEdit,onCancel:_this.onCancel,onSubmit:_this.onSubmit,status:email&&isEmailValid?'ready':'updating',hasError:!!email&&!isEmailValid});case 7:case\"end\":return _context.stop();}}},_callee);}));_this.onChange=function(rowEmail){var email=(rowEmail||'').replace(new RegExp('[<>]','gi'),'');_this.setState({email:email});if(_this.props.moduleState.hasError){_this.props.moduleState.setHasError(false);}};_this.isEmailValid=function(email){var regex=/^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;return regex.test(email);};_this.updateGuestProfile=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(newGuestCheckoutEmail){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!_this.props.data.checkout.result){_context2.next=4;break;}_context2.next=3;return _this.props.data.checkout.result.updateGuestCheckoutEmail({newGuestCheckoutEmail:newGuestCheckoutEmail});case 3:_this.setState({email:newGuestCheckoutEmail});case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.onEdit=function(){_this.props.moduleState.onUpdating();};_this.onSubmit=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var email,isValid,input;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:email=_this.state.email;isValid=_this.isEmailValid(email);if(isValid){_context3.next=8;break;}_this.props.moduleState.setHasError(true);input=_this.inputRef&&_this.inputRef.current&&_this.inputRef.current.focus&&_this.inputRef.current;input&&input.focus();_context3.next=11;break;case 8:_this.props.moduleState.onReady();_context3.next=11;return _this.updateGuestProfile(email);case 11:case\"end\":return _context3.stop();}}},_callee3);}));_this.onCancel=function(){if(!_this.props.data.checkout.result){return;}var email=_this.props.data.checkout.result.guestCheckoutEmail;if(!email){_this.props.moduleState.onUpdating();return;}else{_this.setState({email:email});_this.props.moduleState.setHasError(false);_this.props.moduleState.onReady();}};return _this;}_createClass(CheckoutGuestProfile,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;when(function(){return _this2.isDataReady;},/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _this2.init();case 2:case\"end\":return _context4.stop();}}},_callee4);})));}},{key:\"render\",value:function render(){var _this$props=this.props,className=_this$props.config.className,resources=_this$props.resources,_this$props$moduleSta=_this$props.moduleState,isReady=_this$props$moduleSta.isReady,hasError=_this$props$moduleSta.hasError,hasExternalSubmitGroup=_this$props$moduleSta.hasExternalSubmitGroup;var email=this.props.data.checkout.result&&this.props.data.checkout.result.guestCheckoutEmail||'';var viewProps=_objectSpread(_objectSpread(_objectSpread({},this.props),this.state),{},{onChange:this.onChange,onEdit:this.onEdit,onCancel:this.onCancel,onSubmit:this.onSubmit,moduleProps:{moduleProps:this.props,className:classnames('ms-checkout-guest-profile',className,isReady?'show':'add')},showContactInfo:isReady?getShowContactInfo({canEdit:!hasExternalSubmitGroup,email:email,resources:resources,onEdit:this.onEdit}):undefined,addContactInfo:!isReady?getAddContactInfo({email:this.state.email,hasError:hasError,resources:resources,inputRef:this.inputRef,onChange:this.onChange,canSubmit:!hasExternalSubmitGroup,onSubmit:this.onSubmit,canCancel:!hasExternalSubmitGroup&&!!email,onCancel:this.onCancel}):undefined});return this.props.renderView(viewProps);}},{key:\"isDataReady\",get:function get(){return(this.props.data.checkout.result&&this.props.data.checkout.status)==='SUCCESS';}}]);return CheckoutGuestProfile;}(React.Component);__decorate([computed],CheckoutGuestProfile.prototype,\"isDataReady\",null);CheckoutGuestProfile=__decorate([withModuleState,observer],CheckoutGuestProfile);export default CheckoutGuestProfile;","map":{"version":3,"sources":["modules/checkout-guest-profile/checkout-guest-profile.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { IModuleStateProps, withModuleState } from '@msdyn365-commerce-modules/checkout-utilities';\nimport { IModuleProps } from '@msdyn365-commerce-modules/utilities';\nimport classnames from 'classnames';\nimport { computed, when } from 'mobx';\nimport { observer } from 'mobx-react';\nimport * as React from 'react';\nimport { ICheckoutGuestProfileData } from './checkout-guest-profile.data';\nimport { ICheckoutGuestProfileProps } from './checkout-guest-profile.props.autogenerated';\nimport getAddContactInfo, { IAddContactInfo } from './components/get-add-contact-info';\nimport getShowContactInfo, { IShowContactInfo } from './components/get-show-contact-info';\n\nexport * from './components/get-add-contact-info';\nexport * from './components/get-show-contact-info';\n\ninterface ICheckoutGuestProfileState {\n    email: string;\n}\n\nexport interface ICheckoutGuestProfileModuleProps extends ICheckoutGuestProfileProps<ICheckoutGuestProfileData>, IModuleStateProps { }\n\nexport interface ICheckoutGuestProfileViewProps extends ICheckoutGuestProfileProps<ICheckoutGuestProfileData>, ICheckoutGuestProfileState {\n    moduleProps: IModuleProps;\n    showContactInfo?: IShowContactInfo;\n    addContactInfo?: IAddContactInfo;\n\n    onChange?(email: string): void;\n    onEdit?(): void;\n    onSubmit?(): void;\n    onCancel?(): void;\n}\n\n/**\n *\n * CheckoutGuestProfile component\n * @extends {React.PureComponent<ICheckoutGuestProfileProps<ICheckoutGuestProfileData>, ICheckoutGuestProfileState>}\n */\n// @ts-ignore\n@withModuleState\n@observer\nclass CheckoutGuestProfile extends React.Component<ICheckoutGuestProfileModuleProps, ICheckoutGuestProfileState> {\n    public state: ICheckoutGuestProfileState = {\n        email:\n            (this.props.context &&\n                this.props.context.request &&\n                this.props.context.request.user &&\n                this.props.context.request.user.isAuthenticated &&\n                this.props.context.request.user.emailAddress) ||\n            ''\n    };\n\n    private inputRef: React.RefObject<HTMLInputElement> = React.createRef();\n\n    @computed get isDataReady(): boolean {\n        return (this.props.data.checkout.result && this.props.data.checkout.status) === 'SUCCESS';\n    }\n\n    public componentDidMount(): void {\n        // @ts-ignore: Compiler not reconizing condition check for function params\n        when(\n            () => this.isDataReady,\n            async () => {\n                await this.init();\n            }\n        );\n    }\n\n    public render(): JSX.Element {\n        const {\n            config: { className },\n            resources,\n            moduleState: { isReady, hasError, hasExternalSubmitGroup }\n        } = this.props;\n        const email = (this.props.data.checkout.result && this.props.data.checkout.result.guestCheckoutEmail) || '';\n\n        const viewProps: ICheckoutGuestProfileViewProps = {\n            ...this.props,\n            ...this.state,\n            onChange: this.onChange,\n            onEdit: this.onEdit,\n            onCancel: this.onCancel,\n            onSubmit: this.onSubmit,\n\n            moduleProps: {\n                moduleProps: this.props,\n                className: classnames('ms-checkout-guest-profile', className, isReady ? 'show' : 'add')\n            },\n            showContactInfo: isReady\n                ? getShowContactInfo({\n                    canEdit: !hasExternalSubmitGroup,\n                    email,\n                    resources,\n                    onEdit: this.onEdit\n                })\n                : undefined,\n            addContactInfo: !isReady\n                ? getAddContactInfo({\n                    email: this.state.email,\n                    hasError,\n                    resources,\n                    inputRef: this.inputRef,\n                    onChange: this.onChange,\n                    canSubmit: !hasExternalSubmitGroup,\n                    onSubmit: this.onSubmit,\n                    canCancel: !hasExternalSubmitGroup && !!email,\n                    onCancel: this.onCancel\n                })\n                : undefined\n        };\n\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n\n    private init = async (): Promise<void> => {\n        const emailOnCart = this.props.data.checkout.result?.checkoutCart.cart.ReceiptEmail;\n        const email = emailOnCart || this.state.email;\n\n        if (email) {\n            await this.updateGuestProfile(email);\n        }\n\n        const isEmailValid = this.isEmailValid(email);\n        this.props.moduleState.init({\n            onEdit: this.onEdit,\n            onCancel: this.onCancel,\n            onSubmit: this.onSubmit,\n            status: email && isEmailValid ? 'ready' : 'updating',\n            hasError: !!email && !isEmailValid\n        });\n    };\n\n    private onChange = (rowEmail: string): void => {\n        const email = (rowEmail || '').replace(new RegExp('[<>]', 'gi'), '');\n        this.setState({ email });\n        if (this.props.moduleState.hasError) {\n            // Clear error during user updating the email\n            this.props.moduleState.setHasError(false);\n        }\n    };\n\n    private isEmailValid = (email: string): boolean => {\n        const regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        return regex.test(email);\n    };\n\n    private updateGuestProfile = async (newGuestCheckoutEmail: string): Promise<void> => {\n        if (this.props.data.checkout.result) {\n            await this.props.data.checkout.result.updateGuestCheckoutEmail({ newGuestCheckoutEmail });\n            this.setState({ email: newGuestCheckoutEmail });\n        }\n    };\n\n    private onEdit = (): void => {\n        this.props.moduleState.onUpdating();\n    };\n\n    private onSubmit = async (): Promise<void> => {\n        const { email } = this.state;\n        const isValid = this.isEmailValid(email);\n        if (!isValid) {\n            this.props.moduleState.setHasError(true);\n            // Get error, focus back on the input field\n            const input = this.inputRef && this.inputRef.current && this.inputRef.current.focus && (this.inputRef.current as HTMLElement);\n            input && input.focus();\n        } else {\n            this.props.moduleState.onReady();\n            await this.updateGuestProfile(email);\n        }\n    };\n\n    private onCancel = (): void => {\n        // Reset to the saved value\n        if (!this.props.data.checkout.result) {\n            return;\n        }\n\n        const email = this.props.data.checkout.result.guestCheckoutEmail;\n        if (!email) {\n            // It has no saved email, set to status updating and request user to fill the email form\n            this.props.moduleState.onUpdating();\n            return;\n        } else {\n            // It has saved email, set to status ready\n            this.setState({\n                email\n            });\n            this.props.moduleState.setHasError(false);\n            this.props.moduleState.onReady();\n        }\n    };\n}\n\nexport default CheckoutGuestProfile;"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}