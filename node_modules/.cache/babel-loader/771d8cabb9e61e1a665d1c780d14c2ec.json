{"ast":null,"code":"import\"core-js/modules/es.promise.js\";import{createObservableDataAction,sendRequest}from'@msdyn365-commerce/core';async function submitReview(input,ctx){if(!inputIsValid(input)){ctx.trace(\"[SubmitUserReview] Failed to submit reviews for product due to bad input \".concat(input));return'';}const requestUrl=\"\".concat(input.serviceEndpoint,\"/v2.0/reviews/product/\").concat(input.productId,\"/user?\")+\"tenantId=\".concat(input.tenantId,\"&\")+\"channelId=\".concat(input.channelId,\"&\")+\"locale=\".concat(input.locale);return sendRequest(requestUrl,'post',input.userReviewData,{headers:{Authorization:\"id_token \".concat(input.authorization)}}).then(response=>{if(response.status!==200&&response.status!==201){ctx.trace(\"[SubmitUserReview] Failed to submit reviews for product\");ctx.trace(response.data);return'';}return response.data;}).catch(error=>{ctx.trace(\"[SubmitUserReview] Failed to submit reviews for product\");ctx.telemetry.exception(error);ctx.telemetry.debug(\"[SubmitUserReview] Failed to submit reviews for product\");ctx.trace(error);return'';});}function inputIsValid(input){return input&&!!input.productId&&!!input.tenantId;}export const submitReviewDataAction=createObservableDataAction({id:'@msdyn365-commerce-modules/ratings-reviews/submit-user-review',action:submitReview});export default submitReviewDataAction;","map":{"version":3,"sources":["actions/submit-user-review.ts"],"names":[],"mappings":"sCAKA,OAAS,0BAAT,CAA8D,WAA9D,KAAiF,yBAAjF,CAQA,cAAe,CAAA,YAAf,CAA4B,KAA5B,CAAyD,GAAzD,CAA4E,CACxE,GAAI,CAAC,YAAY,CAAC,KAAD,CAAjB,CAA0B,CACtB,GAAG,CAAC,KAAJ,oFAAsF,KAAtF,GACA,MAAO,EAAP,CACH,CAED,KAAM,CAAA,UAAU,CAAG,UAAG,KAAK,CAAC,eAAT,kCAAiD,KAAK,CAAC,SAAvD,8BACH,KAAK,CAAC,QADH,0BAEF,KAAK,CAAC,SAFJ,uBAGL,KAAK,CAAC,MAHD,CAAnB,CAKA,MAAO,CAAA,WAAW,CAAS,UAAT,CAAqB,MAArB,CAA6B,KAAK,CAAC,cAAnC,CAAmD,CAAC,OAAO,CAAE,CAAC,aAAa,oBAAc,KAAK,CAAC,aAApB,CAAd,CAAV,CAAnD,CAAX,CAA6H,IAA7H,CAAmI,QAAD,EAAa,CAClJ,GAAI,QAAQ,CAAC,MAAT,GAAoB,GAApB,EAA2B,QAAQ,CAAC,MAAT,GAAoB,GAAnD,CAAwD,CACpD,GAAG,CAAC,KAAJ,4DACA,GAAG,CAAC,KAAJ,CAAU,QAAQ,CAAC,IAAnB,EACA,MAAO,EAAP,CACH,CACD,MAAQ,CAAA,QAAQ,CAAC,IAAjB,CACH,CAPM,EAOJ,KAPI,CAOG,KAAD,EAAU,CACf,GAAG,CAAC,KAAJ,4DACA,GAAG,CAAC,SAAJ,CAAc,SAAd,CAAwB,KAAxB,EACA,GAAG,CAAC,SAAJ,CAAc,KAAd,4DACA,GAAG,CAAC,KAAJ,CAAU,KAAV,EACA,MAAO,EAAP,CACH,CAbM,CAAP,CAcH,CAED,QAAS,CAAA,YAAT,CAAsB,KAAtB,CAAkD,CAC9C,MAAO,CAAA,KAAK,EAAI,CAAC,CAAC,KAAK,CAAC,SAAjB,EAA8B,CAAC,CAAC,KAAK,CAAC,QAA7C,CACH,CAED,MAAO,MAAM,CAAA,sBAAsB,CAAG,0BAA0B,CAAC,CAC7D,EAAE,CAAE,+DADyD,CAE7D,MAAM,CAAmB,YAFoC,CAAD,CAAzD,CAKP,cAAe,CAAA,sBAAf","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createObservableDataAction, IAction, IActionContext, sendRequest } from '@msdyn365-commerce/core';\nimport { SubmitUserReviewInput } from './inputs/submit-user-review-input';\n\n/**\n * This data action allows submitting review to the reviews service\n * @param input This user review submission text\n * @param ctx The data action context\n */\nasync function submitReview(input:SubmitUserReviewInput, ctx: IActionContext):Promise<string> {\n    if (!inputIsValid(input)) {\n        ctx.trace(`[SubmitUserReview] Failed to submit reviews for product due to bad input ${input}`);\n        return '';\n    }\n\n    const requestUrl = `${input.serviceEndpoint}/v2.0/reviews/product/${input.productId}/user?` +\n        `tenantId=${input.tenantId}&` +\n        `channelId=${input.channelId}&` +\n        `locale=${input.locale}`;\n\n    return sendRequest<string>(requestUrl, 'post', input.userReviewData, {headers: {Authorization: `id_token ${input.authorization}`}}).then((response) => {\n        if (response.status !== 200 && response.status !== 201) {\n            ctx.trace(`[SubmitUserReview] Failed to submit reviews for product`);\n            ctx.trace(response.data);\n            return '';\n        }\n        return  response.data;\n    }).catch((error) => {\n        ctx.trace(`[SubmitUserReview] Failed to submit reviews for product`);\n        ctx.telemetry.exception(error);\n        ctx.telemetry.debug(`[SubmitUserReview] Failed to submit reviews for product`);\n        ctx.trace(error);\n        return '';\n    });\n}\n\nfunction inputIsValid(input: SubmitUserReviewInput): Boolean {\n    return input && !!input.productId && !!input.tenantId;\n}\n\nexport const submitReviewDataAction = createObservableDataAction({\n    id: '@msdyn365-commerce-modules/ratings-reviews/submit-user-review',\n    action: <IAction<string>>submitReview\n});\n\nexport default submitReviewDataAction;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}