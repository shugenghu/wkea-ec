{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _typeof from\"@babel/runtime/helpers/esm/typeof\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _asyncToGenerator from\"@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/esm/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import{__decorate}from\"tslib\";import*as React from'react';import{addOrganizationUser,AddOrganizationUserInput,deleteOrganizationUser,DeleteOrganizationUserInput,editOrganizationUser,EditOrganizationUserInput}from'@msdyn365-commerce-modules/retail-actions';import{Button,getPayloadObject,getTelemetryAttributes,getTelemetryObject,Heading,Table,TableDataType,TelemetryConstant}from'@msdyn365-commerce-modules/utilities';import MsDyn365 from'@msdyn365-commerce/core';import classnames from'classnames';import{computed,observable}from'mobx';import{observer}from'mobx-react';import{FormButton,FormFieldError,FormInput,FormLabel}from'./components';export var FormType;(function(FormType){FormType[\"None\"]=\"NONE\";FormType[\"Edit\"]=\"EDIT\";FormType[\"Remove\"]=\"REMOVE\";FormType[\"View\"]=\"VIEW\";FormType[\"Add\"]=\"ADD\";})(FormType||(FormType={}));export var InputType;(function(InputType){InputType[\"Text\"]=\"text\";InputType[\"Email\"]=\"email\";})(InputType||(InputType={}));export var InputID;(function(InputID){InputID[\"FirstName\"]=\"FirstName\";InputID[\"LastName\"]=\"LastName\";InputID[\"Email\"]=\"Email\";InputID[\"SpendingLimit\"]=\"SpendingLimit\";InputID[\"Status\"]=\"Status\";InputID[\"FullName\"]=\"Name\";})(InputID||(InputID={}));export var renderInputSection=function renderInputSection(inputs,className,onInputChange){return inputs.map(function(element){var customClass=element.customClass,id=element.id,type=element.type,label=element.label,maxChars=element.maxChars,isRequired=element.isRequired,pattern=element.pattern,value=element.value,isDisabled=element.isDisabled;return{wrapper:{className:classnames(className,id,customClass)},key:id,label:/*#__PURE__*/React.createElement(FormLabel,Object.assign({},{id:id,forId:id,className:className,text:label})),errorMessage:/*#__PURE__*/React.createElement(FormFieldError,Object.assign({},{className:className,type:'item'})),input:/*#__PURE__*/React.createElement(FormInput,Object.assign({},{id:id,type:type,maxLength:maxChars,pattern:pattern,value:value,className:className,isRequired:isRequired===undefined?false:isRequired,onChange:onInputChange,isDisabled:isDisabled}))};});};var BusinessOrganizationList=/*#__PURE__*/function(_React$Component){_inherits(BusinessOrganizationList,_React$Component);var _super=_createSuper(BusinessOrganizationList);function BusinessOrganizationList(props){var _this;_classCallCheck(this,BusinessOrganizationList);_this=_super.call(this,props);_this.BusinessFormDefaultInputs=[{id:InputID.FirstName,type:InputType.Text,label:_this.props.resources.firstNameLabelText,value:'',isRequired:true,customClass:'width-50'},{id:InputID.LastName,type:InputType.Text,label:_this.props.resources.lastNameLabelText,value:'',isRequired:true,customClass:'width-50'},{id:InputID.Email,type:InputType.Email,label:_this.props.resources.emailAddressLabelText,value:'',isRequired:true,pattern:'^[a-zA-Z0-9.!#$%&\\'^_`{}~-]+@[a-zA-Z0-9-]+(?:\\\\.[a-zA-Z0-9-]+)*$',customClass:'width-100'},{id:InputID.SpendingLimit,type:InputType.Text,label:_this.props.resources.spendingLimitLabelText,value:'',isRequired:true,customClass:'width-50'}];_this.moduleClassName='ms-business-organization-list';_this._handleAddUserButtonClicked=function(){var newForm=_this.state.formItems;newForm.forEach(function(input){if(input.id===InputID.Email){input.isDisabled=false;}input.value='';});_this.setState({formItems:newForm,isFormActive:true,formType:FormType.Add,isModalOpen:true,hasFormError:false,hasActionError:false});};_this._handleAddEditFormSaveButton=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var context,_this$state,formType,formItems,updatedUser;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:context=_this.props.context;_this$state=_this.state,formType=_this$state.formType,formItems=_this$state.formItems;updatedUser=_this._createBusinessPartner(formItems);if(formType===FormType.Edit){editOrganizationUser(new EditOrganizationUserInput(updatedUser),context.actionContext).then(function(){window.location.reload(false);})[\"catch\"](function(error){context.telemetry.trace(error);_this.setState({hasActionError:true});});}else{addOrganizationUser(new AddOrganizationUserInput(updatedUser),context.actionContext).then(function(){window.location.reload(false);})[\"catch\"](function(error){context.telemetry.trace(error);_this.setState({hasActionError:true});});}case 4:case\"end\":return _context.stop();}}},_callee);}));_this._createBusinessPartner=function(inputs){var newUser={Email:''};inputs.forEach(function(input){if(input.id===InputID.SpendingLimit){newUser[input.id]=parseFloat(input.value)||0;}else{newUser[input.id]=input.value;}});return newUser;};_this._handleFormCancelButton=function(){_this.setState({isFormActive:false,isModalOpen:false,formType:FormType.None});};_this._handleEditIcon=function(userData){var possibleName=userData.find(function(cell){return cell.id==='Name';});var fullName=possibleName&&possibleName.value||'';var lastSpaceIndex=fullName.lastIndexOf(' ');var firstName=fullName.substring(0,lastSpaceIndex);var lastName=fullName.substring(lastSpaceIndex+1);var formItems=_this.state.formItems;var newForm=formItems;newForm.forEach(function(input){switch(input.id){case InputID.FirstName:input.value=firstName;break;case InputID.LastName:input.value=lastName;break;case InputID.Email:input.isDisabled=true;var possibleCell=userData.find(function(cell){return input.id===cell.id;});input.value=possibleCell&&possibleCell.value||'';break;default:var dataCell=userData.find(function(cell){return input.id===cell.id;});input.value=dataCell&&dataCell.value||'';}});_this.setState({formItems:newForm,isFormActive:true,formType:FormType.Edit,isModalOpen:true,hasFormError:false,hasActionError:false});};_this._handleDeleteIcon=function(userData){var newUser={Email:''};userData.forEach(function(cell){if(cell.id==='Name'){var fullName=cell.value;var lastSpaceIndex=fullName.lastIndexOf(' ');newUser.FirstName=fullName.substring(0,lastSpaceIndex);newUser.LastName=fullName.substring(lastSpaceIndex+1);}else if(cell.type===TableDataType.Price){newUser[cell.id]=_this.props.context.cultureFormatter.formatCurrency(cell.value);}else{newUser[cell.id]=cell.value;}});_this.setState({selectedUserData:newUser,formType:FormType.Remove,isModalOpen:true,isFormActive:false});};_this._handleViewDetails=function(userData){var newUser={Email:''};userData.forEach(function(cell){if(cell.id==='Name'){var fullName=cell.value;var lastSpaceIndex=fullName.lastIndexOf(' ');newUser.FirstName=fullName.substring(0,lastSpaceIndex);newUser.LastName=fullName.substring(lastSpaceIndex+1);}else if(cell.type===TableDataType.Price){newUser[cell.id]=_this.props.context.cultureFormatter.formatCurrency(cell.value);}else{newUser[cell.id]=cell.value;}});_this.setState({selectedUserData:newUser,formType:FormType.View,isModalOpen:true,isFormActive:false});};_this._handleRemoveUserButton=function(records){var context=_this.props.context;var deleteUserData=_this.state.selectedUserData;if(deleteUserData){deleteOrganizationUser(new DeleteOrganizationUserInput(deleteUserData),context.actionContext).then(function(){window.location.reload(false);})[\"catch\"](function(error){context.telemetry.trace(error);});}_this.setState({formType:FormType.None,isModalOpen:false});};_this._onInputChange=function(event){var newForm=_this.state.formItems;newForm.forEach(function(item){if(item.id===event.target.id){item.value=event.target.value;}});_this.setState(function(prev){return{refresh:!prev.refresh,isReady:_this._isFormReady(),formItems:newForm,hasFormError:false,hasActionError:false};});};_this._isFormReady=function(){var formItems=_this.state.formItems;for(var i=0;i<formItems.length;i++){if(formItems[i].isRequired&&formItems[i].value.length<1){return false;}else if(formItems[i].pattern!==undefined&&formItems[i].value.match(formItems[i].pattern)===null){return false;}else if(formItems[i].id===InputID.SpendingLimit&&isNaN(parseFloat(formItems[i].value))){_this.setState({hasFormError:true});return false;}}return true;};_this._formatPrice=function(price){return _this.props.context.cultureFormatter?_this.props.context.cultureFormatter.formatCurrency(price):price.toString();};_this._getCurrentUrl=function(reqContext){if(MsDyn365.isBrowser){return new URL(window.location.href);}else{if(reqContext.url.requestUrl.href){return new URL(reqContext.url.requestUrl.href);}else{return new URL(reqContext.url.requestUrl.href);}}};_this._getViewport=function(){var context=_this.props.context;if(context.request&&context.request.device&&context.request.device.Type==='Mobile'){return'xs';}if((typeof window===\"undefined\"?\"undefined\":_typeof(window))!==undefined&&window.innerWidth){var gridSettings=context.request.gridSettings;if(gridSettings){if(gridSettings.xs&&window.innerWidth<=gridSettings.xs.w){return'xs';}else if(gridSettings.sm&&window.innerWidth<=gridSettings.sm.w){return'sm';}else if(gridSettings.md&&window.innerWidth<=gridSettings.md.w){return'md';}else if(gridSettings.lg&&window.innerWidth<=gridSettings.lg.w){return'lg';}else{return'xl';}}}return'xs';};_this._toggleModal=_this._toggleModal.bind(_assertThisInitialized(_this));_this._onInputChange=_this._onInputChange.bind(_assertThisInitialized(_this));_this._handleRemoveUserButton=_this._handleRemoveUserButton.bind(_assertThisInitialized(_this));_this.mobileExcludedColumns=[InputID.Email,InputID.Status,InputID.SpendingLimit];_this._viewport=props.context.request&&props.context.request.device&&props.context.request.device.Type==='Mobile'?'xs':'lg';_this._updateViewport=_this._updateViewport.bind(_assertThisInitialized(_this));_this.state={isReady:false,formItems:_this.BusinessFormDefaultInputs,isFormActive:false,formType:FormType.None,selectedUserData:{Email:''},refresh:true,isModalOpen:false,hasFormError:false,hasActionError:false};_this.telemetryContent=getTelemetryObject(_this.props.context.request.telemetryPageName,_this.props.friendlyName,_this.props.telemetry);_this.payLoad=getPayloadObject('click',_this.telemetryContent,'');_this._updateViewport();return _this;}_createClass(BusinessOrganizationList,[{key:\"componentDidMount\",value:function componentDidMount(){if(MsDyn365.isBrowser&&window.addEventListener){window.addEventListener('resize',this._updateViewport);this._updateViewport();}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(MsDyn365.isBrowser&&window.removeEventListener){window.removeEventListener('resize',this._updateViewport);}}},{key:\"render\",value:function render(){var _this$props=this.props,config=_this$props.config,resources=_this$props.resources,users=_this$props.data.users;var className=config.className,heading=config.heading;var addUserButtonText=resources.addUserButtonText,loadingMessage=resources.loadingMessage,emptyListMessage=resources.emptyListMessage,errorGettingUsersMessage=resources.errorGettingUsersMessage;var _this$state2=this.state,formItems=_this$state2.formItems,isFormActive=_this$state2.isFormActive,formType=_this$state2.formType,isModalOpen=_this$state2.isModalOpen;var hasUsers=users&&users.result&&users.result.length>0;this.payLoad.contentAction.etext=TelemetryConstant.AddUser;var addUserAttributes=getTelemetryAttributes(this.telemetryContent,this.payLoad);if(!hasUsers){var errorMessage='';if(users.status==='LOADING'){errorMessage=loadingMessage;}else if(users.status==='FAILED'){errorMessage=errorGettingUsersMessage;}else if(users.result&&users.result.length===0){errorMessage=emptyListMessage;}var errorProps=_objectSpread(_objectSpread({},this.props),{},{className:className,OrganizationUserList:{moduleProps:this.props,className:classnames(this.moduleClassName,className)},moduleContainer:{className:\"\".concat(this.moduleClassName,\"__container\")},heading:heading&&/*#__PURE__*/React.createElement(Heading,{className:\"\".concat(this.moduleClassName,\"__heading\"),headingTag:heading.tag,text:heading.text}),addUserButton:/*#__PURE__*/React.createElement(Button,Object.assign({className:\"\".concat(this.moduleClassName,\"__add-user-button\"),onClick:this._handleAddUserButtonClicked},addUserAttributes),addUserButtonText),noUsersText:/*#__PURE__*/React.createElement(\"p\",{className:\"\".concat(this.moduleClassName,\"__error-message\")},errorMessage)});return this.props.renderView(errorProps);}var viewProps=_objectSpread(_objectSpread({},this.props),{},{className:className,OrganizationUserList:{moduleProps:this.props,className:classnames(this.moduleClassName,className)},moduleContainer:{className:\"\".concat(this.moduleClassName,\"__container\")},heading:heading&&/*#__PURE__*/React.createElement(Heading,{className:\"\".concat(this.moduleClassName,\"__heading\"),headingTag:heading.tag,text:heading.text}),modalState:isModalOpen,addUserButton:/*#__PURE__*/React.createElement(Button,Object.assign({className:\"\".concat(this.moduleClassName,\"__add-user-button\"),onClick:this._handleAddUserButtonClicked},addUserAttributes),addUserButtonText),organizationListTable:/*#__PURE__*/React.createElement(Table,Object.assign({},this._createTableProps())),toggleModal:this._toggleModal,formType:formType,form:isFormActive&&isModalOpen&&(formType===FormType.Add||formType===FormType.Edit)?this._renderUserForm():this._renderUserDetails(),formItems:formItems});return this.props.renderView(viewProps);}},{key:\"_createTableProps\",value:function _createTableProps(){var _this2=this;var _this$props2=this.props,config=_this$props2.config,resources=_this$props2.resources,context=_this$props2.context;var tableSort=config.tableSort,showPagination=config.showPagination,paginationItemPerPage=config.paginationItemPerPage;var paginationNextButtonText=resources.paginationNextButtonText,paginationPreviousButtonText=resources.paginationPreviousButtonText,editButtonText=resources.editButtonText,deleteButtonText=resources.deleteButtonText,actionButtonText=resources.actionButtonText,paginationAriaLabel=resources.paginationAriaLabel;var tableData=this._createTableItems();var tableHeading=tableData.length>0&&tableData[0].row.map(function(item){if(_this2.isMobile&&_this2.mobileExcludedColumns.includes(item.id)){return;}else{return{name:item.id,sortable:tableSort&&tableSort||false};}})||[];return{resources:resources,headings:tableHeading,rows:tableData,className:\"\".concat(this.moduleClassName,\"__table\"),editLinkText:this.isMobile?editButtonText:'',deleteLinkText:this.isMobile?deleteButtonText:'',viewLinkText:'View details',enableToModify:true,actionLinkText:actionButtonText,showCheckBoxes:false,isSortable:tableSort,showPagination:showPagination,minifyActions:this.isMobile,excludedColumns:this.isMobile?this.mobileExcludedColumns:[],paginationProperty:{skipCount:context&&context.request&&context.request.query&&context.request.query.skip&&!isNaN(parseInt(context.request.query.skip,10))?parseInt(context.request.query.skip,10):0,itemPerPage:paginationItemPerPage||10,prevText:paginationPreviousButtonText,nextText:paginationNextButtonText,paginationText:paginationAriaLabel,url:context&&this._getCurrentUrl(context.request).href||''},actions:{onDelete:this._handleDeleteIcon,onEdit:this._handleEditIcon,onView:this.isMobile&&this._handleViewDetails||undefined},formatPrice:this._formatPrice};}},{key:\"_createTableItems\",value:function _createTableItems(){var _this$props3=this.props,resources=_this$props3.resources,users=_this$props3.data.users;var activeStatusText=resources.activeStatusText,pendingStatusText=resources.pendingStatusText,removedStatusText=resources.removedStatusText;var usersList=users&&users.result;if(!usersList||usersList.length===0){return[];}return usersList.map(function(user){var statusString='';switch(user.StatusValue){case 0:statusString=pendingStatusText;break;case 1:statusString=activeStatusText;break;case 2:default:statusString=removedStatusText;}return{row:[{id:InputID.FullName,type:TableDataType.Text,value:\"\".concat(user.FirstName,\" \").concat(user.LastName)},{id:InputID.Email,type:TableDataType.Text,value:user.Email},{id:InputID.Status,type:TableDataType.Text,value:statusString},{id:InputID.SpendingLimit,type:TableDataType.Price,value:user.SpendingLimit||0}]};});}},{key:\"_toggleModal\",value:function _toggleModal(){this.setState({isModalOpen:false,isFormActive:false,formType:FormType.None});}},{key:\"_renderUserDetails\",value:function _renderUserDetails(){var _this3=this;var resources=this.props.resources;var _this$state3=this.state,formType=_this$state3.formType,selectedUserData=_this$state3.selectedUserData;var removeModalHeaderText=resources.removeModalHeaderText,removeModalDescription=resources.removeModalDescription,viewModalHeaderText=resources.viewModalHeaderText,cancelButtonText=resources.cancelButtonText,cancelRemoveUserButtonText=resources.cancelRemoveUserButtonText,removeUserButtonText=resources.removeUserButtonText,errorUpdatingUsersMessage=resources.errorUpdatingUsersMessage;var formClassName=\"\".concat(this.moduleClassName,\"__form\");var typeClassName=formType===FormType.Remove?'type-remove':'type-view';var handleRemoveButton=function handleRemoveButton(event){_this3._handleRemoveUserButton(selectedUserData);};return{modalClassName:classnames(\"\".concat(this.moduleClassName,\"__modal\"),typeClassName),FormWrapper:{className:formClassName},modalHeading:formType===FormType.Remove?removeModalHeaderText:viewModalHeaderText,modalDescription:formType===FormType.Remove&&/*#__PURE__*/React.createElement(\"p\",{className:\"\".concat(formClassName,\"-description\")},removeModalDescription),selectedUser:selectedUserData,buttons:[formType===FormType.Remove&&/*#__PURE__*/React.createElement(Button,{key:'action-remove',className:\"\".concat(formClassName,\"-remove-user-button\"),onClick:handleRemoveButton},removeUserButtonText),/*#__PURE__*/React.createElement(Button,{key:'action-cancel',className:\"\".concat(formClassName,\"-cancel\"),onClick:this._handleFormCancelButton},formType===FormType.Remove?cancelRemoveUserButtonText:cancelButtonText)],errorMessage:[/*#__PURE__*/React.createElement(FormFieldError,{key:'fieldIncorrect',id:'fieldIncorrect',className:\"\".concat(formClassName,\"-error\"),message:errorUpdatingUsersMessage})],resources:resources};}},{key:\"_renderUserForm\",value:function _renderUserForm(){var resources=this.props.resources;var _this$state4=this.state,formType=_this$state4.formType,formItems=_this$state4.formItems,hasFormError=_this$state4.hasFormError,hasActionError=_this$state4.hasActionError,isReady=_this$state4.isReady;var editUserFormHeadingText=resources.editUserFormHeadingText,addUserFormHeadingText=resources.addUserFormHeadingText,saveButtonArialabel=resources.saveButtonArialabel,saveButtonText=resources.saveButtonText,cancelButtonArialabel=resources.cancelButtonArialabel,cancelButtonText=resources.cancelButtonText,fieldIncorrectErrorText=resources.fieldIncorrectErrorText,actionErrorText=resources.actionErrorText,allFieldsRequiredMessage=resources.allFieldsRequiredMessage;var formClassName=\"\".concat(this.moduleClassName,\"__form\");var typeClassName=formType===FormType.Add?'type-add':'type-edit';return{modalClassName:classnames(\"\".concat(this.moduleClassName,\"__modal\"),typeClassName),FormWrapper:{className:formClassName},modalHeading:formType===FormType.Add?addUserFormHeadingText:editUserFormHeadingText,modalDescription:formType===FormType.Add&&/*#__PURE__*/React.createElement(\"p\",{className:\"\".concat(formClassName,\"-all-required-msg\")},allFieldsRequiredMessage),inputs:renderInputSection(formItems,\"\".concat(formClassName,\"-item\"),this._onInputChange),buttons:[/*#__PURE__*/React.createElement(FormButton,{key:'continue',id:'continue',className:\"\".concat(formClassName,\"-save\"),ariaLabel:saveButtonArialabel,text:saveButtonText,onClick:this._handleAddEditFormSaveButton,disabled:!isReady,telemetryContent:this.telemetryContent}),/*#__PURE__*/React.createElement(FormButton,{key:'cancel',id:'cancel',className:\"\".concat(formClassName,\"-cancel\"),ariaLabel:cancelButtonArialabel,text:cancelButtonText,onClick:this._handleFormCancelButton,telemetryContent:this.telemetryContent})],errorMessage:[hasFormError&&/*#__PURE__*/React.createElement(FormFieldError,{key:'fieldIncorrect',id:'fieldIncorrect',className:this.moduleClassName,message:fieldIncorrectErrorText}),hasActionError&&/*#__PURE__*/React.createElement(FormFieldError,{key:'fieldIncorrect',id:'fieldIncorrect',className:this.moduleClassName,message:actionErrorText})],resources:resources};}},{key:\"_updateViewport\",value:function _updateViewport(){this._viewport=this._getViewport();}},{key:\"isMobile\",get:function get(){return this._viewport==='xs'||this._viewport==='sm';}}]);return BusinessOrganizationList;}(React.Component);__decorate([observable],BusinessOrganizationList.prototype,\"_viewport\",void 0);__decorate([computed],BusinessOrganizationList.prototype,\"isMobile\",null);BusinessOrganizationList=__decorate([observer],BusinessOrganizationList);export default BusinessOrganizationList;","map":{"version":3,"sources":["modules/business-organization-list/business-organization-list.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as React from 'react';\n\nimport { addOrganizationUser, AddOrganizationUserInput, deleteOrganizationUser, DeleteOrganizationUserInput, editOrganizationUser, EditOrganizationUserInput } from '@msdyn365-commerce-modules/retail-actions';\nimport { Button, getPayloadObject, getTelemetryAttributes, getTelemetryObject, Heading, IDataTableProps, IHeadingsProperty, IModuleProps, INodeProps, IPayLoad,\n     ITableItemProps, ITableRowProps, ITelemetryContent, Table, TableDataType, TelemetryConstant } from '@msdyn365-commerce-modules/utilities';\nimport MsDyn365, { IRequestContext } from '@msdyn365-commerce/core';\nimport { BusinessPartnerUser } from '@msdyn365-commerce/retail-proxy';\nimport classnames from 'classnames';\nimport { computed, observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { IBusinessOrganizationListData } from './business-organization-list.data';\nimport { IBusinessOrganizationListProps, IBusinessOrganizationListResources } from './business-organization-list.props.autogenerated';\nimport { FormButton, FormFieldError, FormInput, FormLabel, IBusinessFormItem, IUserFormItem } from './components';\n\nexport interface IBusinessOrganizationListViewProps extends IBusinessOrganizationListProps<IBusinessOrganizationListData> {\n    OrganizationUserList: IModuleProps;\n    moduleContainer: INodeProps;\n    heading: React.ReactNode;\n    noUsersText?: string;\n    addUserButton?: React.ReactNode;\n    search?: React.ReactNode;\n    organizationListTable: React.ReactNode;\n    form?: IFormViewProps;\n    formItems?: IUserFormItem[];\n    formType: FormType;\n    deleteUserForm?: React.ReactNode;\n    viewUserDetails?: React.ReactNode;\n    modalHeading?: React.ReactNode;\n    modalState?: boolean;\n    toggleModal?(): void;\n}\n\nexport interface IBusinessOrganizationListState {\n    isReady: boolean;\n    formItems: IUserFormItem[];\n    isFormActive: boolean;\n    formType: FormType;\n    selectedUserData: BusinessPartnerUser;\n    refresh: boolean;\n    isModalOpen: boolean;\n    hasFormError: boolean;\n    hasActionError: boolean;\n}\n\ntype GridSize = 'xs' | 'sm' | 'md' | 'lg' | 'xl';\n\nexport enum FormType {\n    None = 'NONE',\n    Edit = 'EDIT',\n    Remove = 'REMOVE',\n    View = 'VIEW',\n    Add = 'ADD'\n}\n\nexport enum InputType {\n    Text = 'text',\n    Email = 'email'\n}\n\nexport enum InputID {\n    FirstName = 'FirstName',\n    LastName = 'LastName',\n    Email = 'Email',\n    SpendingLimit = 'SpendingLimit',\n    Status = 'Status',\n    FullName = 'Name'\n}\n\nexport interface IFormViewProps {\n    modalClassName: string;\n    FormWrapper: INodeProps;\n    modalHeading?: string;\n    modalDescription?: React.ReactNode;\n    inputs?: IBusinessFormItem[];\n    selectedUser?: BusinessPartnerUser;\n    buttons?: React.ReactNode[];\n    errorMessage?: React.ReactNode[];\n    resources: IBusinessOrganizationListResources;\n    toggle?(): void;\n}\n\nexport const renderInputSection = (inputs: IUserFormItem[], className: string, onInputChange: (event: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => void): IBusinessFormItem[] => {\n    return inputs.map((element) => {\n        const { customClass, id, type, label, maxChars, isRequired, pattern, value, isDisabled } = element;\n\n        return {\n            wrapper: {\n                className: classnames(className, id, customClass)\n            },\n            key: id,\n            label: <FormLabel { ...{ id, forId: id, className, text: label }} />,\n            errorMessage: <FormFieldError { ...{ className: className, type: 'item' }} />,\n            input: (\n                <FormInput\n                    {\n                    ...{\n                            id: id,\n                            type: type,\n                            maxLength: maxChars,\n                            pattern: pattern,\n                            value: value,\n                            className: className,\n                            isRequired: isRequired === undefined ? false : isRequired,\n                            onChange: onInputChange,\n                            isDisabled: isDisabled\n                        }\n                    }\n                />\n            )\n        };\n    });\n};\n\n/**\n *\n * BusinessOrganizationList component\n * @extends {React.PureComponent<IBusinessOrganizationListProps<IBusinessOrganizationListData>>}\n */\n@observer\nclass BusinessOrganizationList extends React.Component<IBusinessOrganizationListProps<IBusinessOrganizationListData>,IBusinessOrganizationListState> {\n    public BusinessFormDefaultInputs: IUserFormItem[] = [\n        {\n            id: InputID.FirstName,\n            type: InputType.Text,\n            label: this.props.resources.firstNameLabelText,\n            value: '',\n            isRequired: true,\n            customClass: 'width-50'\n        },\n        {\n            id: InputID.LastName,\n            type: InputType.Text,\n            label: this.props.resources.lastNameLabelText,\n            value: '',\n            isRequired: true,\n            customClass: 'width-50'\n        },\n        {\n            id: InputID.Email,\n            type: InputType.Email,\n            label: this.props.resources.emailAddressLabelText,\n            value: '',\n            isRequired: true,\n            pattern: '^[a-zA-Z0-9.!#$%&\\'^_`{}~-]+@[a-zA-Z0-9-]+(?:\\\\.[a-zA-Z0-9-]+)*$',\n            customClass: 'width-100'\n        },\n        {\n            id: InputID.SpendingLimit,\n            type: InputType.Text,\n            label: this.props.resources.spendingLimitLabelText,\n            value: '',\n            isRequired: true,\n            customClass: 'width-50'\n        },\n    ];\n\n    private moduleClassName: string = 'ms-business-organization-list';\n    private mobileExcludedColumns: string[];\n\n    @observable\n    private _viewport: GridSize;\n    @computed get isMobile(): boolean {\n        return (this._viewport === 'xs' || this._viewport === 'sm');\n    }\n    private telemetryContent?: ITelemetryContent;\n    private payLoad: IPayLoad;\n\n    constructor(props: IBusinessOrganizationListProps<IBusinessOrganizationListData>) {\n        super(props);\n        this._toggleModal = this._toggleModal.bind(this);\n        this._onInputChange = this._onInputChange.bind(this);\n        this._handleRemoveUserButton = this._handleRemoveUserButton.bind(this);\n\n        this.mobileExcludedColumns = [InputID.Email, InputID.Status, InputID.SpendingLimit];\n        this._viewport = props.context.request && props.context.request.device && props.context.request.device.Type === 'Mobile' ? 'xs' : 'lg';\n        this._updateViewport = this._updateViewport.bind(this);\n\n        this.state = {\n            isReady: false,\n            formItems: this.BusinessFormDefaultInputs,\n            isFormActive: false,\n            formType: FormType.None,\n            selectedUserData: {Email: ''},\n            refresh: true,\n            isModalOpen: false,\n            hasFormError: false,\n            hasActionError: false\n        };\n\n        this.telemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!, this.props.friendlyName, this.props.telemetry);\n        this.payLoad = getPayloadObject('click', this.telemetryContent, '');\n        this._updateViewport();\n    }\n\n    public componentDidMount(): void {\n        if (MsDyn365.isBrowser && window.addEventListener) {\n            window.addEventListener('resize', this._updateViewport);\n            this._updateViewport();\n        }\n    }\n\n    public componentWillUnmount(): void {\n        if (MsDyn365.isBrowser && window.removeEventListener) {\n            window.removeEventListener('resize', this._updateViewport);\n        }\n    }\n\n    public render(): JSX.Element | null {\n        const { config, resources, data: { users } } = this.props;\n        const { className, heading } = config;\n        const { addUserButtonText, loadingMessage, emptyListMessage, errorGettingUsersMessage } = resources;\n        const { formItems, isFormActive, formType, isModalOpen } = this.state;\n\n        const hasUsers = users && users.result && users.result.length > 0;\n        this.payLoad.contentAction.etext = TelemetryConstant.AddUser;\n        const addUserAttributes = getTelemetryAttributes(this.telemetryContent!, this.payLoad);\n\n        if (!hasUsers) {\n            let errorMessage = '';\n            if (users.status === 'LOADING') {\n                errorMessage = loadingMessage;\n            } else if (users.status === 'FAILED') {\n                errorMessage = errorGettingUsersMessage;\n            } else if (users.result && users.result.length === 0) {\n                errorMessage = emptyListMessage;\n            }\n\n            const errorProps = {\n                ...this.props,\n                className: className,\n                OrganizationUserList: {\n                    moduleProps: this.props,\n                    className: classnames(this.moduleClassName, className)\n                },\n                moduleContainer: {\n                    className: `${this.moduleClassName}__container`\n                },\n                heading: heading && <Heading className={`${this.moduleClassName}__heading`} headingTag={heading.tag} text={heading.text} />,\n                addUserButton: <Button className={`${this.moduleClassName}__add-user-button`} onClick={this._handleAddUserButtonClicked} {...addUserAttributes} >{addUserButtonText}</Button>,\n                noUsersText: <p className={`${this.moduleClassName}__error-message`}>{errorMessage}</p>\n            };\n\n            return this.props.renderView(errorProps) as React.ReactElement;\n        }\n\n        const viewProps = {\n            ...this.props,\n            className: className,\n            OrganizationUserList: {\n                moduleProps: this.props,\n                className: classnames(this.moduleClassName, className)\n            },\n            moduleContainer: {\n                className: `${this.moduleClassName}__container`\n            },\n            heading: heading && <Heading className={`${this.moduleClassName}__heading`} headingTag={heading.tag} text={heading.text} />,\n            modalState: isModalOpen,\n            addUserButton: <Button className={`${this.moduleClassName}__add-user-button`} onClick={this._handleAddUserButtonClicked} {...addUserAttributes} >{addUserButtonText}</Button>,\n            organizationListTable: <Table {...this._createTableProps()} />,\n            toggleModal: this._toggleModal,\n            formType: formType,\n            form: isFormActive && isModalOpen && (formType === FormType.Add || formType === FormType.Edit) ? this._renderUserForm() : this._renderUserDetails(),\n            formItems: formItems\n        } as IBusinessOrganizationListViewProps;\n\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n\n    // _createTableProps: creates the props for the organization list table\n    private _createTableProps(): IDataTableProps {\n        const { config, resources, context } = this.props;\n        const { tableSort, showPagination, paginationItemPerPage } = config;\n        const { paginationNextButtonText, paginationPreviousButtonText, editButtonText, deleteButtonText, actionButtonText, paginationAriaLabel  } = resources;\n\n        const tableData = this._createTableItems();\n        const tableHeading = tableData.length > 0 && tableData[0].row.map((item) => {\n            if (this.isMobile && this.mobileExcludedColumns.includes(item.id)) {\n                return;\n            } else {\n                return {\n                    name: item.id,\n                    sortable: tableSort && tableSort || false\n                } as IHeadingsProperty;\n            }\n        }) || [];\n\n        return {\n            resources: resources,\n            headings: tableHeading,\n            rows: tableData,\n            className: `${this.moduleClassName}__table`,\n            editLinkText: this.isMobile ? editButtonText : '', // '' === showing just icon\n            deleteLinkText: this.isMobile ? deleteButtonText : '', // '' === showing just icon\n            viewLinkText: 'View details',\n            enableToModify: true,\n            actionLinkText: actionButtonText,\n            showCheckBoxes: false,\n            isSortable: tableSort,\n            showPagination: showPagination,\n            minifyActions: this.isMobile,\n            excludedColumns: this.isMobile ? this.mobileExcludedColumns : [],\n            paginationProperty: {\n                skipCount: context && context.request && context.request.query && context.request.query.skip && !isNaN(parseInt(context.request.query.skip, 10)) ? parseInt(context.request.query.skip, 10) : 0,\n                itemPerPage: paginationItemPerPage || 10,\n                prevText: paginationPreviousButtonText,\n                nextText: paginationNextButtonText,\n                paginationText: paginationAriaLabel,\n                url: context && this._getCurrentUrl(context.request).href || ''\n            },\n            actions: {\n                onDelete: this._handleDeleteIcon,\n                onEdit: this._handleEditIcon,\n                onView: this.isMobile && this._handleViewDetails || undefined\n            },\n            formatPrice: this._formatPrice\n        };\n    }\n\n    // _createTableItems: converts users recieved from the data-action(IBusinessParterUser[]) to tableRows(ITableItemProps[])\n    private _createTableItems(): ITableRowProps[] {\n        const { resources, data: { users } } = this.props;\n        const { activeStatusText, pendingStatusText, removedStatusText } = resources;\n        const usersList = users && users.result;\n\n        if (!usersList || usersList.length === 0) {\n            return [];\n        }\n\n        return usersList.map((user) => {\n            let statusString = '';\n\n            switch(user.StatusValue) {\n                case 0:\n                    statusString = pendingStatusText;\n                    break;\n                case 1:\n                    statusString = activeStatusText;\n                    break;\n                case 2:\n                default:\n                    statusString = removedStatusText;\n            }\n\n            return {\n                row: [\n                    {\n                        id: InputID.FullName,\n                        type: TableDataType.Text,\n                        value: `${user.FirstName} ${user.LastName}`\n                    },\n                    {\n                        id: InputID.Email,\n                        type: TableDataType.Text,\n                        value: user.Email\n                    },\n                    {\n                        id: InputID.Status,\n                        type: TableDataType.Text,\n                        value: statusString\n                    },\n                    {\n                        id: InputID.SpendingLimit,\n                        type: TableDataType.Price,\n                        value: user.SpendingLimit || 0\n                    }\n                ]\n            };\n        });\n    }\n\n    // _toggleModal: closes the modal and resets the form states\n    private _toggleModal():void {\n        this.setState({\n            isModalOpen: false,\n            isFormActive: false,\n            formType: FormType.None\n        });\n    }\n\n    // _handleAddUserButtonClicked: resets input fields, opens the modal, and sets the form states\n    private _handleAddUserButtonClicked = () => {\n        // reset form\n        const newForm = this.state.formItems;\n        newForm.forEach((input) => {\n            if (input.id === InputID.Email) {\n                // make sure email input is re enabled (it gets disabled when admin is editing user)\n                input.isDisabled = false;\n            }\n\n            input.value = '';\n        });\n\n        this.setState({\n            formItems: newForm,\n            isFormActive: true,\n            formType: FormType.Add,\n            isModalOpen: true,\n            hasFormError: false,\n            hasActionError: false\n        });\n    }\n\n    // _handleAddEditFormSaveButton: triggered on the save button for both add/edit forms. Calls the appropriate data-action and reloads the page when successful\n    private _handleAddEditFormSaveButton = async () => {\n        const { context } = this.props;\n        const { formType, formItems } = this.state;\n\n        const updatedUser = this._createBusinessPartner(formItems);\n\n        if (formType === FormType.Edit) {\n            editOrganizationUser(new EditOrganizationUserInput(updatedUser), context.actionContext)\n                .then(() => {\n                    window.location.reload(false);\n                })\n                .catch(error => {\n                    context.telemetry.trace(error);\n                    this.setState({\n                        hasActionError: true\n                    });\n                });\n        } else {\n            addOrganizationUser(new AddOrganizationUserInput(updatedUser), context.actionContext)\n                .then(() => {\n                    window.location.reload(false);\n                })\n                .catch(error => {\n                    context.telemetry.trace(error);\n                    this.setState({\n                        hasActionError: true\n                    });\n                });\n        }\n    }\n\n    // _createBusinessPartner: attempts to convert input values(IUserFormItem) to a new user(BusinessPartnerUser)\n    private _createBusinessPartner = (inputs: IUserFormItem[]): BusinessPartnerUser => {\n        const newUser: BusinessPartnerUser = {\n            Email: ''  // email is required field\n        };\n\n        inputs.forEach((input) => {\n            // deals with input values need need to be converted into numbers\n            if (input.id === InputID.SpendingLimit) {\n                newUser[input.id] = parseFloat(input.value) || 0;\n            } else {\n                newUser[input.id] = input.value;\n            }\n        });\n\n        return newUser;\n    }\n\n    // _handleFormCancelButton: closes the modal when clicking the Cancel button\n    private _handleFormCancelButton = () => {\n        this.setState({\n            isFormActive: false,\n            isModalOpen: false,\n            formType: FormType.None\n        });\n    }\n\n    // _handleEditIcon: converts the table row data(ITableItemProps[]) to input fields(IUserFormItem) and opens the edit form\n    private _handleEditIcon = (userData: ITableItemProps[]) => {\n        // split full name into first and last\n        const possibleName = userData.find(cell => {return cell.id === 'Name';});\n        const fullName = possibleName && possibleName.value as string || '';\n        const lastSpaceIndex = fullName.lastIndexOf(' ');\n        const firstName = fullName.substring(0, lastSpaceIndex);\n        // tslint:disable-next-line:restrict-plus-operands\n        const lastName = fullName.substring(lastSpaceIndex + 1);\n\n        // create clone of formItems, map users information, update state\n        const { formItems } = this.state;\n        const newForm = formItems;\n\n        newForm.forEach(input => {\n            switch (input.id) {\n                case InputID.FirstName:\n                    input.value = firstName;\n                    break;\n                case InputID.LastName:\n                    input.value = lastName;\n                    break;\n                case InputID.Email: // email can never be null/undefined as it is a required field\n                    input.isDisabled = true;\n                    const possibleCell = userData.find(cell => {return input.id === cell.id;});\n                    input.value = possibleCell && possibleCell.value as string || '';\n                    break;\n                default:\n                    const dataCell = userData.find(cell => {return input.id === cell.id;});\n                    input.value = dataCell && dataCell.value as string || '';\n            }\n        });\n\n        this.setState({\n            formItems: newForm,\n            isFormActive: true,\n            formType: FormType.Edit,\n            isModalOpen: true,\n            hasFormError: false,\n            hasActionError: false\n        });\n    }\n\n    // _handleDeleteIcon: opens removeUser confirmation window\n    private _handleDeleteIcon = (userData: ITableItemProps[]) => {\n        const newUser: BusinessPartnerUser = {\n            Email: ''\n        };\n\n        userData.forEach((cell: ITableItemProps) => {\n            if (cell.id === 'Name') {\n                // split full name into first and last\n                const fullName = cell.value as string;\n                const lastSpaceIndex = fullName.lastIndexOf(' ');\n                newUser.FirstName = fullName.substring(0, lastSpaceIndex);\n                // tslint:disable-next-line\n                newUser.LastName = fullName.substring(lastSpaceIndex + 1);\n            } else if (cell.type === TableDataType.Price) {\n                newUser[cell.id] = this.props.context.cultureFormatter.formatCurrency(cell.value as string);\n            } else {\n                newUser[cell.id] = cell.value;\n            }\n        });\n\n        this.setState({\n            selectedUserData: newUser,\n            formType: FormType.Remove,\n            isModalOpen: true,\n            isFormActive: false\n        });\n    }\n\n    // _handleViewDetails: opens user details window\n    private _handleViewDetails = (userData: ITableItemProps[]) => {\n        const newUser: BusinessPartnerUser = {\n            Email: ''\n        };\n\n        userData.forEach((cell: ITableItemProps) => {\n            if (cell.id === 'Name') {\n                // split full name into first and last\n                const fullName = cell.value as string;\n                const lastSpaceIndex = fullName.lastIndexOf(' ');\n                newUser.FirstName = fullName.substring(0, lastSpaceIndex);\n                // tslint:disable-next-line\n                newUser.LastName = fullName.substring(lastSpaceIndex + 1);\n            } else if (cell.type === TableDataType.Price) {\n                newUser[cell.id] = this.props.context.cultureFormatter.formatCurrency(cell.value as string);\n            } else {\n                newUser[cell.id] = cell.value;\n            }\n        });\n\n        this.setState({\n            selectedUserData: newUser,\n            formType: FormType.View,\n            isModalOpen: true,\n            isFormActive: false\n        });\n    }\n\n    // _handleRemoveUserButton: triggered on confirmation of removing a user.\n    private _handleRemoveUserButton = (records: BusinessPartnerUser) => {\n        // TODO\n        const { context } = this.props;\n        const { selectedUserData: deleteUserData } = this.state;\n\n        if (deleteUserData) {\n            deleteOrganizationUser(new DeleteOrganizationUserInput(deleteUserData), context.actionContext)\n                .then(() => {\n                    window.location.reload(false);\n                })\n                .catch((error) => {\n                    context.telemetry.trace(error);\n                });\n        }\n        this.setState({\n            formType: FormType.None,\n            isModalOpen: false\n        });\n    }\n\n    // _renderUserDetails: creates the remove/view form props\n    private _renderUserDetails(): IFormViewProps {\n        const { resources } = this.props;\n        const { formType, selectedUserData } = this.state;\n        const { removeModalHeaderText, removeModalDescription, viewModalHeaderText, cancelButtonText, cancelRemoveUserButtonText, removeUserButtonText, errorUpdatingUsersMessage } = resources;\n\n        const formClassName = `${this.moduleClassName}__form`;\n        const typeClassName = formType === FormType.Remove ? 'type-remove' : 'type-view';\n        const handleRemoveButton = (event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => { this._handleRemoveUserButton(selectedUserData); };\n\n        return {\n            modalClassName: classnames(`${this.moduleClassName}__modal`, typeClassName),\n            FormWrapper: {\n                className: formClassName\n            },\n            modalHeading: formType === FormType.Remove ? removeModalHeaderText : viewModalHeaderText,\n            modalDescription: formType === FormType.Remove && <p className={`${formClassName}-description`}>{removeModalDescription}</p>,\n            selectedUser: selectedUserData,\n            buttons: [\n                // tslint:disable-next-line:react-this-binding-issue\n                formType === FormType.Remove && <Button key={'action-remove'} className={`${formClassName}-remove-user-button`} onClick={handleRemoveButton}>{removeUserButtonText}</Button>,\n                <Button key={'action-cancel'} className={`${formClassName}-cancel`} onClick={this._handleFormCancelButton}>{formType === FormType.Remove ? cancelRemoveUserButtonText : cancelButtonText}</Button>\n            ],\n            errorMessage: [\n                <FormFieldError key='fieldIncorrect' id='fieldIncorrect' className={`${formClassName}-error`} message={errorUpdatingUsersMessage}/>,\n            ],\n            resources: resources\n        };\n    }\n\n    // _renderUserForm: creates the add/edit form props\n    private _renderUserForm(): IFormViewProps {\n        const { resources } = this.props;\n        const { formType, formItems, hasFormError, hasActionError, isReady } = this.state;\n        const { editUserFormHeadingText, addUserFormHeadingText, saveButtonArialabel, saveButtonText, cancelButtonArialabel, cancelButtonText, fieldIncorrectErrorText, actionErrorText, allFieldsRequiredMessage } = resources;\n\n        const formClassName = `${this.moduleClassName}__form`;\n        const typeClassName = formType === FormType.Add ? 'type-add' : 'type-edit';\n\n        return {\n            modalClassName: classnames(`${this.moduleClassName}__modal`, typeClassName),\n            FormWrapper: {\n                className: formClassName\n            },\n            modalHeading: formType === FormType.Add ? addUserFormHeadingText : editUserFormHeadingText,\n            modalDescription: formType === FormType.Add && <p className={`${formClassName}-all-required-msg`}>{allFieldsRequiredMessage}</p>,\n            inputs: renderInputSection(formItems, `${formClassName}-item`, this._onInputChange),\n            buttons: [\n                (\n                    <FormButton\n                        key='continue'\n                        id='continue'\n                        className={`${formClassName}-save`}\n                        ariaLabel={saveButtonArialabel}\n                        text={saveButtonText}\n                        onClick={this._handleAddEditFormSaveButton}\n                        disabled={!isReady}\n                        telemetryContent={this.telemetryContent}\n                    />),\n                <FormButton key='cancel' id='cancel' className={`${formClassName}-cancel`} ariaLabel={cancelButtonArialabel} text={cancelButtonText} onClick={this._handleFormCancelButton} telemetryContent={this.telemetryContent}/>\n            ],\n            errorMessage: [\n                hasFormError && <FormFieldError key='fieldIncorrect' id='fieldIncorrect' className={this.moduleClassName} message={fieldIncorrectErrorText}/>,\n                hasActionError && <FormFieldError key='fieldIncorrect' id='fieldIncorrect' className={this.moduleClassName} message={actionErrorText}/>\n            ],\n            resources: resources\n        };\n    }\n\n    // _onInputChange: updates the fomrItems state on every input change\n    private _onInputChange = (event: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>): void => {\n        const newForm = this.state.formItems;\n\n        newForm.forEach(item => {\n            if (item.id === event.target.id) {\n                item.value = event.target.value;\n            }\n        });\n\n        // update state object with latest values and check if form is ready\n        // TODO: remove !refresh\n        this.setState((prev) => ({\n            refresh: !prev.refresh,\n            isReady: this._isFormReady(),\n            formItems: newForm,\n            hasFormError: false,\n            hasActionError: false\n        }));\n    }\n\n    // _isFormReady: checks whether the current values in the input fields are valid for submission, this will also disable/enable the submit button.\n    private _isFormReady = (): boolean => {\n        const { formItems } = this.state;\n\n        for (let i = 0; i < formItems.length; i++) {\n            // will return TRUE if:\n            //  - input field is required and EMPTY\n            //  OR\n            //  - pattern provided and value does not match pattern\n            //  OR\n            //  - if spendingLimit input --> make sure value can be parsed into an NUMBER\n            if ((formItems[i].isRequired && formItems[i].value.length < 1)) {\n                return false;\n            } else if (formItems[i].pattern !== undefined && formItems[i].value.match(formItems[i].pattern as string) === null) {\n                return false;\n            } else if (formItems[i].id === InputID.SpendingLimit && isNaN(parseFloat(formItems[i].value))) {\n                this.setState({\n                    hasFormError: true\n                });\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    private _formatPrice = (price: number): string => {\n        return this.props.context.cultureFormatter ? this.props.context.cultureFormatter.formatCurrency(price) : price.toString();\n    }\n\n    private _getCurrentUrl = (reqContext: IRequestContext): URL=> {\n        if (MsDyn365.isBrowser) {\n            return new URL(window.location.href);\n        } else {\n            // NOTE: Typing on requestURL is incorrect\n            if (reqContext.url.requestUrl.href) {\n                return new URL(reqContext.url.requestUrl.href);\n            } else {\n                return new URL(reqContext.url.requestUrl.href);\n            }\n        }\n    }\n\n    private _updateViewport(): void {\n        this._viewport = this._getViewport();\n    }\n\n    private _getViewport = (): GridSize => {\n        const { context } = this.props;\n\n        // always render in mobile viewport on a mobile device\n        if (context.request && context.request.device && context.request.device.Type === 'Mobile') {\n            return 'xs';\n        }\n\n        if (typeof window !== undefined && window.innerWidth) {\n            const gridSettings = context.request.gridSettings;\n            if (gridSettings) {\n                if (gridSettings.xs && window.innerWidth <= gridSettings.xs.w) {\n                    return 'xs';\n                } else if (gridSettings.sm && window.innerWidth <= gridSettings.sm.w) {\n                    return 'sm';\n                } else if (gridSettings.md && window.innerWidth <= gridSettings.md.w) {\n                    return 'md';\n                } else if (gridSettings.lg && window.innerWidth <= gridSettings.lg.w) {\n                    return 'lg';\n                } else {\n                    return 'xl';\n                }\n            }\n        }\n\n        return 'xs';\n    }\n}\n\nexport default BusinessOrganizationList;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}