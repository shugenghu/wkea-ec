{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _inherits from\"@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/esm/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import{getTelemetryObject}from'@msdyn365-commerce-modules/utilities';import{Carousel}from'@msdyn365-commerce/components';import classnames from'classnames';import*as React from'react';import{PromoBannerCloseButton,PromoBannerLinks,PromoBannerText}from'./components';var PromoBanner=/*#__PURE__*/function(_React$PureComponent){_inherits(PromoBanner,_React$PureComponent);var _super=_createSuper(PromoBanner);function PromoBanner(){var _this;_classCallCheck(this,PromoBanner);_this=_super.apply(this,arguments);_this.state={animating:false,isVisible:true,activeIndex:0};_this.telemetryContent=getTelemetryObject(_this.props.context.request.telemetryPageName,_this.props.friendlyName,_this.props.telemetry);_this.handleTextChange=function(event){if(_this.props.config.bannerMessages&&_this.props.config.bannerMessages[0]){_this.props.config.bannerMessages[0].text=event.target.value;}};_this.handleLinkTextChange=function(linkIndex){return function(event){if(_this.props.config.bannerMessages&&_this.props.config.bannerMessages[1]){var links=_this.props.config.bannerMessages[1].links;if(links){links[linkIndex].linkText=event.target.value;}}};};_this._next=function(){var nextIndex=_this._isLastItem()?0:_this.state.activeIndex+1;_this._goToIndex(nextIndex);};_this._previous=function(){var nextIndex=_this._isFirstItem()?_this.props.config.bannerMessages?_this.props.config.bannerMessages.length-1:0:_this.state.activeIndex-1;_this._goToIndex(nextIndex);};_this._goToIndex=function(index){if(_this.state.animating){return;}_this.setState({activeIndex:index});};_this._isFirstItem=function(){return _this.state.activeIndex===0;};_this._isLastItem=function(){return _this.props.config.bannerMessages&&_this.state.activeIndex===_this.props.config.bannerMessages.length-1;};_this._onDismiss=function(){_this.setState({isVisible:false});};return _this;}_createClass(PromoBanner,[{key:\"render\",value:function render(){var _this$props$config=this.props.config,bannerMessages=_this$props$config.bannerMessages,dismissEnabled=_this$props$config.dismissEnabled,interval=_this$props$config.interval,hideFlipper=_this$props$config.hideFlipper,autoplay=_this$props$config.autoplay,_this$props$config$cl=_this$props$config.className,className=_this$props$config$cl===void 0?'':_this$props$config$cl;var _this$props$resources=this.props.resources,closeButtonAriaLabel=_this$props$resources.closeButtonAriaLabel,closeButtonLabel=_this$props$resources.closeButtonLabel;var _this$state=this.state,isVisible=_this$state.isVisible,activeIndex=_this$state.activeIndex;if(!isVisible){this.props.context.telemetry.error('Promo banner content is empty, module wont render.');return null;}var viewProps=_objectSpread(_objectSpread({},this.props),{},{className:classnames('ms-promo-banner',className),isVisible:isVisible,onDismiss:this._onDismiss,handleLinks:this.handleLinkTextChange,handleText:this.handleTextChange,promoBannerProps:{className:classnames('ms-promo-banner',className),moduleProps:this.props,role:'banner'},PromoBannerTextProps:{tag:PromoBannerText},PromoBannerLinksProps:{tag:PromoBannerLinks,telemetryContent:this.telemetryContent},contentProps:{className:'ms-promo-banner__content'},bannerMessages:bannerMessages,activeIndex:activeIndex,CarouselProps:{tag:Carousel,className:'ms-promo-banner__carousel',activeIndex:activeIndex,next:this._next,previous:this._previous,onIndicatorsClickHandler:this._goToIndex,hideIndicator:hideFlipper,interval:interval,hideFlipper:hideFlipper,autoplay:autoplay},closeButton:dismissEnabled&&/*#__PURE__*/React.createElement(PromoBannerCloseButton,Object.assign({},{onClose:this._onDismiss,label:closeButtonLabel,closeButtonAriaLabel:closeButtonAriaLabel,telemetryContent:this.telemetryContent}))});return this.props.renderView(viewProps);}}]);return PromoBanner;}(React.PureComponent);export default PromoBanner;","map":{"version":3,"sources":["modules/promo-banner/promo-banner.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { getTelemetryObject, IModuleProps, INodeProps, ITelemetryContent } from '@msdyn365-commerce-modules/utilities';\nimport { Carousel } from '@msdyn365-commerce/components';\nimport * as Msdyn365 from '@msdyn365-commerce/core';\nimport classnames from 'classnames';\nimport * as React from 'react';\nimport { PromoBannerCloseButton, PromoBannerLinks, PromoBannerText } from './components';\nimport { IBannerMessagesData, IPromoBannerProps } from './promo-banner.props.autogenerated';\n\nexport interface IPromoBannerState {\n    animating: boolean;\n    isVisible: boolean;\n    activeIndex: number;\n}\n\nexport interface IPromoBannerViewProps extends IPromoBannerProps<{}>, IPromoBannerState {\n    promoBannerProps: IModuleProps;\n    contentProps: INodeProps ;\n    bannerMessages: IBannerMessagesData[];\n    PromoBannerTextProps: INodeProps;\n    PromoBannerLinksProps: INodeProps;\n    CarouselProps: INodeProps;\n    closeButton?: React.ReactNode;\n    className: string;\n    onDismiss(): void;\n    handleText(): void;\n    handleLinks(): void;\n}\n\n/**\n *\n * PromoBannerModule component\n * @extends {React.PureComponent<IPromoBannerProps<IPromoBannerState>>}\n */\nclass PromoBanner extends React.PureComponent<IPromoBannerProps<{}>, IPromoBannerState> {\n    public state: IPromoBannerState = {\n        animating: false,\n        isVisible: true,\n        activeIndex: 0\n    };\n\n    private telemetryContent: ITelemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!,\n                                                                     this.props.friendlyName,\n                                                                     this.props.telemetry);\n\n    public render(): JSX.Element | null {\n        const { bannerMessages, dismissEnabled, interval, hideFlipper, autoplay, className= '' } = this.props.config;\n        const { closeButtonAriaLabel, closeButtonLabel } = this.props.resources;\n        const { isVisible, activeIndex } = this.state;\n\n        if (!isVisible) {\n            this.props.context.telemetry.error('Promo banner content is empty, module wont render.');\n            return null;\n        }\n\n        const viewProps = {\n            // Context for telemetry and raw data for C1 to do customization\n            // Including computed data, state data and methods\n            ...this.props,\n            className: classnames('ms-promo-banner', className),\n            isVisible, // state data\n            onDismiss: this._onDismiss, // methods\n            handleLinks: this.handleLinkTextChange,\n            handleText: this.handleTextChange,\n\n            promoBannerProps: { className: classnames('ms-promo-banner', className), moduleProps: this.props, role: 'banner' },\n            PromoBannerTextProps: {\n                tag: PromoBannerText\n            },\n            PromoBannerLinksProps: {\n                tag: PromoBannerLinks,\n                telemetryContent: this.telemetryContent\n            },\n            contentProps: { className: 'ms-promo-banner__content' },\n            bannerMessages: bannerMessages,\n            activeIndex: activeIndex,\n            CarouselProps: {\n                tag: Carousel,\n                className: 'ms-promo-banner__carousel',\n                activeIndex: activeIndex,\n                next: this._next,\n                previous: this._previous,\n                onIndicatorsClickHandler: this._goToIndex,\n                hideIndicator: hideFlipper,\n                interval: interval,\n                hideFlipper: hideFlipper,\n                autoplay: autoplay\n            },\n            closeButton: dismissEnabled && <PromoBannerCloseButton {...{ onClose: this._onDismiss, label: closeButtonLabel, closeButtonAriaLabel, telemetryContent: this.telemetryContent }} />\n        };\n\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n    public handleTextChange = (event: Msdyn365.ContentEditableEvent) => {\n        if(this.props.config.bannerMessages && this.props.config.bannerMessages[0]) {\n            this.props.config.bannerMessages[0].text = event.target.value;\n        }\n    }\n    public handleLinkTextChange = (linkIndex: number) => (event: Msdyn365.ContentEditableEvent) => {\n        if(this.props.config.bannerMessages && this.props.config.bannerMessages[1]) {\n            const links = this.props.config.bannerMessages[1].links;\n            if(links) {\n                links[linkIndex].linkText = event.target.value;\n            }\n        }\n    };\n\n    private _next = (): void => {\n        const nextIndex = this._isLastItem() ? 0 : this.state.activeIndex + 1;\n        this._goToIndex(nextIndex);\n    };\n\n    private _previous = (): void => {\n        const nextIndex = this._isFirstItem() ? (this.props.config.bannerMessages ? this.props.config.bannerMessages.length - 1 : 0) : this.state.activeIndex - 1;\n        this._goToIndex(nextIndex);\n    };\n\n    private _goToIndex = (index: number): void => {\n        if (this.state.animating) {\n            return;\n        }\n        this.setState({ activeIndex: index });\n    };\n\n    private _isFirstItem = () => this.state.activeIndex === 0;\n\n    private _isLastItem = () => this.props.config.bannerMessages && this.state.activeIndex === this.props.config.bannerMessages.length - 1;\n\n    private _onDismiss = (): void => {\n        this.setState({ isVisible: false });\n    };\n}\n\nexport default PromoBanner;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}