{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _inherits from\"@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/esm/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import{Heading}from'@msdyn365-commerce-modules/utilities';import classnames from'classnames';import*as React from'react';var Iframe=/*#__PURE__*/function(_React$PureComponent){_inherits(Iframe,_React$PureComponent);var _super=_createSuper(Iframe);function Iframe(props){var _this;_classCallCheck(this,Iframe);_this=_super.call(this,props);_this.iframeRef=/*#__PURE__*/React.createRef();return _this;}_createClass(Iframe,[{key:\"render\",value:function render(){var _this$props=this.props,config=_this$props.config,resources=_this$props.resources;var isConsentGiven=this.props.context.request&&this.props.context.request.cookies&&this.props.context.request.cookies.isConsentGiven&&this.props.context.request.cookies.isConsentGiven();if(!(config&&config.target&&config.target.destinationUrl)){return null;}var srcURL;try{srcURL=new URL(config.target.destinationUrl);}catch(error){this.props.telemetry.exception(error);return null;}if(srcURL&&srcURL.protocol&&srcURL.protocol.toLocaleLowerCase()!=='https:'){return null;}var iframeClassName=classnames('ms-iframe',config.className);var viewProps=_objectSpread(_objectSpread({},this.props),{},{Heading:this._createHeading(config.heading),IframeContainer:{moduleProps:this.props,className:iframeClassName},IFrame:this._createIframe()});if(isConsentGiven===false){viewProps=_objectSpread(_objectSpread({},viewProps),{},{alert:this._renderAlert(resources.cookieConsentRequiredMessage)});}else{viewProps=_objectSpread(_objectSpread({},viewProps),{},{cookieConsentAccepted:true});}return this.props.renderView(viewProps);}},{key:\"_createHeading\",value:function _createHeading(heading){if(!heading||!heading.text||!heading.text.length){return null;}return/*#__PURE__*/React.createElement(Heading,Object.assign({},heading,{className:'ms-iframe__heading'}));}},{key:\"_renderAlert\",value:function _renderAlert(message){return/*#__PURE__*/React.createElement(\"p\",{className:'ms-iframe__error-message',role:'alert',\"aria-live\":'assertive'},message);}},{key:\"_createIframe\",value:function _createIframe(){var config=this.props.config;var targetURL=config.target.destinationUrl;return/*#__PURE__*/React.createElement(\"iframe\",{className:classnames('ms-iframe__content'),src:targetURL,height:config.height,\"aria-label\":config.iframeAriaLabel,ref:this.iframeRef});}}]);return Iframe;}(React.PureComponent);export default Iframe;","map":{"version":3,"sources":["modules/iframe/iframe.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Heading, IModuleProps } from '@msdyn365-commerce-modules/utilities';\nimport classnames from 'classnames';\nimport * as React from 'react';\nimport { IHeadingData, IIframeConfig, IIframeProps } from './iframe.props.autogenerated';\n\nexport interface IIframeViewProps extends IIframeProps<IIframeConfig> {\n    Heading: React.ReactNode;\n    IframeContainer: IModuleProps;\n    IFrame: React.ReactNode;\n    alert?: React.ReactNode;\n    cookieConsentAccepted?: boolean;\n}\n\n/**\n *\n * Iframe component\n * @extends {React.PureComponent<IIframeProps>}\n */\nclass Iframe extends React.PureComponent<IIframeProps<IIframeConfig>> {\n    private iframeRef: React.RefObject<HTMLIFrameElement>;\n    constructor(props: IIframeProps<IIframeConfig>) {\n        super(props);\n        this.iframeRef = React.createRef();\n    }\n    public render(): JSX.Element | null {\n        const { config, resources } = this.props;\n        const isConsentGiven =\n            this.props.context.request &&\n            this.props.context.request.cookies &&\n            this.props.context.request.cookies.isConsentGiven &&\n            this.props.context.request.cookies.isConsentGiven();\n\n        if (!(config && config.target && config.target.destinationUrl)) {\n            return null;\n        }\n\n        let srcURL;\n        try {\n            srcURL = new URL(config.target.destinationUrl);\n        } catch (error) {\n            this.props.telemetry.exception(error);\n            return null;\n        }\n\n        if (srcURL && srcURL.protocol && srcURL.protocol.toLocaleLowerCase() !== 'https:') {\n            return null;\n        }\n        const iframeClassName = classnames('ms-iframe', config.className);\n\n        let viewProps: IIframeViewProps = {\n            ...(this.props as IIframeProps<IIframeConfig>),\n            Heading: this._createHeading(config.heading!),\n            IframeContainer: {\n                moduleProps: this.props,\n                className: iframeClassName\n            },\n            IFrame: this._createIframe()\n        };\n\n        if (isConsentGiven === false) {\n            viewProps = {\n                ...viewProps,\n                alert: this._renderAlert(resources.cookieConsentRequiredMessage)\n            };\n        } else {\n            viewProps = {\n                ...viewProps,\n                cookieConsentAccepted : true\n            };\n        }\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n\n    private _createHeading(heading: IHeadingData): React.ReactNode | null {\n        if (!heading || !heading.text || !heading.text.length) {\n            return null;\n        }\n\n        return (\n            <Heading {...heading} className='ms-iframe__heading' />\n        );\n    }\n\n    private _renderAlert(message: string): React.ReactNode | null {\n        return (\n            <p className='ms-iframe__error-message' role='alert' aria-live='assertive'>\n                {message}\n            </p>);\n    }\n\n    private _createIframe(): React.ReactNode | null {\n        const { config } = this.props;\n        const targetURL = config.target.destinationUrl;\n\n        return (\n            // tslint:disable-next-line: react-iframe-missing-sandbox\n            <iframe\n                className={classnames('ms-iframe__content')}\n                src={targetURL}\n                height={config.height}\n                aria-label={config.iframeAriaLabel}\n                ref={this.iframeRef}\n            />\n        );\n    }\n\n}\n\nexport default Iframe;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}