{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";/*!\r\n * Copyright (c) Microsoft Corporation.\r\n * All rights reserved. See LICENSE in the project root for license information.\r\n */import*as React from'react';/**\r\n * App level const available to module/action developer\r\n */export var MSDyn365Commerce=/*#__PURE__*/function(){function MSDyn365Commerce(){var _this=this;_classCallCheck(this,MSDyn365Commerce);this._cartCookie='_msdyn365___cart_';this._checkoutCartCookie='_msdyn365___checkout_cart_';this._checkoutCartKeyPrefix='checkout';this._buildVersion='00-0000';this._env='development';this._commerceApiSetting={};this._themeRegistration={themes:{},styles:{}};this._imageSettings={imageSettings:{},gridSettings:{}};this._themeSettings={};this._themeModules=[];this._initialLoadCompleted=false;this._appSettings={app:{config:{},routes:{}},msdyn365:{config:{},routes:{},contentSecurityPolicy:{}}};this.setInitialLoadCompleted=function(initialLoadCompleted){_this._initialLoadCompleted=initialLoadCompleted;};this.setThemeRegistration=function(themeRegistration){_this._themeRegistration=themeRegistration;};/**\r\n         * Sets list of theme module objects\r\n         */this.setThemeModules=function(themeModules){_this._themeModules=themeModules;};/**\r\n         * Sets list of theme module objects\r\n         */this.createComponent=function(name,componentObj){return function(props){if(!(componentObj&&componentObj.component)){throw new Error(\"Component \".concat(name,\" missing\"));}var Element=componentObj.component;// @ts-ignore\nreturn/*#__PURE__*/React.createElement(Element,props);};};/**\r\n         * Creates a component override\r\n         */this.createComponentOverride=function(name,componentObj){return function(props){if(!(componentObj&&componentObj.component)){throw new Error(\"Component \".concat(name,\" missing\"));}var Element=componentObj.component;// @ts-ignore\nreturn/*#__PURE__*/React.createElement(Element,props);};};}/**\r\n     * Check if its in postInitialLoading status\r\n     */_createClass(MSDyn365Commerce,[{key:\"initialLoadCompleted\",get:function get(){return this._initialLoadCompleted;}// DO NOT DELETE - keeping this method for backwards\n// compatibility reasons. After modules code tranisitions to using cartCookieName\n// we will delete this getter\n},{key:\"CartCookie\",get:function get(){return this._cartCookie;}},{key:\"cartCookieName\",get:function get(){return this._cartCookie;}/**\r\n     * Get checkout cart cookie\r\n     */},{key:\"checkoutCartCookie\",get:function get(){return this._checkoutCartCookie;}/**\r\n     * Get checkout cart cookie\r\n     */},{key:\"checkoutCartKeyPrefix\",get:function get(){return this._checkoutCartKeyPrefix;}},{key:\"themes\",get:function get(){return this._themeRegistration;}/**\r\n     * Gets theme modules with full layouts and segment objects\r\n     */},{key:\"themeModules\",get:function get(){return this._themeModules;}/**\r\n     * Gets the current build version\r\n     */},{key:\"buildVersion\",get:function get(){return this._buildVersion;}/**\r\n     * Gets the current runtime environment\r\n     */},{key:\"env\",get:function get(){return this._env;}/**\r\n     * Gets the commerce related API settings\r\n     */},{key:\"apiSettings\",get:function get(){return this._commerceApiSetting;}/**\r\n     * Gets the commerce related image settings\r\n     */},{key:\"imageSettings\",get:function get(){return this._imageSettings;}/**\r\n     * Gets the commerce related theme settings\r\n     */},{key:\"themeSettings\",get:function get(){return this._themeSettings;}/**\r\n     * Gets the commerce related APP settings\r\n     */},{key:\"appSettings\",get:function get(){return this._appSettings;}/**\r\n     * Gets the experimentation connector object that contains the registered provider, listener and connector name\r\n     * Returns undefined if an experimentation connector has not been registered\r\n     */},{key:\"experimentationConnector\",get:function get(){return this._experimentationConnector;}/**\r\n     * Gets the experimentation app cache\r\n     */},{key:\"experimentationCache\",get:function get(){return this._experimentationCache;}/**\r\n     * Gets secret manager object\r\n     */},{key:\"secretManager\",get:function get(){return this._secretManager;}/**\r\n     * Gets local credential details\r\n     */},{key:\"localCredentials\",get:function get(){return this._localCredentials;}/**\r\n     * Gets the platformSettings\r\n     */},{key:\"platformSettings\",get:function get(){return this._platformSettings;}/**\r\n     * Returns a boolean value indicating whether or not the current operating environment is browser or server\r\n     */},{key:\"isBrowser\",get:function get(){// tslint:disable-next-line:no-typeof-undefined\nreturn typeof window!=='undefined';}/**\r\n     * Gets the resource manager instance\r\n     */},{key:\"resourceManager\",get:function get(){if(!this.isBrowser){return this._resourceManager;}return undefined;}}]);return MSDyn365Commerce;}();var msdyn365Commerce=new MSDyn365Commerce();export default msdyn365Commerce;","map":{"version":3,"sources":["../../src/msdyn365-commerce.ts"],"names":[],"mappings":"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","sourcesContent":["/*!\n * Copyright (c) Microsoft Corporation.\n * All rights reserved. See LICENSE in the project root for license information.\n */\n\nimport { ICache } from '@msdyn365-commerce/retail-proxy';\nimport * as React from 'react';\nimport { ICommerceApiSettings, IExperimentationConnector } from './contract';\nimport {\n    ComponentType,\n    IComponent,\n    IComponentProps,\n    IDictionary,\n    ILocalCredentials,\n    IMergedAppSettings,\n    IMSDyn365Window,\n    IPartnerImageSettings,\n    IPartnerThemeSettings,\n    IPlatformSettings,\n    IResourceManager,\n    ISecretManager,\n    IThemeModule,\n    IThemeRegistration\n} from './interfaces';\n\ndeclare var window: IMSDyn365Window;\n\n/**\n * App level const available to module/action developer\n */\nexport class MSDyn365Commerce {\n    private _cartCookie: string = '_msdyn365___cart_';\n    private _checkoutCartCookie: string = '_msdyn365___checkout_cart_';\n    private _checkoutCartKeyPrefix: string = 'checkout';\n    private _buildVersion: string = '00-0000';\n    private _env: string = 'development';\n    private _commerceApiSetting: ICommerceApiSettings = <ICommerceApiSettings>{};\n    private _themeRegistration: IThemeRegistration = { themes: {}, styles: {} };\n    private _resourceManager: IResourceManager | undefined;\n    private _imageSettings: IPartnerImageSettings = { imageSettings: {}, gridSettings: {} };\n    private _themeSettings: IDictionary<IPartnerThemeSettings> = {};\n    private _themeModules: IThemeModule[] = [];\n    private _experimentationCache: ICache | undefined;\n    private _secretManager: ISecretManager | undefined;\n    private _experimentationConnector: IExperimentationConnector | undefined;\n    private _platformSettings: IPlatformSettings | undefined;\n    private _initialLoadCompleted: boolean = false;\n    private _localCredentials: ILocalCredentials | undefined;\n    private _appSettings: IMergedAppSettings = {\n        app: { config: {}, routes: {} },\n        msdyn365: { config: {}, routes: {}, contentSecurityPolicy: {} }\n    };\n\n    public setInitialLoadCompleted = (initialLoadCompleted: boolean) => {\n        this._initialLoadCompleted = initialLoadCompleted;\n    };\n    public setThemeRegistration = (themeRegistration: IThemeRegistration) => {\n        this._themeRegistration = themeRegistration;\n    };\n\n    /**\n     * Sets list of theme module objects\n     */\n    public setThemeModules = (themeModules: IThemeModule[]) => {\n        this._themeModules = themeModules;\n    };\n\n    /**\n     * Sets list of theme module objects\n     */\n    public createComponent = <T extends IComponent<IComponentProps>>(name: ComponentType, componentObj: T): React.FC<IComponentProps> => (\n        props: IComponentProps\n    ) => {\n        if (!(componentObj && componentObj.component)) {\n            throw new Error(`Component ${name} missing`);\n        }\n\n        const Element = componentObj.component;\n        // @ts-ignore\n        return React.createElement(Element, props);\n    };\n\n    /**\n     * Creates a component override\n     */\n    public createComponentOverride = <T extends IComponent<IComponentProps>>(\n        name: ComponentType,\n        componentObj: T\n    ): React.FC<IComponentProps> => (props: IComponentProps) => {\n        if (!(componentObj && componentObj.component)) {\n            throw new Error(`Component ${name} missing`);\n        }\n\n        const Element = componentObj.component;\n        // @ts-ignore\n        return React.createElement(Element, props);\n    };\n\n    /**\n     * Check if its in postInitialLoading status\n     */\n\n    get initialLoadCompleted(): boolean {\n        return this._initialLoadCompleted;\n    }\n\n    // DO NOT DELETE - keeping this method for backwards\n    // compatibility reasons. After modules code tranisitions to using cartCookieName\n    // we will delete this getter\n    get CartCookie(): string {\n        return this._cartCookie;\n    }\n\n    get cartCookieName(): string {\n        return this._cartCookie;\n    }\n\n    /**\n     * Get checkout cart cookie\n     */\n    get checkoutCartCookie(): string {\n        return this._checkoutCartCookie;\n    }\n\n    /**\n     * Get checkout cart cookie\n     */\n    get checkoutCartKeyPrefix(): string {\n        return this._checkoutCartKeyPrefix;\n    }\n\n    get themes(): IThemeRegistration {\n        return this._themeRegistration;\n    }\n\n    /**\n     * Gets theme modules with full layouts and segment objects\n     */\n    get themeModules(): IThemeModule[] {\n        return this._themeModules;\n    }\n    /**\n     * Gets the current build version\n     */\n    get buildVersion(): string {\n        return this._buildVersion;\n    }\n\n    /**\n     * Gets the current runtime environment\n     */\n    get env(): string {\n        return this._env;\n    }\n\n    /**\n     * Gets the commerce related API settings\n     */\n    get apiSettings(): ICommerceApiSettings {\n        return this._commerceApiSetting;\n    }\n\n    /**\n     * Gets the commerce related image settings\n     */\n    get imageSettings(): IPartnerImageSettings {\n        return this._imageSettings;\n    }\n\n    /**\n     * Gets the commerce related theme settings\n     */\n    get themeSettings(): IDictionary<IPartnerThemeSettings> {\n        return this._themeSettings;\n    }\n\n    /**\n     * Gets the commerce related APP settings\n     */\n    get appSettings(): IMergedAppSettings {\n        return this._appSettings;\n    }\n\n    /**\n     * Gets the experimentation connector object that contains the registered provider, listener and connector name\n     * Returns undefined if an experimentation connector has not been registered\n     */\n    get experimentationConnector(): IExperimentationConnector | undefined {\n        return this._experimentationConnector;\n    }\n\n    /**\n     * Gets the experimentation app cache\n     */\n    get experimentationCache(): ICache | undefined {\n        return this._experimentationCache;\n    }\n\n    /**\n     * Gets secret manager object\n     */\n    get secretManager(): ISecretManager | undefined {\n        return this._secretManager;\n    }\n\n    /**\n     * Gets local credential details\n     */\n    get localCredentials(): ILocalCredentials | undefined {\n        return this._localCredentials;\n    }\n\n    /**\n     * Gets the platformSettings\n     */\n\n    get platformSettings(): IPlatformSettings | undefined {\n        return this._platformSettings;\n    }\n\n    /**\n     * Returns a boolean value indicating whether or not the current operating environment is browser or server\n     */\n    get isBrowser(): boolean {\n        // tslint:disable-next-line:no-typeof-undefined\n        return typeof window !== 'undefined';\n    }\n\n    /**\n     * Gets the resource manager instance\n     */\n    get resourceManager(): IResourceManager | undefined {\n        if (!this.isBrowser) {\n            return this._resourceManager;\n        }\n\n        return undefined;\n    }\n}\n\nconst msdyn365Commerce = new MSDyn365Commerce();\nexport default msdyn365Commerce;\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}