{"ast":null,"code":"/*!\r\n * Copyright (c) Microsoft Corporation.\r\n * All rights reserved. See LICENSE in the project root for license information.\r\n */import*as React from'react';/**\r\n * App level const available to module/action developer\r\n */export class MSDyn365Commerce{constructor(){this._cartCookie='_msdyn365___cart_';this._checkoutCartCookie='_msdyn365___checkout_cart_';this._checkoutCartKeyPrefix='checkout';this._buildVersion='00-0000';this._env='development';this._commerceApiSetting={};this._themeRegistration={themes:{},styles:{}};this._imageSettings={imageSettings:{},gridSettings:{}};this._themeSettings={};this._themeModules=[];this._initialLoadCompleted=false;this._appSettings={app:{config:{},routes:{}},msdyn365:{config:{},routes:{},contentSecurityPolicy:{}}};this.setInitialLoadCompleted=initialLoadCompleted=>{this._initialLoadCompleted=initialLoadCompleted;};this.setThemeRegistration=themeRegistration=>{this._themeRegistration=themeRegistration;};/**\r\n         * Sets list of theme module objects\r\n         */this.setThemeModules=themeModules=>{this._themeModules=themeModules;};/**\r\n         * Sets list of theme module objects\r\n         */this.createComponent=(name,componentObj)=>props=>{if(!(componentObj&&componentObj.component)){throw new Error(\"Component \".concat(name,\" missing\"));}const Element=componentObj.component;// @ts-ignore\nreturn/*#__PURE__*/React.createElement(Element,props);};/**\r\n         * Creates a component override\r\n         */this.createComponentOverride=(name,componentObj)=>props=>{if(!(componentObj&&componentObj.component)){throw new Error(\"Component \".concat(name,\" missing\"));}const Element=componentObj.component;// @ts-ignore\nreturn/*#__PURE__*/React.createElement(Element,props);};}/**\r\n     * Check if its in postInitialLoading status\r\n     */get initialLoadCompleted(){return this._initialLoadCompleted;}// DO NOT DELETE - keeping this method for backwards\n// compatibility reasons. After modules code tranisitions to using cartCookieName\n// we will delete this getter\nget CartCookie(){return this._cartCookie;}get cartCookieName(){return this._cartCookie;}/**\r\n     * Get checkout cart cookie\r\n     */get checkoutCartCookie(){return this._checkoutCartCookie;}/**\r\n     * Get checkout cart cookie\r\n     */get checkoutCartKeyPrefix(){return this._checkoutCartKeyPrefix;}get themes(){return this._themeRegistration;}/**\r\n     * Gets theme modules with full layouts and segment objects\r\n     */get themeModules(){return this._themeModules;}/**\r\n     * Gets the current build version\r\n     */get buildVersion(){return this._buildVersion;}/**\r\n     * Gets the current runtime environment\r\n     */get env(){return this._env;}/**\r\n     * Gets the commerce related API settings\r\n     */get apiSettings(){return this._commerceApiSetting;}/**\r\n     * Gets the commerce related image settings\r\n     */get imageSettings(){return this._imageSettings;}/**\r\n     * Gets the commerce related theme settings\r\n     */get themeSettings(){return this._themeSettings;}/**\r\n     * Gets the commerce related APP settings\r\n     */get appSettings(){return this._appSettings;}/**\r\n     * Gets the experimentation connector object that contains the registered provider, listener and connector name\r\n     * Returns undefined if an experimentation connector has not been registered\r\n     */get experimentationConnector(){return this._experimentationConnector;}/**\r\n     * Gets the experimentation app cache\r\n     */get experimentationCache(){return this._experimentationCache;}/**\r\n     * Gets secret manager object\r\n     */get secretManager(){return this._secretManager;}/**\r\n     * Gets local credential details\r\n     */get localCredentials(){return this._localCredentials;}/**\r\n     * Gets the platformSettings\r\n     */get platformSettings(){return this._platformSettings;}/**\r\n     * Returns a boolean value indicating whether or not the current operating environment is browser or server\r\n     */get isBrowser(){// tslint:disable-next-line:no-typeof-undefined\nreturn typeof window!=='undefined';}/**\r\n     * Gets the resource manager instance\r\n     */get resourceManager(){if(!this.isBrowser){return this._resourceManager;}return undefined;}}const msdyn365Commerce=new MSDyn365Commerce();export default msdyn365Commerce;","map":{"version":3,"sources":["../../src/msdyn365-commerce.ts"],"names":[],"mappings":"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","sourcesContent":["/*!\n * Copyright (c) Microsoft Corporation.\n * All rights reserved. See LICENSE in the project root for license information.\n */\n\nimport { ICache } from '@msdyn365-commerce/retail-proxy';\nimport * as React from 'react';\nimport { ICommerceApiSettings, IExperimentationConnector } from './contract';\nimport {\n    ComponentType,\n    IComponent,\n    IComponentProps,\n    IDictionary,\n    ILocalCredentials,\n    IMergedAppSettings,\n    IMSDyn365Window,\n    IPartnerImageSettings,\n    IPartnerThemeSettings,\n    IPlatformSettings,\n    IResourceManager,\n    ISecretManager,\n    IThemeModule,\n    IThemeRegistration\n} from './interfaces';\n\ndeclare var window: IMSDyn365Window;\n\n/**\n * App level const available to module/action developer\n */\nexport class MSDyn365Commerce {\n    private _cartCookie: string = '_msdyn365___cart_';\n    private _checkoutCartCookie: string = '_msdyn365___checkout_cart_';\n    private _checkoutCartKeyPrefix: string = 'checkout';\n    private _buildVersion: string = '00-0000';\n    private _env: string = 'development';\n    private _commerceApiSetting: ICommerceApiSettings = <ICommerceApiSettings>{};\n    private _themeRegistration: IThemeRegistration = { themes: {}, styles: {} };\n    private _resourceManager: IResourceManager | undefined;\n    private _imageSettings: IPartnerImageSettings = { imageSettings: {}, gridSettings: {} };\n    private _themeSettings: IDictionary<IPartnerThemeSettings> = {};\n    private _themeModules: IThemeModule[] = [];\n    private _experimentationCache: ICache | undefined;\n    private _secretManager: ISecretManager | undefined;\n    private _experimentationConnector: IExperimentationConnector | undefined;\n    private _platformSettings: IPlatformSettings | undefined;\n    private _initialLoadCompleted: boolean = false;\n    private _localCredentials: ILocalCredentials | undefined;\n    private _appSettings: IMergedAppSettings = {\n        app: { config: {}, routes: {} },\n        msdyn365: { config: {}, routes: {}, contentSecurityPolicy: {} }\n    };\n\n    public setInitialLoadCompleted = (initialLoadCompleted: boolean) => {\n        this._initialLoadCompleted = initialLoadCompleted;\n    };\n    public setThemeRegistration = (themeRegistration: IThemeRegistration) => {\n        this._themeRegistration = themeRegistration;\n    };\n\n    /**\n     * Sets list of theme module objects\n     */\n    public setThemeModules = (themeModules: IThemeModule[]) => {\n        this._themeModules = themeModules;\n    };\n\n    /**\n     * Sets list of theme module objects\n     */\n    public createComponent = <T extends IComponent<IComponentProps>>(name: ComponentType, componentObj: T): React.FC<IComponentProps> => (\n        props: IComponentProps\n    ) => {\n        if (!(componentObj && componentObj.component)) {\n            throw new Error(`Component ${name} missing`);\n        }\n\n        const Element = componentObj.component;\n        // @ts-ignore\n        return React.createElement(Element, props);\n    };\n\n    /**\n     * Creates a component override\n     */\n    public createComponentOverride = <T extends IComponent<IComponentProps>>(\n        name: ComponentType,\n        componentObj: T\n    ): React.FC<IComponentProps> => (props: IComponentProps) => {\n        if (!(componentObj && componentObj.component)) {\n            throw new Error(`Component ${name} missing`);\n        }\n\n        const Element = componentObj.component;\n        // @ts-ignore\n        return React.createElement(Element, props);\n    };\n\n    /**\n     * Check if its in postInitialLoading status\n     */\n\n    get initialLoadCompleted(): boolean {\n        return this._initialLoadCompleted;\n    }\n\n    // DO NOT DELETE - keeping this method for backwards\n    // compatibility reasons. After modules code tranisitions to using cartCookieName\n    // we will delete this getter\n    get CartCookie(): string {\n        return this._cartCookie;\n    }\n\n    get cartCookieName(): string {\n        return this._cartCookie;\n    }\n\n    /**\n     * Get checkout cart cookie\n     */\n    get checkoutCartCookie(): string {\n        return this._checkoutCartCookie;\n    }\n\n    /**\n     * Get checkout cart cookie\n     */\n    get checkoutCartKeyPrefix(): string {\n        return this._checkoutCartKeyPrefix;\n    }\n\n    get themes(): IThemeRegistration {\n        return this._themeRegistration;\n    }\n\n    /**\n     * Gets theme modules with full layouts and segment objects\n     */\n    get themeModules(): IThemeModule[] {\n        return this._themeModules;\n    }\n    /**\n     * Gets the current build version\n     */\n    get buildVersion(): string {\n        return this._buildVersion;\n    }\n\n    /**\n     * Gets the current runtime environment\n     */\n    get env(): string {\n        return this._env;\n    }\n\n    /**\n     * Gets the commerce related API settings\n     */\n    get apiSettings(): ICommerceApiSettings {\n        return this._commerceApiSetting;\n    }\n\n    /**\n     * Gets the commerce related image settings\n     */\n    get imageSettings(): IPartnerImageSettings {\n        return this._imageSettings;\n    }\n\n    /**\n     * Gets the commerce related theme settings\n     */\n    get themeSettings(): IDictionary<IPartnerThemeSettings> {\n        return this._themeSettings;\n    }\n\n    /**\n     * Gets the commerce related APP settings\n     */\n    get appSettings(): IMergedAppSettings {\n        return this._appSettings;\n    }\n\n    /**\n     * Gets the experimentation connector object that contains the registered provider, listener and connector name\n     * Returns undefined if an experimentation connector has not been registered\n     */\n    get experimentationConnector(): IExperimentationConnector | undefined {\n        return this._experimentationConnector;\n    }\n\n    /**\n     * Gets the experimentation app cache\n     */\n    get experimentationCache(): ICache | undefined {\n        return this._experimentationCache;\n    }\n\n    /**\n     * Gets secret manager object\n     */\n    get secretManager(): ISecretManager | undefined {\n        return this._secretManager;\n    }\n\n    /**\n     * Gets local credential details\n     */\n    get localCredentials(): ILocalCredentials | undefined {\n        return this._localCredentials;\n    }\n\n    /**\n     * Gets the platformSettings\n     */\n\n    get platformSettings(): IPlatformSettings | undefined {\n        return this._platformSettings;\n    }\n\n    /**\n     * Returns a boolean value indicating whether or not the current operating environment is browser or server\n     */\n    get isBrowser(): boolean {\n        // tslint:disable-next-line:no-typeof-undefined\n        return typeof window !== 'undefined';\n    }\n\n    /**\n     * Gets the resource manager instance\n     */\n    get resourceManager(): IResourceManager | undefined {\n        if (!this.isBrowser) {\n            return this._resourceManager;\n        }\n\n        return undefined;\n    }\n}\n\nconst msdyn365Commerce = new MSDyn365Commerce();\nexport default msdyn365Commerce;\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}