{"ast":null,"code":"import\"core-js/modules/es.object.assign.js\";import\"core-js/modules/web.dom-collections.iterator.js\";import\"core-js/modules/web.url.js\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import{Heading}from'@msdyn365-commerce-modules/utilities';import classnames from'classnames';import*as React from'react';class Iframe extends React.PureComponent{constructor(props){super(props);this.iframeRef=/*#__PURE__*/React.createRef();}render(){const{config,resources}=this.props;const isConsentGiven=this.props.context.request&&this.props.context.request.cookies&&this.props.context.request.cookies.isConsentGiven&&this.props.context.request.cookies.isConsentGiven();if(!(config&&config.target&&config.target.destinationUrl)){return null;}let srcURL;try{srcURL=new URL(config.target.destinationUrl);}catch(error){this.props.telemetry.exception(error);return null;}if(srcURL&&srcURL.protocol&&srcURL.protocol.toLocaleLowerCase()!=='https:'){return null;}const iframeClassName=classnames('ms-iframe',config.className);let viewProps=_objectSpread(_objectSpread({},this.props),{},{Heading:this._createHeading(config.heading),IframeContainer:{moduleProps:this.props,className:iframeClassName},IFrame:this._createIframe()});if(isConsentGiven===false){viewProps=_objectSpread(_objectSpread({},viewProps),{},{alert:this._renderAlert(resources.cookieConsentRequiredMessage)});}else{viewProps=_objectSpread(_objectSpread({},viewProps),{},{cookieConsentAccepted:true});}return this.props.renderView(viewProps);}_createHeading(heading){if(!heading||!heading.text||!heading.text.length){return null;}return/*#__PURE__*/React.createElement(Heading,Object.assign({},heading,{className:'ms-iframe__heading'}));}_renderAlert(message){return/*#__PURE__*/React.createElement(\"p\",{className:'ms-iframe__error-message',role:'alert',\"aria-live\":'assertive'},message);}_createIframe(){const{config}=this.props;const targetURL=config.target.destinationUrl;return/*#__PURE__*/React.createElement(\"iframe\",{className:classnames('ms-iframe__content'),src:targetURL,height:config.height,\"aria-label\":config.iframeAriaLabel,ref:this.iframeRef});}}export default Iframe;","map":{"version":3,"sources":["modules/iframe/iframe.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Heading, IModuleProps } from '@msdyn365-commerce-modules/utilities';\nimport classnames from 'classnames';\nimport * as React from 'react';\nimport { IHeadingData, IIframeConfig, IIframeProps } from './iframe.props.autogenerated';\n\nexport interface IIframeViewProps extends IIframeProps<IIframeConfig> {\n    Heading: React.ReactNode;\n    IframeContainer: IModuleProps;\n    IFrame: React.ReactNode;\n    alert?: React.ReactNode;\n    cookieConsentAccepted?: boolean;\n}\n\n/**\n *\n * Iframe component\n * @extends {React.PureComponent<IIframeProps>}\n */\nclass Iframe extends React.PureComponent<IIframeProps<IIframeConfig>> {\n    private iframeRef: React.RefObject<HTMLIFrameElement>;\n    constructor(props: IIframeProps<IIframeConfig>) {\n        super(props);\n        this.iframeRef = React.createRef();\n    }\n    public render(): JSX.Element | null {\n        const { config, resources } = this.props;\n        const isConsentGiven =\n            this.props.context.request &&\n            this.props.context.request.cookies &&\n            this.props.context.request.cookies.isConsentGiven &&\n            this.props.context.request.cookies.isConsentGiven();\n\n        if (!(config && config.target && config.target.destinationUrl)) {\n            return null;\n        }\n\n        let srcURL;\n        try {\n            srcURL = new URL(config.target.destinationUrl);\n        } catch (error) {\n            this.props.telemetry.exception(error);\n            return null;\n        }\n\n        if (srcURL && srcURL.protocol && srcURL.protocol.toLocaleLowerCase() !== 'https:') {\n            return null;\n        }\n        const iframeClassName = classnames('ms-iframe', config.className);\n\n        let viewProps: IIframeViewProps = {\n            ...(this.props as IIframeProps<IIframeConfig>),\n            Heading: this._createHeading(config.heading!),\n            IframeContainer: {\n                moduleProps: this.props,\n                className: iframeClassName\n            },\n            IFrame: this._createIframe()\n        };\n\n        if (isConsentGiven === false) {\n            viewProps = {\n                ...viewProps,\n                alert: this._renderAlert(resources.cookieConsentRequiredMessage)\n            };\n        } else {\n            viewProps = {\n                ...viewProps,\n                cookieConsentAccepted : true\n            };\n        }\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n\n    private _createHeading(heading: IHeadingData): React.ReactNode | null {\n        if (!heading || !heading.text || !heading.text.length) {\n            return null;\n        }\n\n        return (\n            <Heading {...heading} className='ms-iframe__heading' />\n        );\n    }\n\n    private _renderAlert(message: string): React.ReactNode | null {\n        return (\n            <p className='ms-iframe__error-message' role='alert' aria-live='assertive'>\n                {message}\n            </p>);\n    }\n\n    private _createIframe(): React.ReactNode | null {\n        const { config } = this.props;\n        const targetURL = config.target.destinationUrl;\n\n        return (\n            // tslint:disable-next-line: react-iframe-missing-sandbox\n            <iframe\n                className={classnames('ms-iframe__content')}\n                src={targetURL}\n                height={config.height}\n                aria-label={config.iframeAriaLabel}\n                ref={this.iframeRef}\n            />\n        );\n    }\n\n}\n\nexport default Iframe;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}