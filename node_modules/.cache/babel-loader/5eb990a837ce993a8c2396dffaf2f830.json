{"ast":null,"code":"import{getProductUrlSync}from'@msdyn365-commerce-modules/retail-actions';import{Button,getPayloadObject,getTelemetryAttributes,TelemetryConstant}from'@msdyn365-commerce-modules/utilities';import{CartLineItemComponent}from'@msdyn365-commerce/components';import*as Msdyn365 from'@msdyn365-commerce/core';import classnames from'classnames';import get from'lodash/get';import*as React from'react';export var getLineItems=function getLineItems(input,telemetryContent){var pickupDeliveryModeCode=get(input,'context.request.channel.PickupDeliveryModeCode');var _getDeliveryLocation=function _getDeliveryLocation(cartLine){var orgUnitLocations=get(input,'data.orgUnitLocations.result');if(!cartLine.FulfillmentStoreId||!orgUnitLocations){return'';}var locationMatch=(orgUnitLocations||[]).find(function(location){return location.OrgUnitNumber===cartLine.FulfillmentStoreId;});return locationMatch&&locationMatch.OrgUnitName;};var _getProduct=function _getProduct(productId){var products=get(input,'data.products.result')||[];return products.find(function(_product){return productId===_product.RecordId;});};var _getLineItemComponent=function _getLineItemComponent(cartLine){var product=cartLine.ProductId&&_getProduct(cartLine.ProductId);var id=input.id,typeName=input.typeName,context=input.context,_input$config=input.config,imageSettings=_input$config.imageSettings,showShippingChargesForLineItems=_input$config.showShippingChargesForLineItems,_input$resources=input.resources,quantityDisplayString=_input$resources.quantityDisplayString,productDimensionTypeColor=_input$resources.productDimensionTypeColor,productDimensionTypeSize=_input$resources.productDimensionTypeSize,productDimensionTypeStyle=_input$resources.productDimensionTypeStyle,configString=_input$resources.configString,inputQuantityAriaLabel=_input$resources.inputQuantityAriaLabel,discountStringText=_input$resources.discountStringText,shippingCharges=_input$resources.shippingCharges,gridSettings=input.context.request.gridSettings;if(!product){return;}return/*#__PURE__*/React.createElement(CartLineItemComponent,{id:id,typeName:typeName,context:context,resources:{sizeString:productDimensionTypeSize,colorString:productDimensionTypeColor,styleString:productDimensionTypeStyle,quantityDisplayString:quantityDisplayString,configString:configString,inputQuantityAriaLabel:inputQuantityAriaLabel,discountStringText:discountStringText,originalPriceText:'',currentPriceText:'',shippingChargesText:shippingCharges},isQuantityEditable:false,imageSettings:imageSettings,gridSettings:gridSettings,productUrl:getProductUrlSync(product,context.actionContext,undefined),primaryImageUrl:product.PrimaryImageUrl,data:{cartLine:cartLine,product:product},showShippingChargesForLineItems:showShippingChargesForLineItems,telemetryContent:telemetryContent});};var _getPickUpAtStoreComponents=function _getPickUpAtStoreComponents(pickupDeliveryLocation){var pickUpAtStoreWithLocationText=input.resources.pickUpAtStoreWithLocationText;return{PickUpAtStore:{className:'ms-checkout__pick-up-at-store'},label:/*#__PURE__*/React.createElement(\"span\",{className:'ms-checkout__store-label'},pickUpAtStoreWithLocationText),location:/*#__PURE__*/React.createElement(\"div\",{className:'ms-checkout__store-location'},pickupDeliveryLocation)};};var _getLineItemsComponents=function _getLineItemsComponents(items){return items.map(function(cartLine){var pickupDeliveryLocation=_getDeliveryLocation(cartLine);var isPickUp=cartLine.DeliveryMode&&cartLine.DeliveryMode!==''?cartLine.DeliveryMode===pickupDeliveryModeCode:false;return{LineId:cartLine.LineId||'',LineItem:{className:'ms-checkout__line-item'},item:_getLineItemComponent(cartLine),pickUpAtStore:isPickUp?_getPickUpAtStoreComponents(pickupDeliveryLocation):undefined};});};var _getGroupTitleComponent=function _getGroupTitleComponent(count,type){var _input$resources2=input.resources,itemLabel=_input$resources2.itemLabel,itemsLabel=_input$resources2.itemsLabel,inStorePickUpLabel=_input$resources2.inStorePickUpLabel,shippingCountCheckoutLineItem=_input$resources2.shippingCountCheckoutLineItem;var suffix=count>1?itemsLabel:itemLabel;var title=type==='ship'?shippingCountCheckoutLineItem:inStorePickUpLabel;return title.replace('{count}',count.toString()).replace('{suffix}',suffix);};var _countItems=function _countItems(items){return items.reduce(function(count,item){return count+(item.Quantity||0);},0);};var _filterItemsByDiliveryType=function _filterItemsByDiliveryType(type){var cart=get(input,'data.checkout.result.checkoutCart.cart');return type==='ship'?cart.CartLines.filter(function(cartLine){return cartLine.DeliveryMode&&cartLine.DeliveryMode!==''?cartLine.DeliveryMode!==pickupDeliveryModeCode:cartLine;}):cart.CartLines.filter(function(cartLine){return cartLine.DeliveryMode===pickupDeliveryModeCode;});};var _getLineItemsByDeliveryType=function _getLineItemsByDeliveryType(type){if((pickupDeliveryModeCode===''||pickupDeliveryModeCode===undefined)&&type==='pickup'){return;}var items=_filterItemsByDiliveryType(type);if(items.length===0){return undefined;}var count=_countItems(items);var title=_getGroupTitleComponent(count,type);return{LineItemDeliveryGroup:{className:classnames('ms-checkout__line-items-delivery-group',type)},LineItemList:{className:'ms-checkout__line-items-list'},heading:/*#__PURE__*/React.createElement(\"div\",{className:'ms-checkout__line-items-group-title'},title),lineItems:_getLineItemsComponents(items)};};var _getLineItems=function _getLineItems(){var context=input.context,lineItemsHeading=input.config.lineItemsHeading,products=input.data.products,editCartText=input.resources.editCartText;var payLoad=getPayloadObject('click',telemetryContent,TelemetryConstant.EditCart);var attribute=getTelemetryAttributes(telemetryContent,payLoad);var cart=get(input,'data.checkout.result.checkoutCart.cart');if(!cart||!cart.CartLines||!cart.CartLines.length||!products){return undefined;}return{LineItems:{className:'ms-checkout__line-items'},Header:{className:'ms-checkout__line-items-header'},heading:lineItemsHeading&&lineItemsHeading.text&&/*#__PURE__*/React.createElement(Msdyn365.Text,Object.assign({className:'ms-checkout__line-items-heading'},lineItemsHeading,{tag:lineItemsHeading.tag||'h2',text:lineItemsHeading.text,editProps:{onEdit:handleLineItemHeadingChange,requestContext:context.request}})),editLink:/*#__PURE__*/React.createElement(Button,Object.assign({className:'ms-checkout__line-items-edit-cart-link',title:editCartText,color:'link',href:Msdyn365.getUrlSync('cart',context.actionContext)||''},attribute),editCartText),itemsForPickup:_getLineItemsByDeliveryType('pickup'),itemsForShip:_getLineItemsByDeliveryType('ship')};};var handleLineItemHeadingChange=function handleLineItemHeadingChange(event){var lineItemsHeading=input.config.lineItemsHeading;lineItemsHeading.text=event.target.value;};return _getLineItems();};","map":{"version":3,"sources":["modules/checkout/components/get-line-items.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { getProductUrlSync } from '@msdyn365-commerce-modules/retail-actions';\nimport { Button, getPayloadObject, getTelemetryAttributes, INodeProps, ITelemetryContent, TelemetryConstant } from '@msdyn365-commerce-modules/utilities';\nimport { CartLineItemComponent } from '@msdyn365-commerce/components';\nimport * as Msdyn365 from '@msdyn365-commerce/core';\nimport { CartLine, OrgUnitLocation, SimpleProduct } from '@msdyn365-commerce/retail-proxy/dist/Entities/CommerceTypes.g';\nimport classnames from 'classnames';\nimport get from 'lodash/get';\nimport * as React from 'react';\nimport { ICheckoutData } from '../checkout.data';\nimport { ICheckoutProps } from '../checkout.props.autogenerated';\n\ntype deliveryType = 'pickup' | 'ship';\n\nexport interface IPickUpAtStore {\n    PickUpAtStore: INodeProps;\n    label: React.ReactNode;\n    location: React.ReactNode;\n}\n\nexport interface ILineItem {\n    LineId: string;\n    LineItem: INodeProps;\n    item?: React.ReactNode;\n    pickUpAtStore?: IPickUpAtStore;\n}\n\nexport interface ILineItemDeliveryGroup {\n    LineItemDeliveryGroup: INodeProps;\n    LineItemList: INodeProps;\n    heading: React.ReactNode;\n    lineItems: ILineItem[];\n}\n\nexport interface ILineItems {\n    LineItems: INodeProps;\n    Header: INodeProps;\n    heading: React.ReactNode;\n    editLink: React.ReactNode;\n    itemsForPickup?: ILineItemDeliveryGroup;\n    itemsForShip?: ILineItemDeliveryGroup;\n}\n\n// tslint:disable-next-line:max-func-body-length\nexport const getLineItems = (input: ICheckoutProps<ICheckoutData>, telemetryContent?: ITelemetryContent): ILineItems | undefined => {\n    const pickupDeliveryModeCode = get(input, 'context.request.channel.PickupDeliveryModeCode');\n    const _getDeliveryLocation = (cartLine: CartLine): string => {\n        const orgUnitLocations = get(input, 'data.orgUnitLocations.result');\n        if (!cartLine.FulfillmentStoreId || !orgUnitLocations) {\n            return '';\n        }\n\n        const locationMatch = (orgUnitLocations || []).find((location: OrgUnitLocation): boolean => {\n            return location.OrgUnitNumber === cartLine.FulfillmentStoreId;\n        });\n\n        return locationMatch && locationMatch.OrgUnitName;\n    };\n\n    const _getProduct = (productId: number): SimpleProduct | undefined => {\n        const products = get(input, 'data.products.result') || [];\n        return products.find((_product: SimpleProduct) => {\n            return productId === _product.RecordId;\n        });\n    };\n\n    const _getLineItemComponent = (cartLine: CartLine): JSX.Element | undefined => {\n        const product = cartLine.ProductId && _getProduct(cartLine.ProductId);\n        const {\n            id,\n            typeName,\n            context,\n            config: { imageSettings, showShippingChargesForLineItems },\n            resources: {\n                quantityDisplayString,\n                productDimensionTypeColor,\n                productDimensionTypeSize,\n                productDimensionTypeStyle,\n                configString,\n                inputQuantityAriaLabel,\n                discountStringText,\n                shippingCharges,\n            },\n            context: {\n                request: { gridSettings }\n            }\n        } = input;\n\n        if (!product) {\n            return;\n        }\n\n        return (\n            <CartLineItemComponent\n                id={id}\n                typeName={typeName}\n                context={context}\n                resources={{\n                    sizeString: productDimensionTypeSize,\n                    colorString: productDimensionTypeColor,\n                    styleString: productDimensionTypeStyle,\n                    quantityDisplayString,\n                    configString,\n                    inputQuantityAriaLabel,\n                    discountStringText,\n                    originalPriceText:'',\n                    currentPriceText:'',\n                    shippingChargesText: shippingCharges,\n                }}\n                isQuantityEditable={false}\n                imageSettings={imageSettings!}\n                gridSettings={gridSettings!}\n                productUrl={getProductUrlSync(product, context.actionContext, undefined)}\n                primaryImageUrl={product.PrimaryImageUrl}\n                data={{\n                    cartLine: cartLine,\n                    product: product\n                }}\n                showShippingChargesForLineItems = {showShippingChargesForLineItems}\n                telemetryContent = {telemetryContent}\n            />\n        );\n    };\n\n    const _getPickUpAtStoreComponents = (pickupDeliveryLocation: string): IPickUpAtStore => {\n        const {\n            resources: { pickUpAtStoreWithLocationText }\n        } = input;\n\n        return {\n            PickUpAtStore: { className: 'ms-checkout__pick-up-at-store' },\n            label: <span className='ms-checkout__store-label'>{pickUpAtStoreWithLocationText}</span>,\n            location: <div className='ms-checkout__store-location'>{pickupDeliveryLocation}</div>\n        };\n    };\n\n    const _getLineItemsComponents = (items: CartLine[]): ILineItem[] => {\n        return items.map(cartLine => {\n            const pickupDeliveryLocation = _getDeliveryLocation(cartLine);\n            const isPickUp = (cartLine.DeliveryMode && cartLine.DeliveryMode !== '') ? cartLine.DeliveryMode === pickupDeliveryModeCode : false;\n            return {\n                LineId: cartLine.LineId || '',\n                LineItem: { className: 'ms-checkout__line-item' },\n                item: _getLineItemComponent(cartLine),\n                pickUpAtStore: isPickUp ? _getPickUpAtStoreComponents(pickupDeliveryLocation) : undefined\n            };\n        });\n    };\n\n    const _getGroupTitleComponent = (count: number, type: deliveryType): string => {\n        const {\n            resources: {\n                itemLabel,\n                itemsLabel,\n                inStorePickUpLabel,\n                shippingCountCheckoutLineItem\n            }\n        } = input;\n\n        const suffix = count > 1 ? itemsLabel : itemLabel;\n        const title = type === 'ship' ? shippingCountCheckoutLineItem : inStorePickUpLabel;\n        return title.replace('{count}', count.toString()).replace('{suffix}', suffix);\n    };\n\n    const _countItems = (items: CartLine[]): number => {\n        return items.reduce((count, item) => {\n            return count + (item.Quantity || 0);\n            // tslint:disable-next-line:align\n        }, 0);\n    };\n\n    const _filterItemsByDiliveryType = (type: deliveryType): CartLine[] => {\n        const cart = get(input, 'data.checkout.result.checkoutCart.cart');\n        return type === 'ship'\n            ? cart.CartLines.filter((cartLine: CartLine) => (cartLine.DeliveryMode && cartLine.DeliveryMode !== '') ? cartLine.DeliveryMode !== pickupDeliveryModeCode : cartLine)\n            : cart.CartLines.filter((cartLine: CartLine) => cartLine.DeliveryMode === pickupDeliveryModeCode);\n    };\n\n    const _getLineItemsByDeliveryType = (type: deliveryType): ILineItemDeliveryGroup | undefined => {\n        if ((pickupDeliveryModeCode === '' || pickupDeliveryModeCode === undefined) && type === 'pickup') {\n            return;\n        }\n\n        const items = _filterItemsByDiliveryType(type);\n\n        if (items.length === 0) {\n            return undefined;\n        }\n\n        const count = _countItems(items);\n        const title = _getGroupTitleComponent(count, type);\n\n        return {\n            LineItemDeliveryGroup: { className: classnames('ms-checkout__line-items-delivery-group', type) },\n            LineItemList: { className: 'ms-checkout__line-items-list' },\n            heading: <div className='ms-checkout__line-items-group-title'>{title}</div>,\n            lineItems: _getLineItemsComponents(items)\n        };\n    };\n\n    const _getLineItems = (): ILineItems | undefined => {\n        const {\n            context,\n            config: { lineItemsHeading },\n            data: { products },\n            resources: { editCartText }\n        } = input;\n\n        const payLoad = getPayloadObject('click', telemetryContent!, TelemetryConstant.EditCart);\n        const attribute = getTelemetryAttributes(telemetryContent!, payLoad);\n        const cart = get(input, 'data.checkout.result.checkoutCart.cart');\n\n        if (!cart || !cart.CartLines || !cart.CartLines.length || !products) {\n            return undefined;\n        }\n\n        return {\n            LineItems: { className: 'ms-checkout__line-items' },\n            Header: { className: 'ms-checkout__line-items-header' },\n            heading: lineItemsHeading && lineItemsHeading.text && (\n                <Msdyn365.Text\n                    className='ms-checkout__line-items-heading'\n                    {...lineItemsHeading}\n                    tag={lineItemsHeading.tag || 'h2'}\n                    text={lineItemsHeading.text}\n                    editProps={{ onEdit: handleLineItemHeadingChange, requestContext: context.request }}\n                />\n            ),\n            editLink: (\n                <Button\n                    className='ms-checkout__line-items-edit-cart-link'\n                    title={editCartText}\n                    color='link'\n                    href={Msdyn365.getUrlSync('cart', context.actionContext) || ''}\n                    {...attribute}\n                >\n                    {editCartText}\n                </Button>\n            ),\n            itemsForPickup: _getLineItemsByDeliveryType('pickup'),\n            itemsForShip: _getLineItemsByDeliveryType('ship')\n        };\n    };\n\n    const handleLineItemHeadingChange = (event: Msdyn365.ContentEditableEvent) => {\n        const {\n            config: { lineItemsHeading }\n        } = input;\n        lineItemsHeading!.text = event.target.value;\n    };\n\n    return _getLineItems();\n};\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}