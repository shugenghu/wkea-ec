{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _toConsumableArray from\"@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/esm/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import classnames from'classnames';import{reaction}from'mobx';import*as React from'react';import{Carousel}from'@msdyn365-commerce/components';import{ImagefullView,inlineZoomImageOnHover,inlineZoomImageOnMouseMove,inlineZoomImageOnMouseOut,inlineZoomInit,onContainerZoomInit,onMouseMoveLensContainer,onMouseOutLensContainer,onMouseOverImageContainer,removeInlineZoomStyle,SingleSlideCarousel}from'@msdyn365-commerce-modules/utilities';import{Image}from'@msdyn365-commerce/core';import{getValidProductImages,validateProductImages}from'./utils';var MediaGallery=/*#__PURE__*/function(_React$Component){_inherits(MediaGallery,_React$Component);var _super=_createSuper(MediaGallery);function MediaGallery(props){var _this;_classCallCheck(this,MediaGallery);_this=_super.call(this,props);_this._inlineZoomDivRef=new Map();_this.defaultGalleryImageSettings={viewports:{xs:{q:'w=767&h=767&m=8',w:0,h:0},sm:{q:'w=600&h=600&m=8',w:0,h:0},md:{q:'w=600&h=772&m=8',w:0,h:0},lg:{q:'h=772&m=8',w:0,h:0}},lazyload:true};_this.defaultThumbnailImageSettings={viewports:{xs:{q:'w=100&m=8',w:100,h:0},lg:{q:'w=100&m=8',w:100,h:0}},lazyload:true};_this.onExiting=function(){_this.setState({animating:true});};_this.onExited=function(){_this.setState({animating:false});};_this.next=function(){if(_this.isLastItem()===undefined){return;}var nextIndex=_this.isLastItem()?0:_this.state.activeIndex+1;_this.goToIndex(nextIndex);};_this.previous=function(){var nextIndex=_this.isFirstItem()?_this.state.mediaGalleryItems?_this.state.mediaGalleryItems.length-1:0:_this.state.activeIndex-1;_this.goToIndex(nextIndex);};_this.goToIndex=function(index){if(_this.state.animating){return;}_this.setState({activeIndex:index});};_this._getCarouselItem=function(image,index){return/*#__PURE__*/React.createElement(Image,Object.assign({className:'ms-media-gallery__item'},image,{gridSettings:_this.props.context.request.gridSettings,imageSettings:_this.props.config.galleryImageSettings||_this.defaultGalleryImageSettings,loadFailureBehavior:'default',role:'tabpanel',id:\"\".concat(_this.props.id,\"__carousel-item__\").concat(index)}));};_this._getThumbnailItem=function(image,index,modifiedActiveIndex){var classes=classnames('ms-media-gallery__thumbnail-item',modifiedActiveIndex===index?'ms-media-gallery__thumbnail-item-active':'');return{ThumbnailItemContainerProps:{tag:'li',className:classes,role:'tab',tabIndex:0,key:index,'aria-label':image.altText,'aria-selected':modifiedActiveIndex===index,'aria-controls':\"\".concat(_this.props.id,\"__carousel-item__\").concat(index),onClick:_this._generateOnThumbnailClick(index),onKeyDown:_this._generateOnThumbnailKeyDown(index)},Picture:/*#__PURE__*/React.createElement(Image,Object.assign({className:'ms-media-gallery__thumbnail'},image,{gridSettings:_this.props.context.request.gridSettings,imageSettings:_this.props.config.thumbnailImageSettings||_this.defaultThumbnailImageSettings,loadFailureBehavior:'default'}))};};_this._generateOnThumbnailKeyDown=function(index){return function(event){if(event.which===13||event.which===32){event.preventDefault();_this.goToIndex(index);}};};_this._generateOnThumbnailClick=function(index){return function(event){event.preventDefault();_this.goToIndex(index);};};_this.isFirstItem=function(){return _this.state.activeIndex===0;};_this.isLastItem=function(){return _this.state.mediaGalleryItems&&_this.state.activeIndex===_this.state.mediaGalleryItems.length-1;};_this.openModalDialog=function(){_this._toggleModal();};_this.imageModalSlider=function(ZoomView){var _this$props=_this.props,product=_this$props.data.product.result,resources=_this$props.resources;var mediaGalleryItems=_this.state.mediaGalleryItems;if(!mediaGalleryItems&&product){mediaGalleryItems=[_this._mapProductToImageData(product)];}var carouselprops={tag:Carousel,className:'ms-media-gallery__carousel',items:mediaGalleryItems&&mediaGalleryItems.map(function(item,index){return _this._renderCarouselItemImageView(ZoomView,item,index);}),activeIndex:_this.state.activeIndex,next:_this.next,previous:_this.previous,interval:false,directionTextPrev:resources.previousScreenshotFlipperText,directionTextNext:resources.nextScreenshotFlipperText,onIndicatorsClickHandler:_this.goToIndex,showPaginationTooltip:true,hideIndicator:true,handleOnExited:_this.onExited,handleOnExiting:_this.onExiting};var carousel=/*#__PURE__*/React.createElement(Carousel,Object.assign({},carouselprops));var imageModalSliderProps={modalIsOpen:_this.state.modalIsOpen,ontoggle:_this._toggleModal,galleryCarousel:carousel};return ImagefullView(imageModalSliderProps);};_this._toggleModal=_this._toggleModal.bind(_assertThisInitialized(_this));_this.state={activeIndex:0,animating:false,mediaGalleryItems:undefined,isImageZoomed:false,modalIsOpen:false};_this._onImageMouseOut=_this._onImageMouseOut.bind(_assertThisInitialized(_this));_this._inlineZoomImageOnHover=_this._inlineZoomImageOnHover.bind(_assertThisInitialized(_this));_this._onInlineImageClick=_this._onInlineImageClick.bind(_assertThisInitialized(_this));_this._onContainerZoomImageClick=_this._onContainerZoomImageClick.bind(_assertThisInitialized(_this));_this._onMouseOutLensContainer=_this._onMouseOutLensContainer.bind(_assertThisInitialized(_this));return _this;}_createClass(MediaGallery,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _this2=this;var source,curatedImage,images,_images;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:source=this.props.config.imageSource||\"pageContext\";curatedImage=this.props.config.images||[];if(source===\"pageContext\"){reaction(function(){return _this2.props.data.product.result?_this2.props.data.product.result.RecordId:null;},/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var images;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!_this2.props.data.product.result){_context.next=7;break;}_context.next=3;return getValidProductImages(_this2.props.data.product.result.RecordId,+_this2.props.context.request.apiSettings.channelId,_this2.props.context.actionContext,_this2.props.config.thumbnailImageSettings||_this2.defaultThumbnailImageSettings);case 3:images=_context.sent;_this2.setState({mediaGalleryItems:[].concat(_toConsumableArray(images),_toConsumableArray(curatedImage))});_context.next=8;break;case 7:_this2.setState({mediaGalleryItems:_toConsumableArray(curatedImage)});case 8:case\"end\":return _context.stop();}}},_callee);})));}if(!(source===\"productId\"&&this.props.data.mediaLocations.result)){_context2.next=10;break;}_context2.next=6;return validateProductImages(this.props.data.mediaLocations.result,this.props.context.actionContext,this.props.config.thumbnailImageSettings||this.defaultThumbnailImageSettings);case 6:images=_context2.sent;this.setState({mediaGalleryItems:[].concat(_toConsumableArray(images),_toConsumableArray(curatedImage))});_context2.next=18;break;case 10:if(!(source===\"pageContext\"&&this.props.data.product.result)){_context2.next=17;break;}_context2.next=13;return getValidProductImages(this.props.data.product.result.RecordId,+this.props.context.request.apiSettings.channelId,this.props.context.actionContext,this.props.config.thumbnailImageSettings||this.defaultThumbnailImageSettings);case 13:_images=_context2.sent;this.setState({mediaGalleryItems:[].concat(_toConsumableArray(_images),_toConsumableArray(curatedImage))});_context2.next=18;break;case 17:this.setState({mediaGalleryItems:_toConsumableArray(curatedImage)});case 18:case\"end\":return _context2.stop();}}},_callee2,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this3=this;var _this$props2=this.props,product=_this$props2.data.product.result,id=_this$props2.id,config=_this$props2.config,resources=_this$props2.resources;var mediaGalleryItems=this.state.mediaGalleryItems;var className=config.className,showPaginationTooltip=config.showPaginationTooltip;var imgSource=config.imageSource||\"pageContext\";if(!mediaGalleryItems&&imgSource===\"pageContext\"&&product){this.setState({mediaGalleryItems:[this._mapProductToImageData(product)].concat(_toConsumableArray(config.images||[]))});}var isVertical=config.thumbnailsOrientation===\"vertical\";var allowFullscreen=config.allowFullScreen||false;var zoomViewMode=config.imageZoom===\"inline\"?\"inline\":config.imageZoom===\"container\"?\"container\":'';var zoomView=allowFullscreen?'fullscreen':zoomViewMode;var viewProps=_objectSpread(_objectSpread({},this.props),{},{state:this.state,MediaGallery:{moduleProps:this.props,className:classnames(\"ms-media-gallery \".concat(isVertical?'vertical':''),className)},Modal:allowFullscreen?this.imageModalSlider(zoomViewMode):null,CarouselProps:{tag:Carousel,className:'ms-media-gallery__carousel',items:mediaGalleryItems&&mediaGalleryItems.map(function(item,index){return _this3._renderCarouselItemImageView(zoomView,item,index);}),activeIndex:this.state.activeIndex,next:this.next,previous:this.previous,interval:false,directionTextPrev:resources.previousScreenshotFlipperText,directionTextNext:resources.nextScreenshotFlipperText,onIndicatorsClickHandler:this.goToIndex,showPaginationTooltip:showPaginationTooltip===true,handleOnExited:this.onExited,handleOnExiting:this.onExiting},Thumbnails:{ThumbnailsContainerProps:{className:'ms-media-gallery__thumbnails-container'},SingleSlideCarouselComponentProps:{tag:SingleSlideCarousel,className:'ms-media-gallery__thumbnails',vertical:isVertical,flipperPrevLabel:resources.previousScreenshotFlipperText,flipperNextLabel:resources.nextScreenshotFlipperText,parentId:id,useTabList:true},items:mediaGalleryItems&&mediaGalleryItems.map(function(item,index){return _this3._getThumbnailItem(item,index,_this3.state.activeIndex);})}});return this.props.renderView(viewProps);}},{key:\"_renderCarouselItemImageView\",value:function _renderCarouselItemImageView(zoomView,image,index){if(zoomView==='container'){return this._renderImageInContainerOnZoom(image,index);}else if(zoomView==='inline'){return this._renderImageInlineOnZoom(image,index);}else if(zoomView==='fullscreen'){return this._renderImageFullScreenOnZoom(image,index);}else{return/*#__PURE__*/React.createElement(React.Fragment,null,this._getCarouselItem(image,index));}}},{key:\"_renderImageInlineOnZoom\",value:function _renderImageInlineOnZoom(image,index){var _this4=this;return/*#__PURE__*/React.createElement(\"div\",{className:\"ms-inline-zoom \".concat(this.state.isImageZoomed?'zoomed':''),ref:function ref(divRef){return _this4._inlineZoomDivRef.set(index,divRef);},\"data-scale\":this.props.config.dataScale},/*#__PURE__*/React.createElement(Image,Object.assign({className:'ms-media-gallery__item'},image,{gridSettings:this.props.context.request.gridSettings,imageSettings:this.props.config.galleryImageSettings||this.defaultGalleryImageSettings,loadFailureBehavior:'default',role:'tabpanel',onClick:this._onInlineImageClick,onMouseOver:this.state.isImageZoomed&&this._inlineZoomImageOnHover||undefined,id:\"\".concat(this.props.id,\"__carousel-item__\").concat(index)})),/*#__PURE__*/React.createElement(Image,Object.assign({role:'presentation',className:'ms-inline-zoom__zoomedImg'},image,{onClick:this._onImageMouseOut,gridSettings:this.props.context.request.gridSettings,imageSettings:this.props.config.galleryImageSettings||this.defaultGalleryImageSettings,loadFailureBehavior:'default',id:\"\".concat(this.props.id,\"__zoom__\").concat(index),onMouseMove:this.state.isImageZoomed&&inlineZoomImageOnMouseMove||undefined})));}},{key:\"_inlineZoomImageOnHover\",value:function _inlineZoomImageOnHover(event){inlineZoomImageOnHover(event,this.props.config.dataScale);}},{key:\"_onInlineImageClick\",value:function _onInlineImageClick(event){if(window.innerWidth<=768){return;}inlineZoomInit(event,this.props.config.dataScale);this.setState({isImageZoomed:true});}},{key:\"_onImageMouseOut\",value:function _onImageMouseOut(event){inlineZoomImageOnMouseOut(event);this.setState({isImageZoomed:false});}},{key:\"_onContainerZoomImageClick\",value:function _onContainerZoomImageClick(event){if(window.innerWidth<=768){return;}onContainerZoomInit(event);this.setState({isImageZoomed:true});}},{key:\"_onMouseOutLensContainer\",value:function _onMouseOutLensContainer(event){onMouseOutLensContainer(event);this.setState({isImageZoomed:false});}},{key:\"_renderImageInContainerOnZoom\",value:function _renderImageInContainerOnZoom(image,index){return/*#__PURE__*/React.createElement(\"div\",{className:'ms-containerZoom__container'},/*#__PURE__*/React.createElement(\"div\",{className:'ms-containerZoom__zoom-lens',role:'presentation',onMouseOut:this._onMouseOutLensContainer,onClick:this._onMouseOutLensContainer,onMouseMove:this.state.isImageZoomed&&onMouseMoveLensContainer||undefined}),/*#__PURE__*/React.createElement(Image,Object.assign({className:'ms-media-gallery__item'},image,{gridSettings:this.props.context.request.gridSettings,onClick:this._onContainerZoomImageClick,imageSettings:this.props.config.galleryImageSettings||this.defaultGalleryImageSettings,loadFailureBehavior:'default',onMouseOver:this.state.isImageZoomed&&onMouseOverImageContainer||undefined,id:\"\".concat(this.props.id,\"__carousel-item__\").concat(index)})));}},{key:\"_renderImageFullScreenOnZoom\",value:function _renderImageFullScreenOnZoom(image,index){return/*#__PURE__*/React.createElement(\"div\",{className:'ms-fullscreen-section'},/*#__PURE__*/React.createElement(Image,Object.assign({className:'ms-media-gallery__item'},image,{gridSettings:this.props.context.request.gridSettings,imageSettings:this.props.config.galleryImageSettings||this.defaultGalleryImageSettings,loadFailureBehavior:'default',role:'tabpanel'})),/*#__PURE__*/React.createElement(\"div\",{className:'ms-fullscreen-section__overlay'},/*#__PURE__*/React.createElement(\"a\",{href:'javascript:void(0);',title:this.props.resources.fullScreenTitleText,role:'button',onClick:this.openModalDialog,className:'ms-fullscreen-section__magnifying-glass-icon'})));}},{key:\"_mapProductToImageData\",value:function _mapProductToImageData(product){return{src:product.PrimaryImageUrl||''};}},{key:\"_toggleModal\",value:function _toggleModal(){if(this.state.modalIsOpen){var parentDiv=this._inlineZoomDivRef.get(this.state.activeIndex);if(parentDiv&&parentDiv.children&&parentDiv.children.length>=2){var image=parentDiv.children[1].querySelector('img');if(image){image.removeAttribute('style');}}this.setState({isImageZoomed:false});}this.setState({isImageZoomed:false,modalIsOpen:!this.state.modalIsOpen});removeInlineZoomStyle();}}]);return MediaGallery;}(React.Component);export default MediaGallery;","map":{"version":3,"sources":["modules/media-gallery/media-gallery.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport classnames from 'classnames';\nimport { reaction } from 'mobx';\nimport * as React from 'react';\n\nimport { Carousel, ICarouselProps } from '@msdyn365-commerce/components';\n\nimport {\n    IComponentNodeProps,\n    ImagefullView,\n    IModalViewProps,\n    IModuleProps,\n    inlineZoomImageOnHover,\n    inlineZoomImageOnMouseMove,\n    inlineZoomImageOnMouseOut,\n    inlineZoomInit,\n    INodeProps,\n    ISingleSlideCarouselProps,\n    KeyCodes,\n    NodeTag,\n    onContainerZoomInit,\n    onMouseMoveLensContainer,\n    onMouseOutLensContainer,\n    onMouseOverImageContainer,\n    removeInlineZoomStyle,\n    SingleSlideCarousel\n} from '@msdyn365-commerce-modules/utilities';\nimport { IImageData, IImageSettings, Image } from '@msdyn365-commerce/core';\nimport { SimpleProduct } from '@msdyn365-commerce/retail-proxy';\nimport { imageSource, imageZoom, IMediaGalleryData, IMediaGalleryProps, thumbnailsOrientation } from '../..';\nimport { getValidProductImages, validateProductImages } from './utils';\n\nexport interface IMediaGalleryState {\n    animating: boolean;\n    activeIndex: number;\n    mediaGalleryItems: IImageData[] | undefined;\n    isImageZoomed: boolean;\n    modalIsOpen: boolean;\n}\n\nexport interface IMediaGalleryThumbnailsViewProps {\n    ThumbnailsContainerProps: INodeProps;\n    SingleSlideCarouselComponentProps: INodeProps;\n    items?: IMediaGalleryThumbnailItemViewProps[];\n}\n\nexport interface IMediaGalleryThumbnailItemViewProps {\n    ThumbnailItemContainerProps: INodeProps;\n    Picture: React.ReactElement;\n}\n\nexport interface IMediaGalleryViewProps extends IMediaGalleryProps<IMediaGalleryData> {\n    state: IMediaGalleryState;\n    MediaGallery: IModuleProps;\n    CarouselProps: INodeProps;\n    Thumbnails: IMediaGalleryThumbnailsViewProps;\n    Modal?:React.ReactElement|null;\n}\n\n/**\n * Media gallery component\n */\nclass MediaGallery extends React.Component<IMediaGalleryProps<IMediaGalleryData>, IMediaGalleryState> {\n    private _inlineZoomDivRef: Map<number, HTMLDivElement> = new Map();\n    private readonly defaultGalleryImageSettings: IImageSettings = {\n        viewports: {\n            xs: { q: 'w=767&h=767&m=8', w: 0, h: 0 },\n            sm: { q: 'w=600&h=600&m=8', w: 0, h: 0 },\n            md: { q: 'w=600&h=772&m=8', w: 0, h: 0 },\n            lg: { q: 'h=772&m=8', w: 0, h: 0 }\n        },\n        lazyload: true\n    };\n\n    private readonly defaultThumbnailImageSettings: IImageSettings = {\n        viewports: {\n            xs: { q: 'w=100&m=8', w: 100, h: 0 },\n            lg: { q: 'w=100&m=8', w: 100, h: 0 }\n        },\n        lazyload: true\n    };\n\n    constructor(props: IMediaGalleryProps<IMediaGalleryData>) {\n        super(props);\n        this._toggleModal = this._toggleModal.bind(this);\n        this.state = { activeIndex: 0, animating: false, mediaGalleryItems: undefined, isImageZoomed: false, modalIsOpen:false };\n\n        this._onImageMouseOut = this._onImageMouseOut.bind(this);\n        this._inlineZoomImageOnHover = this._inlineZoomImageOnHover.bind(this);\n        this._onInlineImageClick = this._onInlineImageClick.bind(this);\n        this._onContainerZoomImageClick = this._onContainerZoomImageClick.bind(this);\n        this._onMouseOutLensContainer = this._onMouseOutLensContainer.bind(this);\n    }\n\n    public async componentDidMount(): Promise<void> {\n        const source = this.props.config.imageSource || imageSource.pageContext;\n        const curatedImage = this.props.config.images || [];\n\n        if (source === imageSource.pageContext) {\n            reaction(\n                () => (this.props.data.product.result ? this.props.data.product.result.RecordId : null),\n                async () => {\n                    if (this.props.data.product.result) {\n                        const images = await getValidProductImages(\n                            this.props.data.product.result.RecordId,\n                            +this.props.context.request.apiSettings.channelId,\n                            this.props.context.actionContext,\n                            this.props.config.thumbnailImageSettings || this.defaultThumbnailImageSettings\n                        );\n                        this.setState({\n                            mediaGalleryItems: [...images, ...curatedImage]\n                        });\n                    } else {\n                        this.setState({\n                            mediaGalleryItems: [...curatedImage]\n                        });\n                    }\n                }\n            );\n        }\n\n        if (source === imageSource.productId && this.props.data.mediaLocations.result) {\n            const images = await validateProductImages(\n                this.props.data.mediaLocations.result,\n                this.props.context.actionContext,\n                this.props.config.thumbnailImageSettings || this.defaultThumbnailImageSettings\n            );\n            this.setState({\n                mediaGalleryItems: [...images, ...curatedImage]\n            });\n        } else if (source === imageSource.pageContext && this.props.data.product.result) {\n            const images = await getValidProductImages(\n                this.props.data.product.result.RecordId,\n                +this.props.context.request.apiSettings.channelId,\n                this.props.context.actionContext,\n                this.props.config.thumbnailImageSettings || this.defaultThumbnailImageSettings\n            );\n\n            this.setState({\n                mediaGalleryItems: [...images, ...curatedImage]\n            });\n        } else {\n            this.setState({\n                mediaGalleryItems: [...curatedImage]\n            });\n        }\n    }\n\n    public render(): JSX.Element {\n        const {\n            data: {\n                product: { result: product },\n            },\n            id,\n            config,\n            resources\n        } = this.props;\n\n        const mediaGalleryItems = this.state.mediaGalleryItems;\n        const { className, showPaginationTooltip } = config;\n        const imgSource = config.imageSource || imageSource.pageContext;\n\n        if (!mediaGalleryItems && imgSource === imageSource.pageContext && product) {\n            this.setState({ mediaGalleryItems: [this._mapProductToImageData(product), ...config.images || []] });\n        }\n\n        const isVertical: boolean = config.thumbnailsOrientation === thumbnailsOrientation.vertical;\n        const allowFullscreen:boolean = config.allowFullScreen || false;\n        const zoomViewMode: string =\n            config.imageZoom === imageZoom.inline\n                ? imageZoom.inline\n                : config.imageZoom === imageZoom.container\n                ? imageZoom.container\n                : '';\n        const zoomView = allowFullscreen ? 'fullscreen': zoomViewMode;\n\n        const viewProps: IMediaGalleryViewProps = {\n            ...(this.props as IMediaGalleryProps<IMediaGalleryData>),\n            state: this.state,\n            MediaGallery: {\n                moduleProps: this.props,\n                className: classnames(`ms-media-gallery ${isVertical ? 'vertical' : ''}`, className)\n            },\n            Modal: allowFullscreen ? this.imageModalSlider(zoomViewMode): null,\n            CarouselProps: {\n                tag: Carousel,\n                className: 'ms-media-gallery__carousel',\n                items:\n                    mediaGalleryItems &&\n                    mediaGalleryItems.map((item: IImageData, index: number) => this._renderCarouselItemImageView(zoomView, item, index)),\n                activeIndex: this.state.activeIndex,\n                next: this.next,\n                previous: this.previous,\n                interval: false,\n                directionTextPrev: resources.previousScreenshotFlipperText,\n                directionTextNext: resources.nextScreenshotFlipperText,\n                onIndicatorsClickHandler: this.goToIndex,\n                showPaginationTooltip: showPaginationTooltip === true,\n                handleOnExited: this.onExited,\n                handleOnExiting: this.onExiting\n            } as IComponentNodeProps<ICarouselProps>,\n            Thumbnails: {\n                ThumbnailsContainerProps: { className: 'ms-media-gallery__thumbnails-container' },\n                SingleSlideCarouselComponentProps: {\n                    tag: SingleSlideCarousel,\n                    className: 'ms-media-gallery__thumbnails',\n                    vertical: isVertical,\n                    flipperPrevLabel: resources.previousScreenshotFlipperText,\n                    flipperNextLabel: resources.nextScreenshotFlipperText,\n                    parentId: id,\n                    useTabList: true\n                } as IComponentNodeProps<ISingleSlideCarouselProps>,\n                items:\n                    mediaGalleryItems &&\n                    mediaGalleryItems.map((item: IImageData, index: number) => this._getThumbnailItem(item, index, this.state.activeIndex))\n            }\n        };\n\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n\n    private onExiting = () => {\n        this.setState({ animating: true });\n    };\n\n    private onExited = () => {\n        this.setState({ animating: false });\n    };\n\n    private next = (): void => {\n        if (this.isLastItem() === undefined) {\n            return;\n        }\n\n        const nextIndex = this.isLastItem() ? 0 : this.state.activeIndex + 1;\n        this.goToIndex(nextIndex);\n    };\n\n    private previous = (): void => {\n        const nextIndex = this.isFirstItem()\n            ? this.state.mediaGalleryItems\n                ? this.state.mediaGalleryItems.length - 1\n                : 0\n            : this.state.activeIndex - 1;\n        this.goToIndex(nextIndex);\n    };\n\n    private goToIndex = (index: number): void => {\n        if (this.state.animating) {\n            return;\n        }\n        this.setState({ activeIndex: index });\n    };\n\n    private _renderCarouselItemImageView(zoomView: string, image: IImageData, index: number): React.ReactNode {\n        if (zoomView === 'container') {\n            return this._renderImageInContainerOnZoom(image, index);\n        } else if (zoomView === 'inline') {\n            return this._renderImageInlineOnZoom(image, index);\n        } else if (zoomView === 'fullscreen') {\n            return this._renderImageFullScreenOnZoom(image, index);\n        } else {\n            return <React.Fragment>{this._getCarouselItem(image, index)}</React.Fragment>;\n        }\n    }\n\n    private _getCarouselItem = (image: IImageData, index: number): React.ReactNode => (\n        <Image\n            className='ms-media-gallery__item'\n            {...image}\n            gridSettings={this.props.context.request.gridSettings!}\n            imageSettings={this.props.config.galleryImageSettings || this.defaultGalleryImageSettings}\n            loadFailureBehavior='default'\n            role='tabpanel'\n            id={`${this.props.id}__carousel-item__${index}`}\n        />\n    );\n\n    private _getThumbnailItem = (image: IImageData, index: number, modifiedActiveIndex: number): IMediaGalleryThumbnailItemViewProps => {\n        const classes = classnames(\n            'ms-media-gallery__thumbnail-item',\n            modifiedActiveIndex === index ? 'ms-media-gallery__thumbnail-item-active' : ''\n        );\n\n        return {\n            ThumbnailItemContainerProps: {\n                tag: 'li' as NodeTag,\n                className: classes,\n                role: 'tab',\n                tabIndex: 0,\n                key: index,\n                'aria-label': image.altText,\n                'aria-selected': modifiedActiveIndex === index,\n                'aria-controls': `${this.props.id}__carousel-item__${index}`,\n                onClick: this._generateOnThumbnailClick(index),\n                onKeyDown: this._generateOnThumbnailKeyDown(index)\n            },\n            Picture: (\n                <Image\n                    className='ms-media-gallery__thumbnail'\n                    {...image}\n                    gridSettings={this.props.context.request.gridSettings!}\n                    imageSettings={this.props.config.thumbnailImageSettings || this.defaultThumbnailImageSettings}\n                    loadFailureBehavior='default'\n                />\n            )\n        };\n    };\n\n    private _generateOnThumbnailKeyDown = (index: number) => {\n        return (event: React.KeyboardEvent) => {\n            if (event.which === KeyCodes.Enter || event.which === KeyCodes.Space) {\n                event.preventDefault();\n\n                this.goToIndex(index);\n            }\n        };\n    };\n\n    private _generateOnThumbnailClick = (index: number) => {\n        return (event: React.MouseEvent<HTMLLIElement>) => {\n            event.preventDefault();\n\n            this.goToIndex(index);\n        };\n    };\n\n    private _renderImageInlineOnZoom(image: IImageData, index: number): React.ReactNode {\n        return (\n            // tslint:disable-next-line: react-this-binding-issue\n            <div className={`ms-inline-zoom ${this.state.isImageZoomed ? 'zoomed' : ''}`} ref={divRef => this._inlineZoomDivRef.set(index, divRef!)} data-scale={this.props.config.dataScale}>\n                <Image\n                    className='ms-media-gallery__item'\n                    {...image}\n                    gridSettings={this.props.context.request.gridSettings!}\n                    imageSettings={this.props.config.galleryImageSettings || this.defaultGalleryImageSettings}\n                    loadFailureBehavior='default'\n                    role='tabpanel'\n                    onClick={this._onInlineImageClick}\n                    onMouseOver={this.state.isImageZoomed && this._inlineZoomImageOnHover || undefined}\n                    id={`${this.props.id}__carousel-item__${index}`}\n                />\n                <Image\n                    role='presentation'\n                    className='ms-inline-zoom__zoomedImg'\n                    {...image}\n                    onClick={this._onImageMouseOut}\n                    gridSettings={this.props.context.request.gridSettings!}\n                    imageSettings={this.props.config.galleryImageSettings || this.defaultGalleryImageSettings}\n                    loadFailureBehavior='default'\n                    id={`${this.props.id}__zoom__${index}`}\n                    onMouseMove={this.state.isImageZoomed && inlineZoomImageOnMouseMove || undefined}\n                />\n            </div>\n        );\n    }\n\n    private _inlineZoomImageOnHover(event: React.MouseEvent<HTMLImageElement>): void {\n        inlineZoomImageOnHover(event, this.props.config.dataScale);\n    }\n\n    private _onInlineImageClick(event: React.MouseEvent<HTMLImageElement>): void {\n        if (window.innerWidth <= 768) { // $msv-breakpoint-m\n            return;\n        }\n\n        inlineZoomInit(event, this.props.config.dataScale);\n        this.setState({\n            isImageZoomed: true\n        });\n    }\n\n    private _onImageMouseOut(event: React.MouseEvent<HTMLImageElement, MouseEvent>): void {\n        inlineZoomImageOnMouseOut(event);\n        this.setState({\n            isImageZoomed: false\n        });\n\n    }\n\n    private _onContainerZoomImageClick(event: React.MouseEvent<HTMLImageElement>): void {\n        if (window.innerWidth <= 768) { // $msv-breakpoint-m\n            return;\n        }\n\n        onContainerZoomInit(event);\n\n        this.setState({\n            isImageZoomed: true\n        });\n    }\n\n    private _onMouseOutLensContainer(event: React.MouseEvent<HTMLImageElement>): void {\n        onMouseOutLensContainer(event);\n\n        this.setState({\n            isImageZoomed: false\n        });\n    }\n\n    private _renderImageInContainerOnZoom(image: IImageData, index: number): React.ReactNode {\n        return (\n            <div className='ms-containerZoom__container'>\n                <div className='ms-containerZoom__zoom-lens' role='presentation' onMouseOut={this._onMouseOutLensContainer} onClick={this._onMouseOutLensContainer} onMouseMove={this.state.isImageZoomed && onMouseMoveLensContainer || undefined} />\n                <Image\n                    className='ms-media-gallery__item'\n                    {...image}\n                    gridSettings={this.props.context.request.gridSettings!}\n                    onClick={this._onContainerZoomImageClick}\n                    imageSettings={this.props.config.galleryImageSettings || this.defaultGalleryImageSettings}\n                    loadFailureBehavior='default'\n                    onMouseOver={this.state.isImageZoomed && onMouseOverImageContainer || undefined}\n                    id={`${this.props.id}__carousel-item__${index}`}\n                />\n            </div>\n        );\n    }\n\n    private _renderImageFullScreenOnZoom(image: IImageData, index: number): React.ReactNode {\n        return (\n            <div className='ms-fullscreen-section'>\n                <Image\n                    className='ms-media-gallery__item'\n                    {...image}\n                    gridSettings={this.props.context.request.gridSettings!}\n                    imageSettings={this.props.config.galleryImageSettings || this.defaultGalleryImageSettings}\n                    loadFailureBehavior='default'\n                    role='tabpanel'\n                />\n                <div className='ms-fullscreen-section__overlay'>\n                    <a href='javascript:void(0);' title={this.props.resources.fullScreenTitleText} role='button' onClick={this.openModalDialog} className='ms-fullscreen-section__magnifying-glass-icon'/>\n                </div>\n            </div>\n        );\n    }\n\n    private _mapProductToImageData(product: SimpleProduct): IImageData {\n        return {\n            src: product.PrimaryImageUrl || ''\n        };\n    }\n\n    private isFirstItem = () => this.state.activeIndex === 0;\n\n    private isLastItem = () => this.state.mediaGalleryItems && this.state.activeIndex === this.state.mediaGalleryItems.length - 1;\n\n    private openModalDialog = (): void => {\n        this._toggleModal();\n    }\n\n    private _toggleModal(): void {\n        if (this.state.modalIsOpen) {\n            const parentDiv = this._inlineZoomDivRef.get(this.state.activeIndex);\n            if (parentDiv && parentDiv.children && parentDiv.children.length >= 2) {\n                const image = parentDiv.children[1].querySelector('img');\n                if (image) {\n                    image.removeAttribute('style');\n                }\n            }\n            this.setState({\n                isImageZoomed: false\n            });\n        }\n        this.setState({\n            isImageZoomed: false,\n            modalIsOpen: !this.state.modalIsOpen\n        });\n        removeInlineZoomStyle();\n    }\n\n    private imageModalSlider=(ZoomView:string):React.ReactElement => {\n        const {\n            data: {\n                product: { result: product }\n            },\n            resources\n        } = this.props;\n        let mediaGalleryItems = this.state.mediaGalleryItems;\n\n        if (!mediaGalleryItems && product) {\n            mediaGalleryItems = [this._mapProductToImageData(product)];\n        }\n\n        const carouselprops = {\n            tag: Carousel,\n            className: 'ms-media-gallery__carousel',\n            items:\n                mediaGalleryItems &&\n                mediaGalleryItems.map((item: IImageData, index: number) => this._renderCarouselItemImageView(ZoomView, item, index)),\n            activeIndex: this.state.activeIndex,\n            next: this.next,\n            previous: this.previous,\n            interval: false,\n            directionTextPrev: resources.previousScreenshotFlipperText,\n            directionTextNext: resources.nextScreenshotFlipperText,\n            onIndicatorsClickHandler: this.goToIndex,\n            showPaginationTooltip: true,\n            hideIndicator: true,\n            handleOnExited: this.onExited,\n            handleOnExiting: this.onExiting,\n        } as IComponentNodeProps<ICarouselProps>;\n\n        const carousel = <Carousel  {...carouselprops} />;\n\n        const imageModalSliderProps:IModalViewProps = {\n            modalIsOpen:this.state.modalIsOpen,\n            ontoggle:this._toggleModal,\n            galleryCarousel: carousel\n       };\n        return ImagefullView(imageModalSliderProps) as React.ReactElement;\n    }\n}\n\nexport default MediaGallery;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}