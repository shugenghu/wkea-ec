{"ast":null,"code":"import\"core-js/modules/es.object.assign.js\";import _objectWithoutProperties from\"@babel/runtime/helpers/esm/objectWithoutProperties\";import{getPayloadObject,getTelemetryAttributes}from'@msdyn365-commerce-modules/utilities';import{RatingComponent}from'@msdyn365-commerce/components';import*as React from'react';export default class RefineItem extends React.Component{constructor(props){super(props);this._onClick=e=>{e.preventDefault();const{parentProductRefinerHierarchy,productRefinerValue,selectedRefinementCriterion}=this.props;if(productRefinerValue){this.props.onToggle({parentProductRefinerHierarchy:parentProductRefinerHierarchy,productRefinerValue:productRefinerValue,isSelecting:!selectedRefinementCriterion});setTimeout(()=>{this.anchorType.current&&this.anchorType.current.focus();},0);}};this._onClick=this._onClick.bind(this);this.state={isChecked:!!this.props.selectedRefinementCriterion};this.anchorType=/*#__PURE__*/React.createRef();this.payLoad=getPayloadObject('click',this.props.telemetryContent,'');}render(){const _this$props=this.props,{isDisabled,refineItemCommonProps,parentProductRefinerHierarchy,productRefinerValue,selectedRefinementCriterion,index,children,onToggle,context,telemetryContent}=_this$props,attrs=_objectWithoutProperties(_this$props,[\"isDisabled\",\"refineItemCommonProps\",\"parentProductRefinerHierarchy\",\"productRefinerValue\",\"selectedRefinementCriterion\",\"index\",\"children\",\"onToggle\",\"context\",\"telemetryContent\"]);if(!productRefinerValue){refineItemCommonProps.telemetry.error('[refine-item] Cannot render refineItem without productRefinerValue');return undefined;}if(!productRefinerValue.LeftValueBoundString){refineItemCommonProps.telemetry.warning(\"[refine-item]  RefineItem without LeftValueBoundString: \".concat(JSON.stringify(productRefinerValue)));}const isSingleSelect=parentProductRefinerHierarchy.RefinerTypeValue===0;let itemTypeClassName=isSingleSelect?'single-select':'multi-select';itemTypeClassName=\"ms-refine-submenu-item \".concat(itemTypeClassName);const inputType=isSingleSelect?'radio':'checkbox';itemTypeClassName=!!selectedRefinementCriterion?\"\".concat(itemTypeClassName,\"-checked\"):itemTypeClassName;if(parentProductRefinerHierarchy.SourceValue===4){if(productRefinerValue.LeftValueBoundString){this.payLoad.contentAction.etext=productRefinerValue.LeftValueBoundLocalizedString;const attribute=getTelemetryAttributes(telemetryContent,this.payLoad);return/*#__PURE__*/React.createElement(\"li\",{className:'ms-refine-submenu-item',role:'radio',\"aria-checked\":'false',id:\"\".concat(parentProductRefinerHierarchy.KeyName,\"_\").concat(index),\"aria-label\":\"\".concat(parentProductRefinerHierarchy.KeyName,\"_\").concat(index)},/*#__PURE__*/React.createElement(\"a\",Object.assign({href:this._getRefinerUrl(),\"aria-label\":\"\".concat(parentProductRefinerHierarchy.KeyName,\"_\").concat(productRefinerValue.LeftValueBoundLocalizedString),onClick:this._onClick},attribute),/*#__PURE__*/React.createElement(RatingComponent,{avgRating:parseInt(productRefinerValue.LeftValueBoundString,10),ratingCount:productRefinerValue.LeftValueBoundLocalizedString?productRefinerValue.LeftValueBoundLocalizedString:productRefinerValue.LeftValueBoundString,hideCount:false,readOnly:true,ariaLabel:'',context:context,id:this.props.moduleId,typeName:this.props.moduleTypeName,data:{}}),/*#__PURE__*/React.createElement(\"span\",{className:'refine-submenu-item__rating'},productRefinerValue.Count!==undefined&&\"(\".concat(productRefinerValue.Count,\")\"))));}else{return undefined;}}else{this.payLoad.contentAction.etext=productRefinerValue.LeftValueBoundLocalizedString||productRefinerValue.LeftValueBoundString;const attribute=getTelemetryAttributes(telemetryContent,this.payLoad);return/*#__PURE__*/React.createElement(\"li\",{className:'ms-refine-submenu-item',id:\"\".concat(parentProductRefinerHierarchy.KeyName,\"_\").concat(index)},/*#__PURE__*/React.createElement(\"a\",Object.assign({key:!!selectedRefinementCriterion?'true':'false',ref:this.anchorType,href:this._getRefinerUrl(),tabIndex:0,onClick:this._onClick,className:itemTypeClassName,role:inputType,\"aria-checked\":!!selectedRefinementCriterion},attribute,attrs),/*#__PURE__*/React.createElement(\"span\",{className:'ms-refine-submenu-item__label'},productRefinerValue.LeftValueBoundLocalizedString||productRefinerValue.LeftValueBoundString,productRefinerValue.Count!==undefined&&\" (\".concat(productRefinerValue.Count,\")\"))));}}_getRefinerUrl(){const{urlBuilder,parentProductRefinerHierarchy,productRefinerValue,selectedRefinementCriterion}=this.props;if(productRefinerValue){return urlBuilder({parentProductRefinerHierarchy:parentProductRefinerHierarchy,productRefinerValue:productRefinerValue,isSelecting:!selectedRefinementCriterion});}return'';}}","map":{"version":3,"sources":["modules/search-result-container/components/refine-item.tsx"],"names":[],"mappings":"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","sourcesContent":["import { getPayloadObject, getTelemetryAttributes, IPayLoad, ITelemetryContent } from '@msdyn365-commerce-modules/utilities';\nimport { IProductRefinerHierarchy } from '@msdyn365-commerce/commerce-entities';\nimport { RatingComponent } from '@msdyn365-commerce/components';\nimport { ICoreContext } from '@msdyn365-commerce/core';\nimport { ProductRefinerValue } from '@msdyn365-commerce/retail-proxy';\nimport * as React from 'react';\nimport { IRefineItemToggleNotification } from './refine-item-toggle-notification';\nimport { IRefineItemCommonProps } from './refine-item.props.common';\nimport { ProductRefinerSource, ProductRefinerTypeValue } from './utilities';\n\n/**\n * RefineItem properties\n */\nexport interface IRefineItemProps {\n\n    parentProductRefinerHierarchy: IProductRefinerHierarchy;\n    productRefinerValue: ProductRefinerValue;\n    selectedRefinementCriterion: ProductRefinerValue | undefined;\n    refineItemCommonProps: IRefineItemCommonProps;\n    isDisabled: boolean;\n    context: ICoreContext;\n    moduleId: string;\n    moduleTypeName: string;\n    index?: number;\n    /** The telemetry content */\n    telemetryContent?: ITelemetryContent;\n    onToggle(notfication: Readonly<IRefineItemToggleNotification>): void;\n    urlBuilder(refiner: IRefineItemToggleNotification): string;\n}\n\n/**\n * Refine item state\n */\nexport interface IRefineItemState extends React.ComponentState {\n    isChecked: boolean;\n    renderingError?: object;\n}\n\n/**\n * Single-select and multi-select refine item component (controlled by RefineSubmenu)\n */\nexport default class RefineItem extends React.Component<IRefineItemProps, IRefineItemState> {\n    private anchorType: React.RefObject<HTMLAnchorElement>;\n    private payLoad: IPayLoad;\n\n    constructor(props: IRefineItemProps) {\n        super(props);\n        this._onClick = this._onClick.bind(this);\n        this.state = {\n            isChecked: !!this.props.selectedRefinementCriterion\n        };\n        this.anchorType = React.createRef();\n        this.payLoad = getPayloadObject('click', this.props.telemetryContent!, '');\n    }\n\n    public render(): JSX.Element | undefined {\n        const {\n            isDisabled,\n            refineItemCommonProps,\n            parentProductRefinerHierarchy,\n            productRefinerValue,\n            selectedRefinementCriterion,\n            index,\n            children,\n            onToggle,\n            context,\n            telemetryContent,\n            ...attrs\n        } = this.props;\n        if (!productRefinerValue) {\n            refineItemCommonProps.telemetry.error('[refine-item] Cannot render refineItem without productRefinerValue');\n            return undefined;\n        }\n        if (!productRefinerValue.LeftValueBoundString) {\n            refineItemCommonProps.telemetry.warning(`[refine-item]  RefineItem without LeftValueBoundString: ${JSON.stringify(productRefinerValue)}`);\n        }\n        const isSingleSelect = parentProductRefinerHierarchy.RefinerTypeValue === ProductRefinerTypeValue.Single;\n        let itemTypeClassName = isSingleSelect ? 'single-select' : 'multi-select';\n        itemTypeClassName = `ms-refine-submenu-item ${itemTypeClassName}`;\n        const inputType = isSingleSelect ? 'radio' : 'checkbox';\n        itemTypeClassName = !!selectedRefinementCriterion ? `${itemTypeClassName}-checked` : itemTypeClassName;\n        if (parentProductRefinerHierarchy.SourceValue === ProductRefinerSource.Rating) {\n            if (productRefinerValue.LeftValueBoundString) {\n                this.payLoad.contentAction.etext = productRefinerValue.LeftValueBoundLocalizedString;\n                const attribute = getTelemetryAttributes(telemetryContent!, this.payLoad);\n                return (\n                    <li\n                        className='ms-refine-submenu-item'\n                        role='radio'\n                        aria-checked='false'\n                        id={`${parentProductRefinerHierarchy.KeyName! }_${index}`}\n                        aria-label={`${parentProductRefinerHierarchy.KeyName!}_${index}`}\n                    >\n                        <a\n                            href={this._getRefinerUrl()}\n                            aria-label={`${parentProductRefinerHierarchy.KeyName!}_${productRefinerValue.LeftValueBoundLocalizedString}`}\n                            onClick={this._onClick}\n                            {...attribute}\n                        >\n                            <RatingComponent\n                                avgRating={parseInt(productRefinerValue.LeftValueBoundString, 10)}\n                                ratingCount={productRefinerValue.LeftValueBoundLocalizedString ? productRefinerValue.LeftValueBoundLocalizedString : productRefinerValue.LeftValueBoundString}\n                                hideCount={false}\n                                readOnly={true}\n                                ariaLabel=''\n                                context={context}\n                                id={this.props.moduleId}\n                                typeName={this.props.moduleTypeName}\n                                data={{}}\n                            />\n                            <span className='refine-submenu-item__rating'>{productRefinerValue.Count !== undefined && `(${productRefinerValue.Count})`}</span>\n                        </a>\n                    </li>\n                );\n            } else {\n                return undefined;\n            }\n        } else {\n            this.payLoad.contentAction.etext = productRefinerValue.LeftValueBoundLocalizedString || productRefinerValue.LeftValueBoundString;\n            const attribute = getTelemetryAttributes(telemetryContent!, this.payLoad);\n            return (\n                <li className='ms-refine-submenu-item' id={`${parentProductRefinerHierarchy.KeyName!}_${index}`}>\n                    <a\n                        key={!!selectedRefinementCriterion ? 'true' : 'false'}\n                        ref={this.anchorType}\n                        href={this._getRefinerUrl()}\n                        tabIndex={0}\n                        onClick={this._onClick}\n                        className={itemTypeClassName}\n                        role={inputType}\n                        aria-checked={!!selectedRefinementCriterion}\n                        {...attribute}\n                        {...attrs}\n                    >\n                        <span className='ms-refine-submenu-item__label'>\n                            {productRefinerValue.LeftValueBoundLocalizedString || productRefinerValue.LeftValueBoundString}\n                            {productRefinerValue.Count !== undefined && ` (${productRefinerValue.Count})`}\n                        </span>\n                    </a>\n                </li>\n            );\n        }\n    }\n\n    private _getRefinerUrl(): string {\n        const { urlBuilder, parentProductRefinerHierarchy, productRefinerValue, selectedRefinementCriterion } = this.props;\n\n        if (productRefinerValue) {\n            return urlBuilder({\n                parentProductRefinerHierarchy: parentProductRefinerHierarchy,\n                productRefinerValue: productRefinerValue,\n                isSelecting: !selectedRefinementCriterion\n            });\n        }\n\n        return '';\n    }\n\n    private _onClick = (e: React.MouseEvent<HTMLAnchorElement | HTMLInputElement>): void => {\n        e.preventDefault();\n\n        const { parentProductRefinerHierarchy, productRefinerValue, selectedRefinementCriterion } = this.props;\n        if (productRefinerValue) {\n            this.props.onToggle({\n                parentProductRefinerHierarchy: parentProductRefinerHierarchy,\n                productRefinerValue: productRefinerValue,\n                isSelecting: !selectedRefinementCriterion\n            });\n\n            setTimeout(\n                () => {\n                    this.anchorType.current && this.anchorType.current.focus();\n                },\n                0\n            );\n        }\n    }\n}"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}