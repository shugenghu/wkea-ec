{"ast":null,"code":"import*as React from'react';import{getPayloadObject,getTelemetryAttributes,TelemetryConstant}from'@msdyn365-commerce-modules/utilities';import{buildStoreHours,secondsToTime}from'./date-time-helpers';var StoreSelectorLocationLineItemComponentActions={onLocationSelected:function onLocationSelected(props){props.handlers.onSelected(props.location);},onSetAsPreferredStore:function onSetAsPreferredStore(props){props.handlers.onSetAsPreferredStore(props.location.OrgUnitNumber);},onRemovePreferredStore:function onRemovePreferredStore(props){props.handlers.onRemovePreferredStore();}};var renderStoreHours=function renderStoreHours(storeHours,location,resources){if(storeHours&&storeHours.RegularStoreHours){var storeHoursList=buildStoreHours(storeHours.RegularStoreHours,resources);return/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__store-hours-details-group'},storeHoursList.map(function(displayTime){return/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__store-hours-details'},displayTime.endDayShort?/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__store-hours-day'},/*#__PURE__*/React.createElement(\"abbr\",{title:displayTime.startDayFull},displayTime.startDayShort),\"\\u2013\",/*#__PURE__*/React.createElement(\"abbr\",{title:displayTime.endDayFull},displayTime.endDayShort)):/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__store-hours-day'},/*#__PURE__*/React.createElement(\"abbr\",{title:displayTime.startDayFull},displayTime.startDayShort)),/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__store-hours-time'},displayTime.timeRange));}));}else{var storeOpenFrom=secondsToTime(location.OpenFrom);var storeOpenTo=secondsToTime(location.OpenTo);return/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__store-hours-details'},storeOpenFrom,\"-\",storeOpenTo);}};var buildDistanceString=function buildDistanceString(distance,preferredDistanceUnit,isLocationDisabled){if(distance===undefined||isLocationDisabled){return undefined;}else if(distance<1){return\"(<1 \".concat(preferredDistanceUnit,\")\");}else{return\"(\".concat(Math.floor(distance),\" \").concat(preferredDistanceUnit,\")\");}};var extractPhoneNumber=function extractPhoneNumber(contacts){if(!contacts){return undefined;}var allPhoneContacts=contacts.filter(function(contact){return contact.ContactTypeValue===1&&!contact.IsPrivate;});if(allPhoneContacts&&allPhoneContacts.length>0){var primaryPhoneContact=allPhoneContacts.find(function(contact){return contact.IsPrimary;});if(primaryPhoneContact){return primaryPhoneContact.Locator;}return allPhoneContacts[0].Locator;}return undefined;};var StoreSelectorLocationLineItem=function StoreSelectorLocationLineItem(props){var onClick=function onClick(){return StoreSelectorLocationLineItemComponentActions.onLocationSelected(props);};var hideStockStatus=props.hideStockStatus,isCurrentLocation=props.isCurrentLocation,isInStock=props.isInStock,location=props.location,resources=props.resources,storeHours=props.storeHours,stockStatusLabel=props.stockStatusLabel,storeLocatorView=props.storeLocatorView,index=props.index,preferredStoreLocationId=props.preferredStoreLocationId,isPreferredStoreEnabled=props.isPreferredStoreEnabled,isLocationDisabled=props.isLocationDisabled,telemetryContent=props.telemetryContent;var storeName=location.OrgUnitName;var distanceAsString=buildDistanceString(location.Distance,props.preferredDistanceUnit,isLocationDisabled);var storeAddress=location.Address;var phoneNumber=extractPhoneNumber(location.Contacts);var resourceLabel=isInStock?resources.inStock:resources.outOfStock;var stockLabel=stockStatusLabel?stockStatusLabel:undefined;var stockText=hideStockStatus?undefined:stockLabel?stockLabel:resourceLabel;var canSelectLocation=hideStockStatus||isInStock;var pickupInStoreButtonText=resources.selectLocation;var pickupInStoreAriaLabel=resources.selectLocationAriaLabelFormat.replace('{StoreName}',storeName||'');var isPreferredStore=preferredStoreLocationId===location.OrgUnitNumber;var payLoad=getPayloadObject('click',telemetryContent,TelemetryConstant.PickupInStore);var attributes=getTelemetryAttributes(telemetryContent,payLoad);payLoad.contentAction.etext=TelemetryConstant.PreferredStore;var preferredStoreAttr=getTelemetryAttributes(telemetryContent,payLoad);payLoad.contentAction.etext=TelemetryConstant.RemovePreferredStore;var RemovePreferredStoreAttr=getTelemetryAttributes(telemetryContent,payLoad);var setAsPreferredStore=function setAsPreferredStore(){return StoreSelectorLocationLineItemComponentActions.onSetAsPreferredStore(props);};var removePreferredStore=function removePreferredStore(){return StoreSelectorLocationLineItemComponentActions.onRemovePreferredStore(props);};return/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__location-line-item'},/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__location-line-item-header'},storeLocatorView&&/*#__PURE__*/React.createElement(\"span\",{className:'ms-store-select__location-line-item-store-index'},index),/*#__PURE__*/React.createElement(\"span\",{className:'ms-store-select__location-line-item-store-name'},storeName),distanceAsString?/*#__PURE__*/React.createElement(\"span\",{className:'ms-store-select__location-line-item-store-distance'},\" \",distanceAsString):false),/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__location-line-item-content'},/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__location-line-item-contact-info'},/*#__PURE__*/React.createElement(\"p\",{className:'ms-store-select__location-line-header'},resources.contactInfoHeader),storeAddress&&/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__location-line-shop-address-section'},/*#__PURE__*/React.createElement(\"span\",{className:'msi msi-map-marker-alt ms-store-select__location-line-shop-address-glyph-icon'}),/*#__PURE__*/React.createElement(\"span\",{className:'ms-store-select__location-line-shop-address-text'},storeAddress)),phoneNumber&&/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__location-line-shop-phone-section'},/*#__PURE__*/React.createElement(\"span\",{className:'msi msi-phone ms-store-select__location-line-shop-phone-icon'}),/*#__PURE__*/React.createElement(\"span\",{className:'ms-store-select__location-line-shop-phone-text'},phoneNumber))),/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__location-line-item-store-hours'},/*#__PURE__*/React.createElement(\"p\",{className:'ms-store-select__location-line-header'},resources.storeHoursHeader),renderStoreHours(storeHours,location,resources)),!storeLocatorView&&/*#__PURE__*/React.createElement(\"div\",{className:'ms-store-select__location-line-item-store-availability'},/*#__PURE__*/React.createElement(\"p\",{className:'ms-store-select__location-line-header'},resources.availabilityInfoHeader),stockText&&/*#__PURE__*/React.createElement(\"p\",{className:'ms-store-select__location-line-stock-status'},stockText),isCurrentLocation?/*#__PURE__*/React.createElement(\"p\",{className:'ms-store-select__location-line-current-location'},resources.currentLocation):canSelectLocation?/*#__PURE__*/React.createElement(\"button\",Object.assign({className:'ms-store-select__location-line-select-store',\"aria-label\":pickupInStoreAriaLabel,onClick:onClick},attributes),pickupInStoreButtonText):false),isPreferredStoreEnabled?isPreferredStore?/*#__PURE__*/React.createElement(\"button\",Object.assign({className:'ms-store-select__location-line-item-preferred-store',\"aria-label\":resources.preferredStoreAriaLabel,onClick:removePreferredStore},RemovePreferredStoreAttr),resources.preferredStoreText):/*#__PURE__*/React.createElement(\"button\",Object.assign({className:'ms-store-select__location-line-item-set-as-preferred-store',\"aria-label\":resources.setAsPreferredStoreTextAriaLabel},preferredStoreAttr,{onClick:setAsPreferredStore}),resources.setAsPreferredStoreText):null));};export var StoreSelectorLocationLineItemComponent=StoreSelectorLocationLineItem;","map":{"version":3,"sources":["modules/store-selector/components/store-selector-location-line-item/store-selector-location-line-item.components.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as React from 'react';\n\nimport { getPayloadObject, getTelemetryAttributes, IPayLoad, ITelemetryContent, TelemetryConstant } from '@msdyn365-commerce-modules/utilities';\nimport {\n    OrgUnitContact,\n    OrgUnitLocation,\n    StoreHours\n} from '@msdyn365-commerce/retail-proxy';\nimport { buildStoreHours, IHoursDisplayInfo, secondsToTime } from './date-time-helpers';\n\nexport interface IStoreSelectorLocationLineItemResources {\n    contactInfoHeader: string;\n    storeHoursHeader: string;\n    availabilityInfoHeader: string;\n\n    closedText: string;\n\n    outOfStock: string;\n    inStock: string;\n\n    currentLocation: string;\n    selectLocation: string;\n    selectLocationAriaLabelFormat: string;\n    setAsPreferredStoreText: string;\n    setAsPreferredStoreTextAriaLabel: string;\n    preferredStoreText: string;\n    preferredStoreAriaLabel: string;\n\n    days: {\n        monday: string;\n        tuesday: string;\n        wednesday: string;\n        thursday: string;\n        friday: string;\n        saturday: string;\n        sunday: string;\n        mondayFull: string;\n        tuesdayFull: string;\n        wednesdayFull: string;\n        thursdayFull: string;\n        fridayFull: string;\n        saturdayFull: string;\n        sundayFull: string;\n    };\n}\n\nexport interface IStoreSelectorLocationLineItemProps {\n    location: OrgUnitLocation;\n    storeHours?: StoreHours;\n\n    hideStockStatus?: boolean;\n    isInStock?: boolean;\n    isCurrentLocation?: boolean;\n\n    resources: IStoreSelectorLocationLineItemResources;\n    stockStatusLabel?: string;\n    storeLocatorView?: boolean;\n    isPreferredStoreEnabled?: boolean;\n    index: string;\n    preferredStoreLocationId: string | null;\n    /** The telemetry content */\n    telemetryContent?: ITelemetryContent;\n    preferredDistanceUnit: string;\n    isLocationDisabled?: boolean;\n    handlers: {\n        onSelected(location: OrgUnitLocation): void;\n        onSetAsPreferredStore(locationId: string | undefined): void;\n        onRemovePreferredStore(): void;\n    };\n}\n\nconst StoreSelectorLocationLineItemComponentActions = {\n    onLocationSelected(props: IStoreSelectorLocationLineItemProps): void {\n        props.handlers.onSelected(props.location);\n    },\n    onSetAsPreferredStore(props: IStoreSelectorLocationLineItemProps): void {\n        props.handlers.onSetAsPreferredStore(props.location.OrgUnitNumber);\n    },\n    onRemovePreferredStore(props: IStoreSelectorLocationLineItemProps): void {\n        props.handlers.onRemovePreferredStore();\n    }\n};\n\nconst renderStoreHours = (storeHours: StoreHours | undefined, location: OrgUnitLocation, resources: IStoreSelectorLocationLineItemResources): JSX.Element | null => {\n    // First, use the store hours. This will allow listing day by day houts\n    if (storeHours && storeHours.RegularStoreHours) {\n        const storeHoursList: IHoursDisplayInfo[] = buildStoreHours(storeHours.RegularStoreHours, resources);\n\n        return (\n            <div className='ms-store-select__store-hours-details-group'>\n                {storeHoursList.map(displayTime => (\n                    <div className='ms-store-select__store-hours-details'>\n                        {displayTime.endDayShort ? (\n                            <div className='ms-store-select__store-hours-day'>\n                                <abbr title={displayTime.startDayFull}>{displayTime.startDayShort}</abbr>–\n                                <abbr title={displayTime.endDayFull}>{displayTime.endDayShort}</abbr>\n                            </div>\n                        ) : (\n                                <div className='ms-store-select__store-hours-day'>\n                                    <abbr title={displayTime.startDayFull}>{displayTime.startDayShort}</abbr>\n                                </div>\n                            )}\n                        <div className='ms-store-select__store-hours-time'>{displayTime.timeRange}</div>\n                    </div>\n                ))}\n            </div>\n        );\n    } else {\n        // If that fails, fall back to using the OpenFrom and OpenTo properties on the location\n        const storeOpenFrom: string | undefined = secondsToTime(location.OpenFrom);\n        const storeOpenTo: string | undefined = secondsToTime(location.OpenTo);\n\n        return (\n            <div className='ms-store-select__store-hours-details'>\n                {storeOpenFrom}-{storeOpenTo}\n            </div>\n        );\n    }\n};\n\nconst buildDistanceString = (distance: number | undefined, preferredDistanceUnit: string, isLocationDisabled?: boolean): string | undefined => {\n    if (distance === undefined || isLocationDisabled) {\n        return undefined;\n    } else if (distance < 1) {\n        return `(<1 ${preferredDistanceUnit})`;\n    } else {\n        return `(${Math.floor(distance)} ${preferredDistanceUnit})`;\n    }\n};\n\nconst extractPhoneNumber = (contacts: OrgUnitContact[] | undefined): string | undefined => {\n    if (!contacts) {\n        return undefined;\n    }\n\n    const allPhoneContacts = contacts.filter(contact => contact.ContactTypeValue === 1 && !contact.IsPrivate);\n\n    if (allPhoneContacts && allPhoneContacts.length > 0) {\n        const primaryPhoneContact = allPhoneContacts.find(contact => contact.IsPrimary);\n\n        if (primaryPhoneContact) {\n            return primaryPhoneContact.Locator;\n        }\n\n        return allPhoneContacts[0].Locator;\n    }\n\n    return undefined;\n};\n\n// tslint:disable-next-line: max-func-body-length\nconst StoreSelectorLocationLineItem: React.FC<IStoreSelectorLocationLineItemProps> = (props: IStoreSelectorLocationLineItemProps) => {\n    const onClick = () => StoreSelectorLocationLineItemComponentActions.onLocationSelected(props);\n\n    const {\n        hideStockStatus,\n        isCurrentLocation,\n        isInStock,\n        location,\n        resources,\n        storeHours,\n        stockStatusLabel,\n        storeLocatorView,\n        index,\n        preferredStoreLocationId,\n        isPreferredStoreEnabled,\n        isLocationDisabled,\n        telemetryContent\n    } = props;\n\n    const storeName: string | undefined = location.OrgUnitName;\n    const distanceAsString: string | undefined = buildDistanceString(location.Distance, props.preferredDistanceUnit, isLocationDisabled);\n    const storeAddress: string | undefined = location.Address;\n    const phoneNumber: string | undefined = extractPhoneNumber(location.Contacts);\n\n    const resourceLabel = isInStock ? resources.inStock : resources.outOfStock;\n    const stockLabel = stockStatusLabel ? stockStatusLabel : undefined;\n    const stockText: string | undefined = (hideStockStatus) ? undefined : (stockLabel ? stockLabel : resourceLabel);\n    const canSelectLocation = hideStockStatus || isInStock;\n    const pickupInStoreButtonText: string = resources.selectLocation;\n    const pickupInStoreAriaLabel: string = resources.selectLocationAriaLabelFormat.replace('{StoreName}', storeName || '');\n    const isPreferredStore = preferredStoreLocationId === location.OrgUnitNumber;\n    const payLoad: IPayLoad = getPayloadObject('click', telemetryContent!, TelemetryConstant.PickupInStore);\n    const attributes = getTelemetryAttributes(telemetryContent!, payLoad);\n    payLoad.contentAction.etext = TelemetryConstant.PreferredStore;\n    const preferredStoreAttr = getTelemetryAttributes(telemetryContent!, payLoad);\n    payLoad.contentAction.etext = TelemetryConstant.RemovePreferredStore;\n    const RemovePreferredStoreAttr = getTelemetryAttributes(telemetryContent!, payLoad);\n\n    const setAsPreferredStore = () => StoreSelectorLocationLineItemComponentActions.onSetAsPreferredStore(props);\n    const removePreferredStore = () => StoreSelectorLocationLineItemComponentActions.onRemovePreferredStore(props);\n\n    return (\n        <div className='ms-store-select__location-line-item'>\n            <div className='ms-store-select__location-line-item-header'>\n                {storeLocatorView && <span className='ms-store-select__location-line-item-store-index'>{index}</span>}\n                <span className='ms-store-select__location-line-item-store-name'>{storeName}</span>\n                {distanceAsString ? <span className='ms-store-select__location-line-item-store-distance'> {distanceAsString}</span> : false}\n            </div>\n            <div className='ms-store-select__location-line-item-content'>\n                <div className='ms-store-select__location-line-item-contact-info'>\n                    <p className='ms-store-select__location-line-header'>{resources.contactInfoHeader}</p>\n                    {storeAddress && (\n                        <div className='ms-store-select__location-line-shop-address-section'>\n                            <span className='msi msi-map-marker-alt ms-store-select__location-line-shop-address-glyph-icon' />\n                            <span className='ms-store-select__location-line-shop-address-text'>{storeAddress}</span>\n                        </div>\n                    )}\n                    {phoneNumber && (\n                        <div className='ms-store-select__location-line-shop-phone-section'>\n                            <span className='msi msi-phone ms-store-select__location-line-shop-phone-icon' />\n                            <span className='ms-store-select__location-line-shop-phone-text'>{phoneNumber}</span>\n                        </div>\n                    )}\n                </div>\n                <div className='ms-store-select__location-line-item-store-hours'>\n                    <p className='ms-store-select__location-line-header'>{resources.storeHoursHeader}</p>\n                    {renderStoreHours(storeHours, location, resources)}\n                </div>\n                {\n                    !storeLocatorView &&\n                    <div className='ms-store-select__location-line-item-store-availability'>\n                        <p className='ms-store-select__location-line-header'>{resources.availabilityInfoHeader}</p>\n                        {stockText && <p className='ms-store-select__location-line-stock-status'>{stockText}</p>}\n                        {isCurrentLocation ?\n                            (\n                                <p className='ms-store-select__location-line-current-location'>{resources.currentLocation}</p>\n                            ) : canSelectLocation ?\n                                (\n                                    <button\n                                        className='ms-store-select__location-line-select-store'\n                                        aria-label={pickupInStoreAriaLabel}\n                                        onClick={onClick}\n                                        {...attributes}\n                                    >\n                                        {pickupInStoreButtonText}\n                                    </button>\n                                ) : (\n                                    false\n                                )\n                        }\n                    </div>\n                }\n                {\n                    isPreferredStoreEnabled ?\n                        isPreferredStore ?\n                            <button className='ms-store-select__location-line-item-preferred-store' aria-label={resources.preferredStoreAriaLabel} onClick={removePreferredStore} {...RemovePreferredStoreAttr} >\n                                {resources.preferredStoreText}\n                            </button>\n                            : <button className='ms-store-select__location-line-item-set-as-preferred-store' aria-label={resources.setAsPreferredStoreTextAriaLabel} {...preferredStoreAttr} onClick={setAsPreferredStore}>\n                                {resources.setAsPreferredStoreText}\n                            </button>\n                        : null\n                }\n            </div>\n        </div>\n    );\n};\n\nexport const StoreSelectorLocationLineItemComponent = StoreSelectorLocationLineItem as (props: IStoreSelectorLocationLineItemProps) => JSX.Element;"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}