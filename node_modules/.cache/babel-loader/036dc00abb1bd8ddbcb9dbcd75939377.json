{"ast":null,"code":"import\"core-js/modules/es.array.reduce.js\";import\"core-js/modules/es.object.assign.js\";import{PriceComponent}from'@msdyn365-commerce/components';import*as React from'react';export const getOrderDetailsPaymentMethods=(_ref)=>{let{priceContext,tenderLines,tenderIdOperationIdMap,resource:{paymentMethodsTitle,creditCardEndingLabel,giftCardEndingLabel,amountCoveredLabel,loyaltyCardUsedLabel,cashUsedLabel,customerAccountUsedLabel}}=_ref;const OPERATIONS={PayCard:201,PayGiftCertificate:214,PayLoyalty:207,PayCash:200,PayCustomerAccount:202};const getLastFourDigit=function getLastFourDigit(){let digits=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';return digits.substr(-4);};const getCard=tenderLine=>{const cardLastFourDigit=getLastFourDigit(tenderLine.MaskedCardNumber);const isValidCardNumber=cardLastFourDigit&&!isNaN(cardLastFourDigit);return/*#__PURE__*/React.createElement(\"div\",{className:'ms-order-details__payment-methods-line',key:tenderLine.TenderTypeId},/*#__PURE__*/React.createElement(\"p\",{className:'ms-order-details__payment-methods-card'},\"\".concat(tenderLine.CardTypeId,\" \").concat(isValidCardNumber?\"\".concat(creditCardEndingLabel,\" \").concat(cardLastFourDigit):\"\")));};const getCustomerAccountPayment=tenderLine=>/*#__PURE__*/React.createElement(\"div\",{className:'ms-order-details__payment-methods-line',key:tenderLine.TenderTypeId},/*#__PURE__*/React.createElement(\"p\",{className:'ms-order-details__payment-methods-customer-account'},customerAccountUsedLabel,\" \",tenderLine.CustomerId),/*#__PURE__*/React.createElement(\"p\",{className:'ms-order-details__payment-methods-customer-account-info'},amountCoveredLabel,/*#__PURE__*/React.createElement(PriceComponent,Object.assign({},priceContext,{className:'ms-order-details__payment-methods-customer-account-amount',data:{price:{CustomerContextualPrice:tenderLine.Amount||0}}}))));const getGiftCertificate=tenderLine=>/*#__PURE__*/React.createElement(\"div\",{className:'ms-order-details__payment-methods-line',key:tenderLine.TenderTypeId},/*#__PURE__*/React.createElement(\"p\",{className:'ms-order-details__payment-methods-gift-card-number'},giftCardEndingLabel,\" \",getLastFourDigit(tenderLine.GiftCardId)),/*#__PURE__*/React.createElement(\"p\",{className:'ms-order-details__payment-methods-gift-card-amount-info'},amountCoveredLabel,/*#__PURE__*/React.createElement(PriceComponent,Object.assign({},priceContext,{className:'ms-order-details__payment-methods-gift-card-amount',data:{price:{CustomerContextualPrice:tenderLine.Amount||0}}}))));const getLoyalty=tenderLine=>/*#__PURE__*/React.createElement(\"div\",{className:'ms-order-details__payment-methods-line',key:tenderLine.TenderTypeId},/*#__PURE__*/React.createElement(\"p\",{className:'ms-order-details__payment-methods-loyalty-number'},loyaltyCardUsedLabel,\" \",tenderLine.LoyaltyCardId),/*#__PURE__*/React.createElement(\"p\",{className:'ms-order-details__payment-methods-loyalty-amount-info'},amountCoveredLabel,/*#__PURE__*/React.createElement(PriceComponent,Object.assign({},priceContext,{className:'ms-order-details__payment-methods-loyalty-amount',data:{price:{CustomerContextualPrice:tenderLine.Amount||0}}}))));const getCash=tenderLine=>/*#__PURE__*/React.createElement(\"div\",{className:'ms-order-details__payment-methods-line',key:tenderLine.TenderTypeId},/*#__PURE__*/React.createElement(\"p\",{className:'ms-order-details__payment-methods-cash'},cashUsedLabel),/*#__PURE__*/React.createElement(\"p\",{className:'ms-order-details__payment-methods-cash-amount-info'},amountCoveredLabel,/*#__PURE__*/React.createElement(PriceComponent,Object.assign({},priceContext,{className:'ms-order-details__payment-methods-cash-amount',data:{price:{CustomerContextualPrice:tenderLine.Amount||0}}}))));return{paymentMethodsProps:{className:'ms-order-details__payment-methods'},title:/*#__PURE__*/React.createElement(\"div\",{className:'ms-order-details__payment-methods-title'},paymentMethodsTitle),methods:tenderLines.reduce((lines,tenderLine)=>{if(!tenderLine.TenderTypeId){return lines;}switch(tenderIdOperationIdMap[tenderLine.TenderTypeId]){case OPERATIONS.PayCard:lines.push(getCard(tenderLine));break;case OPERATIONS.PayGiftCertificate:lines.push(getGiftCertificate(tenderLine));break;case OPERATIONS.PayLoyalty:lines.push(getLoyalty(tenderLine));break;case OPERATIONS.PayCash:lines.push(getCash(tenderLine));break;case OPERATIONS.PayCustomerAccount:lines.push(getCustomerAccountPayment(tenderLine));break;default:}return lines;},[])};};","map":{"version":3,"sources":["modules/order-details/components/get-payment-methods.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { PriceComponent } from '@msdyn365-commerce/components';\nimport { TenderLine } from '@msdyn365-commerce/retail-proxy/dist/Entities/CommerceTypes.g';\nimport * as React from 'react';\nimport { IPaymentMethods, IPaymentMethodsInput } from '../../../common';\n\n// tslint:disable-next-line:max-func-body-length\nexport const getOrderDetailsPaymentMethods = ({\n    priceContext,\n    tenderLines,\n    tenderIdOperationIdMap,\n    resource: { paymentMethodsTitle, creditCardEndingLabel, giftCardEndingLabel, amountCoveredLabel, loyaltyCardUsedLabel, cashUsedLabel, customerAccountUsedLabel }\n}: IPaymentMethodsInput): IPaymentMethods => {\n\n    const OPERATIONS = {\n        PayCard: 201,\n        PayGiftCertificate: 214,\n        PayLoyalty: 207,\n        PayCash: 200,\n        PayCustomerAccount: 202,\n    };\n\n    const getLastFourDigit = (digits = '') => digits.substr(-4);\n\n    const getCard = (tenderLine: TenderLine) => {\n        const cardLastFourDigit = getLastFourDigit(tenderLine.MaskedCardNumber);\n        // @ts-ignore\n        const isValidCardNumber = cardLastFourDigit && !isNaN(cardLastFourDigit);\n\n        return (\n            <div className='ms-order-details__payment-methods-line' key={tenderLine.TenderTypeId}>\n                <p className='ms-order-details__payment-methods-card'>\n                    {`${tenderLine.CardTypeId} ${isValidCardNumber ? `${creditCardEndingLabel} ${cardLastFourDigit}` : ``}`}\n                </p>\n            </div>\n        );\n    };\n\n    const getCustomerAccountPayment = (tenderLine: TenderLine) => (\n        <div className='ms-order-details__payment-methods-line' key={tenderLine.TenderTypeId}>\n            <p className='ms-order-details__payment-methods-customer-account'>\n                {customerAccountUsedLabel} {tenderLine.CustomerId}\n            </p>\n            <p className='ms-order-details__payment-methods-customer-account-info'>\n                {amountCoveredLabel}\n                <PriceComponent\n                    {...priceContext}\n                    className='ms-order-details__payment-methods-customer-account-amount'\n                    data={{ price: { CustomerContextualPrice: tenderLine.Amount || 0 } }}\n                />\n            </p>\n        </div>\n    );\n\n    const getGiftCertificate = (tenderLine: TenderLine) => (\n        <div className='ms-order-details__payment-methods-line' key={tenderLine.TenderTypeId}>\n            <p className='ms-order-details__payment-methods-gift-card-number'>\n                {giftCardEndingLabel} {getLastFourDigit(tenderLine.GiftCardId)}\n            </p>\n            <p className='ms-order-details__payment-methods-gift-card-amount-info'>\n                {amountCoveredLabel}\n                <PriceComponent\n                    {...priceContext}\n                    className='ms-order-details__payment-methods-gift-card-amount'\n                    data={{ price: { CustomerContextualPrice: tenderLine.Amount || 0 } }}\n                />\n            </p>\n        </div>\n    );\n\n    const getLoyalty = (tenderLine: TenderLine) => (\n        <div className='ms-order-details__payment-methods-line' key={tenderLine.TenderTypeId}>\n            <p className='ms-order-details__payment-methods-loyalty-number'>\n                {loyaltyCardUsedLabel} {tenderLine.LoyaltyCardId}\n            </p>\n            <p className='ms-order-details__payment-methods-loyalty-amount-info'>\n                {amountCoveredLabel}\n                <PriceComponent\n                    {...priceContext}\n                    className='ms-order-details__payment-methods-loyalty-amount'\n                    data={{ price: { CustomerContextualPrice: tenderLine.Amount || 0 } }}\n                />\n            </p>\n        </div>\n    );\n\n    const getCash = (tenderLine: TenderLine) => (\n        <div className='ms-order-details__payment-methods-line' key={tenderLine.TenderTypeId}>\n            <p className='ms-order-details__payment-methods-cash'>{cashUsedLabel}</p>\n            <p className='ms-order-details__payment-methods-cash-amount-info'>\n                {amountCoveredLabel}\n                <PriceComponent\n                    {...priceContext}\n                    className='ms-order-details__payment-methods-cash-amount'\n                    data={{ price: { CustomerContextualPrice: tenderLine.Amount || 0 } }}\n                />\n            </p>\n        </div>\n    );\n\n    return {\n        paymentMethodsProps: { className: 'ms-order-details__payment-methods' },\n        title: <div className='ms-order-details__payment-methods-title'>{paymentMethodsTitle}</div>,\n        methods: tenderLines.reduce((lines: React.ReactNode[], tenderLine) => {\n            if (!tenderLine.TenderTypeId) {\n                return lines;\n            }\n            switch (tenderIdOperationIdMap[tenderLine.TenderTypeId]) {\n                case OPERATIONS.PayCard:\n                    lines.push(getCard(tenderLine));\n                    break;\n                case OPERATIONS.PayGiftCertificate:\n                    lines.push(getGiftCertificate(tenderLine));\n                    break;\n                case OPERATIONS.PayLoyalty:\n                    lines.push(getLoyalty(tenderLine));\n                    break;\n                case OPERATIONS.PayCash:\n                    lines.push(getCash(tenderLine));\n                    break;\n                case OPERATIONS.PayCustomerAccount:\n                    lines.push(getCustomerAccountPayment(tenderLine));\n                    break;\n                default:\n                // do nothing\n            }\n            return lines;\n        },                          [])\n    };\n};\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}