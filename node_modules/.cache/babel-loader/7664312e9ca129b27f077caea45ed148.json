{"ast":null,"code":"import\"core-js/modules/es.object.assign.js\";import\"core-js/modules/web.dom-collections.iterator.js\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import{getTelemetryObject}from'@msdyn365-commerce-modules/utilities';import{Carousel}from'@msdyn365-commerce/components';import classnames from'classnames';import*as React from'react';import{PromoBannerCloseButton,PromoBannerLinks,PromoBannerText}from'./components';class PromoBanner extends React.PureComponent{constructor(){super(...arguments);this.state={animating:false,isVisible:true,activeIndex:0};this.telemetryContent=getTelemetryObject(this.props.context.request.telemetryPageName,this.props.friendlyName,this.props.telemetry);this.handleTextChange=event=>{if(this.props.config.bannerMessages&&this.props.config.bannerMessages[0]){this.props.config.bannerMessages[0].text=event.target.value;}};this.handleLinkTextChange=linkIndex=>event=>{if(this.props.config.bannerMessages&&this.props.config.bannerMessages[1]){const links=this.props.config.bannerMessages[1].links;if(links){links[linkIndex].linkText=event.target.value;}}};this._next=()=>{const nextIndex=this._isLastItem()?0:this.state.activeIndex+1;this._goToIndex(nextIndex);};this._previous=()=>{const nextIndex=this._isFirstItem()?this.props.config.bannerMessages?this.props.config.bannerMessages.length-1:0:this.state.activeIndex-1;this._goToIndex(nextIndex);};this._goToIndex=index=>{if(this.state.animating){return;}this.setState({activeIndex:index});};this._isFirstItem=()=>this.state.activeIndex===0;this._isLastItem=()=>this.props.config.bannerMessages&&this.state.activeIndex===this.props.config.bannerMessages.length-1;this._onDismiss=()=>{this.setState({isVisible:false});};}render(){const{bannerMessages,dismissEnabled,interval,hideFlipper,autoplay,className=''}=this.props.config;const{closeButtonAriaLabel,closeButtonLabel}=this.props.resources;const{isVisible,activeIndex}=this.state;if(!isVisible){this.props.context.telemetry.error('Promo banner content is empty, module wont render.');return null;}const viewProps=_objectSpread(_objectSpread({},this.props),{},{className:classnames('ms-promo-banner',className),isVisible,onDismiss:this._onDismiss,handleLinks:this.handleLinkTextChange,handleText:this.handleTextChange,promoBannerProps:{className:classnames('ms-promo-banner',className),moduleProps:this.props,role:'banner'},PromoBannerTextProps:{tag:PromoBannerText},PromoBannerLinksProps:{tag:PromoBannerLinks,telemetryContent:this.telemetryContent},contentProps:{className:'ms-promo-banner__content'},bannerMessages:bannerMessages,activeIndex:activeIndex,CarouselProps:{tag:Carousel,className:'ms-promo-banner__carousel',activeIndex:activeIndex,next:this._next,previous:this._previous,onIndicatorsClickHandler:this._goToIndex,hideIndicator:hideFlipper,interval:interval,hideFlipper:hideFlipper,autoplay:autoplay},closeButton:dismissEnabled&&/*#__PURE__*/React.createElement(PromoBannerCloseButton,Object.assign({},{onClose:this._onDismiss,label:closeButtonLabel,closeButtonAriaLabel,telemetryContent:this.telemetryContent}))});return this.props.renderView(viewProps);}}export default PromoBanner;","map":{"version":3,"sources":["modules/promo-banner/promo-banner.tsx"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { getTelemetryObject, IModuleProps, INodeProps, ITelemetryContent } from '@msdyn365-commerce-modules/utilities';\nimport { Carousel } from '@msdyn365-commerce/components';\nimport * as Msdyn365 from '@msdyn365-commerce/core';\nimport classnames from 'classnames';\nimport * as React from 'react';\nimport { PromoBannerCloseButton, PromoBannerLinks, PromoBannerText } from './components';\nimport { IBannerMessagesData, IPromoBannerProps } from './promo-banner.props.autogenerated';\n\nexport interface IPromoBannerState {\n    animating: boolean;\n    isVisible: boolean;\n    activeIndex: number;\n}\n\nexport interface IPromoBannerViewProps extends IPromoBannerProps<{}>, IPromoBannerState {\n    promoBannerProps: IModuleProps;\n    contentProps: INodeProps ;\n    bannerMessages: IBannerMessagesData[];\n    PromoBannerTextProps: INodeProps;\n    PromoBannerLinksProps: INodeProps;\n    CarouselProps: INodeProps;\n    closeButton?: React.ReactNode;\n    className: string;\n    onDismiss(): void;\n    handleText(): void;\n    handleLinks(): void;\n}\n\n/**\n *\n * PromoBannerModule component\n * @extends {React.PureComponent<IPromoBannerProps<IPromoBannerState>>}\n */\nclass PromoBanner extends React.PureComponent<IPromoBannerProps<{}>, IPromoBannerState> {\n    public state: IPromoBannerState = {\n        animating: false,\n        isVisible: true,\n        activeIndex: 0\n    };\n\n    private telemetryContent: ITelemetryContent = getTelemetryObject(this.props.context.request.telemetryPageName!,\n                                                                     this.props.friendlyName,\n                                                                     this.props.telemetry);\n\n    public render(): JSX.Element | null {\n        const { bannerMessages, dismissEnabled, interval, hideFlipper, autoplay, className= '' } = this.props.config;\n        const { closeButtonAriaLabel, closeButtonLabel } = this.props.resources;\n        const { isVisible, activeIndex } = this.state;\n\n        if (!isVisible) {\n            this.props.context.telemetry.error('Promo banner content is empty, module wont render.');\n            return null;\n        }\n\n        const viewProps = {\n            // Context for telemetry and raw data for C1 to do customization\n            // Including computed data, state data and methods\n            ...this.props,\n            className: classnames('ms-promo-banner', className),\n            isVisible, // state data\n            onDismiss: this._onDismiss, // methods\n            handleLinks: this.handleLinkTextChange,\n            handleText: this.handleTextChange,\n\n            promoBannerProps: { className: classnames('ms-promo-banner', className), moduleProps: this.props, role: 'banner' },\n            PromoBannerTextProps: {\n                tag: PromoBannerText\n            },\n            PromoBannerLinksProps: {\n                tag: PromoBannerLinks,\n                telemetryContent: this.telemetryContent\n            },\n            contentProps: { className: 'ms-promo-banner__content' },\n            bannerMessages: bannerMessages,\n            activeIndex: activeIndex,\n            CarouselProps: {\n                tag: Carousel,\n                className: 'ms-promo-banner__carousel',\n                activeIndex: activeIndex,\n                next: this._next,\n                previous: this._previous,\n                onIndicatorsClickHandler: this._goToIndex,\n                hideIndicator: hideFlipper,\n                interval: interval,\n                hideFlipper: hideFlipper,\n                autoplay: autoplay\n            },\n            closeButton: dismissEnabled && <PromoBannerCloseButton {...{ onClose: this._onDismiss, label: closeButtonLabel, closeButtonAriaLabel, telemetryContent: this.telemetryContent }} />\n        };\n\n        return this.props.renderView(viewProps) as React.ReactElement;\n    }\n    public handleTextChange = (event: Msdyn365.ContentEditableEvent) => {\n        if(this.props.config.bannerMessages && this.props.config.bannerMessages[0]) {\n            this.props.config.bannerMessages[0].text = event.target.value;\n        }\n    }\n    public handleLinkTextChange = (linkIndex: number) => (event: Msdyn365.ContentEditableEvent) => {\n        if(this.props.config.bannerMessages && this.props.config.bannerMessages[1]) {\n            const links = this.props.config.bannerMessages[1].links;\n            if(links) {\n                links[linkIndex].linkText = event.target.value;\n            }\n        }\n    };\n\n    private _next = (): void => {\n        const nextIndex = this._isLastItem() ? 0 : this.state.activeIndex + 1;\n        this._goToIndex(nextIndex);\n    };\n\n    private _previous = (): void => {\n        const nextIndex = this._isFirstItem() ? (this.props.config.bannerMessages ? this.props.config.bannerMessages.length - 1 : 0) : this.state.activeIndex - 1;\n        this._goToIndex(nextIndex);\n    };\n\n    private _goToIndex = (index: number): void => {\n        if (this.state.animating) {\n            return;\n        }\n        this.setState({ activeIndex: index });\n    };\n\n    private _isFirstItem = () => this.state.activeIndex === 0;\n\n    private _isLastItem = () => this.props.config.bannerMessages && this.state.activeIndex === this.props.config.bannerMessages.length - 1;\n\n    private _onDismiss = (): void => {\n        this.setState({ isVisible: false });\n    };\n}\n\nexport default PromoBanner;\n"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}