{"ast":null,"code":"import\"core-js/modules/es.promise.js\";import{createObservableDataAction}from'@msdyn365-commerce/core';import{createGlobalState}from'../global-state/i-global-state';/**\r\n * Shared class that handles global state inputs\r\n */export class GlobalStateInput{constructor(key,stateConstructor,apiSettings){this.getCacheKey=()=>\"\".concat(this.key,\"-chanId:\").concat(this.apiSettings.channelId,\"-catId:\").concat(this.apiSettings.catalogId);this.getCacheObjectType=()=>this.key;this.dataCacheType=()=>'instance';this.apiSettings=apiSettings;this.stateConstructor=stateConstructor;this.key=key;}}export async function getState(input,ctx){const globalStateObject=createGlobalState(input.stateConstructor,ctx);await globalStateObject.initialize();return globalStateObject;}export default function createGlobalStateDataAction(key,stateConstructor){return createObservableDataAction({action:getState,input:args=>{return new GlobalStateInput(key,stateConstructor,args.requestContext.apiSettings);}});}","map":{"version":3,"sources":["data-actions/global-state-data-action.ts"],"names":[],"mappings":"sCAAA,OAAoB,0BAApB,KAA4J,yBAA5J,CACA,OAAS,iBAAT,KAAwE,gCAAxE,CAIA;;AAEG,GACH,MAAM,MAAO,CAAA,gBAAgB,CAKzB,WAAA,CAAY,GAAZ,CAAkC,gBAAlC,CAAkF,WAAlF,CAAmH,CAM5G,KAAA,WAAA,CAAc,cAAS,KAAK,GAAd,oBAA4B,KAAK,WAAL,CAAiB,SAA7C,mBAAgE,KAAK,WAAL,CAAiB,SAAjF,CAAd,CACA,KAAA,kBAAA,CAAqB,IAAM,KAAK,GAAhC,CACA,KAAA,aAAA,CAAgB,IAAiB,UAAjC,CAPH,KAAK,WAAL,CAAmB,WAAnB,CACA,KAAK,gBAAL,CAAwB,gBAAxB,CACA,KAAK,GAAL,CAAW,GAAX,CACH,CATwB,CAgB7B,MAAO,eAAe,CAAA,QAAf,CAAmD,KAAnD,CAAkF,GAAlF,CAAqG,CACxG,KAAM,CAAA,iBAAiB,CAAG,iBAAiB,CAAC,KAAK,CAAC,gBAAP,CAAyB,GAAzB,CAA3C,CAEA,KAAM,CAAA,iBAAiB,CAAC,UAAlB,EAAN,CAEA,MAAO,CAAA,iBAAP,CACH,CAED,cAAc,SAAU,CAAA,2BAAV,CAAiE,GAAjE,CAAuF,gBAAvF,CAAqI,CAC/I,MAAO,CAAA,0BAA0B,CAAC,CAC9B,MAAM,CAAiB,QADO,CAE9B,KAAK,CAAG,IAAD,EAA+B,CAClC,MAAO,IAAI,CAAA,gBAAJ,CAAqB,GAArB,CAA0B,gBAA1B,CAA4C,IAAI,CAAC,cAAL,CAAoB,WAAhE,CAAP,CACH,CAJ6B,CAAD,CAAjC,CAMH","sourcesContent":["import { CacheType, createObservableDataAction, IAction, IActionContext, IActionInput, ICommerceApiSettings, ICreateActionContext, IObservableAction } from '@msdyn365-commerce/core';\nimport { createGlobalState, GlobalStateConstructor, IGlobalState } from '../global-state/i-global-state';\n\nexport declare type GlobalStateType = 'CARTSTATE' | 'CHECKOUTSTATE';\n\n/**\n * Shared class that handles global state inputs\n */\nexport class GlobalStateInput<TOut extends IGlobalState> implements IActionInput {\n    public readonly stateConstructor: GlobalStateConstructor<TOut>;\n    public readonly key: GlobalStateType;\n    private apiSettings: ICommerceApiSettings;\n\n    constructor(key: GlobalStateType, stateConstructor: GlobalStateConstructor<TOut>, apiSettings: ICommerceApiSettings) {\n        this.apiSettings = apiSettings;\n        this.stateConstructor = stateConstructor;\n        this.key = key;\n    }\n\n    public getCacheKey = () => `${this.key}-chanId:${this.apiSettings.channelId}-catId:${this.apiSettings.catalogId}`;\n    public getCacheObjectType = () => this.key;\n    public dataCacheType = (): CacheType => 'instance';\n}\n\nexport async function getState<TOut extends IGlobalState>(input: GlobalStateInput<TOut>, ctx: IActionContext): Promise<TOut> {\n    const globalStateObject = createGlobalState(input.stateConstructor, ctx);\n\n    await globalStateObject.initialize();\n\n    return globalStateObject;\n}\n\nexport default function createGlobalStateDataAction<TOut extends IGlobalState>(key: GlobalStateType, stateConstructor: GlobalStateConstructor<TOut>): IObservableAction<TOut> {\n    return createObservableDataAction({\n        action: <IAction<TOut>>getState,\n        input: (args: ICreateActionContext) => {\n            return new GlobalStateInput(key, stateConstructor, args.requestContext.apiSettings);\n        }\n    });\n}"],"sourceRoot":"./src/"},"metadata":{},"sourceType":"module"}