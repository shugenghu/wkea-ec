{"ast":null,"code":"import\"core-js/modules/es.promise.js\";import{createObservableDataAction}from'@msdyn365-commerce/core';import{getAttributeDefinitionsAsync}from'@msdyn365-commerce/retail-proxy/dist/DataActions/StoreOperationsDataActions.g';import{buildCacheKey}from'./utilities/utils';/**\r\n * Input class for get attribute definitions data action\r\n */export class GetAttributeDefinitionsInput{constructor(apiSettings,attributeDefinitionCriteria){this.getCacheKey=()=>buildCacheKey('AttributeDefinitions',this.apiSettings);this.getCacheObjectType=()=>'CustomerAttribute';this.dataCacheType=()=>'request';this.attributeDefinitionCriteria=attributeDefinitionCriteria;this.apiSettings=apiSettings;}}/**\r\n * Creates the input required to make the retail api call\r\n */const createInput=inputData=>{const{apiSettings,channel}=inputData.requestContext;if(!channel||!channel.CustomerAttributeGroupId){throw new Error('[getAttributeDefinitions][createInput]: Customer attribute group id is not found.');}return new GetAttributeDefinitionsInput(apiSettings,{AttributeGroupIdentifier:channel.CustomerAttributeGroupId});};const getAttributeDefinitionsAction=async(input,ctx)=>{if(input&&ctx.requestContext.channel&&ctx.requestContext.channel.CustomerAttributeGroupId){return getAttributeDefinitionsAsync({callerContext:ctx},input.attributeDefinitionCriteria||null).then(response=>{return response;});}ctx.trace('[getAttributeDefinitions]Invalid input passed to action');return[];};export default createObservableDataAction({id:'@msdyn365-commerce-modules/retail-actions/get-custom-attributes',action:getAttributeDefinitionsAction,input:createInput});","map":{"version":3,"sources":["../../src/get-attribute-definitions.ts"],"names":[],"mappings":"sCACA,OAAS,0BAAT,KAAiG,yBAAjG,CACA,OACI,4BADJ,KAEO,+EAFP,CAIA,OAAS,aAAT,KAA8B,mBAA9B,CAEA;;AAEG,GACH,MAAM,MAAO,CAAA,4BAA4B,CAIrC,WAAA,CAAY,WAAZ,CAA+C,2BAA/C,CAAwG,CAKjG,KAAA,WAAA,CAAc,IAAM,aAAa,CAAC,sBAAD,CAAyB,KAAK,WAA9B,CAAjC,CACA,KAAA,kBAAA,CAAqB,IAAM,mBAA3B,CACA,KAAA,aAAA,CAAgB,IAAiB,SAAjC,CANH,KAAK,2BAAL,CAAmC,2BAAnC,CACA,KAAK,WAAL,CAAmB,WAAnB,CACH,CAPoC,CAczC;;AAEG,GACH,KAAM,CAAA,WAAW,CAAI,SAAD,EAAkF,CAClG,KAAM,CAAE,WAAF,CAAe,OAAf,EAA2B,SAAS,CAAC,cAA3C,CACA,GAAI,CAAC,OAAD,EAAY,CAAC,OAAO,CAAC,wBAAzB,CAAmD,CAC/C,KAAM,IAAI,CAAA,KAAJ,CAAU,mFAAV,CAAN,CACH,CAED,MAAO,IAAI,CAAA,4BAAJ,CAAiC,WAAjC,CAA8C,CAAC,wBAAwB,CAAE,OAAO,CAAC,wBAAnC,CAA9C,CAAP,CACH,CAPD,CASA,KAAM,CAAA,6BAA6B,CAAG,MAAO,KAAP,CAA4C,GAA5C,GAAmG,CACrI,GAAI,KAAK,EAAI,GAAG,CAAC,cAAJ,CAAmB,OAA5B,EAAuC,GAAG,CAAC,cAAJ,CAAmB,OAAnB,CAA2B,wBAAtE,CAAgG,CAC5F,MAAO,CAAA,4BAA4B,CAAC,CAAE,aAAa,CAAE,GAAjB,CAAD,CAAyB,KAAK,CAAC,2BAAN,EAAqC,IAA9D,CAA5B,CAAgG,IAAhG,CAAqG,QAAQ,EAAG,CACnH,MAAQ,CAAA,QAAR,CACH,CAFM,CAAP,CAGH,CAED,GAAG,CAAC,KAAJ,CAAU,yDAAV,EACA,MAAO,EAAP,CACH,CATD,CAWA,cAAe,CAAA,0BAA0B,CAAC,CACtC,EAAE,CAAE,iEADkC,CAEtC,MAAM,CAAkC,6BAFF,CAGtC,KAAK,CAAE,WAH+B,CAAD,CAAzC","sourcesContent":["import { CacheType, IAction, IActionInput, ICommerceApiSettings } from '@msdyn365-commerce/core';\nimport { createObservableDataAction, IActionContext, IAny, ICreateActionContext, IGeneric } from '@msdyn365-commerce/core';\nimport {\n    getAttributeDefinitionsAsync\n} from '@msdyn365-commerce/retail-proxy/dist/DataActions/StoreOperationsDataActions.g';\nimport { AttributeDefinition, AttributeDefinitionCriteria} from '@msdyn365-commerce/retail-proxy/dist/Entities/CommerceTypes.g';\nimport { buildCacheKey } from './utilities/utils';\n\n/**\n * Input class for get attribute definitions data action\n */\nexport class GetAttributeDefinitionsInput implements IActionInput {\n    public attributeDefinitionCriteria?: AttributeDefinitionCriteria;\n    private apiSettings: ICommerceApiSettings;\n\n    constructor(apiSettings: ICommerceApiSettings, attributeDefinitionCriteria?: AttributeDefinitionCriteria) {\n        this.attributeDefinitionCriteria = attributeDefinitionCriteria;\n        this.apiSettings = apiSettings;\n    }\n\n    public getCacheKey = () => buildCacheKey('AttributeDefinitions', this.apiSettings);\n    public getCacheObjectType = () => 'CustomerAttribute';\n    public dataCacheType = (): CacheType => 'request';\n}\n\n/**\n * Creates the input required to make the retail api call\n */\nconst createInput = (inputData: ICreateActionContext<IGeneric<IAny>>): GetAttributeDefinitionsInput => {\n    const { apiSettings, channel } = inputData.requestContext;\n    if (!channel || !channel.CustomerAttributeGroupId) {\n        throw new Error('[getAttributeDefinitions][createInput]: Customer attribute group id is not found.');\n    }\n\n    return new GetAttributeDefinitionsInput(apiSettings, {AttributeGroupIdentifier: channel.CustomerAttributeGroupId});\n};\n\nconst getAttributeDefinitionsAction = async (input: GetAttributeDefinitionsInput, ctx: IActionContext): Promise<AttributeDefinition[]> => {\n    if (input && ctx.requestContext.channel && ctx.requestContext.channel.CustomerAttributeGroupId) {\n        return getAttributeDefinitionsAsync({ callerContext: ctx }, input.attributeDefinitionCriteria || null).then(response => {\n            return  response;\n        });\n    }\n\n    ctx.trace('[getAttributeDefinitions]Invalid input passed to action');\n    return [];\n};\n\nexport default createObservableDataAction({\n    id: '@msdyn365-commerce-modules/retail-actions/get-custom-attributes',\n    action: <IAction<AttributeDefinition[]>>getAttributeDefinitionsAction,\n    input: createInput\n});\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}