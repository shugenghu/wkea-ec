{"ast":null,"code":"/*!\r\n * Copyright (c) Microsoft Corporation.\r\n * All rights reserved. See LICENSE in the project root for license information.\r\n */'use strict';import*as fs from'fs';import*as path from'path';// Make sure any symlinks in the project folder are resolved:\n// https://github.com/facebookincubator/create-react-app/issues/637\nvar appDirectory=fs.realpathSync(process.cwd());var resolveFromBuildFolder=function resolveFromBuildFolder(relativePath){return path.resolve(appDirectory,'build',relativePath);};var resolveFromNodeModules=function resolveFromNodeModules(relativePath){return path.resolve(appDirectory,'node_modules',relativePath);};var _cache=new Map();export var getSharedComponentCssPath=function getSharedComponentCssPath(isDebug){var key=\"\".concat(isDebug);if(_cache.has(key)){return _cache.get(key);}var rootPath=path.resolve(appDirectory,'build','public','static','shared-components').replace(/\\\\/gi,'/');var appBuildPublicStatic=path.resolve(appDirectory,'build','public','static').replace(/\\\\/gi,'/');// @TODO remove fallback logic\nvar sharedComponentsDev=path.relative(appBuildPublicStatic,path.join(rootPath,'main.css')).replace(/\\\\/gi,'/');var sharedComponentsDevVnext=path.relative(appBuildPublicStatic,path.join(rootPath,'shared-components.css')).replace(/\\\\/gi,'/');var sharedComponentsProdVnext=path.relative(appBuildPublicStatic,path.join(rootPath,'shared-components.min.css')).replace(/\\\\/gi,'/');// @TODO this is part of the hack until shared components ships two bundles excluding bootstrap\nif(fs.existsSync(path.resolve(appBuildPublicStatic,sharedComponentsDev))){_cache.set(key,sharedComponentsDev);}else{// this code should take over...\nif(isDebug&&fs.existsSync(path.resolve(appBuildPublicStatic,sharedComponentsDevVnext))){_cache.set(key,sharedComponentsDevVnext);}else if(!isDebug&&fs.existsSync(path.resolve(appBuildPublicStatic,sharedComponentsProdVnext))){_cache.set(key,sharedComponentsProdVnext);}else{// falsey string, won't create output\n_cache.set(key,'');}}return _cache.get(key);};export default{KEYSTONE_PAGE_MOCKS_DIR:resolveFromBuildFolder('pageMocks'),KEYSTONE_MODULE_MOCKS_DIR:resolveFromBuildFolder('moduleMocks'),KEYSTONE_NODE_MODULES_DIR:resolveFromNodeModules('@msdyn365-commerce-modules'),KEYSTONE_DEFINITIONS_DIR:resolveFromBuildFolder('definitions'),KEYSTONE_THEMES_DIR:path.resolve(appDirectory,'src','themes'),KEYSTONE_STATIC_DIR:resolveFromBuildFolder('public/static'),KEYSTONE_APP_DEFINITION_FILEPATH:path.resolve(appDirectory,'lib','module-definition-api.json'),KEYSTONE_APP_DAPI_FILEPATH:path.resolve(appDirectory,'lib','module-definition-dapi.json'),KEYSTONE_APP_THEMES_DAPI_FILEPATH:path.resolve(appDirectory,'lib','themes-definition-dapi.json'),KEYSTONE_APP_RESOURCES_DAPI_FILEPATH:path.resolve(appDirectory,'lib','resources-definition-dapi.json'),KEYSTONE_APP_SETTINGS_DAPI_FILEPATH:path.resolve(appDirectory,'lib','themesettings-dapi.json'),KEYSTONE_APP_PACKAGE_VERSION:resolveFromBuildFolder('packageVersions.json'),KEYSTONE_APP_YARN_LOCK:path.resolve(appDirectory,'yarn.lock'),KEYSTONE_APP_SETTINGS_DIR:resolveFromBuildFolder('settings'),KEYSTONE_SECRETS_DIR:resolveFromBuildFolder('secrets')};","map":{"version":3,"sources":["../../src/paths.ts"],"names":[],"mappings":"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","sourcesContent":["/*!\n * Copyright (c) Microsoft Corporation.\n * All rights reserved. See LICENSE in the project root for license information.\n */\n\n'use strict';\nimport * as fs from 'fs';\nimport * as path from 'path';\n\n// Make sure any symlinks in the project folder are resolved:\n// https://github.com/facebookincubator/create-react-app/issues/637\nconst appDirectory = fs.realpathSync(process.cwd());\nconst resolveFromBuildFolder = (relativePath: string) => path.resolve(appDirectory, 'build', relativePath);\nconst resolveFromNodeModules = (relativePath: string) => path.resolve(appDirectory, 'node_modules', relativePath);\n\nconst _cache = new Map<string, string>();\n\nexport const getSharedComponentCssPath = (isDebug: boolean) => {\n    const key = `${isDebug}`;\n    if (_cache.has(key)) {\n        return _cache.get(key);\n    }\n    const rootPath = path.resolve(appDirectory, 'build', 'public', 'static', 'shared-components').replace(/\\\\/gi, '/');\n    const appBuildPublicStatic = path.resolve(appDirectory, 'build', 'public', 'static').replace(/\\\\/gi, '/');\n    // @TODO remove fallback logic\n    const sharedComponentsDev = path.relative(appBuildPublicStatic, path.join(rootPath, 'main.css')).replace(/\\\\/gi, '/');\n    const sharedComponentsDevVnext = path.relative(appBuildPublicStatic, path.join(rootPath, 'shared-components.css')).replace(/\\\\/gi, '/');\n    const sharedComponentsProdVnext = path\n        .relative(appBuildPublicStatic, path.join(rootPath, 'shared-components.min.css'))\n        .replace(/\\\\/gi, '/');\n\n    // @TODO this is part of the hack until shared components ships two bundles excluding bootstrap\n    if (fs.existsSync(path.resolve(appBuildPublicStatic, sharedComponentsDev))) {\n        _cache.set(key, sharedComponentsDev);\n    } else {\n        // this code should take over...\n        if (isDebug && fs.existsSync(path.resolve(appBuildPublicStatic, sharedComponentsDevVnext))) {\n            _cache.set(key, sharedComponentsDevVnext);\n        } else if (!isDebug && fs.existsSync(path.resolve(appBuildPublicStatic, sharedComponentsProdVnext))) {\n            _cache.set(key, sharedComponentsProdVnext);\n        } else {\n            // falsey string, won't create output\n            _cache.set(key, '');\n        }\n    }\n    return _cache.get(key);\n};\n\nexport default {\n    KEYSTONE_PAGE_MOCKS_DIR: resolveFromBuildFolder('pageMocks'),\n    KEYSTONE_MODULE_MOCKS_DIR: resolveFromBuildFolder('moduleMocks'),\n    KEYSTONE_NODE_MODULES_DIR: resolveFromNodeModules('@msdyn365-commerce-modules'),\n    KEYSTONE_DEFINITIONS_DIR: resolveFromBuildFolder('definitions'),\n    KEYSTONE_THEMES_DIR: path.resolve(appDirectory, 'src', 'themes'),\n    KEYSTONE_STATIC_DIR: resolveFromBuildFolder('public/static'),\n    KEYSTONE_APP_DEFINITION_FILEPATH: path.resolve(appDirectory, 'lib', 'module-definition-api.json'),\n    KEYSTONE_APP_DAPI_FILEPATH: path.resolve(appDirectory, 'lib', 'module-definition-dapi.json'),\n    KEYSTONE_APP_THEMES_DAPI_FILEPATH: path.resolve(appDirectory, 'lib', 'themes-definition-dapi.json'),\n    KEYSTONE_APP_RESOURCES_DAPI_FILEPATH: path.resolve(appDirectory, 'lib', 'resources-definition-dapi.json'),\n    KEYSTONE_APP_SETTINGS_DAPI_FILEPATH: path.resolve(appDirectory, 'lib', 'themesettings-dapi.json'),\n    KEYSTONE_APP_PACKAGE_VERSION: resolveFromBuildFolder('packageVersions.json'),\n    KEYSTONE_APP_YARN_LOCK: path.resolve(appDirectory, 'yarn.lock'),\n    KEYSTONE_APP_SETTINGS_DIR: resolveFromBuildFolder('settings'),\n    KEYSTONE_SECRETS_DIR: resolveFromBuildFolder('secrets')\n};\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}